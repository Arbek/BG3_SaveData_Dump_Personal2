Version 1
SubGoalCombiner SGC_AND

INITSECTION
DB_Debug_WYR_WelcomeDialogRepro(S_GLO_GnomePrisoner_001_4fbd62e8-a486-471e-8a65-00966b058dd5, Debug_WYR_Ironhand_WelcomeDialog_GnomePrisoner_001_00b1d993-21f7-4d10-93cf-a03cf8ee1738);
DB_Debug_WYR_WelcomeDialogRepro(S_WYR_Ironhand_Artificer_001_627b5b4d-51df-416a-800a-ddf357c96995, Debug_WYR_Ironhand_WelcomeDialog_Artificer_001_09219fa2-4ff6-4f3e-b44a-09fd466a208e);
DB_Debug_WYR_WelcomeDialogRepro(S_GLO_GnomeWorkerDaffy_fdaeccaa-d903-4568-ac36-a0a0ec24977d, Debug_WYR_Ironhand_WelcomeDialog_GnomeWorkerDaffy_a86e1e39-669f-447c-9633-2ed5b715278f);
DB_Debug_WYR_WelcomeDialogRepro(S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96, Debug_WYR_Ironhand_WelcomeDialog_InjuredGnome_ae767dd2-bb22-40c2-8a04-4d95ea4f9c1b);
DB_Debug_WYR_WelcomeDialogRepro(S_GLO_HiddenGnome_6cacd488-c479-47a9-9a39-1cfb2bf6836e, Debug_WYR_Ironhand_WelcomeDialog_HiddenGnome_c487fc3b-086f-41f7-88f2-4b28d227222d);
DB_OneTimeEventFlag(Debug_WYR_Ironhand_RemoveGnomes_ec2ad676-b6fc-4236-a6a7-d8d60be59db9);
DB_OneTimeEventFlag(Debug_WYR_Ironhand_SetupAllGnomes_7024b82b-15e4-473a-9cf3-6d16f40d290a);
DB_OneTimeEventFlag(Debug_WYR_Ironhand_SetupBarcusNoAct2Gnomes_40c3e0bb-0bb3-4ae2-aaec-954afe93c38e);
DB_OneTimeEventFlag(Debug_WYR_Ironhand_SetupOnlyAct2Gnomes_91d859ce-9f32-4f16-91c1-692d44488ed0);
DB_OneTimeEventFlag(Debug_WYR_Ironhand_SetupAllButBarcus_c7389112-74fb-437f-8a87-8bfb2c7874fb);
DB_OneTimeEventFlag(Debug_WYR_Ironhand_RerunSceneSetup_db316b86-c86d-4eb4-a033-0783a4c65c83);
DB_Debug_WYR_Ironhand_SetupGnome(Debug_WYR_Ironhand_SetupWulbren_d429a03c-2373-4356-accb-1b82823ec959, S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf);
DB_Debug_WYR_Ironhand_SetupGnome(Debug_WYR_Ironhand_SetupUnfortunateGnome_902317ce-1794-4203-a3c5-acb685884f5b, S_FOR_UnfortunateGnome_6e45a00b-bad2-40bb-9403-147b9e92d976);
DB_Debug_WYR_Ironhand_SetupGnome(Debug_WYR_Ironhand_SetupInjuredGnome_61b9da09-f0df-4781-b850-fcaa1b41f376, S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96);
DB_Debug_WYR_Ironhand_SetupGnome(Debug_WYR_Ironhand_SetupGnomeWorkerDaffy_a609b101-2def-48b0-a606-a70b2bdd30cb, S_GLO_GnomeWorkerDaffy_fdaeccaa-d903-4568-ac36-a0a0ec24977d);
DB_Debug_WYR_Ironhand_SetupGnome(Debug_WYR_Ironhand_SetupGnomePrisoner_001_514fbabf-2733-4eb3-9e4b-289a9643556e, S_GLO_GnomePrisoner_001_4fbd62e8-a486-471e-8a65-00966b058dd5);
DB_Debug_WYR_Ironhand_SetupGnome(Debug_WYR_Ironhand_SetupGnomePrisoner_002_f153de51-f694-4bd4-8d5f-f526156a864d, S_GLO_GnomePrisoner_002_c9a7d921-bef0-4829-8792-d48c529daee5);
DB_Debug_WYR_Ironhand_SetupGnome(Debug_WYR_Ironhand_SetupHiddenGnome_81139587-e353-4d78-8640-2221d0d5ce60, S_GLO_HiddenGnome_6cacd488-c479-47a9-9a39-1cfb2bf6836e);
DB_WYR_SetupForAct_FlagChecks(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, HAV_SavingPrisoners_State_WulbrenReturned_73a0c737-a7d1-9945-01d3-003fde6ed946, 1);
DB_GLO_SetupForAct_Character("BGO_Main_A", S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf);
DB_WYR_SetupForAct_FlagChecks(S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96, UND_InjuredGnome_State_Healed_6dd9c64e-a6b0-47d5-87f6-b1a1c49d3ab4, 1);
DB_WYR_SetupForAct_FlagChecks(S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96, UND_InjuredGnome_State_WasPermaDefeated_b73fbcdc-e526-4c1e-b236-4e2ea49a1c27, 0);
DB_WYR_SetupForAct_FlagChecks(S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96, UND_InjuredGnome_State_SporeServant_4a1d7911-e00d-4e32-8dff-3352a0a7af63, 0);
DB_GLO_SetupForAct_Character("BGO_Main_A", S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96);
DB_WYR_SetupForAct_FlagChecks(S_FOR_UnfortunateGnome_6e45a00b-bad2-40bb-9403-147b9e92d976, UND_State_LeaderFreedGnomes_49acb531-d0c4-d3d1-6af4-c79e246e4327, 1);
DB_WYR_SetupForAct_FlagChecks(S_FOR_UnfortunateGnome_6e45a00b-bad2-40bb-9403-147b9e92d976, GLO_UnfortunateGnome_State_InHaven_a5673d70-d182-4dee-a93b-a2d7715856dc, 1);
DB_GLO_SetupForAct_Character("BGO_Main_A", S_FOR_UnfortunateGnome_6e45a00b-bad2-40bb-9403-147b9e92d976);
PROC_SetOnStage(S_WYR_Ironhands_UnfortunateGnomeDiary_736f4dc4-7755-44a8-85b5-ac5ad77e175d, 0);
DB_WYR_SetupForAct_FlagChecks(S_GLO_GnomeWorkerDaffy_fdaeccaa-d903-4568-ac36-a0a0ec24977d, UND_State_LeaderFreedGnomes_49acb531-d0c4-d3d1-6af4-c79e246e4327, 1);
DB_WYR_SetupForAct_FlagChecks(S_GLO_GnomeWorkerDaffy_fdaeccaa-d903-4568-ac36-a0a0ec24977d, UND_GnomeWorkerDaffy_Dead_92f4d092-e94e-4b31-ab50-e8cb404fe908, 0);
DB_GLO_SetupForAct_Character("BGO_Main_A", S_GLO_GnomeWorkerDaffy_fdaeccaa-d903-4568-ac36-a0a0ec24977d);
DB_WYR_SetupForAct_FlagChecks(S_GLO_GnomePrisoner_001_4fbd62e8-a486-471e-8a65-00966b058dd5, HAV_SavingPrisoners_State_Gnome001Returned_d9df5c72-356e-4649-8eda-3f844d084371, 1);
DB_GLO_SetupForAct_Character("BGO_Main_A", S_GLO_GnomePrisoner_001_4fbd62e8-a486-471e-8a65-00966b058dd5);
DB_WYR_SetupForAct_FlagChecks(S_GLO_GnomePrisoner_002_c9a7d921-bef0-4829-8792-d48c529daee5, HAV_SavingPrisoners_State_Gnome002Returned_60ef28ec-9557-4c00-b3be-41982550e228, 1);
DB_GLO_SetupForAct_Character("BGO_Main_A", S_GLO_GnomePrisoner_002_c9a7d921-bef0-4829-8792-d48c529daee5);
DB_WYR_SetupForAct_FlagChecks(S_GLO_HiddenGnome_6cacd488-c479-47a9-9a39-1cfb2bf6836e, UND_EscapedGnome_State_GnomeSaved_c5fe7588-a178-3d13-7303-332689b4941a, 1);
DB_WYR_SetupForAct_FlagChecks(S_GLO_HiddenGnome_6cacd488-c479-47a9-9a39-1cfb2bf6836e, UND_PanicRoom_Event_GnomeSuicide_b230716c-ca7d-4a41-9980-e0c8b8655a72, 0);
DB_GLO_SetupForAct_Character("BGO_Main_A", S_GLO_HiddenGnome_6cacd488-c479-47a9-9a39-1cfb2bf6836e);
DB_WYR_Ironhand_Init(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, S_WYR_Ironhand_InitPos_Wulbren_871e4d40-bf0b-4222-b1df-223172782023, WYR_Wulbren_fcd8ff87-7c42-9748-9a31-e9b8568f1a58, WYR_Ironhand_InAct3_Wulbren_3097cdd8-33eb-4ca0-956b-b2826bb01f8a);
DB_WYR_Ironhand_Init(S_FOR_UnfortunateGnome_6e45a00b-bad2-40bb-9403-147b9e92d976, S_WYR_Ironhand_InitPos_Unfortunate_8a9604a3-8937-4ce2-ad94-d06aaf8af704, WYR_UnfortunateGnome_4897143a-f55e-123f-2fed-8a7c7dfd96a6, WYR_Ironhand_InAct3_UnfortunateGnome_ac1b779a-401d-4119-bebd-3efb70a697ee);
DB_WYR_Ironhand_Init(S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96, S_WYR_Ironhand_InitPos_Injured_d4207fa3-c6c3-4723-92cc-df53003f4024, WYR_InjuredGnome_1432cbff-0a3a-d4a8-7acd-637aa3fe7ffc, WYR_Ironhand_InAct3_InjuredGnome_aeaf0ee1-6537-4003-b51b-5d88e2ead0c8);
DB_WYR_Ironhand_Init(S_GLO_GnomeWorkerDaffy_fdaeccaa-d903-4568-ac36-a0a0ec24977d, S_WYR_Ironhand_InitPos_GnomeWorkerDaffy_f7941cf0-cb0f-4c1c-b02a-7526b7078adc, WYR_GnomeWorkerDaffy_eefef09a-9f79-0a39-decd-4a19343f1ff6, WYR_Ironhand_InAct3_GnomeWorkerDaffy_4ccd5763-ff87-4893-9d90-1c187c2ac065);
DB_WYR_Ironhand_Init(S_GLO_GnomePrisoner_001_4fbd62e8-a486-471e-8a65-00966b058dd5, S_WYR_Ironhand_InitPos_Prisoner_001_a1d7dfe0-f80f-4b53-8f3d-c2056b933f14, WYR_GnomePrisoner_001_326f7ca8-1dae-f0d6-5801-abab9b8af111, WYR_Ironhand_InAct3_GnomePrisoner_001_abde3a6c-f009-42a7-a967-f374b88e7dc2);
DB_WYR_Ironhand_Init(S_GLO_GnomePrisoner_002_c9a7d921-bef0-4829-8792-d48c529daee5, S_WYR_Ironhand_InitPos_Prisoner_002_74fa871a-6ed1-4a86-96b6-5f8eccb43fcf, WYR_GnomePrisoner_002_7787b2b4-4ef3-0032-86c8-88beae256f49, WYR_Ironhand_InAct3_GnomePrisoner_002_772e4743-7f87-47dc-a2d7-38f612327e1e);
DB_WYR_Ironhand_Init(S_GLO_HiddenGnome_6cacd488-c479-47a9-9a39-1cfb2bf6836e, S_WYR_Ironhand_InitPos_HiddenGnome_e850b71b-9dba-4677-8b87-48020f3bedbd, WYR_HiddenGnome_7380caae-ac94-0eeb-db80-d3d862737591, WYR_Ironhand_InAct3_HiddenGnome_a2450e42-adbf-4ade-b784-47e217ae6378);
DB_WYR_Ironhand_Init(S_WYR_Ironhand_Merchant_6fbabd70-2f22-47aa-8def-78459e662ca6, S_WYR_Ironhand_InitPos_Merchant_bbfe7f9d-2c11-47ec-a59d-27ff6b1a47b9, WYR_Ironhand_Merchant_7cce34f7-8cd3-9a32-1e91-7b9eed621c04, NULL_00000000-0000-0000-0000-000000000000);
DB_WYR_Ironhand_Init(S_WYR_Ironhand_Artificer_001_627b5b4d-51df-416a-800a-ddf357c96995, S_WYR_Ironhand_InitPos_Artificer_001_dced96be-14e4-4a00-8916-b381c7599e5e, WYR_Ironhand_Artificer_001_faa8393d-fa81-55a4-9f05-989813c76c87, NULL_00000000-0000-0000-0000-000000000000);
DB_WYR_Ironhand_Init(S_WYR_Ironhand_Artificer_002_8e9bf995-3c1d-4404-afe5-7bdfdc43bc35, S_WYR_Ironhand_InitPos_Artificer_002_4d5ab559-0c9f-470a-a050-1088ec153927, WYR_Ironhand_Artificer_002_42ae6f92-5274-b48a-c201-a1b01b9be17c, NULL_00000000-0000-0000-0000-000000000000);
DB_WYR_Ironhand_NewGnomeRoots(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, WYR_Wulbren_c7bd0d1e-65d7-4ed1-b7c5-228690895da8);
DB_WYR_Ironhand_NewGnomeRoots(S_FOR_UnfortunateGnome_6e45a00b-bad2-40bb-9403-147b9e92d976, WYR_UnfortunateGnome_febf6225-9355-45a9-84ff-40ee4e927fb3);
DB_WYR_Ironhand_NewGnomeRoots(S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96, WYR_InjuredGnome_2fd0db85-e353-4754-ae86-c3f41042a3eb);
DB_WYR_Ironhand_NewGnomeRoots(S_GLO_GnomeWorkerDaffy_fdaeccaa-d903-4568-ac36-a0a0ec24977d, WYR_GnomeWorkerDaffy_e4ce2419-e0bd-4b64-a939-2a2b4b9e471a);
DB_WYR_Ironhand_NewGnomeRoots(S_GLO_GnomePrisoner_001_4fbd62e8-a486-471e-8a65-00966b058dd5, WYR_GnomePrisoner_001_a183843e-0b4f-4a08-9ff0-71942c080a8c);
DB_WYR_Ironhand_NewGnomeRoots(S_GLO_GnomePrisoner_002_c9a7d921-bef0-4829-8792-d48c529daee5, WYR_GnomePrisoner_002_1447a624-08a0-4971-b50c-3f25a000a203);
DB_WYR_Ironhand_NewGnomeRoots(S_GLO_HiddenGnome_6cacd488-c479-47a9-9a39-1cfb2bf6836e, WYR_HiddenGnome_e0dc09f2-9193-4af2-b578-ddf44b97aca9);
DB_WYR_Ironhand_TradeTreasure(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, "WYR_Ironhand_Worker");
DB_WYR_Ironhand_TradeTreasure(S_FOR_UnfortunateGnome_6e45a00b-bad2-40bb-9403-147b9e92d976, "WYR_UnfortunateGnome");
DB_WYR_Ironhand_TradeTreasure(S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96, "WYR_Ironhand_Worker");
DB_WYR_Ironhand_TradeTreasure(S_GLO_GnomeWorkerDaffy_fdaeccaa-d903-4568-ac36-a0a0ec24977d, "WYR_Ironhand_Worker");
DB_WYR_Ironhand_TradeTreasure(S_GLO_GnomePrisoner_001_4fbd62e8-a486-471e-8a65-00966b058dd5, "WYR_Ironhand_Worker");
DB_WYR_Ironhand_TradeTreasure(S_GLO_GnomePrisoner_002_c9a7d921-bef0-4829-8792-d48c529daee5, "WYR_Ironhand_Worker");
DB_WYR_Ironhand_TradeTreasure(S_GLO_HiddenGnome_6cacd488-c479-47a9-9a39-1cfb2bf6836e, "WYR_Ironhand_Worker");
DB_WYR_Ironhand_Extra(S_WYR_Ironhand_Merchant_6fbabd70-2f22-47aa-8def-78459e662ca6);
DB_WYR_Ironhand_Extra(S_WYR_Ironhand_Artificer_001_627b5b4d-51df-416a-800a-ddf357c96995);
DB_WYR_Ironhand_Extra(S_WYR_Ironhand_Artificer_002_8e9bf995-3c1d-4404-afe5-7bdfdc43bc35);
DB_WYR_Ironhand_ExtraExtra(S_WYR_Ironhand_ArtificerExtra_001_a47370d5-d3f6-4acb-9d87-5d13a1f7e83c);
DB_WYR_Ironhand_ExtraExtra(S_WYR_Ironhand_ArtificerExtra_002_18f98c7f-0c7d-42b1-9ff2-acbcfd764e60);
DB_Dialogs(S_WYR_Ironhand_ArtificerExtra_001_a47370d5-d3f6-4acb-9d87-5d13a1f7e83c, WYR_Ironhand_ArtificerExtra_001_9688af0c-f507-ff0a-bdab-3b8d938d74d2);
DB_Dialogs(S_WYR_Ironhand_ArtificerExtra_002_18f98c7f-0c7d-42b1-9ff2-acbcfd764e60, WYR_Ironhand_ArtificerExtra_002_4edb7e85-e497-3650-2c91-74a4bd96ca66);
DB_WYR_Ironhand_ExtraExtra_Pos(S_WYR_Ironhand_ArtificerExtra_001_a47370d5-d3f6-4acb-9d87-5d13a1f7e83c, S_WYR_Ironhand_InitPos_HiddenGnome_e850b71b-9dba-4677-8b87-48020f3bedbd);
DB_WYR_Ironhand_ExtraExtra_Pos(S_WYR_Ironhand_ArtificerExtra_001_a47370d5-d3f6-4acb-9d87-5d13a1f7e83c, S_WYR_Ironhand_InitPos_GnomeWorkerDaffy_f7941cf0-cb0f-4c1c-b02a-7526b7078adc);
DB_WYR_Ironhand_ExtraExtra_Pos(S_WYR_Ironhand_ArtificerExtra_002_18f98c7f-0c7d-42b1-9ff2-acbcfd764e60, S_WYR_Ironhand_InitPos_Injured_d4207fa3-c6c3-4723-92cc-df53003f4024);
DB_WYR_Ironhand_ExtraExtra_Pos(S_WYR_Ironhand_ArtificerExtra_002_18f98c7f-0c7d-42b1-9ff2-acbcfd764e60, S_WYR_Ironhand_InitPos_Prisoner_001_a1d7dfe0-f80f-4b53-8f3d-c2056b933f14);
DB_WYR_Ironhand_ExtraExtra_RoleFlag(S_WYR_Ironhand_ArtificerExtra_001_a47370d5-d3f6-4acb-9d87-5d13a1f7e83c, S_WYR_Ironhand_InitPos_HiddenGnome_e850b71b-9dba-4677-8b87-48020f3bedbd, WYR_Ironhand_ReplaceGnome_1_ef6260ad-61c0-4dd3-b505-1a30bf773b4f);
DB_WYR_Ironhand_ExtraExtra_RoleFlag(S_WYR_Ironhand_ArtificerExtra_002_18f98c7f-0c7d-42b1-9ff2-acbcfd764e60, S_WYR_Ironhand_InitPos_Injured_d4207fa3-c6c3-4723-92cc-df53003f4024, WYR_Ironhand_ReplaceGnome_1_ef6260ad-61c0-4dd3-b505-1a30bf773b4f);
Open(DOOR_Single_Dungeon_Abbey_B_001_ac8f8d4e-2442-46b9-91b2-9a88dad2d5bf);
DB_WYR_Ironhand_Checkpoint_Candidate(1, S_GLO_GnomePrisoner_001_4fbd62e8-a486-471e-8a65-00966b058dd5);
DB_WYR_Ironhand_Checkpoint_Candidate(1, S_WYR_Ironhand_Artificer_001_627b5b4d-51df-416a-800a-ddf357c96995);
DB_WYR_Ironhand_Checkpoint_Candidate(2, S_GLO_GnomeWorkerDaffy_fdaeccaa-d903-4568-ac36-a0a0ec24977d);
DB_WYR_Ironhand_Checkpoint_Candidate(2, S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96);
DB_WYR_Ironhand_Checkpoint_Candidate(2, S_GLO_HiddenGnome_6cacd488-c479-47a9-9a39-1cfb2bf6836e);
DB_WYR_Ironhand_WelcomeGnome(S_WYR_Ironhand_Artificer_002_8e9bf995-3c1d-4404-afe5-7bdfdc43bc35);
NOT DB_WYR_Ironhand_SceneGnomes(0, NULL_00000000-0000-0000-0000-000000000000);
DB_WYR_Ironhand_Pos_BeforeCheckpoint(1, S_WYR_Ironhand_Gnome1PosBeforeCheckpoint_eb85ad60-7958-45ab-ab56-211f13c7bf25);
DB_WYR_Ironhand_Pos_BeforeCheckpoint(2, S_WYR_Ironhand_Gnome2PosBeforeCheckpoint_81d426f8-821d-4537-bda1-edcfbb23d938);
DB_WYR_Ironhand_Pos_BridgeCheckpointDialog(1, S_WYR_Ironhand_GnomeBridgePos_1_9493a470-c1ed-40b4-9f75-818a217359dc);
DB_WYR_Ironhand_Pos_BridgeCheckpointDialog(2, S_WYR_Ironhand_GnomeBridgePos_2_fa2ebb46-3d07-4b5d-b2e0-8ffeb967591f);
DB_WYR_Ironhand_Pos_TpInsideCave(1, S_WYR_Ironhand_EscapeCheckpoint_Pos4_de334604-9b30-4315-bdfc-7e2f3083bda3);
DB_WYR_Ironhand_Pos_TpInsideCave(2, S_WYR_Ironhand_EscapeCheckpoint_Pos4_de334604-9b30-4315-bdfc-7e2f3083bda3);
DB_WYR_Ironhand_Pos_ReturnToRoom(1, S_WYR_Ironhand_EscapeCheckpoint_InRoom_0_370a47ab-dd55-4040-acbb-19660816c6d8);
DB_WYR_Ironhand_Pos_ReturnToRoom(2, S_WYR_Ironhand_EscapeCheckpoint_InRoom_1_41dfef6e-1a9f-404e-a17c-d8e8dbd64ccb);
PROC_TriggerRegisterForPlayers(S_WYR_Ironhand_SpotOnEntry_Off_ee352681-79ca-49e4-bdeb-3199be15b068);
DB_ItemOwnerShipClearItem("BGO_Main_A", S_WYR_DOOR_Single_Dungeon_Abbey_B_001_ac8f8d4e-2442-46b9-91b2-9a88dad2d5bf);
DB_ItemOwnerShipTriggers("BGO_Main_A", S_WYR_Ironhand_OwnershipZone_69edc17a-4c40-474e-abb9-89ef1bbd18c4, S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf);
DB_ItemOwnerShipClearItem("BGO_Main_A", DOOR_Single_Dungeon_Abbey_B_001_ac8f8d4e-2442-46b9-91b2-9a88dad2d5bf);
DB_ItemOwnerShipClearItem("BGO_Main_A", S_WYR_Ironhand_CaveExitLadder_31e6d8a9-aaa8-4e9f-bec1-394f597b2500);
DB_ItemOwnerShipClearItem("BGO_Main_A", S_WYR_Ironhand_HatchLever_7b551707-c332-4acd-8b4e-5da47cac1ca6);
DB_WYR_Ironhand_SplatterStatuses(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, "CUST_SPLATTER_GLO_Wulbren");
DB_WYR_Ironhand_SplatterStatuses(S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96, "CUST_SPLATTER_GLO_InjuredGnome");
DB_WYR_Ironhand_SplatterStatuses(S_GLO_GnomeWorkerDaffy_fdaeccaa-d903-4568-ac36-a0a0ec24977d, "CUST_SPLATTER_GLO_GnomeWorkerDaffy");
DB_WYR_Ironhand_SplatterStatuses(S_GLO_GnomePrisoner_001_4fbd62e8-a486-471e-8a65-00966b058dd5, "CUST_SPLATTER_GLO_GnomePrisoner_001");
DB_WYR_Ironhand_SplatterStatuses(S_GLO_GnomePrisoner_002_c9a7d921-bef0-4829-8792-d48c529daee5, "CUST_SPLATTER_GLO_GnomePrisoner_002");
DB_WYR_Ironhand_SplatterStatuses(S_GLO_HiddenGnome_6cacd488-c479-47a9-9a39-1cfb2bf6836e, "CUST_SPLATTER_GLO_HiddenGnome");
PROC_SetOnStage(S_WYR_Ironhand_RunepowderBomb_8b926cb4-9dd3-4bbf-8b76-9d628270cf1f, 0);
PROC_SetOnStage(S_WYR_Ironhand_GnomeHideoutRubble_ee2a91be-7fe6-48cb-9b46-63c75eea3e1d, 0);

KBSECTION
IF
DB_IsEditor(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Debug_WYR_Ironhand_SetupGnome(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_GlobalSetFlagAndCache(_Var1);

IF
DB_IsEditor(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Debug_WYR_Ironhand_SetupGnome(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_WYR_SetupForAct_FlagChecks(_Var2, _Var3, 1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GlobalSetFlagAndCache(_Var3);

IF
DB_IsEditor(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Debug_WYR_Ironhand_SetupGnome(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_SetupForAct_FlagChecks(_Var2, _Var3, 0, _Var1, _Var1)
THEN
PROC_GlobalClearFlagAndCache(_Var3);

QRY
QRY_GLO_SetupForAct_CustomBlock("BGO_Main_A", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_IsEditor(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Debug_WYR_Ironhand_SetupGnome(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_OneTimeEventFlag(Debug_WYR_Ironhand_RemoveGnomes_ec2ad676-b6fc-4236-a6a7-d8d60be59db9, (FLAG)_Var1, (FLAG)_Var1, (FLAG)_Var1, (FLAG)_Var1)
AND
DB_Debug_WYR_Ironhand_SetupGnome(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_GlobalClearFlagAndCache(_Var1);

PROC
PROC_OneTimeEventFlag(Debug_WYR_Ironhand_RemoveGnomes_ec2ad676-b6fc-4236-a6a7-d8d60be59db9, _, _, _, _)
THEN
PROC_GLO_SetupForAct_DebugRerun();

PROC
PROC_OneTimeEventFlag(Debug_WYR_Ironhand_SetupAllGnomes_7024b82b-15e4-473a-9cf3-6d16f40d290a, (FLAG)_Var1, (FLAG)_Var1, (FLAG)_Var1, (FLAG)_Var1)
AND
DB_Debug_WYR_Ironhand_SetupGnome(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_GlobalSetFlagAndCache(_Var1);

PROC
PROC_OneTimeEventFlag(Debug_WYR_Ironhand_SetupAllGnomes_7024b82b-15e4-473a-9cf3-6d16f40d290a, _, _, _, _)
THEN
PROC_GLO_SetupForAct_DebugRerun();

PROC
PROC_OneTimeEventFlag(Debug_WYR_Ironhand_SetupOnlyAct2Gnomes_91d859ce-9f32-4f16-91c1-692d44488ed0, (FLAG)_Var1, (FLAG)_Var1, (FLAG)_Var1, (FLAG)_Var1)
AND
DB_Debug_WYR_Ironhand_SetupGnome(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_GlobalClearFlagAndCache(_Var1);

PROC
PROC_OneTimeEventFlag(Debug_WYR_Ironhand_SetupOnlyAct2Gnomes_91d859ce-9f32-4f16-91c1-692d44488ed0, _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(Debug_WYR_Ironhand_SetupWulbren_d429a03c-2373-4356-accb-1b82823ec959);
PROC_GlobalSetFlagAndCache(Debug_WYR_Ironhand_SetupGnomePrisoner_001_514fbabf-2733-4eb3-9e4b-289a9643556e);
PROC_GlobalSetFlagAndCache(Debug_WYR_Ironhand_SetupGnomePrisoner_002_f153de51-f694-4bd4-8d5f-f526156a864d);
PROC_GLO_SetupForAct_DebugRerun();

PROC
PROC_OneTimeEventFlag(Debug_WYR_Ironhand_SetupAllButBarcus_c7389112-74fb-437f-8a87-8bfb2c7874fb, _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(Debug_WYR_Ironhand_SetupWulbren_d429a03c-2373-4356-accb-1b82823ec959);
PROC_GlobalClearFlagAndCache(Debug_WYR_Ironhand_SetupUnfortunateGnome_902317ce-1794-4203-a3c5-acb685884f5b);
PROC_GlobalSetFlagAndCache(Debug_WYR_Ironhand_SetupInjuredGnome_61b9da09-f0df-4781-b850-fcaa1b41f376);
PROC_GlobalSetFlagAndCache(Debug_WYR_Ironhand_SetupGnomeWorkerDaffy_a609b101-2def-48b0-a606-a70b2bdd30cb);
PROC_GlobalSetFlagAndCache(Debug_WYR_Ironhand_SetupGnomePrisoner_001_514fbabf-2733-4eb3-9e4b-289a9643556e);
PROC_GlobalSetFlagAndCache(Debug_WYR_Ironhand_SetupGnomePrisoner_002_f153de51-f694-4bd4-8d5f-f526156a864d);
PROC_GlobalSetFlagAndCache(Debug_WYR_Ironhand_SetupHiddenGnome_81139587-e353-4d78-8640-2221d0d5ce60);
PROC_GLO_SetupForAct_DebugRerun();

PROC
PROC_OneTimeEventFlag(Debug_WYR_Ironhand_RerunSceneSetup_db316b86-c86d-4eb4-a033-0783a4c65c83, _, _, _, _)
THEN
PROC_GLO_SetupForAct_DebugRerun();

PROC
PROC_GLO_SetupForAct_DebugRerun()
AND
DB_WYR_SetupForAct_FlagChecks(_Var1, _Var2, 1, _Var1, _Var1)
AND
DB_Debug_WYR_Ironhand_SetupGnome(_, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GlobalClearFlagAndCache(_Var2);

PROC
PROC_GLO_SetupForAct_DebugRerun()
AND
DB_WYR_SetupForAct_FlagChecks(_Var1, _Var2, 0, _Var1, _Var1)
AND
DB_Debug_WYR_Ironhand_SetupGnome(_, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GlobalClearFlagAndCache(_Var2);

PROC
PROC_GLO_SetupForAct_DebugRerun()
AND
DB_WYR_Ironhand_Gnomes(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var1, 0);
ClearFlag(WYR_Ironhand_FromPrecedingAct_f2edcf6f-22cf-423d-ab56-8a968b681f58, _Var1, 0);
NOT DB_WYR_Ironhand_Gnomes(_Var1);

PROC
PROC_GLO_SetupForAct_DebugRerun()
AND
DB_WYR_Ironhand_Init(_Var1, _, _, _Var4, _Var1)
THEN
PROC_GlobalClearFlagAndCache(_Var4);

PROC
PROC_GLO_SetupForAct_DebugRerun()
AND
DB_GlobalFlag(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Debug_WYR_Ironhand_SetupGnome(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_WYR_SetupForAct_FlagChecks(_Var2, _Var3, 1, _Var1, _Var1)
THEN
PROC_GlobalSetFlagAndCache(_Var3);

PROC
PROC_GLO_SetupForAct_DebugRerun()
AND
DB_GlobalFlag(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Debug_WYR_Ironhand_SetupGnome(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_WYR_SetupForAct_FlagChecks(_Var2, _Var3, 0, _Var1, _Var1)
THEN
PROC_GlobalClearFlagAndCache(_Var3);

PROC
PROC_GLO_SetupForAct_DebugRerun()
AND
DB_WYR_Ironhand_ExtraExtra_Placed(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
NOT DB_WYR_Ironhand_ExtraExtra_Placed(_Var1, _Var2);

IF
FlagSet((FLAG)_Var1, NULL_00000000-0000-0000-0000-000000000000, (INTEGER)_Var2, (FLAG)_Var1, (FLAG)_Var1)
AND
DB_Debug_WYR_WelcomeDialogRepro(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
DB_DialogPlayers(_Var2, _Var4, _, _Var1, _Var1)
THEN
PROC_ForceStopDialog(_Var4);

IF
FlagSet((FLAG)_Var1, NULL_00000000-0000-0000-0000-000000000000, _, (FLAG)_Var1, (FLAG)_Var1)
AND
DB_Debug_WYR_WelcomeDialogRepro(_Var3, _Var1, _Var1, _Var1, _Var1)
THEN
ClearFlag(_Var1, NULL_00000000-0000-0000-0000-000000000000, 0);
DB_WYR_Ironhand_SceneGnomes(3, _Var3);
PROC_SetOnStage(_Var3, 1);
TeleportTo(_Var3, S_Debug_WYR_Ironhand_WelcomeDialogTPG_8b25879d-b135-4475-bc16-947abfa13a3e, "DB_Debug_WYR_WelcomeDialogRepro");

IF
EntityEvent((GUIDSTRING)_Var1, "DB_Debug_WYR_WelcomeDialogRepro", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
GetHostCharacter(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var2, S_Debug_WYR_Ironhand_WelcomeDialogTP_e402f075-0c77-4e69-ae2c-38374eae97a0, "DB_Debug_WYR_WelcomeDialogRepro");

IF
TextEvent("wyr_iron_skipscene", _, _, _, _)
AND
DB_WYR_Ironhand_SceneGnomes(_, _Var2, _, _, _)
AND
DB_WYR_Ironhand_Init(_Var2, _Var3, _, _, _)
THEN
SetFlag(WYR_Ironhand_State_GnomesReturned_a082d5cd-8360-429b-a77a-124e11ec99e8);
TeleportTo(_Var2, _Var3, "");
ClearFlag(WYR_Ironhand_State_AtCheckpoint_fbba9492-5888-4f04-8be7-b6af11ab5463, _Var2);

IF
DB_WYR_Ironhand_Extra(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var1, 0);

IF
DB_WYR_Ironhand_ExtraExtra(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var1, 0);

QRY
QRY_GLO_SetupForAct_CustomBlock("BGO_Main_A", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_WYR_Ironhand_Init(_Var1, _, _, _, _Var1)
AND
_Var1 != S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf
AND NOT
DB_GlobalFlag(WYR_Ironhand_InAct3_Wulbren_3097cdd8-33eb-4ca0-956b-b2826bb01f8a, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_GLO_SetupForAct_CustomBlock("BGO_Main_A", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_WYR_SetupForAct_FlagChecks(_Var1, _Var2, _Var3, _Var1, _Var1)
AND
_Var1 != S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf
AND
DB_Negate(_Var3, _Var4, _Var1, _Var1, _Var1)
AND
GetFlag(_Var2, NULL_00000000-0000-0000-0000-000000000000, _Var4, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_GLO_SetupForAct("BGO_Main_A", (CHARACTER)_Var1, 1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_WYR_Ironhand_SplatterStatuses(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
RemoveStatus(_Var1, _Var2, NULL_00000000-0000-0000-0000-000000000000);
RemoveSplatters(_Var1);
SetHitpointsPercentage(_Var1, 100);
PROC_SelfHealing_Enable(_Var1);

PROC
PROC_GLO_SetupForAct("BGO_Main_A", S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96, _, (INTEGER)_, (INTEGER)_)
THEN
NOT DB_PreventPermaDefeated(S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96);

PROC
PROC_GLO_SetupForAct("BGO_Main_A", S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96, 0, _, _)
AND NOT
DB_PermaDefeated(S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96, _, _, _, _)
AND
DB_GlobalFlag(UND_InjuredGnome_State_SporeServant_4a1d7911-e00d-4e32-8dff-3352a0a7af63, _, _, _, _)
THEN
PROC_DieImmediate(S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96, 0, 0);

PROC
PROC_GLO_SetupForAct("BGO_Main_A", (CHARACTER)_Var1, 1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_WYR_Ironhand_Init(_Var1, _, _, _, _Var1)
THEN
SetTag(_Var1, BADASSCIVILIAN_91f4b379-63a2-40e9-a509-7b9b2f90e4c8);
PROC_SetOnStage(_Var1, 1);
SetFlag(WYR_Ironhand_FromPrecedingAct_f2edcf6f-22cf-423d-ab56-8a968b681f58, _Var1, 0);
DB_WYR_Ironhand_Gnomes(_Var1);

PROC
PROC_GLO_SetupForActComplete("BGO_Main_A", _, _, _, _)
AND NOT
QRY_IsEmptyDB("DB_WYR_Ironhand_Gnomes", 1, _, _, _)
AND
DB_WYR_Ironhand_Extra(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var1, 1);
DB_WYR_Ironhand_Gnomes(_Var1);

PROC
PROC_GLO_SetupForActComplete("BGO_Main_A", _, _, _, _)
AND NOT
QRY_IsEmptyDB("DB_WYR_Ironhand_Gnomes", 1, _, _, _)
AND
SysCount("DB_WYR_Ironhand_Gnomes", 1, _Var1, _Var1, _Var1)
AND
_Var1 <= 5
AND
DB_WYR_Ironhand_ExtraExtra(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var2, 1);
DB_WYR_Ironhand_Gnomes(_Var2);
PROC_WYR_Ironhand_ExtraExtra_PutInPlace(_Var2);

PROC
PROC_GLO_SetupForActComplete("BGO_Main_A", _, _, _, _)
THEN
ClearFlag(WYR_Ironhand_State_NotAllGnomesInAct3_1e57a8b5-0f36-489c-8dd4-a401dea8d3e9);

PROC
PROC_GLO_SetupForActComplete("BGO_Main_A", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_WYR_Ironhand_Init(_Var1, _, _, _, _Var1)
AND NOT
DB_WYR_Ironhand_Gnomes(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(WYR_Ironhand_State_NotAllGnomesInAct3_1e57a8b5-0f36-489c-8dd4-a401dea8d3e9);

PROC
PROC_GLO_SetupForActComplete("BGO_Main_A", _, _, _, _)
AND
DB_WYR_Ironhand_Gnomes(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, _, _, _, _)
THEN
PROC_WYR_Ironhand_GnomesAddedToAct();

PROC
PROC_GLO_SetupForActComplete("BGO_Main_A", _, _, _, _)
AND NOT
DB_WYR_Ironhand_Gnomes(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, _, _, _, _)
THEN
PROC_WYR_Ironhand_NoGnomesInAct();

IF
DB_WYR_Ironhand_Gnomes(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_Init(_Var1, _Var2, _, _, _Var1)
AND
_Var2 != NULL_00000000-0000-0000-0000-000000000000
THEN
TeleportTo(_Var1, _Var2, "WYR_Ironhand_InitTP");
LookFromTrigger(_Var1, _Var2, 0);

IF
DB_WYR_Ironhand_Gnomes(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_Init(_Var1, _, _Var3, _, _Var1)
AND
_Var3 != NULL_00000000-0000-0000-0000-000000000000
THEN
PROC_RemoveAllDialogEntriesForSpeaker(_Var1);
DB_Dialogs(_Var1, _Var3);

IF
DB_WYR_Ironhand_Gnomes(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_Init(_Var1, _, _, _Var4, _Var1)
AND
_Var4 != NULL_00000000-0000-0000-0000-000000000000
THEN
PROC_GlobalSetFlagAndCache(_Var4);

IF
DB_WYR_Ironhand_Gnomes(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFaction(_Var1, ACT3_WYR_IronhandGnomes_9e36c2d3-a13f-4d4e-bc5b-8ac237f84159);

IF
DB_WYR_Ironhand_Gnomes(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TriggerRegisterForCharacter(S_WYR_Ironhand_SUB_55832d9c-360c-483f-977a-bb6c4beb4eb0, _Var1);

IF
DB_InRegion(_Var1, S_WYR_Ironhand_SUB_55832d9c-360c-483f-977a-bb6c4beb4eb0, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_Gnomes(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetCombatGroupID(_Var1, "WYR_IronhandHideoutGnomes");

IF
LeftTrigger((CHARACTER)_Var1, S_WYR_Ironhand_SUB_55832d9c-360c-483f-977a-bb6c4beb4eb0, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_WYR_Ironhand_Gnomes(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetCombatGroupID(_Var1, "WYR_IronhandOutsideGnomes");

IF
DB_WYR_Ironhand_Gnomes(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_OffStage(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_NewGnomeRoots(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
Transform(_Var1, _Var2, LevelTraveler_9453ac5e-5ad4-429a-9743-dbf3e1d641cf);

IF
DB_WYR_Ironhand_Gnomes(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_TradeTreasure(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_SetCustomTradeTreasure(_Var1, _Var2);
SetCanTrade(_Var1, 1);

IF
DB_WYR_Ironhand_Gnomes(S_FOR_UnfortunateGnome_6e45a00b-bad2-40bb-9403-147b9e92d976, _, _, _, _)
THEN
PROC_SetOnStage(S_WYR_Ironhands_UnfortunateGnomeDiary_736f4dc4-7755-44a8-85b5-ac5ad77e175d, 1);
ToInventory(S_WYR_Ironhands_UnfortunateGnomeDiary_736f4dc4-7755-44a8-85b5-ac5ad77e175d, S_FOR_UnfortunateGnome_6e45a00b-bad2-40bb-9403-147b9e92d976);

PROC
PROC_WYR_Ironhand_ExtraExtra_PutInPlace((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_WYR_Ironhand_ExtraExtra_Pos(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_Init(_Var3, _Var2, _, _, _Var1)
AND NOT
DB_WYR_Ironhand_Gnomes(_Var3, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_ExtraExtra_Placed(_Var1, _, _Var1, _Var1, _Var1)
THEN
DB_WYR_Ironhand_ExtraExtra_Placed(_Var1, _Var2);
TeleportTo(_Var1, _Var2, "WYR_Ironhand_InitTP");
LookFromTrigger(_Var1, _Var2, 0);

IF
DB_WYR_Ironhand_ExtraExtra_Placed(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_ExtraExtra_RoleFlag(_Var1, _Var2, _Var3, _Var1, _Var1)
THEN
SetFlag(_Var3, _Var1, 0);

PROC
PROC_StartDialog_AddExtraSpeakers(WYR_Wulbren_fcd8ff87-7c42-9748-9a31-e9b8568f1a58, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
QRY_SpeakerIsAvailable(S_FOR_UnfortunateGnome_6e45a00b-bad2-40bb-9403-147b9e92d976, _Var1, _Var1, _Var1, _Var1)
AND
QRY_IsInRange(S_FOR_UnfortunateGnome_6e45a00b-bad2-40bb-9403-147b9e92d976, S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, 15, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_FOR_UnfortunateGnome_6e45a00b-bad2-40bb-9403-147b9e92d976);

PROC
PROC_WYR_Ironhand_GnomesAddedToAct()
THEN
PROC_WYR_Ironhand_SetupCheckpointScene();

PROC
PROC_WYR_Ironhand_SetupCheckpointScene()
THEN
SysClear("DB_WYR_Ironhand_SceneGnomes", 2);

PROC
PROC_WYR_Ironhand_SetupCheckpointScene()
THEN
PROC_WYR_Ironhand_SetupSceneGnome(1);
PROC_WYR_Ironhand_SetupSceneGnome(2);

PROC
PROC_WYR_Ironhand_SetupSceneGnome((INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_WYR_Ironhand_Checkpoint_Candidate(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_Gnomes(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_SceneGnomes(_Var1, _, _Var1, _Var1, _Var1)
THEN
DB_WYR_Ironhand_SceneGnomes(_Var1, _Var2);
DB_CustomDialogRange(_Var2, 9999);

PROC
PROC_WYR_Ironhand_SetupCheckpointScene()
AND
DB_WYR_Ironhand_SceneGnomes(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_Pos_BeforeCheckpoint(_Var1, _Var3, _Var1, _Var1, _Var1)
AND
GetFlag(GLO_State_NoCower_8180293e-4d0d-4e9b-9dfc-b195d4c67ddb, _Var2, _Var4, _Var1, _Var1)
THEN
TeleportTo(_Var2, _Var3);
DB_WYR_Ironhand_HadNoCower(_Var2, _Var4);
SetFlag(GLO_State_NoCower_8180293e-4d0d-4e9b-9dfc-b195d4c67ddb, _Var2);
SetFlag(WYR_Ironhand_State_AtCheckpoint_fbba9492-5888-4f04-8be7-b6af11ab5463, _Var2);

IF
DB_Is_InCombat(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_SceneGnomes(_, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var4, _Var2, _Var1, _Var1, _Var1)
AND
DB_Players(_Var4, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_GnomesReturned(2, _Var1, _Var1, _Var1, _Var1)
AND
IsEnemy(_Var1, _Var4, 1, _Var1, _Var1)
THEN
PROC_GlobalSetFlagAndCache(WYR_Ironhand_PlayerAttackedGnomesAtBridge_4b131584-19f8-4917-858b-495ae70d67cf);

IF
KilledBy((CHARACTER)_Var1, (CHARACTER)_Var2, _, _, (CHARACTER)_Var1)
AND
DB_WYR_Ironhand_SceneGnomes(_, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_GnomesReturned(2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GlobalSetFlagAndCache(WYR_Ironhand_PlayerAttackedGnomesAtBridge_4b131584-19f8-4917-858b-495ae70d67cf);

PROC
PROC_WYR_Ironhand_GnomesIntervent((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_WYR_Ironhand_SceneGnomes(_, _Var3, _Var1, _Var1, _Var1)
THEN
SetFlag(WYR_Ironhand_WasAtBridge_593d213b-ab66-490b-98af-d9f7243c5afc, _Var3);

PROC
PROC_WYR_Ironhand_GnomesIntervent((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_WYR_Ironhand_SceneGnomes(1, _Var2, _Var1, _Var1, _Var1)
THEN
DB_WYR_Ironhand_SteelWatchSunflashed(_Var1, _Var2);
CreateExplosion(_Var1, "Projectile_Sunflash", -1, _Var2);
PROC_CharacterDisableCrime(_Var1, "EnemyOfAbsolute");
PROC_WYR_Ironhand_GnomesRun();

PROC
PROC_WYR_Ironhand_GnomesRun()
THEN
SetFlag(WYR_Ironhand_Event_GnomesRanAway_f7bd298c-ac5d-4654-8368-c1022172272f);

IF
DialogEnded(WYR_South_Primary_f03a1685-b148-b70e-b773-b62404525308, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_GlobalFlag(WYR_South_State_AccessGranted_3339af4f-3214-4d10-aaab-3d3511b9ab74, _Var1, _Var1, _Var1, _Var1)
AND
DB_DialogPlayers(_Var1, _Var2, 1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(WYR_Ironhand_Event_GnomesIntervent_06ad5471-b210-4ea0-a390-09bc7afdd332, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_WYR_Ironhand_SkipScene();

PROC
PROC_WYR_Ironhand_SkipScene()
AND NOT
DB_GlobalFlag(WYR_Ironhand_State_GnomesReturned_a082d5cd-8360-429b-a77a-124e11ec99e8, _, _, _, _)
AND
DB_WYR_Ironhand_SceneGnomes(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_Pos_TpInsideCave(_Var1, _Var3, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var2, _Var3, "WYR_Ironhand_EscapeCheckpoint_ToPos4");

IF
EnteredTrigger((GUIDSTRING)_Var1, S_WYR_Ironhand_SUB_55832d9c-360c-483f-977a-bb6c4beb4eb0, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
SetFlag(WYR_Ironhand_State_InBasement_d9bdb8db-e34d-4263-8b21-6fc21643d963, _Var1);

IF
LeftTrigger((GUIDSTRING)_Var1, S_WYR_Ironhand_SUB_55832d9c-360c-483f-977a-bb6c4beb4eb0, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
ClearFlag(WYR_Ironhand_State_InBasement_d9bdb8db-e34d-4263-8b21-6fc21643d963, _Var1);

IF
UseFinished(_, S_WYR_Ironhand_HatchLever_7b551707-c332-4acd-8b4e-5da47cac1ca6, 1, (CHARACTER)_, (CHARACTER)_)
THEN
DB_WYR_Ironhand_HatchUnlocked(1);

PROC
PROC_BlockUseOfItem((GUIDSTRING)_Var1, S_WYR_Ironhand_CaveExitLadder_31e6d8a9-aaa8-4e9f-bec1-394f597b2500, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_HatchUnlocked(1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_CustomUseItemResponse(_Var1, S_WYR_Ironhand_CaveExitLadder_31e6d8a9-aaa8-4e9f-bec1-394f597b2500, 0);
PROC_TryStartAD(WYR_Ironhand_AD_HatchLocked_1e01d78e-a000-8a71-25a6-7581c362de94, _Var1);

PROC
PROC_BlockUseOfItem((CHARACTER)_Var1, S_WYR_Ironhand_CaveEntranceHatch_a3e607db-91b0-42fe-bf3e-3ff82026659b, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_HatchUnlocked(1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_CustomUseItemResponse(_Var1, S_WYR_Ironhand_CaveEntranceHatch_a3e607db-91b0-42fe-bf3e-3ff82026659b, 0);
PROC_TryStartAD(WYR_Ironhand_AD_HatchLocked_1e01d78e-a000-8a71-25a6-7581c362de94, _Var1);

IF
DB_Sees(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_Gnomes(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_WYR_Ironhand_SUB_55832d9c-360c-483f-977a-bb6c4beb4eb0, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(WYR_Ironhand_State_PlayerSawGnomes_d2378ff6-22b2-4f31-aa4e-947408de5cdc, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(WYR_Ironhand_State_PlayerSawGnomes_d2378ff6-22b2-4f31-aa4e-947408de5cdc, NULL_00000000-0000-0000-0000-000000000000, 0);

PROC
PROC_WYR_Ironhand_GnomesAddedToAct()
THEN
PROC_WYR_Ironhand_TrespassOn();

PROC
PROC_WYR_Ironhand_TrespassOn()
THEN
DB_TrespassTrigger(S_WYR_Ironhand_TrespassZone_a4d4730d-7706-457c-9585-e5f5e46282e0, TeleportTrigger_Bedroom_a6f18a3c-bab8-48d2-95dd-5acf1c88ec6a, "WYR_Ironhand_Trespass");

PROC
PROC_WYR_Ironhand_TrespassOff()
THEN
PROC_RemoveDBTrespassTrigger(S_WYR_Ironhand_TrespassZone_a4d4730d-7706-457c-9585-e5f5e46282e0);

IF
FlagSet(WYR_Ironhand_Event_TrespassAllowed_f8e792be-ac01-4360-8ee9-29430cf6ee56, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_WYR_Ironhand_TrespassOff();

IF
DialogActorLeft(WYR_NGB_Ironhand_Trespass_e36ee768-2cd1-6763-b1cc-46699d5d4b03, (INTEGER)_Var1, (CHARACTER)_Var2, _, (INTEGER)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
GetFlag(WYR_Ironhand_Event_TrespassAllowed_f8e792be-ac01-4360-8ee9-29430cf6ee56, NULL_00000000-0000-0000-0000-000000000000, 1, _Var1, _Var1)
THEN
PROC_WYR_Ironhand_TrespassOff();

IF
DialogStarted(WYR_Wulbren_fcd8ff87-7c42-9748-9a31-e9b8568f1a58, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_WYR_Ironhand_TrespassOff();

IF
DialogStarted(WYR_UnfortunateGnome_4897143a-f55e-123f-2fed-8a7c7dfd96a6, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_WYR_Ironhand_TrespassOff();

IF
DialogStarted(WYR_Ironhand_Welcome_bcba96a2-7cbb-9ea7-76b0-8b189c47388f, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_WYR_Ironhand_TrespassOff();

IF
DB_WYR_Ironhand_WelcomeGnome(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_CrimeType_CustomWarning(_Var1, "WYR_Ironhand_Trespass", WYR_Ironhand_Welcome_bcba96a2-7cbb-9ea7-76b0-8b189c47388f);

PROC
PROC_WYR_Ironhand_WelcomeDialogOn()
AND NOT
DB_GlobalFlag(WYR_Ironhand_Event_TrespassAllowed_f8e792be-ac01-4360-8ee9-29430cf6ee56, _, _, _, _)
AND
DB_WYR_Ironhand_WelcomeGnome(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_WYR_Ironhand_WelcomeDialogExpected(1);
DB_SpotPlayers(_Var1, "WYR_Ironhand_Welcome", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers_SpotTrigger(_Var1, "WYR_Ironhand_Welcome", S_WYR_Ironhand_SpotOnEntry_9d644be3-a2f5-4e65-a23a-79bc9cff8ae3);

PROC
PROC_SpotPlayers_Spotted((GUIDSTRING)_Var1, "WYR_Ironhand_Welcome", (GUIDSTRING)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_WYR_Ironhand_WelcomeGnome(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_WelcomeDialogExpected(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialog(WYR_Ironhand_Welcome_bcba96a2-7cbb-9ea7-76b0-8b189c47388f, _Var1, _Var2, _Var1, _Var1)
THEN
NOT DB_WYR_Ironhand_WelcomeDialogExpected(1);

PROC
PROC_StartDialog_AddExtraSpeakers(WYR_Ironhand_Welcome_bcba96a2-7cbb-9ea7-76b0-8b189c47388f, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_WYR_Ironhand_WelcomeGnome(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_SceneGnomes(_, _Var4, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailable(_Var4, _Var1, _Var1, _Var1, _Var1)
AND
QRY_IsInRange(_Var4, _Var2, 25, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, _Var4);
PROC_Purge_CancelMovement(_Var4);

IF
DialogActorLeft(WYR_Ironhand_Welcome_bcba96a2-7cbb-9ea7-76b0-8b189c47388f, _, (CHARACTER)_Var2, _, _)
AND
DB_WYR_Ironhand_SceneGnomes(_Var4, _Var2, _, _, _)
AND NOT
DB_WYR_Ironhand_GnomesReturned(2, _, _, _, _)
THEN
PROC_WYR_Ironhand_FromEntranceToWulbren(_Var2);

IF
EnteredTrigger((CHARACTER)_Var1, S_WYR_Ironhand_SpotOnEntry_Off_ee352681-79ca-49e4-bdeb-3199be15b068, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_WelcomeGnome(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_WelcomeDialogExpected(1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SpotPlayers_StopSpotting(_Var2, "WYR_Ironhand_Welcome");
PROC_TriggerUnregisterForPlayers(S_WYR_Ironhand_SpotOnEntry_Off_ee352681-79ca-49e4-bdeb-3199be15b068);
NOT DB_WYR_Ironhand_WelcomeDialogExpected(1);

QRY
QRY_SelectCustomDialog_AfterGenerics((CHARACTER)_Var1, (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_WelcomeGnome(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_WelcomeDialogExpected(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialog(WYR_Ironhand_Welcome_bcba96a2-7cbb-9ea7-76b0-8b189c47388f, _Var1, _Var2, _Var1, _Var1)
THEN
NOT DB_WYR_Ironhand_WelcomeDialogExpected(1);
PROC_SpotPlayers_StopSpotting("WYR_Ironhand_Welcome");
PROC_TriggerUnregisterForPlayers(S_WYR_Ironhand_SpotOnEntry_Off_ee352681-79ca-49e4-bdeb-3199be15b068);

PROC
PROC_WYR_Ironhand_GnomesRun()
AND
DB_WYR_Ironhand_SceneGnomes(_, _Var2, _, _, _)
THEN
PROC_WYR_Ironhand_TrespassOff();
PROC_WYR_Ironhand_WelcomeDialogOn();
PROC_WYR_Ironhand_RunGnomeRun(_Var2);

PROC
PROC_WYR_Ironhand_RunGnomeRun((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
LeaveCombat(_Var1);
PROC_CharacterMoveTo(_Var1, S_WYR_Ironhand_EscapeCheckpoint_Pos0_889ee973-40b8-4eb4-9344-ff500bd30278, "Run", "WYR_Ironhand_EscapeCheckpoint_ToPos0");

PROC
PROC_WYR_Ironhand_RunGnomeRun(S_GLO_GnomePrisoner_001_4fbd62e8-a486-471e-8a65-00966b058dd5, _, _, _, _)
THEN
PROC_TryStartAD(WYR_Ironhand_AD_RunRunRun_4233f3d0-69d8-8384-86b3-2fc619ac6d0d, S_GLO_GnomePrisoner_001_4fbd62e8-a486-471e-8a65-00966b058dd5);

PROC
PROC_WYR_Ironhand_RunGnomeRun(S_WYR_Ironhand_Artificer_001_627b5b4d-51df-416a-800a-ddf357c96995, _, _, _, _)
THEN
PROC_TryStartAD(WYR_Ironhand_AD_RunRunRun_4233f3d0-69d8-8384-86b3-2fc619ac6d0d, NULL_00000000-0000-0000-0000-000000000000, S_WYR_Ironhand_Artificer_001_627b5b4d-51df-416a-800a-ddf357c96995);

IF
EntityEvent((GUIDSTRING)_Var1, "WYR_Ironhand_EscapeCheckpoint_ToPos0", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
PROC_CharacterMoveTo(_Var1, S_WYR_Ironhand_EscapeCheckpoint_Pos1_4889d1de-5dd2-43d1-95d5-588f9d306e30, "Run", "WYR_Ironhand_EscapeCheckpoint_ToPos1");

IF
EntityEvent((GUIDSTRING)_Var1, "WYR_Ironhand_EscapeCheckpoint_ToPos1", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
TeleportTo(_Var1, S_WYR_Ironhand_EscapeCheckpoint_Pos2_79bb89da-c591-4439-970c-f4a488da4104, "Projectile_WYR_Ironhand_GnomeJump");

IF
CastedSpell((CHARACTER)_Var1, "Projectile_WYR_Ironhand_GnomeJump", _, _, _)
THEN
PROC_CharacterMoveTo(_Var1, S_WYR_Ironhand_EscapeCheckpoint_Pos3_2cef84ee-8de1-4635-806f-36d8c54c5076, "Run", "WYR_Ironhand_EscapeCheckpoint_ToPos3");

IF
EntityEvent((GUIDSTRING)_Var1, "Projectile_WYR_Ironhand_GnomeJump", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
RemoveSpell(_Var1, "Projectile_WYR_Ironhand_GnomeJump", 0);
PROC_CharacterMoveTo(_Var1, S_WYR_Ironhand_EscapeCheckpoint_Pos3_2cef84ee-8de1-4635-806f-36d8c54c5076, "Run", "WYR_Ironhand_EscapeCheckpoint_ToPos3");

IF
EntityEvent((GUIDSTRING)_Var1, "WYR_Ironhand_EscapeCheckpoint_ToPos3", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
TeleportTo(_Var1, S_WYR_Ironhand_EscapeCheckpoint_Pos4_de334604-9b30-4315-bdfc-7e2f3083bda3, "WYR_Ironhand_EscapeCheckpoint_ToPos4");

IF
EntityEvent((CHARACTER)_Var1, "WYR_Ironhand_EscapeCheckpoint_ToPos4", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_InRegion(_Var2, S_WYR_Ironhand_SUB_55832d9c-360c-483f-977a-bb6c4beb4eb0, _Var1, _Var1, _Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_FromEntranceToWulbren(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_WYR_Ironhand_FromEntranceToWulbren(_Var1);

IF
EntityEvent((GUIDSTRING)_Var1, "WYR_Ironhand_EscapeCheckpoint_ToPos4", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_WYR_Ironhand_FromEntranceToWulbren(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_WYR_Ironhand_WaitForPlayerToRun(1);

IF
DB_WYR_Ironhand_WaitForPlayerToRun(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_WYR_Ironhand_SUB_55832d9c-360c-483f-977a-bb6c4beb4eb0, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_SceneGnomes(_Var2, _Var3, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_FromEntranceToWulbren(_Var3, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(WYR_Ironhand_PlayerFollowsGnomes_6f09d846-7838-4815-9f73-f154c104ace2);
PROC_WYR_Ironhand_FromEntranceToWulbren(_Var3);

PROC
PROC_WYR_Ironhand_FromEntranceToWulbren((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_WYR_Ironhand_SceneGnomes(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_Pos_ReturnToRoom(_Var2, _Var3, _Var1, _Var1, _Var1)
THEN
DB_WYR_Ironhand_FromEntranceToWulbren(_Var1);
PROC_CharacterMoveTo(_Var1, _Var3, "Run", "WYR_Ironhand_ReturnedHome");

IF
EntityEvent((GUIDSTRING)_Var1, "WYR_Ironhand_EscapeCheckpoint_ToPos4", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_WYR_Ironhand_SceneGnomes(_, _Var1, _Var1, _Var1, _Var1)
THEN
DB_WYR_Ironhand_ReturnHomeCanAD(1);

IF
DB_WYR_Ironhand_ReturnHomeCanAD(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_WYR_Ironhand_SUB_55832d9c-360c-483f-977a-bb6c4beb4eb0, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_SceneGnomes(1, _Var2, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("WYR_Ironhand_AD_FollowMe", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(WYR_Ironhand_AD_FollowMe_ac78df67-f6a2-782d-7544-1e08bb50ac39, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_StartDialog_AddExtraSpeakers(WYR_Ironhand_AD_FollowMe_ac78df67-f6a2-782d-7544-1e08bb50ac39, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_WYR_Ironhand_SceneGnomes(1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, _Var2);

IF
DB_WYR_Ironhand_ReturnHomeCanAD(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_HadNoCower(_Var1, 0, _Var1, _Var1, _Var1)
THEN
ClearFlag(GLO_State_NoCower_8180293e-4d0d-4e9b-9dfc-b195d4c67ddb, _Var1);

IF
AutomatedDialogStarted(WYR_Ironhand_AD_FollowMe_ac78df67-f6a2-782d-7544-1e08bb50ac39, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
NOT DB_WYR_Ironhand_ReturnHomeCanAD(1);

IF
AutomatedDialogEnded(WYR_Ironhand_AD_FollowMe_ac78df67-f6a2-782d-7544-1e08bb50ac39, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
NOT DB_WYR_Ironhand_ReturnHomeCanAD(1);

IF
EntityEvent(_, "WYR_Ironhand_ReturnedHome", _, _, _)
AND
DB_WYR_Ironhand_GnomesReturned(1, _, _, _, _)
THEN
NOT DB_WYR_Ironhand_GnomesReturned(1);
DB_WYR_Ironhand_GnomesReturned(2);

IF
EntityEvent(_, "WYR_Ironhand_ReturnedHome", _, _, _)
AND NOT
DB_WYR_Ironhand_GnomesReturned(_, _, _, _, _)
THEN
DB_WYR_Ironhand_GnomesReturned(1);

IF
DB_WYR_Ironhand_GnomesReturned(2, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_SceneGnomes(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_SceneGnomes(2, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(WYR_Ironhand_State_WulbrenDead_b837a5cd-31f9-4cfc-b341-dee71e93a067, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(WYR_Ironhand_State_GnomesReturned_a082d5cd-8360-429b-a77a-124e11ec99e8);
PROC_TryStartAD(WYR_Ironhand_AD_GnomesBackHome_854368fc-651d-ab2a-01ab-2c20c665b0cd, S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, S_FOR_UnfortunateGnome_6e45a00b-bad2-40bb-9403-147b9e92d976, _Var1, _Var2);

IF
DB_WYR_Ironhand_GnomesReturned(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_SceneGnomes(1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_SceneGnomes(2, _, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(WYR_Ironhand_State_WulbrenDead_b837a5cd-31f9-4cfc-b341-dee71e93a067, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(WYR_Ironhand_State_GnomesReturned_a082d5cd-8360-429b-a77a-124e11ec99e8);
PROC_TryStartAD(WYR_Ironhand_AD_GnomesBackHome_854368fc-651d-ab2a-01ab-2c20c665b0cd, S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, S_FOR_UnfortunateGnome_6e45a00b-bad2-40bb-9403-147b9e92d976, _Var1, NULL_00000000-0000-0000-0000-000000000000);

QRY
QRY_StartDialogFailed(WYR_Ironhand_AD_GnomesBackHome_854368fc-651d-ab2a-01ab-2c20c665b0cd, _, _, _, _, _, _, (GUIDSTRING)_, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_WYR_Ironhand_GnomesToBasePos();

IF
AutomatedDialogEnded(WYR_Ironhand_AD_GnomesBackHome_854368fc-651d-ab2a-01ab-2c20c665b0cd, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_WYR_Ironhand_GnomesToBasePos();

PROC
PROC_WYR_Ironhand_GnomesToBasePos()
AND
DB_WYR_Ironhand_SceneGnomes(_, _Var2, _, _, _)
AND
DB_WYR_Ironhand_Init(_Var2, _Var3, _, _, _)
THEN
ClearFlag(WYR_Ironhand_State_AtCheckpoint_fbba9492-5888-4f04-8be7-b6af11ab5463, _Var2);
PROC_CharacterMoveTo(_Var2, _Var3, "Walk", "");

IF
EnteredTrigger((GUIDSTRING)_Var1, S_WYR_Ironhand_FootprintsVB_Zone_59ab580b-995b-4a80-b20f-4a2a4b2f4fe6, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_Footprint_Checks(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_Footprint_Result(_Var1, _, _Var1, _Var1, _Var1)
THEN
PROC_WYR_Ironhand_FootprintsCheck(_Var1);

PROC
PROC_WYR_Ironhand_FootprintsCheck((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_Footprint_Checks(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_Footprint_Result(_Var2, _, _Var1, _Var1, _Var1)
AND
QRY_IsInRange(_Var2, _Var1, 11, _Var1, _Var1)
THEN
PROC_TrySkillCheck(_Var2, NULL_00000000-0000-0000-0000-000000000000, "Survival", Act3_Medium_77cee1c4-384a-4217-b670-67db3c7add57, "WYR_Ironhand_Footprints");
DB_WYR_Ironhand_Footprint_Checks(_Var2);

QRY
QRY_GLO_SkillCheck_CheckAdvantage((CHARACTER)_Var1, _, "WYR_Ironhand_Footprints", (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
IsTagged(_Var1, REALLY_DEEPGNOME_17d29357-beba-4096-accc-c28bdea88fda, 1, _Var1, _Var1)
THEN
DB_QRYRTN_GLO_Skillcheck_CheckAdvantage(2);

QRY
QRY_GLO_SkillCheck_CheckAdvantage((CHARACTER)_Var1, _, "WYR_Ironhand_Footprints", (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_QRYRTN_GLO_Skillcheck_CheckAdvantage(2, _Var1, _Var1, _Var1, _Var1)
AND
IsTagged(_Var1, REALLY_UNDERDARK_2d0a73b9-f113-4d35-bdee-a31ab9163d74, 1, _Var1, _Var1)
THEN
DB_QRYRTN_GLO_Skillcheck_CheckAdvantage(1);

PROC
PROC_RollResult("WYR_Ironhand_Footprints", (GUIDSTRING)_Var1, (GUIDSTRING)_Var2, 1, (GUIDSTRING)_Var1)
THEN
SetFlag(WYR_Ironhand_State_HideoutRollSuccess_64e6e13a-21bb-408b-ae0e-a6e063a86bad, _Var1, 0);

PROC
PROC_RollResult("WYR_Ironhand_Footprints", (GUIDSTRING)_Var1, (GUIDSTRING)_Var2, (INTEGER)_Var3, (GUIDSTRING)_Var1)
AND
_Var3 != 2
AND
DB_WYR_Ironhand_Footprint_Checks(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_WYR_Ironhand_Footprint_Result(_Var1, _Var3);

PROC
PROC_RollResult("WYR_Ironhand_Footprints", (GUIDSTRING)_Var1, (GUIDSTRING)_Var2, (INTEGER)_Var3, (GUIDSTRING)_Var1)
AND
DB_WYR_Ironhand_Footprint_Checks(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_WYR_Ironhand_Footprint_Checks(_Var1);

PROC
PROC_RollResult("WYR_Ironhand_Footprints", (GUIDSTRING)_Var1, (GUIDSTRING)_Var2, _, (GUIDSTRING)_Var1)
AND NOT
DB_WYR_Ironhand_Footprint_Checks(_, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_WYR_Ironhand_Footprint_ChooseOne();

PROC
PROC_WYR_Ironhand_Footprint_ChooseOne()
AND
DB_WYR_Ironhand_Footprint_Result(_Var1, 1, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_Footprint_ChosenOne(_, _Var1, _Var1, _Var1, _Var1)
AND
IsTagged(_Var1, REALLY_DEEPGNOME_17d29357-beba-4096-accc-c28bdea88fda, 1, _Var1, _Var1)
THEN
DB_WYR_Ironhand_Footprint_ChosenOne(_Var1);

PROC
PROC_WYR_Ironhand_Footprint_ChooseOne()
AND
DB_WYR_Ironhand_Footprint_Result(_Var1, 1, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_Footprint_ChosenOne(_, _Var1, _Var1, _Var1, _Var1)
AND
IsTagged(_Var1, REALLY_UNDERDARK_2d0a73b9-f113-4d35-bdee-a31ab9163d74, 1, _Var1, _Var1)
THEN
DB_WYR_Ironhand_Footprint_ChosenOne(_Var1);

PROC
PROC_WYR_Ironhand_Footprint_ChooseOne()
AND
DB_WYR_Ironhand_Footprint_Result(_Var1, 1, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_Footprint_ChosenOne(_, _Var1, _Var1, _Var1, _Var1)
THEN
DB_WYR_Ironhand_Footprint_ChosenOne(_Var1);

PROC
PROC_WYR_Ironhand_Footprint_ChooseOne()
AND
DB_WYR_Ironhand_Footprint_Result(_Var1, _, _Var1, _Var1, _Var1)
AND NOT
DB_WYR_Ironhand_Footprint_ChosenOne(_, _Var1, _Var1, _Var1, _Var1)
THEN
DB_WYR_Ironhand_Footprint_ChosenOne(_Var1);

IF
DB_WYR_Ironhand_Footprint_ChosenOne(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(WYR_Ironhand_PAD_Footprints_486dff09-7f85-b134-3083-d2ca1836c3e7, _Var1);

IF
DB_WYR_Ironhand_Footprint_Result(_Var1, 1, _Var1, _Var1, _Var1)
THEN
PROC_PlayPerceptionRevealEffect(S_WYR_Ironhand_CaveEntranceDoor_bdcadf43-35e5-421e-8fa4-7d5456b825e6, "WYR_Ironhand_CaveVFX");
PROC_TriggerUnregisterForPlayers(S_WYR_Ironhand_FootprintsVB_Zone_59ab580b-995b-4a80-b20f-4a2a4b2f4fe6);

PROC
PROC_WYR_Ironhand_GnomesAddedToAct()
THEN
DB_WYR_Ironhand_EntranceInteractible(1);

PROC
PROC_WYR_Ironhand_NoGnomesInAct()
THEN
DB_WYR_Ironhand_EntranceInteractible(0);

IF
DB_WYR_Ironhand_EntranceInteractible(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_EntranceInteractible(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != _Var2
THEN
NOT DB_WYR_Ironhand_EntranceInteractible(_Var2);

IF
DB_WYR_Ironhand_EntranceInteractible(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetCanInteract(S_WYR_Ironhand_CaveEntranceDoor_bdcadf43-35e5-421e-8fa4-7d5456b825e6, _Var1);
PROC_SetOnStage(S_WYR_Ironhand_Footprints_16ea3bbf-2b03-4b45-9f48-cf4f0bf0e7ee, _Var1);

IF
DB_WYR_Ironhand_EntranceInteractible(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Negate(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(S_WYR_Ironhand_GnomeHideoutRubble_ee2a91be-7fe6-48cb-9b46-63c75eea3e1d, _Var2);

IF
DB_WYR_Ironhand_EntranceInteractible(1, _, _, _, _)
THEN
PROC_TriggerRegisterForPlayers(S_WYR_Ironhand_FootprintsVB_Zone_59ab580b-995b-4a80-b20f-4a2a4b2f4fe6);

IF
DB_WYR_Ironhand_EntranceInteractible(0, _, _, _, _)
THEN
PROC_TriggerUnregisterForPlayers(S_WYR_Ironhand_FootprintsVB_Zone_59ab580b-995b-4a80-b20f-4a2a4b2f4fe6);

PROC
PROC_WYR_Ironhand_GnomesAddedToAct()
THEN
DB_PermaDefeatedEvent(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, WYR_Ironhand_State_WulbrenDead_b837a5cd-31f9-4cfc-b341-dee71e93a067);

IF
DB_Sees(_Var1, S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, _Var1, _Var1, _Var1)
AND
DB_WYR_Ironhand_SceneGnomes(_, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(WYR_Ironhand_State_WulbrenDead_b837a5cd-31f9-4cfc-b341-dee71e93a067, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_WYR_Ironhand_ReturnedAndRunAway();

IF
DB_WYR_Ironhand_GnomesReturned(2, _, _, _, _)
AND
DB_GlobalFlag(WYR_Ironhand_State_WulbrenDead_b837a5cd-31f9-4cfc-b341-dee71e93a067, _, _, _, _)
THEN
PROC_WYR_Ironhand_ReturnedAndRunAway();

IF
DB_WYR_Ironhand_GnomesReturned(1, _, _, _, _)
AND NOT
DB_WYR_Ironhand_SceneGnomes(2, _, _, _, _)
AND
DB_GlobalFlag(WYR_Ironhand_State_WulbrenDead_b837a5cd-31f9-4cfc-b341-dee71e93a067, _, _, _, _)
THEN
PROC_WYR_Ironhand_ReturnedAndRunAway();

PROC
PROC_WYR_Ironhand_ReturnedAndRunAway()
THEN
PROC_GlobalSetFlagAndCache(WYR_Ironhand_State_GnomesReturned_a082d5cd-8360-429b-a77a-124e11ec99e8);

PROC
PROC_WYR_Ironhand_ReturnedAndRunAway()
AND
QRY_OnlyOnce("WYR_Ironhand_AD_GnomesBackHome_WulbrenDead", _, _, _, _)
THEN
PROC_TryStartAD(WYR_Ironhand_AD_GnomesBackHome_WulbrenDead_8dd4ec5a-0405-8a9e-4c48-573172e59e20, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_StartDialog_AddExtraSpeakers(WYR_Ironhand_AD_GnomesBackHome_WulbrenDead_8dd4ec5a-0405-8a9e-4c48-573172e59e20, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_WYR_Ironhand_SceneGnomes(1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, _Var2);

PROC
PROC_StartDialog_AddExtraSpeakers(WYR_Ironhand_AD_GnomesBackHome_WulbrenDead_8dd4ec5a-0405-8a9e-4c48-573172e59e20, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_WYR_Ironhand_SceneGnomes(2, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, _Var2);

QRY
QRY_StartDialogFailed(WYR_Ironhand_AD_GnomesBackHome_WulbrenDead_8dd4ec5a-0405-8a9e-4c48-573172e59e20, _, _, _, _, _, _, _, _, _)
AND
DB_WYR_Ironhand_SceneGnomes(_, _Var8, _, _, _)
THEN
PROC_WYR_Ironhand_GnomesLeavesBasement(_Var8);

IF
AutomatedDialogEnded(WYR_Ironhand_AD_GnomesBackHome_WulbrenDead_8dd4ec5a-0405-8a9e-4c48-573172e59e20, _, _, _, _)
AND
DB_WYR_Ironhand_SceneGnomes(_, _Var3, _, _, _)
THEN
PROC_WYR_Ironhand_GnomesLeavesBasement(_Var3);

IF
DB_GlobalFlag(WYR_Ironhand_State_WulbrenDead_b837a5cd-31f9-4cfc-b341-dee71e93a067, _, _, _, _)
AND
DB_CurrentLevel("BGO_Main_A", _, _, _, _)
AND
QRY_OnlyOnce("WYR_Ironhand_AllIronhandGnomesLeave", _, _, _, _)
THEN
PROC_WYR_Ironhand_AllGnomesLeave();

PROC
PROC_WYR_Ironhand_AllGnomesLeave()
AND NOT
DB_InRegion(_, S_WYR_Ironhand_SUB_55832d9c-360c-483f-977a-bb6c4beb4eb0, _, _, _)
AND
DB_WYR_Ironhand_Gnomes(_Var2, _, _, _, _)
AND NOT
DB_PermaDefeated(_Var2, _, _, _, _)
THEN
SetOnStage(_Var2, 0);

PROC
PROC_WYR_Ironhand_AllGnomesLeave()
AND
QRY_AnyCharacterInTrigger(S_WYR_Ironhand_SUB_55832d9c-360c-483f-977a-bb6c4beb4eb0, _, _, _, _)
AND
DB_WYR_Ironhand_Gnomes(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsInTrigger(_Var1, S_WYR_Ironhand_SUB_55832d9c-360c-483f-977a-bb6c4beb4eb0, 1, _Var1, _Var1)
THEN
PROC_NotifyWhenReadyToMoveOn(_Var1, "WYR_Ironhand_GnomeReadyToLeaveBasement");

PROC
PROC_ReadyToMoveOn((CHARACTER)_Var1, "WYR_Ironhand_GnomeReadyToLeaveBasement", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_WYR_Ironhand_GnomesLeavesBasement(_Var1);

PROC
PROC_WYR_Ironhand_GnomesLeavesBasement((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_CharacterMoveTo(_Var1, S_TeleportTrigger_BlackSmithCave_002_55b78fdb-f4dc-41c4-8926-68ff27d94ebe, "Run", "WYR_Ironhand_GnomeLeaveBasement");

IF
EntityEvent((GUIDSTRING)_Var1, "WYR_Ironhand_GnomeLeaveBasement", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
SetOnStage(_Var1, 0);

PROC
PROC_WYR_Ironhand_GnomesAddedToAct()
THEN
PROC_SetOnStage(S_WYR_Ironhand_RunepowderBomb_8b926cb4-9dd3-4bbf-8b76-9d628270cf1f, 1);

PROC
PROC_WYR_Ironhand_NoGnomesInAct()
THEN
PROC_SetOnStage(S_WYR_Ironhand_RunepowderBomb_8b926cb4-9dd3-4bbf-8b76-9d628270cf1f, 0);

IF
FlagSet(WYR_Ironhand_Event_TerroristQuest_Offered_681451d3-6186-4c59-aba7-94ef8fdef701, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
ClearOwnership(S_WYR_Ironhand_RunepowderBomb_8b926cb4-9dd3-4bbf-8b76-9d628270cf1f);

IF
FlagSet(WYR_Ironhand_Event_TerroristQuest_Accepted_0dae7572-9ff4-4991-900b-dadfe153d306, _, (INTEGER)_Var2, _, _)
AND
DB_DialogPlayers(_Var2, _Var3, 1, _, _)
AND
IsInInventory(S_WYR_Ironhand_RunepowderBomb_8b926cb4-9dd3-4bbf-8b76-9d628270cf1f, 0, _, _, _)
AND
IsInTrigger(S_WYR_Ironhand_RunepowderBomb_8b926cb4-9dd3-4bbf-8b76-9d628270cf1f, S_WYR_Ironhand_BombArea_47fbcaee-7fcb-4f07-a536-9f110d4db7a5, 1, _, _)
AND
IsDestroyed(S_WYR_Ironhand_RunepowderBomb_8b926cb4-9dd3-4bbf-8b76-9d628270cf1f, 0, _, _, _)
THEN
ToInventory(S_WYR_Ironhand_RunepowderBomb_8b926cb4-9dd3-4bbf-8b76-9d628270cf1f, _Var3, 1, 1, 1);

IF
AddedTo(S_WYR_Ironhand_RunepowderBomb_8b926cb4-9dd3-4bbf-8b76-9d628270cf1f, (GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(WYR_Ironhand_Event_TerroristQuest_Offered_681451d3-6186-4c59-aba7-94ef8fdef701, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_WYR_Ironhand_PlayerTookBomb(_Var1);

PROC
PROC_WYR_Ironhand_PlayerTookBomb((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_GlobalFlag(WYR_Ironhand_Event_TerroristQuest_Accepted_0dae7572-9ff4-4991-900b-dadfe153d306, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GlobalSetFlagAndCache(WYR_Ironhand_Event_PlayerTookBomb_103ee3a7-83b8-3d83-9fea-b6d2fe84898d);

PROC
PROC_WYR_Ironhand_PlayerTookBomb((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_GlobalFlag(WYR_Ironhand_Event_PlayerTookBomb_103ee3a7-83b8-3d83-9fea-b6d2fe84898d, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(WYR_Ironhand_Event_TerroristQuest_Accepted_0dae7572-9ff4-4991-900b-dadfe153d306, _Var1, _Var1, _Var1, _Var1)
AND
DB_Sees(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialog(WYR_Wulbren_fcd8ff87-7c42-9748-9a31-e9b8568f1a58, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_WYR_Ironhand_PlayerTookBomb((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Sees(S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(WYR_Ironhand_Event_TerroristQuest_Accepted_0dae7572-9ff4-4991-900b-dadfe153d306, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("WYR_Ironhand_AD_PlayerPicksBomb", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(WYR_Ironhand_AD_PlayerPicksBomb_a40e6e57-34d9-6cbc-501a-1d9d327856f7, S_GLO_InjuredGnome_fcf53ac7-1805-4e57-b6ed-4f7b0f90cf96, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_WYR_Ironhand_PlayerTookBomb((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Sees(S_WYR_Ironhand_ArtificerExtra_002_18f98c7f-0c7d-42b1-9ff2-acbcfd764e60, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(WYR_Ironhand_Event_TerroristQuest_Accepted_0dae7572-9ff4-4991-900b-dadfe153d306, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("WYR_Ironhand_AD_PlayerPicksBomb", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(WYR_Ironhand_AD_PlayerPicksBomb_a40e6e57-34d9-6cbc-501a-1d9d327856f7, NULL_00000000-0000-0000-0000-000000000000, S_WYR_Ironhand_ArtificerExtra_002_18f98c7f-0c7d-42b1-9ff2-acbcfd764e60);

IF
DB_PermaDefeated(S_GLO_Gortash_b878a854-f790-4999-95c4-3f20f00f65ac, _, _, _, _)
AND NOT
DB_Defeated(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, _, _, _, _)
AND
DB_GlobalFlag(WYR_Ironhand_InAct3_Wulbren_3097cdd8-33eb-4ca0-956b-b2826bb01f8a, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_SteelWatchFoundry_State_Destroyed_cdfffe24-5082-4e41-b7c2-f1fef6da3a8a, _, _, _, _)
THEN
DB_NotifyWhenReadyToMoveOn(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, "WYR_Ironhand_GortashDead_WulbrenReadyToGo");

PROC
PROC_ReadyToMoveOn(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, "WYR_Ironhand_GortashDead_WulbrenReadyToGo", _, _, _)
THEN
PROC_DisappearOutOfSight(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, "Walk", 1, "WYR_Ironhand_GortashDead_WulbrenWentToFoundry");
DB_WYR_IronHand_WulbrenWaitingToTeleport(1);

IF
DB_CurrentLevel("CTY_Main_A", _, _, _, _)
AND
DB_WYR_IronHand_WulbrenWaitingToTeleport(1, _, _, _, _)
THEN
NOT DB_WYR_IronHand_WulbrenWaitingToTeleport(1);
TeleportTo(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, S_LOW_SteelWatchOutcomeLocation_672c319c-ecc6-4797-8447-16eeca161146, "", 0, 0, 0, 1, 1);
SetOnStage(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, 1);
SetFaction(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, ACT3_LOW_SteelWatchFoundry_Ironhands_64aaa374-aa33-4866-8780-6e1472f215d8);
PROC_RemoveDialog(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf);
DB_Dialogs(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf, LOW_SteelWatchFoundry_WulbrenThanks_23985c4f-1b42-5820-f757-e56ea3957746);
DB_WYR_IronHand_WulbrenWaitingAtFoundry(1);

IF
DialogEnded(LOW_SteelWatchFoundry_WulbrenThanks_23985c4f-1b42-5820-f757-e56ea3957746, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
DB_LOW_SteelWatchFoundry_DisappearAfterLongRest(S_GLO_Wulbren_2d70edbf-1a70-4047-8099-48f3e75d93bf);


EXITSECTION
ENDEXITSECTION

ParentTargetEdge "Act3_GEN"
