Version 1
SubGoalCombiner SGC_AND

INITSECTION
DB_LOW_BaldursGate_WarningTriggers(LOW_BaldursGate_EmperorAD_EmperorWarning1_cae726bd-cbba-838b-3dc0-ae52ee7a97cd, S_LOW_BaldursGate_Lvl1Warning_fbbefd03-3745-4374-bc87-8b1cb42fd3e1);
DB_LOW_BaldursGate_WarningTriggers(LOW_BaldursGate_EmperorAD_EmperorWarning2_8d155aa8-174f-981c-24ac-8e89afd4ea17, S_LOW_BaldursGate_Lvl3Warning_37707943-c06d-4f3a-a65d-1c6cb6928db8);
DB_LOW_BaldursGate_WarningTriggers(LOW_BaldursGate_EmperorAD_EmperorWarning3_adbaffca-3c58-ac53-6590-45ca139306a1, S_LOW_BaldursGate_Lvl3Warning_001_f1c47b77-78ed-453d-b3c8-1794b7753f05);
DB_Dialogs(S_LOW_BaldursGate_Civilian_001_01bf1f19-906d-49f6-92ae-2140132e4bde, LOW_BaldursGate_Civilian_001_e0b705cf-b0a3-e325-1f91-1ddd3bbf2cc6);
DB_Dialogs(S_LOW_BaldursGate_Civilian_002_65c3898f-aaf0-4690-8f3d-4f67ca38d8b1, LOW_BaldursGate_Civilian_002_5c62fc2e-9fe3-2191-5b2f-504d25861c8f);
DB_Dialogs(S_LOW_BaldursGate_Civilian_003_64e336e2-3129-4927-a40a-7957260d1f33, LOW_BaldursGate_Civilian_003_f3ae8f29-9d8f-23b3-e6a2-bbf83275168a);
DB_Dialogs(S_LOW_BaldursGate_Civilian_004_0cb40ad2-5825-4b0d-8190-baef7c7e4883, LOW_BaldursGate_Civilian_004_f7d07be5-3244-eb9e-1154-23f7b1a7b382);
DB_Dialogs(S_LOW_BaldursGate_Civilian_005_2dcd714d-7516-4be1-b598-86cbd0f6c5bf, LOW_BaldursGate_Civilian_005_a8e33dc5-93ff-1ffb-b655-9f48656a92e3);
DB_Dialogs(S_LOW_BaldursGate_Civilian_006_34a066d0-17ce-4493-a030-6ec60fb1a24e, LOW_BaldursGate_Civilian_006_34081cf2-6c62-b341-9fd2-e315c2ee9d45);
DB_Dialogs(S_LOW_BaldursGate_Civilian_007_4f600f97-50b9-493a-814d-132af409d546, LOW_BaldursGate_Civilian_007_7d97f38d-b17d-6273-8a58-a5a61cf6d511);
DB_Dialogs(S_LOW_BaldursGate_Civilian_008_2707dc70-00d6-4fa8-8467-6d3c9c672ec5, LOW_BaldursGate_Civilian_008_fcb4ebce-9c6c-3ef7-d081-3f14adb11ff0);
DB_Dialogs(S_LOW_BaldursGate_Civilian_009_2611633d-3a0d-461a-9d89-7546a8e6410c, LOW_BaldursGate_Civilian_009_da00d0f9-71ac-49e8-7f42-c8fd227a04f3);
DB_Dialogs(S_LOW_BaldursGate_Civilian_010_3673512c-aa19-4372-a23b-58b7b28645f5, LOW_BaldursGate_Civilian_010_f9533e9a-2565-79f3-0f50-6e4773338ae0);
DB_Dialogs(S_LOW_BaldursGate_Civilian_011_af704b06-6d69-41ae-9636-7b7ef043036c, LOW_BaldursGate_Civilian_011_7c73a4b5-b806-a0f0-758b-74434b25a731);
DB_Dialogs(S_LOW_BaldursGate_FlamingFist_Caster_001_02a89b77-07fe-4cc2-90d6-a7d5102f4cf7, LOW_BaldursGate_FlamingFist_Caster001_ba7ad372-5dd4-120b-1868-4bb403af3215);
DB_Dialogs(S_LOW_BaldursGate_FlamingFist_Cleric_001_f61ed726-793d-4611-a234-ad5a6b487514, LOW_BaldursGate_FlamingFist_Cleric_001_fe015ca8-c39d-0f31-242f-05c954e767a2);
DB_Dialogs(S_LOW_BaldursGate_FlamingFist_Melee_001_db0f9ee3-bdda-43f9-82e3-27f7e5ae6da9, LOW_BaldursGate_FlamingFist_Melee_001_3633d8fd-31cd-8e14-f875-21f13f393511);
DB_Dialogs(S_LOW_BaldursGate_FlamingFist_Melee_002_7fbbdc48-5a94-4fc3-bf75-2bc9427d53b9, LOW_BaldursGate_FlamingFist_Melee_002_134e07a7-718b-803b-1975-ba614d90ac5d);
DB_Dialogs(S_LOW_BaldursGate_FlamingFist_Melee_003_631b6f9d-b5bd-4ea9-99ff-c8cb2f9b6c1d, LOW_BaldursGate_FlamingFist_Melee_003_5867d9ea-9a5b-833d-bf5a-4e77c2ec396c);
DB_Dialogs(S_LOW_BaldursGate_FlamingFist_Melee_004_730ac8f8-1ea6-43ac-a106-a1094450ce13, LOW_BaldursGate_FlamingFist_Melee_004_ec9fa980-c9cd-3254-1918-17e95b6a72c0);
DB_Dialogs(S_LOW_BaldursGate_FlamingFist_Ranger_001_08d0dcec-a5c3-4099-922c-2a0b8b97fcd6, LOW_BaldursGate_FlamingFist_Ranger_001_6ce798a6-1813-3353-604b-7ede9ca79bdd);
DB_Dialogs(S_LOW_BaldursGate_FlamingFist_Ranger_002_961b6b4e-8dfe-40c1-ba9b-2859cecbe3a3, LOW_BaldursGate_FlamingFist_Ranger_002_39e31dfc-9f76-56cb-7c2a-33c72b727c55);
PROC_TriggerRegisterForPlayers(S_LOW_BaldursGate_SlowZone_ca99b6a7-9dc9-4f74-87c4-410aa22af3c9);
PROC_TriggerRegisterForPlayers(S_LOW_BaldursGate_RapidMindMeldArea_d7ff0c9f-c071-4960-bbbf-0962dfca11bf);
DB_GLO_Brainquakes_Directional_Difficult("Constitution", Act3_Impossible_ef0d0c54-3500-466f-98db-5c0600158cb7, "LOW_BaldursGate_Brainquakes");
DB_GLO_Brainquakes_Directional_StunTime("LOW_BaldursGate_Brainquakes", 4);
PROC_LOW_BaldursGate_WarningEventsSetup();
DB_GLO_RapidAD_MindMeldDistancePoints("LOW_BaldursGate_Brainquakes", S_LOW_BaldursGate_Brainquakes_Distance_001_f1a5a587-1236-4f78-8d03-b393c38f8d93, S_LOW_BaldursGate_Brainquakes_Distance_002_d3056fe2-1d3c-4d14-ba9b-e2568abdacce);
DB_GLO_RapidAD_MindMeldRegion("LOW_BaldursGate_Brainquakes", S_LOW_BaldursGate_RapidMindMeldArea_d7ff0c9f-c071-4960-bbbf-0962dfca11bf);
DB_GLO_RapidAD_ADHelper("LOW_BaldursGate_Brainquakes", S_LOW_BaldursGate_RapidAD_Helper_001_27b7dec0-51da-4f2c-976c-5719dc5f8f51, LOW_BaldursGate_AD_RapidMelt_001_3d2de33c-8154-b13d-3379-a4d15992469f);
DB_GLO_RapidAD_ADHelper("LOW_BaldursGate_Brainquakes", S_LOW_BaldursGate_RapidAD_Helper_000_08a9c073-9c6b-4e56-aba1-613cb2dff9ba, LOW_BaldursGate_AD_RapidMelt_002_bfa93d34-be1d-7af6-afda-5047812f3595);
DB_GLO_RapidAD_ADHelper("LOW_BaldursGate_Brainquakes", S_LOW_BaldursGate_RapidAD_Helper_002_9d7d862e-1d87-4295-ad01-0b36b270e61a, LOW_BaldursGate_AD_RapidMelt_003_751f0f6f-b7ec-638d-2a30-8270259b58ab);
DB_GLO_RapidAD_ADHelper("LOW_BaldursGate_Brainquakes", S_LOW_BaldursGate_RapidAD_Helper_003_e6085c8a-fa53-49e9-aad4-49b1b389c50c, LOW_BaldursGate_AD_RapidMelt_004_5a908c39-7b2c-fd43-5487-ce310fbb0587);
DB_GLO_RapidAD_ADHelper("LOW_BaldursGate_Brainquakes", S_LOW_BaldursGate_RapidAD_Helper_004_b440ed3f-ad45-40d1-a905-62e1b64d4390, LOW_BaldursGate_AD_RapidMelt_005_75e048e1-70c0-20ee-fa07-728692d8e568);
DB_GLO_RapidAD_ADHelper("LOW_BaldursGate_Brainquakes", S_LOW_BaldursGate_RapidAD_Helper_3d2542f4-6667-4933-bbdc-b7fd43cea626, LOW_BaldursGate_AD_RapidMelt_006_cb751c32-a725-798e-f1cf-b50682b60303);
DB_GLO_Brainquakes_SlowZone("LOW_BaldursGate_Brainquakes", S_LOW_BaldursGate_SlowZone_ca99b6a7-9dc9-4f74-87c4-410aa22af3c9, LOW_BaldursGate_VB_PsionicSupression_95ede1d9-e653-483b-c14f-3eb083f6734d);
DB_GLO_RapidAD_OverloadOffsetRules("LOW_BaldursGate_Brainquakes", 2, -0.5, 1, 1);
PROC_GLO_RapidAD_SetMaxDistance("LOW_BaldursGate_Brainquakes");
PROC_SetOnStage(S_LOW_BaldursGate_Gate_4232768e-43fb-4d7d-883a-2eecab18329b, 0);

KBSECTION
PROC
PROC_SpotPlayers_Spotted((CHARACTER)_Var1, "LOW_BaldursGate_GuardsSpotting", (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialog(LOW_BaldursGate_FlamingFists_BeforeMainDoor_73990848-a5d4-bf61-bcb5-ca7eb53e86d3, S_LOW_BaldursGate_FlamingFist_Cleric_001_f61ed726-793d-4611-a234-ad5a6b487514, S_LOW_BaldursGate_FlamingFist_Ranger_001_08d0dcec-a5c3-4099-922c-2a0b8b97fcd6, _Var2, _Var1)
THEN
DB_NOOP(1);

IF
UseStarted((CHARACTER)_Var1, S_LOW_BaldursGate_Gate_3b44a2e3-e33d-48e7-9ac4-62480ff48bc8, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_StartDialog(LOW_BaldursGate_DoorDialog_0d7628e0-b800-a7e0-fbd5-966e42edab98, S_LOW_BaldursGate_ElderBrain_Helper_877f2eb3-586f-4660-bea5-333d00c3ea92, _Var1, _Var1, _Var1)
THEN
PROC_PlayCantUseItemAD(_Var1);

IF
EnteredTrigger((CHARACTER)_Var1, S_LOW_BaldursGate_Lvl3Warning_003_23ac5522-cbac-4da2-b890-92f1cd3dd363, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsTagged(_Var1, ILLITHID_1eec74e8-3673-4500-abec-57b7ed8469ed, 1, _Var1, _Var1)
THEN
ScreenFadeTo(_Var1, 1.5, 1, "LOW_BaldursGate_TeleportParty");
DB_LOW_BaldursGate_FadeEvent(_Var1, "LOW_BaldursGate_TeleportParty");

IF
EnteredTrigger((GUIDSTRING)_Var1, (GUIDSTRING)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
IsTagged(_Var1, ILLITHID_1eec74e8-3673-4500-abec-57b7ed8469ed, 1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_BaldursGate_WarningTriggers(_Var3, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_EmperorAD(_Var1, _Var3);

IF
ScreenFadeDone(_, (STRING)_Var2, _, _, _)
AND
DB_LOW_BaldursGate_FadeEvent(_Var3, _Var2, _, _, _)
THEN
TeleportTo(_Var3, S_LOW_BaldursGate_Lvl1Warning_fbbefd03-3745-4374-bc87-8b1cb42fd3e1, "", 1, 1, 1, 0, 1);
NOT DB_LOW_BaldursGate_FadeEvent(_Var3, _Var2);
ClearScreenFade(_Var3, 1.5, "LOW_BaldursGate_TeleportParty");
PROC_LOW_BaldursGate_WarningEventsSetup();

PROC
PROC_LOW_BaldursGate_WarningEventsSetup()
THEN
DB_GLO_Brainquakes_Directional_Triggers(S_LOW_BaldursGate_Lvl1Warning_fbbefd03-3745-4374-bc87-8b1cb42fd3e1, LOW_BaldursGate_BrainquakeOrigin_d51377e0-f811-4215-97a1-a3bd8fe428cf, 3, 3, "LOW_BaldursGate_Brainquakes", "CTY_Main_A");
DB_GLO_Brainquakes_Directional_Triggers(S_LOW_BaldursGate_Lvl2Warning_5f24cfac-e422-41b2-b6fe-696d4f98e936, LOW_BaldursGate_BrainquakeOrigin_d51377e0-f811-4215-97a1-a3bd8fe428cf, 3, 3, "LOW_BaldursGate_Brainquakes", "CTY_Main_A");
DB_GLO_Brainquakes_Directional_Triggers(S_LOW_BaldursGate_Lvl3Warning_37707943-c06d-4f3a-a65d-1c6cb6928db8, LOW_BaldursGate_BrainquakeOrigin_d51377e0-f811-4215-97a1-a3bd8fe428cf, 3, 3, "LOW_BaldursGate_Brainquakes", "CTY_Main_A");
DB_GLO_Brainquakes_Directional_Triggers(S_LOW_BaldursGate_Lvl3Warning_000_39e82882-fbd2-40cc-8bfa-a7c5d85989da, LOW_BaldursGate_BrainquakeOrigin_d51377e0-f811-4215-97a1-a3bd8fe428cf, 3, 3, "LOW_BaldursGate_Brainquakes", "CTY_Main_A");
DB_GLO_Brainquakes_Directional_Triggers(S_LOW_BaldursGate_Lvl3Warning_001_f1c47b77-78ed-453d-b3c8-1794b7753f05, LOW_BaldursGate_BrainquakeOrigin_d51377e0-f811-4215-97a1-a3bd8fe428cf, 3, 3, "LOW_BaldursGate_Brainquakes", "CTY_Main_A");
DB_GLO_Brainquakes_Directional_Triggers(S_LOW_BaldursGate_Lvl3Warning_002_0cd8c4d7-983d-4c88-a8df-88581bfcc386, LOW_BaldursGate_BrainquakeOrigin_d51377e0-f811-4215-97a1-a3bd8fe428cf, 3, 3, "LOW_BaldursGate_Brainquakes", "CTY_Main_A");
DB_GLO_Brainquakes_Directional_Triggers(S_LOW_BaldursGate_Lvl3Warning_003_23ac5522-cbac-4da2-b890-92f1cd3dd363, LOW_BaldursGate_BrainquakeOrigin_d51377e0-f811-4215-97a1-a3bd8fe428cf, 3, 3, "LOW_BaldursGate_Brainquakes", "CTY_Main_A");

IF
DB_GlobalFlag(GLO_EmperorPrelude_State_GortashStoneCollected_c608f192-c5ab-4be9-b13d-4c4ca3c6b971, _, _, _, _)
AND
DB_GlobalFlag(GLO_EmperorPrelude_State_OrinStoneCollected_3e629422-74fd-49d0-9e15-d078f6a9c02c, _, _, _, _)
AND
DB_CurrentLevel("CTY_Main_A", _, _, _, _)
THEN
PROC_LOW_BaldursGate_CleanWarnings();
PROC_SetOnStage(S_LOW_BaldursGate_Gate_4232768e-43fb-4d7d-883a-2eecab18329b, 1);

PROC
PROC_LOW_BaldursGate_CleanWarnings()
THEN
PROC_TriggerUnregisterForPlayers(S_LOW_BG_Lvl1Warning_fbbefd03-3745-4374-bc87-8b1cb42fd3e1);
PROC_TriggerUnregisterForPlayers(S_LOW_BG_Lvl2Warning_5f24cfac-e422-41b2-b6fe-696d4f98e936);
PROC_TriggerUnregisterForPlayers(S_LOW_BaldursGate_Lvl3Warning_37707943-c06d-4f3a-a65d-1c6cb6928db8);
PROC_TriggerUnregisterForPlayers(S_LOW_BaldursGate_Lvl3Warning_000_39e82882-fbd2-40cc-8bfa-a7c5d85989da);
PROC_TriggerUnregisterForPlayers(S_LOW_BaldursGate_Lvl3Warning_001_f1c47b77-78ed-453d-b3c8-1794b7753f05);
PROC_TriggerUnregisterForPlayers(S_LOW_BaldursGate_Lvl3Warning_002_0cd8c4d7-983d-4c88-a8df-88581bfcc386);
PROC_TriggerUnregisterForPlayers(S_LOW_BaldursGate_Lvl3Warning_003_23ac5522-cbac-4da2-b890-92f1cd3dd363);
PROC_TriggerUnregisterForPlayers(S_LOW_BaldursGate_RapidMindMeldArea_d7ff0c9f-c071-4960-bbbf-0962dfca11bf);
PROC_TriggerUnregisterForPlayers(S_LOW_BaldursGate_SlowZone_ca99b6a7-9dc9-4f74-87c4-410aa22af3c9);
NOT DB_GLO_Brainquakes_Directional_Triggers(S_LOW_BaldursGate_Lvl1Warning_fbbefd03-3745-4374-bc87-8b1cb42fd3e1, LOW_BaldursGate_BrainquakeOrigin_d51377e0-f811-4215-97a1-a3bd8fe428cf, 3, 3, "LOW_BaldursGate_Brainquakes", "CTY_Main_A");
NOT DB_GLO_Brainquakes_Directional_Triggers(S_LOW_BaldursGate_Lvl2Warning_5f24cfac-e422-41b2-b6fe-696d4f98e936, LOW_BaldursGate_BrainquakeOrigin_d51377e0-f811-4215-97a1-a3bd8fe428cf, 3, 3, "LOW_BaldursGate_Brainquakes", "CTY_Main_A");
NOT DB_GLO_Brainquakes_Directional_Triggers(S_LOW_BaldursGate_Lvl3Warning_37707943-c06d-4f3a-a65d-1c6cb6928db8, LOW_BaldursGate_BrainquakeOrigin_d51377e0-f811-4215-97a1-a3bd8fe428cf, 3, 3, "LOW_BaldursGate_Brainquakes", "CTY_Main_A");
NOT DB_GLO_Brainquakes_Directional_Triggers(S_LOW_BaldursGate_Lvl3Warning_000_39e82882-fbd2-40cc-8bfa-a7c5d85989da, LOW_BaldursGate_BrainquakeOrigin_d51377e0-f811-4215-97a1-a3bd8fe428cf, 3, 3, "LOW_BaldursGate_Brainquakes", "CTY_Main_A");
NOT DB_GLO_Brainquakes_Directional_Triggers(S_LOW_BaldursGate_Lvl3Warning_001_f1c47b77-78ed-453d-b3c8-1794b7753f05, LOW_BaldursGate_BrainquakeOrigin_d51377e0-f811-4215-97a1-a3bd8fe428cf, 3, 3, "LOW_BaldursGate_Brainquakes", "CTY_Main_A");
NOT DB_GLO_Brainquakes_Directional_Triggers(S_LOW_BaldursGate_Lvl3Warning_002_0cd8c4d7-983d-4c88-a8df-88581bfcc386, LOW_BaldursGate_BrainquakeOrigin_d51377e0-f811-4215-97a1-a3bd8fe428cf, 3, 3, "LOW_BaldursGate_Brainquakes", "CTY_Main_A");
NOT DB_GLO_Brainquakes_Directional_Triggers(S_LOW_BaldursGate_Lvl3Warning_003_23ac5522-cbac-4da2-b890-92f1cd3dd363, LOW_BaldursGate_BrainquakeOrigin_d51377e0-f811-4215-97a1-a3bd8fe428cf, 3, 3, "LOW_BaldursGate_Brainquakes", "CTY_Main_A");
NOT DB_GLO_Brainquakes_Directional_Difficult("Constitution", Act3_Impossible_ef0d0c54-3500-466f-98db-5c0600158cb7, "LOW_BaldursGate_Brainquakes");
NOT DB_GLO_Brainquakes_Directional_StunTime("LOW_BaldursGate_Brainquakes", 4);
NOT DB_GLO_RapidAD_MindMeldDistancePoints("LOW_BaldursGate_Brainquakes", S_LOW_BaldursGate_Brainquakes_Distance_001_f1a5a587-1236-4f78-8d03-b393c38f8d93, S_LOW_BaldursGate_Brainquakes_Distance_002_d3056fe2-1d3c-4d14-ba9b-e2568abdacce);
NOT DB_GLO_RapidAD_MindMeldRegion("LOW_BaldursGate_Brainquakes", S_LOW_BaldursGate_RapidMindMeldArea_d7ff0c9f-c071-4960-bbbf-0962dfca11bf);
NOT DB_GLO_Brainquakes_SlowZone("LOW_BaldursGate_Brainquakes", S_LOW_BaldursGate_SlowZone_ca99b6a7-9dc9-4f74-87c4-410aa22af3c9, LOW_BaldursGate_VB_PsionicSupression_95ede1d9-e653-483b-c14f-3eb083f6734d);
NOT DB_GLO_RapidAD_OverloadOffsetRules("LOW_BaldursGate_Brainquakes", 2, -0.5, 1, 1);

PROC
PROC_LOW_BaldursGate_CleanWarnings()
AND
DB_LOW_BaldursGate_WarningTriggers(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_BaldursGate_WarningTriggers(_Var1, _Var2);

PROC
PROC_LOW_BaldursGate_CleanWarnings()
AND
DB_GLO_RapidAD_ADHelper("LOW_BaldursGate_Brainquakes", _Var1, _Var2, _Var1, _Var1)
THEN
NOT DB_GLO_RapidAD_ADHelper("LOW_BaldursGate_Brainquakes", _Var1, _Var2);

IF
EnteredTrigger((GUIDSTRING)_Var1, S_LOW_BaldursGate_Lvl1Warning_fbbefd03-3745-4374-bc87-8b1cb42fd3e1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
QRY_OnlyOnce("LOW_BaldursGate_FirstReaction", _Var1, _Var1, _Var1, _Var1)
THEN
DB_LOW_BaldursGate_SayWarning(_Var1);

IF
AutomatedDialogEnded(LOW_BaldursGate_EmperorAD_EmperorWarning1_cae726bd-cbba-838b-3dc0-ae52ee7a97cd, _, _, _, _)
AND
DB_LOW_BaldursGate_SayWarning(_Var2, _, _, _, _)
THEN
NOT DB_LOW_BaldursGate_SayWarning(_Var2);
PROC_TryStartAD(LOW_BaldursGate_PAD_AfterEmperorWarning_28fa8435-ac3a-63d4-7eff-5b16eb3bd53d, _Var2);


EXITSECTION
ENDEXITSECTION

ParentTargetEdge "Act3b"
