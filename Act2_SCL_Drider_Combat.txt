Version 1
SubGoalCombiner SGC_AND

INITSECTION
NOT DB_SCL_DriderCombat_ADs("", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SCL_DriderCombat_ADs("CombatStarts", S_SCL_HarperScout_000_c6dfb2aa-809f-4b3e-8b32-968c10184ec3, SCL_HarperScout_000_AD_CombatStarts_0001426d-4d37-a80e-fa71-25140b70f70a);
DB_SCL_DriderCombat_ADs("CombatStarts", S_SCL_Drider_Harper_Melee_000_b9f6bb1e-f4cd-4bb3-a7f0-80aad9bae8c8, SCL_Drider_Harper_Melee_000_AD_CombatStarts_99a15b87-b835-b730-b8b2-501b44e6386c);
DB_SCL_DriderCombat_ADs("CombatStarts", S_SCL_Drider_aa59ce01-3d2e-42e8-a539-c07e0ea292ab, SCL_Drider_AD_CombatStarts_9b63348f-a2c8-a38f-b8af-2be9fa932e4a);
DB_SCL_DriderCombat_ADs("DriderDropsLantern", S_SCL_Drider_aa59ce01-3d2e-42e8-a539-c07e0ea292ab, SCL_Drider_AD_DroppedLantern_87d7eb53-925b-751f-3b90-e49f5d6c0427);
DB_SCL_DriderCombat_ADs("DriderDropsLantern_Harpers", S_SCL_Drider_Harper_Melee_000_b9f6bb1e-f4cd-4bb3-a7f0-80aad9bae8c8, SCL_Drider_Harper_Melee_000_AD_DriderDropsLantern_7dd2f456-6229-3596-0a75-6a7ff8404639);
DB_SCL_DriderCombat_ADs("DriderDropsLantern_Harpers", S_SCL_HarperScout_000_c6dfb2aa-809f-4b3e-8b32-968c10184ec3, SCL_HarperScout_000_AD_DriderDropsLantern_8236a240-0c05-d4e4-fefd-2d46f0ab5f8f);
DB_SCL_DriderCombat_ADs("HarperPicksLantern", S_SCL_Drider_Harper_Melee_000_b9f6bb1e-f4cd-4bb3-a7f0-80aad9bae8c8, SCL_Drider_Harper_Melee_000_AD_TakesMoonlantern_8c033149-8669-87cd-370c-f826dd951fdc);
DB_SCL_DriderCombat_ADs("HarperPicksLantern", S_SCL_HarperScout_000_c6dfb2aa-809f-4b3e-8b32-968c10184ec3, SCL_HarperScout_000_AD_TakesMoonlantern_f015fba0-d93a-4818-c93c-df3073b847b4);
DB_SCL_DriderCombat_ADs("HarperPicksLantern", S_SCL_Drider_aa59ce01-3d2e-42e8-a539-c07e0ea292ab, SCL_Drider_AD_HarperTakesMoonlantern_9dfc5ac8-615c-e164-070f-75643f1d33ae);
DB_SCL_DriderCombat_ADs("PlayerPicksLantern_NotWithDrider", S_SCL_Drider_aa59ce01-3d2e-42e8-a539-c07e0ea292ab, SCL_Drider_AD_PlayerTakesMoonlantern_b1e8f189-6572-443d-09f1-3a7e5213dc23);
DB_SCL_DriderCombat_ADs("PlayerPicksLantern_NotWithHarpers", S_SCL_HarperScout_000_c6dfb2aa-809f-4b3e-8b32-968c10184ec3, SCL_HarperScout_000_AD_PlayerTookLantern_93887bee-bc54-d625-21e6-11035d081df7);
DB_SCL_DriderCombat_ADs("PlayerPicksLantern_NotWithHarpers", S_SCL_Drider_Harper_Melee_000_b9f6bb1e-f4cd-4bb3-a7f0-80aad9bae8c8, SCL_Drider_Harper_Melee_000_AD_PlayerTookLantern_7b807b53-0fee-61a1-f43a-b6274287d969);
DB_SCL_DriderCombat_ADs("LassandraDies", S_SCL_Drider_Harper_Ranger_000_ce089a64-1a91-4ab0-ac71-a2712680780d, SCL_Drider_Harper_Ranger_000_AD_LassandraDies_9e61d76c-498c-25e7-c871-3a8e207655a9);
DB_SCL_DriderCombat_ADs("LassandraDies", S_SCL_Drider_Harper_Melee_000_b9f6bb1e-f4cd-4bb3-a7f0-80aad9bae8c8, SCL_Drider_Harper_Melee_000_AD_LassandraDies_60cddaef-6e8a-0a0b-43b8-af04b9f2a39d);
DB_SCL_DriderCombat_ADs("DriderDies_Absolute", S_SCL_DriderCaravan_HalfOrcCaster_f9522205-623f-4a82-904a-128b26182707, SCL_DriderCaravan_HalfOrcCaster_AD_DriderDies_366676cd-f4fa-ae77-16f2-b2f52cfe4ae4);
DB_SCL_DriderCombat_ADs("DriderDies_Absolute", S_SCL_DriderCaravan_GoblinMelee_000_c176d94a-eaa6-4869-a344-88e44b31e17d, SCL_DriderCaravan_GoblinMelee_000_AD_DriderDies_2c4d6941-0703-6289-91a1-8d30b34728f0);
DB_SCL_DriderCombat_ADs("DriderDies_Harpers", S_SCL_Drider_Harper_Melee_000_b9f6bb1e-f4cd-4bb3-a7f0-80aad9bae8c8, SCL_Drider_Harper_Melee_000_AD_DriderDies_9217afd0-77d7-6f55-a371-2158ebcd7add);
DB_SCL_DriderCombat_ADs("DriderDies_Harpers", S_SCL_HarperScout_000_c6dfb2aa-809f-4b3e-8b32-968c10184ec3, SCL_HarperScout_000_AD_DriderDies_e0e0e2c5-7874-e8c9-2bb9-0943473e543f);
NOT DB_SCL_DriderCombat_ADsCancelledBy("", "");
DB_SCL_DriderCombat_ADsCancelledBy("CombatStarts_HarperSide", "CombatStarts_DriderSide");
DB_SCL_DriderCombat_ADsCancelledBy("CombatStarts_DriderSide", "CombatStarts_HarperSide");
DB_SCL_DriderCombat_ADsCancelledBy("DriderDropsLantern_Harper", "DriderDropsLantern");
DB_CombatReact_AD_OnNextTurn(S_SCL_DriderCaravan_GoblinMelee_001_0648b227-b64b-471f-a6ac-d71af926dfb4, SCL_Drider_Caravan_AD_GoblinMelee_001_8c6dc5e6-89c5-0310-8426-937821aeeac1);
DB_CombatReact_AD_OnNextTurn(S_SCL_DriderCaravan_HalfOrcCaster_f9522205-623f-4a82-904a-128b26182707, SCL_Drider_Caravan_AD_HalfOrcCaster_406d5efb-f5d5-b83b-7fe8-b8ae5794e445);
DB_CombatReact_AD_OnNextTurn(S_SCL_Drider_Harper_Caster_000_ef609a8e-08bf-4648-bbb4-380a7f4bc887, SCL_Drider_AD_Harper_Caster_000_18abd52f-5fa3-577b-eaf2-c5a682d54437);
DB_CombatReact_AD_OnNextTurn(S_SCL_Drider_Harper_Melee_000_b9f6bb1e-f4cd-4bb3-a7f0-80aad9bae8c8, SCL_Drider_AD_Harper_Melee_000_9725edf4-14a2-e48d-276b-47c63879f57e);
DB_CombatReact_AD_OnNextTurn(S_SCL_Drider_Harper_Ranger_000_ce089a64-1a91-4ab0-ac71-a2712680780d, SCL_Drider_AD_Harper_Ranger_000_4a3b5b79-93af-29d8-534f-228d94196d28);

KBSECTION
PROC
PROC_SCL_DriderCombat_TriggerAD((STRING)_Var1, (STRING)_Var1, (STRING)_Var1, (STRING)_Var1, (STRING)_Var1)
AND NOT
DB_SCL_DriderCombat_ADInProgress(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce_Reset("SCL_DriderCombat_TriggerAD", _Var1, _Var1, _Var1, _Var1)
AND
DB_SCL_Drider_AmbushCombatID(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_SCL_DriderCombat_ADs(_Var1, _Var3, _Var4, _Var1, _Var1)
AND NOT
DB_OnlyOnce("SCL_DriderCombat_TriggerAD", _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var3, _Var2, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailable(_Var3, 1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("SCL_DriderCombat_TriggerAD", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SCL_DriderCombat_CancelRelatedADs(_Var1);
PROC_TryStartAD(_Var4, _Var3);

PROC
PROC_SCL_DriderCombat_CancelRelatedADs((STRING)_Var1, (STRING)_Var1, (STRING)_Var1, (STRING)_Var1, (STRING)_Var1)
AND
DB_SCL_DriderCombat_ADsCancelledBy(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SCL_DriderCombat_RemoveAD(_Var2);

IF
AutomatedDialogStarted((GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_SCL_DriderCombat_ADs(_Var3, _, _Var1, _Var1, _Var1)
THEN
DB_SCL_DriderCombat_ADInProgress(_Var3);

IF
AutomatedDialogEnded((GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_SCL_DriderCombat_ADs(_Var3, _, _Var1, _Var1, _Var1)
THEN
PROC_SCL_DriderCombat_RemoveAD(_Var3);

PROC
PROC_SCL_DriderCombat_RemoveAD((STRING)_Var1, (STRING)_Var1, (STRING)_Var1, (STRING)_Var1, (STRING)_Var1)
THEN
NOT DB_SCL_DriderCombat_ADInProgress(_Var1);

PROC
PROC_SCL_DriderCombat_RemoveAD((STRING)_Var1, (STRING)_Var1, (STRING)_Var1, (STRING)_Var1, (STRING)_Var1)
AND
DB_SCL_DriderCombat_ADs(_Var1, _Var2, _Var3, _Var1, _Var1)
THEN
NOT DB_SCL_DriderCombat_ADs(_Var1, _Var2, _Var3);

IF
DB_SCL_Drider_AmbushCombatID(_, _, _, _, _)
THEN
PROC_SCL_DriderCombat_TriggerAD("CombatStarts");

IF
RemovedFrom(S_GLO_DriderMoonlantern_4591d212-8f1b-4b85-880c-dc94f76702f4, S_SCL_Drider_aa59ce01-3d2e-42e8-a539-c07e0ea292ab, _, _, _)
THEN
PROC_SCL_DriderCombat_TriggerAD("DriderDropsLantern");
PROC_SCL_DriderCombat_TriggerAD("DriderDropsLantern_Harpers");

IF
AddedTo(S_GLO_DriderMoonlantern_4591d212-8f1b-4b85-880c-dc94f76702f4, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_SCL_Drider_HarpersGroup(_Var1, _, _, _Var1, _Var1)
THEN
PROC_SCL_DriderCombat_TriggerAD("HarperPicksLantern");

IF
AddedTo(S_GLO_DriderMoonlantern_4591d212-8f1b-4b85-880c-dc94f76702f4, (GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(SCL_Drider_State_SidedWithCaravan_57a698da-0149-48d1-91fa-9a84a5dcc293, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SCL_DriderCombat_TriggerAD("PlayerPicksLantern_NotWithDrider");

IF
AddedTo(S_GLO_DriderMoonlantern_4591d212-8f1b-4b85-880c-dc94f76702f4, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(SCL_Drider_State_SidedWithHarpers_a130dde9-c086-4486-9cd8-298a67fb6aee, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SCL_DriderCombat_TriggerAD("PlayerPicksLantern_NotWithHarpers");

IF
KilledBy((CHARACTER)_Var1, S_SCL_Drider_aa59ce01-3d2e-42e8-a539-c07e0ea292ab, _, _, (CHARACTER)_Var1)
AND
DB_SCL_Drider_AmbushCombatID(_Var4, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(S_SCL_Drider_aa59ce01-3d2e-42e8-a539-c07e0ea292ab, _Var4, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var1, _Var4, _Var1, _Var1, _Var1)
AND
QRY_IsEnemy(S_SCL_Drider_aa59ce01-3d2e-42e8-a539-c07e0ea292ab, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(SCL_Drider_AD_KillsSomeone_423b5212-4375-cd14-710a-8638b984ea95, S_SCL_Drider_aa59ce01-3d2e-42e8-a539-c07e0ea292ab);

IF
DB_Dead(S_SCL_HarperScout_000_c6dfb2aa-809f-4b3e-8b32-968c10184ec3, _, _, _, _)
THEN
PROC_SCL_DriderCombat_TriggerAD("LassandraDies");

IF
DB_Dead(S_SCL_Drider_aa59ce01-3d2e-42e8-a539-c07e0ea292ab, _, _, _, _)
THEN
PROC_SCL_DriderCombat_TriggerAD("DriderDies_Absolute");
PROC_SCL_DriderCombat_TriggerAD("DriderDies_Harpers");


EXITSECTION
ENDEXITSECTION

ParentTargetEdge "Act2"
