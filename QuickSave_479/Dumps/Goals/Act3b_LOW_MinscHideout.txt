Version 1
SubGoalCombiner SGC_AND

INITSECTION
DB_OneShot_VoiceBarkTrigger(S_LOW_MinscHideout_NoticeWaterTrigger_6cb2ab66-21c3-4265-ac49-3c2dd4b9ae5c, LOW_MinscHideout_VB_NoticeWater_a023c249-5d98-8dcf-5028-e528942ad8e2);
DB_LOW_MinscHideout_SluiceGuards(S_LOW_MinscHideout_SluiceGuard_000_344ca9a0-d7ac-4a22-b859-6e99b6c45a18);
DB_LOW_MinscHideout_SluiceGuards(S_LOW_MinscHideout_SluiceGuard_001_b68a4b00-ed19-4b68-8eb3-990f432c10c6);
DB_LOW_MinscHideout_SluiceGuards(S_LOW_MinscHideout_SluiceGuard_002_c24f4c4a-58ad-4c82-b968-5eb7c422993c);
DB_LOW_MinscHideout_SluiceGuards_Crows(LOW_BhaalCultist_Crow_000_c39c5c99-6fba-488f-996b-8205ff436fdc, S_LOW_MinscHideout_SluiceGuard_CrowSpawnPoint_000_0da5b132-72fb-4cfc-bfc2-5ccb29b21e30);
DB_LOW_MinscHideout_SluiceGuards_Crows(LOW_BhaalCultist_Crow_001_533d3286-9870-4073-93d3-bfc1b9fa36ac, S_LOW_MinscHideout_SluiceGuard_CrowSpawnPoint_001_1b4d3cdd-a7d4-4af7-9c50-471a95b1fcb4);
DB_LOW_MinscHideout_SluiceGuards_Crows(LOW_BhaalCultist_Crow_002_66f1fee5-0a9e-4d98-b29c-19caa6680b3a, S_LOW_MinscHideout_SluiceGuard_CrowSpawnPoint_002_a01cba61-9eda-4c35-bde9-9d5f604feb73);
DB_LOW_MinscHideout_SluiceGuards_Crows(LOW_BhaalCultist_Crow_003_5ffe3104-542e-4cb3-92d7-457cb4f1cca1, S_LOW_MinscHideout_SluiceGuard_CrowSpawnPoint_003_7403dcf8-9633-4bca-a251-207e4a4cb8c8);
DB_LOW_MinscHideout_SluiceGuards_Crows(LOW_BhaalCultist_Crow_004_165bd441-1663-4f16-82a0-c3f3aab1dc35, S_LOW_MinscHideout_SluiceGuard_CrowSpawnPoint_004_dd8dfb8f-9225-4cff-aef8-aeae729498ab);
DB_LOW_MinscHideout_SluiceGuards_Crows(LOW_BhaalCultist_Crow_005_4deeeb08-3fa4-4466-b920-22b83770fb0d, S_LOW_MinscHideout_SluiceGuard_CrowSpawnPoint_005_97533fcc-4ce6-41ea-bbc5-0c7d7ef51ab2);
DB_LOW_MinscHideout_SluiceGuards_Crows(LOW_BhaalCultist_Crow_006_6d176306-05e6-4bad-bcf4-a00c0b7ff015, S_LOW_MinscHideout_SluiceGuard_CrowSpawnPoint_006_69d3ce3c-5351-4b95-94bf-4eec7f7a3170);
PROC_TriggerRegisterForPlayers(S_LOW_MinscHideout_Box_PlayerNearSluiceGuard_002_667148a6-0b90-4c76-a30e-0ccf614c85e4);
DB_LOW_MinscHideout_Valves(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087);
DB_LOW_MinscHideout_Valves(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8);
DB_LOW_MinscHideout_ValveIndicators(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, S_LOW_MinscHideout_WaterIndicator_Gauge_2fcaabf2-29fa-440e-9214-ce2e9c518dbf);
DB_LOW_MinscHideout_ValveIndicators(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, S_LOW_MinscHideout_TemperatureIndicator_Gauge_0dc8d7e4-19f7-4af2-93a6-a24734d13abb);
DB_LOW_MinscHideout_ValveStatuses(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, "LOW_MINSCHIDEOUT_WATERVALVE_LOW", 18, 1);
DB_LOW_MinscHideout_ValveStatuses(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, "LOW_MINSCHIDEOUT_WATERVALVE_MID", 18, 2);
DB_LOW_MinscHideout_ValveStatuses(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, "LOW_MINSCHIDEOUT_WATERVALVE_HIGH", 18, 3);
DB_LOW_MinscHideout_ValveStatuses(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, "LOW_MINSCHIDEOUT_WATERVALVE_OVER", -1, 4);
DB_LOW_MinscHideout_ValveStatuses(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, "LOW_MINSCHIDEOUT_TEMPERATUREVALVE_LOW", 18, 1);
DB_LOW_MinscHideout_ValveStatuses(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, "LOW_MINSCHIDEOUT_TEMPERATUREVALVE_MID", 18, 2);
DB_LOW_MinscHideout_ValveStatuses(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, "LOW_MINSCHIDEOUT_TEMPERATUREVALVE_HIGH", 18, 3);
DB_LOW_MinscHideout_ValveStatuses(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, "LOW_MINSCHIDEOUT_TEMPERATUREVALVE_OVER", -1, 4);
DB_LOW_MinscHideout_ValveTimerStatuses(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, "LOW_MINSCHIDEOUT_WATERVALVE_INCREASING", 12);
DB_LOW_MinscHideout_ValveTimerStatuses(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, "LOW_MINSCHIDEOUT_TEMPERATUREVALVE_INCREASING", 6);
DB_LOW_MinscHideout_SluiceGates(S_LOW_MinscHideout_SluiceGate_ec35b4be-09a3-4e59-bca8-d183b729542c, PUZ_InvisibleBlocker_2x2_1H_A_Dynamic_001_377d17cc-da68-4e34-9551-a811aeb74536);
DB_LOW_MinscHideout_SluiceGates(S_LOW_MinscHideout_SluiceGate_Exit_5eb023b9-6a07-4635-8461-1ad56793f16e, PUZ_InvisibleBlocker_2x2_1H_A_Dynamic_000_9ad4cfdf-902a-4c3d-be9b-ba1569baab56);
DB_KnowledgeCheckTrigger("LOW_MinscHideout_NoticeSluiceValve", S_LOW_MinscHideout_NoticeSluiceValveTrigger_46aa0f2c-a60e-4333-8073-00babd8d577a, "Perception", Act3_VeryEasy_b9cea18d-f40a-444d-a692-76582a69130c);
DB_KnowledgeCheckItem_AD("LOW_MinscHideout_ForceValveRoll", S_LOW_MinscHideout_SluiceValve_Entrance_cffe260f-c4ae-4138-ace0-263c8603dfea, "Athletics", Act3_VeryHard_60916b01-ba4c-418e-9f30-19a669704b4d, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_KnowledgeCheckItem_AD("LOW_MinscHideout_ForceValveRoll", S_LOW_MinscHideout_SluiceValve_Exit_f28c12a3-2b5a-4610-a60d-6c19f0c68266, "Athletics", Act3_VeryHard_60916b01-ba4c-418e-9f30-19a669704b4d, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_LOW_MinscHideout_DisabledValves(S_LOW_MinscHideout_SluiceValve_Broken_f9db1298-c539-4618-bf77-ab53d83d5e7a);
PROC_LOW_MinscHideout_InitSluiceGatePuzzle();
PROC_SetRelationMutual(ACT3_LOW_MinscHideout_MinscsGang_2cc8f4c1-33ee-460b-9c0a-6f516cbbad1b, Hero_a1542c81-6895-929e-4522-10ce218bb360, 0);
DB_LOW_MinscHideout_TeleportParams(S_LOW_CountingHouse_JaheiraClone_4da802f5-3237-40b8-afff-d728016e3047, S_LOW_MinscHideout_DopplegangerRetreatPoint_b501b673-b453-4fbe-b069-8ed616893c20);
DB_LOW_MinscHideout_TeleportParams(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, S_LOW_MinscHideout_MinscRetreatPoint_df3a2aa8-e232-4100-9d53-578941868569);
DB_AddCharactersInTriggerToDialog(LOW_MinscHideout_RoahBribe_041941c1-00ba-ad43-6da9-6f7a597053b3, S_LOW_MinscHideout_MeetingSceneDialogTrigger_AddChars_fb8bb0b2-af42-4029-98d0-5fb2e195e086, 1);
PROC_TriggerRegisterForParty(S_LOW_MinscHideout_MeetingSceneDialogTrigger_AddChars_fb8bb0b2-af42-4029-98d0-5fb2e195e086);
DB_LOW_MinscHideout_RelicVB(S_LOW_MinscHideout_RelicAerie_4ff1a465-6de5-4e23-b4ee-8bda6749c401, LOW_MinscHideout_PAD_RelicAerie_a49d82ff-5980-5a35-88e3-11fd33fb15ae, LOW_MinscHideout_VB_RelicAerie_6c1dc1c0-1754-33c6-bdae-1ca538ea652b);
DB_LOW_MinscHideout_RelicVB(S_LOW_MinscHideout_RelicDynaheir_bdb00280-abda-4405-9af7-f3a7573afeaa, LOW_MinscHideout_PAD_RelicDynaheir_5921f4e8-060b-3a25-1e0a-99be4a18dde4, LOW_MinscHideout_VB_RelicDynaheir_74405fb3-492d-f656-cf3e-fac4096fcea6);
DB_LOW_MinscHideout_RelicVB(S_LOW_MinscHideout_RelicJan_8d5607f8-e1d3-40d4-892e-2ffe034046a4, LOW_MinscHideout_PAD_RelicJan_4aec5dec-bc4d-dfe4-3fef-3ea22b0a8307, LOW_MinscHideout_VB_RelicJan_74acd181-e4b8-c662-37ba-6f258cdc9b74);
DB_LOW_MinscHideout_RelicVB(S_LOW_MinscHideout_RelicKeldorn_042a3ea0-0d44-4a10-82f5-ff4f0025a6e4, LOW_MinscHideout_PAD_RelicKeldorn_6782682a-9afe-8da9-daa3-2bd1b166cecc, LOW_MinscHideout_VB_RelicKeldorn_7731b78a-e725-0662-7571-421c2b11d71a);
DB_LOW_MinscHideout_RelicVB(S_LOW_MinscHideout_RelicMazzy_b3598674-2d08-4ba9-b74b-64da605c9e0b, LOW_MinscHideout_PAD_RelicMazzy_3d31f65c-abce-d355-2af3-1af831f255ef, LOW_MinscHideout_VB_RelicMazzy_75dc9412-69ea-02db-077e-ed95bd6a253c);
DB_CombatReact_AD_OnDeathOther(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, S_LOW_CountingHouse_JaheiraClone_4da802f5-3237-40b8-afff-d728016e3047, LOW_MinscHideout_AD_MinscSeesNaheiraDie_678d96b9-d84e-74ab-5808-c190e9ba51d4);
DB_CombatReact_AD_OnDeathOther(S_Player_Jaheira_91b6b200-7d00-4d62-8dc9-99e8339dfa1a, S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, LOW_MinscHideout_PAD_Jaheira_MinscDies_c9655ab3-3364-2308-6156-5540514fb8f3);
DB_OneShot_VoiceBarkTrigger(S_LOW_MinscHideout_VB_Neighbourhood_123920b0-7013-49dc-9412-cffbc2d258be, LOW_MinscHideout_VB_Neighbourhood_162ed6c4-fefe-e058-8a25-fe435674326c, "PerUserAndNearbyPlayers");
PROC_LOW_MinscHideout_DelayedSetupZhentBribe();

KBSECTION
IF
DB_LOW_MinscHideout_SluiceGuards(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_Dialogs(_Var1, LOW_MinscHideout_SluiceGuard_3c581210-b03a-c9ea-f267-6f401168667f);
DB_SpotPlayers(_Var1, "LOW_MinscHideout_SluiceGuardSpotting", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_SpotPlayers_Spotted((CHARACTER)_Var1, "LOW_MinscHideout_SluiceGuardSpotting", (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_OnlyOnce("LOW_MinscHideout_StartSluiceGuardDialog", _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_StartDialog(LOW_MinscHideout_SluiceGuard_3c581210-b03a-c9ea-f267-6f401168667f, _Var1, _Var2, _Var1, _Var1)
THEN
PROC_SetHostileToIndivPlayerFaction(ACT3_LOW_MinscHideout_SluiceGuards_1c02c7b1-1b14-428b-bd68-be33ea90c1fa, _Var2);

PROC
PROC_LOW_MinscHideout_MinscFightStarted()
THEN
PROC_SetRelationToPlayers(ACT3_LOW_MinscHideout_SluiceGuards_1c02c7b1-1b14-428b-bd68-be33ea90c1fa, 0);
PROC_SpotPlayers_CleanupSpotting("LOW_MinscHideout_SluiceGuardSpotting");

IF
DB_LOW_MinscHideout_SluiceGuards_Crows(_Var1, _, _Var1, _Var1, _Var1)
THEN
SetOnStage(_Var1, 0);

IF
CastedSpell((GUIDSTRING)_Var1, "Target_LOW_BhaalCultist_RangersCompanion_Raven", _, _, _)
AND
DB_LOW_MinscHideout_SluiceGuards_Crows(_Var5, _Var6, _Var1, _Var1, _Var1)
THEN
AppearAt(_Var5, _Var6, 1, DFLT_UTIL_Spawn_01_510ff37e-0618-40e4-8ce0-236e3dc9c291, "");

IF
DB_InRegion(_Var1, S_LOW_MinscHideout_Box_PlayerNearSluiceGuard_002_667148a6-0b90-4c76-a30e-0ccf614c85e4, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_LOW_MinscHideout_PlayerNearSluiceGuard_002(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_LOW_MinscHideout_PlayerNearSluiceGuard_002(_Var1);
PROC_GlobalSetFlagAndCache(LOW_MinscHideout_State_PlayerNearSluiceGuard_002_18cf4b81-0cae-4856-9d71-495359733d99);

IF
DB_LOW_MinscHideout_PlayerNearSluiceGuard_002(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_InRegion(_Var1, S_LOW_MinscHideout_Box_PlayerNearSluiceGuard_002_667148a6-0b90-4c76-a30e-0ccf614c85e4, _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_MinscHideout_PlayerNearSluiceGuard_002(_Var1);

IF
DB_GlobalFlag(LOW_MinscHideout_State_PlayerNearSluiceGuard_002_18cf4b81-0cae-4856-9d71-495359733d99, _, _, _, _)
AND NOT
DB_LOW_MinscHideout_PlayerNearSluiceGuard_002(_, _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(LOW_MinscHideout_State_PlayerNearSluiceGuard_002_18cf4b81-0cae-4856-9d71-495359733d99);

PROC
PROC_LOW_MinscHideout_InitSluiceGatePuzzle()
THEN
PROC_LOW_MinscHideout_InitValves();
PROC_LOW_MinscHideout_InitSluiceGates();

PROC
PROC_LOW_MinscHideout_InitValves()
AND
DB_LOW_MinscHideout_Valves(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_MinscHideout_ValveStatuses(_Var1, _Var2, _, _, _Var1)
AND
DB_LOW_MinscHideout_ValveTimerStatuses(_Var1, _Var5, _, _Var1, _Var1)
THEN
RemoveStatus(_Var1, _Var2, _Var1);
RemoveStatus(_Var1, _Var5, _Var1);
PROC_LOW_MinscHideout_SetValveIndicator(_Var1, 0);

PROC
PROC_LOW_MinscHideout_InitValves()
AND
DB_LOW_MinscHideout_Valves(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_LOW_MinscHideout_ValveLevel(_Var1, 0, 0);
DB_LOW_MinscHideout_ValveOpened(_Var1, 0);

IF
DB_LOW_MinscHideout_ValveOpened(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_LOW_MinscHideout_ValveOpened(_Var1, _Var3, _Var1, _Var1, _Var1)
AND
_Var2 != _Var3
THEN
NOT DB_LOW_MinscHideout_ValveOpened(_Var1, _Var3);

PROC
PROC_LOW_MinscHideout_InitSluiceGates()
THEN
PROC_LOW_MinscHideout_LockSluiceGate();

IF
AttackedBy((ITEM)_Var1, _, _, "Fire", _, _, (INTEGER)_Var6, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_LOW_MinscHideout_Valves(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
ApplyStatus(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, "LOW_MINSCHIDEOUT_TEMPERATUREVALVE_HEATUP", 6);

IF
AttackedBy((ITEM)_Var1, _, _, "Cold", _, _, (INTEGER)_Var6, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_LOW_MinscHideout_Valves(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
ApplyStatus(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, "LOW_MINSCHIDEOUT_TEMPERATUREVALVE_COOLDOWN", 6);

PROC
PROC_GLO_KnowledgeCheckSuccess((CHARACTER)_Var1, "LOW_MinscHideout_NoticeSluiceValve", _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
StartVoiceBark(LOW_MinscHideout_VB_NoticeSluiceValve_e4d85178-a54f-9e7d-9249-56d7dc5c0f97, _Var1);
PROC_PlayPerceptionRevealEffect(S_LOW_MinscHideout_SluiceValve_cffe260f-c4ae-4138-ace0-263c8603dfea, "LOW_MinscHideout_HighlightSluiceValve");

PROC
PROC_GLO_KnowledgeCheckSuccess((CHARACTER)_Var1, "LOW_MinscHideout_ForceValveRoll", _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_LOW_MinscHideout_UnlockSluiceGate();

PROC
PROC_GLO_KnowledgeCheckFailure((CHARACTER)_Var1, "LOW_MinscHideout_ForceValveRoll", _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_TryStartAD(GEN_AD_ItemBlocked_a4eb2e7b-809a-a9e4-94da-955a8ac9b8c6, _Var1);

PROC
PROC_LOW_MinscHideout_LockSluiceGate()
AND
DB_LOW_MinscHideout_SluiceGates(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_ItemCloseAndLock(_Var1, "NO_KEY");

PROC
PROC_LOW_MinscHideout_UnlockSluiceGate()
THEN
SetFlag(LOW_MinscHideout_State_SluiceValveUnlocked_3501c02d-a13b-632a-0469-3625ac234715);

PROC
PROC_LOW_MinscHideout_UnlockSluiceGate()
AND
DB_LOW_MinscHideout_Valves(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_MinscHideout_ValveTimerStatuses(_Var1, _Var2, _, _Var1, _Var1)
THEN
RemoveStatus(_Var1, _Var2, _Var1);

PROC
PROC_LOW_MinscHideout_UnlockSluiceGate()
AND
DB_LOW_MinscHideout_SluiceGates(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PlaySound(_Var1, "SE_CTY_SluiceValve_GateOpen");
PROC_ItemUnlockAndOpen(_Var1);

PROC
PROC_LOW_MinscHideout_UnlockSluiceGate()
THEN
PROC_KnowledgeCheck_Clear(S_LOW_MinscHideout_NoticeSluiceValveTrigger_46aa0f2c-a60e-4333-8073-00babd8d577a);
SetEntityEvent(S_LOW_MinscHideout_SluicePuzzleHint_a8bb0f44-7a68-484d-8a4b-e798d0e8e4ee, "StoryCancel", 1);

IF
Opened((ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_LOW_MinscHideout_SluiceGates(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var2, 0);

IF
Closed((ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_LOW_MinscHideout_SluiceGates(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var2, 1);

IF
DestroyedBy((ITEM)_Var1, _, _, _, (ITEM)_Var1)
AND
DB_LOW_MinscHideout_SluiceGates(_Var1, _Var5, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var5, 0);

PROC
PROC_BlockUseOfItem((CHARACTER)_Var1, (ITEM)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_MinscHideout_SluiceGates(_Var2, _, _Var1, _Var1, _Var1)
THEN
DB_CustomUseItemResponse(_Var1, _Var2, 0);
PROC_TryStartAD(GEN_AD_ItemBlocked_a4eb2e7b-809a-a9e4-94da-955a8ac9b8c6, _Var1);

IF
StatusApplied((ITEM)_Var1, (STRING)_Var2, _, _, (ITEM)_Var1)
AND
DB_LOW_MinscHideout_ValveStatuses(_Var1, _Var2, _, 2, _Var1)
AND
DB_LOW_MinscHideout_ValveStatuses(_Var6, _Var7, _, 2, _Var1)
AND
_Var1 != _Var6
AND
HasActiveStatus(_Var6, _Var7, 1, _Var1, _Var1)
AND NOT
GetStatusTurns(_Var6, _Var7, -1, _Var1, _Var1)
THEN
RemoveStatus(_Var1, _Var2, _Var1);
RemoveStatus(_Var6, _Var7, _Var6);
ApplyStatus(_Var1, _Var2, -1, 0, _Var1);
ApplyStatus(_Var6, _Var7, -1, 0, _Var6);
DB_LOW_MinscHideout_ValveOpened(_Var1, 0);
DB_LOW_MinscHideout_ValveOpened(_Var6, 0);
PROC_LOW_MinscHideout_UnlockSluiceGate();

IF
UseStarted(_, (ITEM)_Var2, _, _, _)
AND
DB_LOW_MinscHideout_Valves(_Var2, _, _, _, _)
AND NOT
QRY_LOW_MinscHideout_ToggleValveOff(_Var2, _, _, _, _)
AND
DB_LOW_MinscHideout_ValveTimerStatuses(_Var2, _Var3, _Var4, _, _)
THEN
DB_LOW_MinscHideout_ValveOpened(_Var2, 1);

QRY
QRY_LOW_MinscHideout_ToggleValveOff((ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_LOW_MinscHideout_ValveTimerStatuses(_Var1, _Var2, _, _Var1, _Var1)
AND
HasActiveStatus(_Var1, _Var2, 1, _Var1, _Var1)
THEN
DB_LOW_MinscHideout_ValveOpened(_Var1, 0);

IF
DB_LOW_MinscHideout_ValveOpened(_Var1, 1, _Var1, _Var1, _Var1)
AND
DB_LOW_MinscHideout_ValveTimerStatuses(_Var1, _Var2, _Var3, _Var1, _Var1)
THEN
ApplyStatus(_Var1, _Var2, _Var3);

IF
DB_LOW_MinscHideout_ValveOpened(_Var1, 0, _Var1, _Var1, _Var1)
AND
DB_LOW_MinscHideout_ValveTimerStatuses(_Var1, _Var2, _Var3, _Var1, _Var1)
THEN
RemoveStatus(_Var1, _Var2, _Var1);

PROC
PROC_BlockUseOfItem((CHARACTER)_Var1, (ITEM)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_MinscHideout_ValveStatuses(_Var2, _Var3, _, 4, _Var1)
AND
HasActiveStatus(_Var2, _Var3, 1, _Var1, _Var1)
THEN
DB_CustomUseItemResponse(_Var1, _Var2, 0);
PROC_TryStartAD(GEN_AD_ItemBlocked_a4eb2e7b-809a-a9e4-94da-955a8ac9b8c6, _Var1);

IF
UseStarted(_, S_LOW_MinscHideout_ReleaseValve_f5d649c0-05e6-4d01-ba38-6e3b5ea15584, _, _, _)
AND
DB_LOW_MinscHideout_Valves(_Var2, _, _, _, _)
AND
DB_LOW_MinscHideout_ValveStatuses(_Var2, _Var3, _, 4, _)
AND
HasActiveStatus(_Var2, _Var3, 1, _, _)
AND
DB_LOW_MinscHideout_ValveStatuses(_Var2, _Var5, _Var6, 3, _)
THEN
DB_LOW_MinscHideout_ValveOpened(_Var2, 0);
RemoveStatus(_Var2, _Var3, _Var2);
ApplyStatus(_Var2, _Var5, _Var6, 0, _Var2);
PlaySound(S_LOW_MinscHideout_ReleaseValve_f5d649c0-05e6-4d01-ba38-6e3b5ea15584, "SE_CTY_SluiceValve_ReleasePressure");

IF
StatusApplied((ITEM)_Var1, (STRING)_Var2, _, _, (ITEM)_Var1)
AND
DB_LOW_MinscHideout_ValveStatuses(_Var1, _Var2, _, _Var6, _Var1)
THEN
PROC_LOW_MinscHideout_SetValveIndicator(_Var1, _Var6);

IF
StatusRemoved((ITEM)_Var1, (STRING)_Var2, _, _, (ITEM)_Var1)
AND
DB_LOW_MinscHideout_ValveStatuses(_Var1, _Var2, _, 1, _Var1)
AND
DB_LOW_MinscHideout_ValveTimerStatuses(_Var1, _Var6, _, _Var1, _Var1)
AND
HasActiveStatus(_Var1, _Var6, 0, _Var1, _Var1)
THEN
PROC_LOW_MinscHideout_SetValveIndicator(_Var1, 0);

PROC
PROC_LOW_MinscHideout_SetValveIndicator((ITEM)_Var1, (INTEGER)_Var2, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_LOW_MinscHideout_ValveIndicators(_Var1, _Var3, _Var1, _Var1, _Var1)
THEN
SetAnimationEventInt(_Var3, "LOW_MinscHideout_SetGuageLevel", _Var2);

PROC
PROC_LOW_MinscHideout_SetValveIndicator((ITEM)_Var1, (INTEGER)_Var2, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_LOW_MinscHideout_ValveLevel(_Var1, _Var3, _Var4, _Var1, _Var1)
THEN
NOT DB_LOW_MinscHideout_ValveLevel(_Var1, _Var3, _Var4);
DB_LOW_MinscHideout_ValveLevel(_Var1, _Var4, _Var2);

IF
StatusApplied((ITEM)_Var1, (STRING)_Var2, _, _, (ITEM)_Var1)
AND
DB_LOW_MinscHideout_ValveStatuses(_Var1, _Var2, _, 4, _Var1)
THEN
PROC_LOW_MinscHideout_ValveOverloaded(_Var1);

PROC
PROC_LOW_MinscHideout_ValveOverloaded((ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_IsInRange(_Var1, _Var2, 10, _Var1, _Var1)
AND
QRY_OnlyOnce("LOW_MinscHideout_PuzzleOverload_PAD", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(LOW_MinscHideout_PAD_SluiceValveOverloading_f4154b8e-ef50-7845-3e29-b1772ed5f167, _Var2);
TimerLaunch("LOW_MinscHideout_PuzzleOverload_PAD", 20);

IF
TimerFinished("LOW_MinscHideout_PuzzleOverload_PAD", _, _, _, _)
AND
QRY_OnlyOnce_Reset("LOW_MinscHideout_PuzzleOverload_PAD", _, _, _, _)
THEN
DB_NOOP(1);

PROC
PROC_LOW_MinscHideout_ValveOverloaded(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, _, _, _, _)
THEN
UseSpell(S_LOW_MinscHideout_Helper_WaterBlast_9c7751b5-f43d-4b1d-a24e-f5c131a36c99, "Zone_LOW_MinscHideout_SluiceValve_SteamBlast", S_LOW_MinscHideout_Poly_WaterSurface_07053a07-6389-47b2-8b28-40dd641123d4);

PROC
PROC_LOW_MinscHideout_ValveOverloaded(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, _, _, _, _)
THEN
UseSpell(S_LOW_MinscHideout_Helper_FireBlast_1721384f-7e5e-4c92-9fe7-b124decb3dd1, "Zone_LOW_MinscHideout_SluiceValve_FireBlast", S_LOW_MinscHideout_Poly_FireSurface_db30158d-868c-4ccb-838b-df0b04b4c27c);

PROC
PROC_BlockUseOfItem((CHARACTER)_Var1, (ITEM)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_MinscHideout_DisabledValves(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
DB_CustomUseItemResponse(_Var1, _Var2, 0);
PROC_TryStartAD(GEN_AD_ItemBlocked_a4eb2e7b-809a-a9e4-94da-955a8ac9b8c6, _Var1);

IF
DB_LOW_MinscHideout_ValveOpened(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, 1, _, _, _)
THEN
PlaySound(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, "SE_CTY_SluiceValve_HeatIncrease_Loop");
PROC_LoopEffect(VFX_Script_CTY_AbandonedCistern_Steam_Fire_Light_01_8b0565bf-49fd-d492-2d57-b5466b7bde0c, S_LOW_MinscHideout_Helper_HeatSteamLeak_002_b47bc411-ca2d-4f1b-a0e7-31f6f01e455a, "MinscHideout_SteamLeak_Valve", "CTY_Main_A", "");

IF
DB_LOW_MinscHideout_ValveOpened(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, 1, _, _, _)
THEN
PlaySound(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, "SE_CTY_SluiceValve_WaterThroughPipes_Loop");
PROC_LoopEffect(VFX_Script_CTY_AbandonedCistern_Steam_Light_01_acdae0fb-4822-0ea6-fb71-2c7f9c7b36ae, S_LOW_MinscHideout_Helper_WaterSteamLeak_002_15628190-24c4-4fd3-841c-99299ea6d2ac, "MinscHideout_SteamLeak_Valve", "CTY_Main_A", "");

IF
DB_LOW_MinscHideout_ValveLevel(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, 2, 3, _, _)
THEN
PlaySound(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, "SE_CTY_SluiceValve_MetalCreaking_Loop");
PROC_LoopEffect(VFX_Script_CTY_AbandonedCistern_Steam_Fire_Medium_01_db7515c2-8fc3-d7c4-7e33-5445a0e0835b, S_LOW_MinscHideout_Helper_HeatSteamLeak_000_dccd9136-345a-4296-971b-fe9fc368ae3b, "MinscHideout_SteamLeak_Vat", "CTY_Main_A", "");
PROC_LoopEffect(VFX_Script_CTY_AbandonedCistern_Steam_Fire_Medium_01_db7515c2-8fc3-d7c4-7e33-5445a0e0835b, S_LOW_MinscHideout_Helper_HeatSteamLeak_001_312ed4a9-8c4d-4432-9fad-7da68bcbc553, "MinscHideout_SteamLeak_Vat", "CTY_Main_A", "");

IF
DB_LOW_MinscHideout_ValveLevel(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, 2, 3, _, _)
THEN
PlaySound(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, "SE_CTY_SluiceValve_MetalBuckling_Loop");
PROC_LoopEffect(VFX_Script_CTY_AbandonedCistern_Steam_Medium_01_0f60f2f7-e2c6-cbec-e984-dbf9ae12d9a6, S_LOW_MinscHideout_Helper_WaterSteamLeak_000_c1106307-2162-49d3-8f36-13b68552bcb9, "MinscHideout_SteamLeak_Vat", "CTY_Main_A", "");
PROC_LoopEffect(VFX_Script_CTY_AbandonedCistern_Steam_Medium_01_0f60f2f7-e2c6-cbec-e984-dbf9ae12d9a6, S_LOW_MinscHideout_Helper_WaterSteamLeak_001_95d49db5-57e5-4117-ae91-cee36153280c, "MinscHideout_SteamLeak_Vat", "CTY_Main_A", "");

IF
DB_LOW_MinscHideout_ValveLevel(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, _, 4, _, _)
THEN
PROC_StopLoopEffect(S_LOW_MinscHideout_Helper_HeatSteamLeak_000_dccd9136-345a-4296-971b-fe9fc368ae3b, "MinscHideout_SteamLeak_Vat");
PROC_StopLoopEffect(S_LOW_MinscHideout_Helper_HeatSteamLeak_001_312ed4a9-8c4d-4432-9fad-7da68bcbc553, "MinscHideout_SteamLeak_Vat");
PROC_LoopEffect(VFX_Script_CTY_AbandonedCistern_Steam_Fire_Heavy_01_b0d5d3a9-1143-c51a-ffff-593e64b78c32, S_LOW_MinscHideout_Helper_HeatSteamLeak_000_dccd9136-345a-4296-971b-fe9fc368ae3b, "MinscHideout_SteamLeak_VatHeavy", "CTY_Main_A", "");
PROC_LoopEffect(VFX_Script_CTY_AbandonedCistern_Steam_Fire_Heavy_01_b0d5d3a9-1143-c51a-ffff-593e64b78c32, S_LOW_MinscHideout_Helper_HeatSteamLeak_001_312ed4a9-8c4d-4432-9fad-7da68bcbc553, "MinscHideout_SteamLeak_VatHeavy", "CTY_Main_A", "");

IF
DB_LOW_MinscHideout_ValveLevel(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, _, 4, _, _)
THEN
PROC_StopLoopEffect(S_LOW_MinscHideout_Helper_WaterSteamLeak_000_c1106307-2162-49d3-8f36-13b68552bcb9, "MinscHideout_SteamLeak_Vat");
PROC_StopLoopEffect(S_LOW_MinscHideout_Helper_WaterSteamLeak_001_95d49db5-57e5-4117-ae91-cee36153280c, "MinscHideout_SteamLeak_Vat");
PROC_LoopEffect(VFX_Script_CTY_AbandonedCistern_Steam_Heavy_01_651be98b-b113-c838-7bce-785fe9179b38, S_LOW_MinscHideout_Helper_WaterSteamLeak_000_c1106307-2162-49d3-8f36-13b68552bcb9, "MinscHideout_SteamLeak_VatHeavy", "CTY_Main_A", "");
PROC_LoopEffect(VFX_Script_CTY_AbandonedCistern_Steam_Heavy_01_651be98b-b113-c838-7bce-785fe9179b38, S_LOW_MinscHideout_Helper_WaterSteamLeak_001_95d49db5-57e5-4117-ae91-cee36153280c, "MinscHideout_SteamLeak_VatHeavy", "CTY_Main_A", "");

IF
DB_LOW_MinscHideout_ValveOpened(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, 0, _, _, _)
THEN
PlaySound(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, "SE_CTY_SluiceValve_HeatIncrease_Loop_Stop");
PROC_StopLoopEffect(S_LOW_MinscHideout_Helper_HeatSteamLeak_002_b47bc411-ca2d-4f1b-a0e7-31f6f01e455a, "MinscHideout_SteamLeak_Valve");

IF
DB_LOW_MinscHideout_ValveOpened(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, 0, _, _, _)
THEN
PlaySound(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, "SE_CTY_SluiceValve_WaterThroughPipes_Loop_Stop");
PROC_StopLoopEffect(S_LOW_MinscHideout_Helper_WaterSteamLeak_002_15628190-24c4-4fd3-841c-99299ea6d2ac, "MinscHideout_SteamLeak_Valve");

IF
DB_LOW_MinscHideout_ValveLevel(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, 3, 2, _, _)
THEN
PlaySound(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, "SE_CTY_SluiceValve_MetalCreaking_Loop_Stop");
PROC_StopLoopEffect(S_LOW_MinscHideout_Helper_HeatSteamLeak_000_dccd9136-345a-4296-971b-fe9fc368ae3b, "MinscHideout_SteamLeak_Vat");
PROC_StopLoopEffect(S_LOW_MinscHideout_Helper_HeatSteamLeak_001_312ed4a9-8c4d-4432-9fad-7da68bcbc553, "MinscHideout_SteamLeak_Vat");

IF
DB_LOW_MinscHideout_ValveLevel(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, 3, 2, _, _)
THEN
PlaySound(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, "SE_CTY_SluiceValve_MetalBuckling_Loop_Stop");
PROC_StopLoopEffect(S_LOW_MinscHideout_Helper_WaterSteamLeak_000_c1106307-2162-49d3-8f36-13b68552bcb9, "MinscHideout_SteamLeak_Vat");
PROC_StopLoopEffect(S_LOW_MinscHideout_Helper_WaterSteamLeak_001_95d49db5-57e5-4117-ae91-cee36153280c, "MinscHideout_SteamLeak_Vat");

IF
DB_LOW_MinscHideout_ValveLevel(S_LOW_MinscHideout_TemperatureValve_2491b6ee-1538-44bf-8e1a-9edf131185a8, 4, _, _, _)
THEN
PROC_StopLoopEffect(S_LOW_MinscHideout_Helper_HeatSteamLeak_000_dccd9136-345a-4296-971b-fe9fc368ae3b, "MinscHideout_SteamLeak_VatHeavy");
PROC_StopLoopEffect(S_LOW_MinscHideout_Helper_HeatSteamLeak_001_312ed4a9-8c4d-4432-9fad-7da68bcbc553, "MinscHideout_SteamLeak_VatHeavy");
PROC_LoopEffect(VFX_Script_CTY_AbandonedCistern_Steam_Fire_Medium_01_db7515c2-8fc3-d7c4-7e33-5445a0e0835b, S_LOW_MinscHideout_Helper_HeatSteamLeak_000_dccd9136-345a-4296-971b-fe9fc368ae3b, "MinscHideout_SteamLeak_Vat", "CTY_Main_A", "");
PROC_LoopEffect(VFX_Script_CTY_AbandonedCistern_Steam_Fire_Medium_01_db7515c2-8fc3-d7c4-7e33-5445a0e0835b, S_LOW_MinscHideout_Helper_HeatSteamLeak_001_312ed4a9-8c4d-4432-9fad-7da68bcbc553, "MinscHideout_SteamLeak_Vat", "CTY_Main_A", "");

IF
DB_LOW_MinscHideout_ValveLevel(S_LOW_MinscHideout_WaterValve_b7aacda4-3cfe-4cec-8c5b-8d78b3361087, 4, _, _, _)
THEN
PROC_StopLoopEffect(S_LOW_MinscHideout_Helper_WaterSteamLeak_000_c1106307-2162-49d3-8f36-13b68552bcb9, "MinscHideout_SteamLeak_VatHeavy");
PROC_StopLoopEffect(S_LOW_MinscHideout_Helper_WaterSteamLeak_001_95d49db5-57e5-4117-ae91-cee36153280c, "MinscHideout_SteamLeak_VatHeavy");
PROC_LoopEffect(VFX_Script_CTY_AbandonedCistern_Steam_Medium_01_0f60f2f7-e2c6-cbec-e984-dbf9ae12d9a6, S_LOW_MinscHideout_Helper_WaterSteamLeak_000_c1106307-2162-49d3-8f36-13b68552bcb9, "MinscHideout_SteamLeak_Vat", "CTY_Main_A", "");
PROC_LoopEffect(VFX_Script_CTY_AbandonedCistern_Steam_Medium_01_0f60f2f7-e2c6-cbec-e984-dbf9ae12d9a6, S_LOW_MinscHideout_Helper_WaterSteamLeak_001_95d49db5-57e5-4117-ae91-cee36153280c, "MinscHideout_SteamLeak_Vat", "CTY_Main_A", "");

PROC
PROC_State_Changed(_, "LOW_Guildhall_State", "LOW_Guildhall_State_PostHeist", (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_LOW_MinscHideout_SetupMinscNaheira();

PROC
PROC_LOW_MinscHideout_SetupMinscNaheira()
THEN
PROC_LOW_MinscHideout_TeleportMinscNaheira();
SetFaction(S_LOW_CountingHouse_JaheiraClone_4da802f5-3237-40b8-afff-d728016e3047, ACT3_LOW_MinscHideout_MinscsGang_2cc8f4c1-33ee-460b-9c0a-6f516cbbad1b);
SetFaction(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, ACT3_LOW_MinscHideout_MinscsGang_2cc8f4c1-33ee-460b-9c0a-6f516cbbad1b);

PROC
PROC_LOW_MinscHideout_TeleportMinscNaheira()
AND
DB_LOW_MinscHideout_TeleportParams(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_LOW_MinscHideout_TeleportCharacter(_Var1);

PROC
PROC_LOW_MinscHideout_TeleportCharacter((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_MinscHideout_TeleportParams(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
DB_LOW_MinscHideout_TeleportingToHideout(_Var1);
PROC_Poof(_Var1, VFX_Script_Minsc_Teleport_Disappear_4d3bdeed-c0d0-57a7-8074-c27a850c66d4);

IF
WentOnStage((CHARACTER)_Var1, 0, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_MinscHideout_TeleportingToHideout(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_MinscHideout_TeleportParams(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var1, _Var2, "LOW_MinscHideout_Teleported");

IF
EntityEvent((CHARACTER)_Var1, "LOW_MinscHideout_Teleported", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_MinscHideout_TeleportingToHideout(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetCombatGroupID(_Var1, "93263aca-71b3-0838-a35d-2f2c90a2f89d");
PROC_SetOnStage(_Var1, 1);
PlayEffect(_Var1, VFX_Script_Minsc_Teleport_Appear_522cf31a-7a74-ea02-a6ab-acfc98d2756d, "");
NOT DB_LOW_MinscHideout_TeleportingToHideout(_Var1);

PROC
PROC_State_Changed(_, "LOW_Guildhall_State", "LOW_Guildhall_State_PostHeist", _, _)
AND
DB_LOW_Guildhall_ZhentRepresentative(_Var2, _, _, _, _)
AND NOT
DB_LOW_MinscHideout_ZhentLeaderMoving(1, _, _, _, _)
THEN
TeleportTo(_Var2, S_LOW_MinscHideout_SecretExit_8a513e19-26eb-4b5a-b861-654d4d08a80f, "LOW_MinscHideout_PreCoup_ZhentLeaderArriving");
PROC_SetOnStage(_Var2, 1);
DB_LOW_MinscHideout_ZhentLeaderMoving(1);

IF
EntityEvent((CHARACTER)_Var1, "LOW_MinscHideout_PreCoup_ZhentLeaderArriving", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
SetFaction(_Var1, ACT3_LOW_MinscHideout_MinscsGang_2cc8f4c1-33ee-460b-9c0a-6f516cbbad1b);
SetCombatGroupID(_Var1, "93263aca-71b3-0838-a35d-2f2c90a2f89d");
PROC_CharacterMoveTo(_Var1, S_LOW_MinscHideout_RoahMeetingPoint_faa1fd32-afa3-46af-87c4-400b366a1c32, "Walk", "LOW_MinscHideout_PreCoup_ZhentLeaderArrived");

IF
EntityEvent((CHARACTER)_Var1, "LOW_MinscHideout_PreCoup_ZhentLeaderArrived", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
NOT DB_LOW_MinscHideout_ZhentLeaderMoving(1);
PROC_State_Progress(S_LOW_Guildhall_SUB_adf8c225-5a74-4c9b-86ea-198aca6fabae, "LOW_Guildhall_State", "LOW_Guildhall_State_PreCoup");

PROC
PROC_State_Changed(_, "LOW_Guildhall_State", "LOW_Guildhall_State_PreHeist", "LOW_Guildhall_State_PreCoup", _)
AND
DB_LOW_Guildhall_ZhentRepresentative(_Var2, _, _, _, _)
THEN
PROC_LOW_MinscHideout_SetupMinscNaheira();
PROC_SetOnStage(_Var2, 1);
SetFaction(_Var2, ACT3_LOW_MinscHideout_MinscsGang_2cc8f4c1-33ee-460b-9c0a-6f516cbbad1b);
SetCombatGroupID(_Var2, "93263aca-71b3-0838-a35d-2f2c90a2f89d");
TeleportTo(_Var2, S_LOW_MinscHideout_RoahMeetingPoint_faa1fd32-afa3-46af-87c4-400b366a1c32);

PROC
PROC_State_Changed(_, "LOW_Guildhall_State", _, "LOW_Guildhall_State_PreCoup", _)
AND
DB_LOW_Guildhall_ZhentRepresentative(_Var3, _, _, _, _)
THEN
PROC_SetRelationToPlayers(ACT3_LOW_MinscHideout_MinscsGang_2cc8f4c1-33ee-460b-9c0a-6f516cbbad1b, 50);
PROC_SceneDialogOnly("LOW_MinscHideout_ZhentBribe", _Var3, S_LOW_MinscHideout_MeetingSceneDialogTrigger_8796be50-6ccc-40f9-8c79-03e1467c80bb);
PROC_SceneDialogOnly("LOW_MinscHideout_ZhentBribe", S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, S_LOW_MinscHideout_MeetingSceneDialogTrigger_8796be50-6ccc-40f9-8c79-03e1467c80bb);
PROC_SceneDialogOnly("LOW_MinscHideout_ZhentBribe", S_LOW_CountingHouse_JaheiraClone_4da802f5-3237-40b8-afff-d728016e3047, S_LOW_MinscHideout_MeetingSceneDialogTrigger_8796be50-6ccc-40f9-8c79-03e1467c80bb);
DB_OneShotPlayerTrigger(S_LOW_MinscHideout_MeetingSceneDialogTrigger_8796be50-6ccc-40f9-8c79-03e1467c80bb);

IF
EnteredCombat((CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_Guildhall_ZhentRepresentative(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_MinscHideout_ZhentLeaderMoving(1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_ClearStoryMove(_Var1);
NOT DB_LOW_MinscHideout_ZhentLeaderMoving(1);
PROC_LOW_MinscHideout_ZhentLeaderEscaping();

PROC
PROC_OneShotTriggerEntered((CHARACTER)_Var1, S_LOW_MinscHideout_MeetingSceneDialogTrigger_8796be50-6ccc-40f9-8c79-03e1467c80bb, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_Guildhall_ZhentRepresentative(S_GOB_Quartermaster_646936f3-8d8d-484e-9361-cd1ed484c615, _Var1, _Var1, _Var1, _Var1)
AND
DB_SceneTriggerManager("LOW_MinscHideout_ZhentBribe", _, _, _Var1, _Var1)
AND NOT
QRY_StartDialog(LOW_MinscHideout_RoahBribe_041941c1-00ba-ad43-6da9-6f7a597053b3, S_GOB_Quartermaster_646936f3-8d8d-484e-9361-cd1ed484c615, NULL_00000000-0000-0000-0000-000000000000, S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, S_LOW_CountingHouse_JaheiraClone_4da802f5-3237-40b8-afff-d728016e3047, _Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_MinscHideout_FightStarts();

PROC
PROC_OneShotTriggerEntered((CHARACTER)_Var1, S_LOW_MinscHideout_MeetingSceneDialogTrigger_8796be50-6ccc-40f9-8c79-03e1467c80bb, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_Guildhall_ZhentRepresentative(S_LOW_Guildhall_Zhent_Leader_b7e51fc3-0788-44f2-add7-1714f2b9b6d9, _Var1, _Var1, _Var1, _Var1)
AND
DB_SceneTriggerManager("LOW_MinscHideout_ZhentBribe", _, _, _Var1, _Var1)
AND NOT
QRY_StartDialog(LOW_MinscHideout_RoahBribe_041941c1-00ba-ad43-6da9-6f7a597053b3, NULL_00000000-0000-0000-0000-000000000000, S_LOW_Guildhall_Zhent_Leader_b7e51fc3-0788-44f2-add7-1714f2b9b6d9, S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, S_LOW_CountingHouse_JaheiraClone_4da802f5-3237-40b8-afff-d728016e3047, _Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_MinscHideout_FightStarts();

PROC
PROC_OneShotTriggerEntered((CHARACTER)_Var1, S_LOW_MinscHideout_MeetingSceneDialogTrigger_8796be50-6ccc-40f9-8c79-03e1467c80bb, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
DB_SpotPlayers(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Players", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers_SpotterIgnoreCantTalk(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Players");
DB_SpotPlayers_TargetIgnoreCantTalk(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Players");
DB_SpotPlayers_IncludeWildshapedPlayers(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Players");
DB_SpotPlayers_IncludeSummons(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Players");
DB_SpotPlayers_IncludeFollowers(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Players");

PROC
PROC_SpotPlayers_Spotted(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Players", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
SetFlag(LOW_MinscHideout_State_PlayerSpottedDuringBribe_9f2066b4-4fb9-622b-367e-7e54facf09e1);

IF
FlagSet(LOW_MinscHideout_Event_NaheiraGivesGoldTo_f5b4f7cc-e60e-4d91-6660-8b0cc3f28b89, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_Guildhall_ZhentLeader(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsInInventoryOf(S_LOW_CountingHouse_StolenGoldBag_d31cdfbd-daea-4188-b685-38b708143a8d, S_LOW_CountingHouse_JaheiraClone_4da802f5-3237-40b8-afff-d728016e3047, 1, _Var1, _Var1)
THEN
ToInventory(S_LOW_CountingHouse_StolenGoldBag_d31cdfbd-daea-4188-b685-38b708143a8d, _Var1, 1, 0, 1);

IF
EnteredCombat(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, _, _, _, _)
AND NOT
DB_GlobalFlag(ORI_Minsc_State_SavedFromAbsolute_62e1d5ec-7c7e-70c2-68de-cadc7c7f5f20, _, _, _, _)
THEN
PROC_LOW_MinscHideout_MinscFightStarted();
PROC_SpotPlayers_CleanupSpotting("Minsc_Spotting_Players");

PROC
PROC_LOW_MinscHideout_MinscFightStarted()
THEN
DB_SpotPlayers(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Jaheira", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers_Continuous(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Jaheira");
DB_SpotPlayers_HasTag(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Jaheira", JAHEIRA_2c948b46-0d8a-426b-ad8b-5f41233df4c1, 1);
DB_SpotPlayers_IgnoreCombat(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Jaheira");
DB_SpotPlayers(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Naheira", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers_IncludeExtra(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Naheira", S_LOW_CountingHouse_JaheiraClone_4da802f5-3237-40b8-afff-d728016e3047);
DB_SpotPlayers_Continuous(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Naheira");
DB_SpotPlayers_IgnoreCombat(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Naheira");
DB_SpotPlayers_IncludeDefeated(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Naheira");
DB_SpotPlayers_IncludeDead(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Naheira");
DB_SpotPlayers_TargetIgnoreCantTalk(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Naheira");

IF
DB_SpotPlayers_Spotted(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Naheira", S_LOW_CountingHouse_JaheiraClone_4da802f5-3237-40b8-afff-d728016e3047, _, _)
AND
DB_SpotPlayers_Spotted(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, "Minsc_Spotting_Jaheira", S_Player_Jaheira_91b6b200-7d00-4d62-8dc9-99e8339dfa1a, _, _)
AND NOT
DB_GlobalFlag(ORI_Minsc_State_SavedFromAbsolute_62e1d5ec-7c7e-70c2-68de-cadc7c7f5f20, _, _, _, _)
THEN
DB_CombatReact_AD_OnNextTurn(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, LOW_MinscHideout_AD_MinscSeesTwoJaheiras_8fecde5c-0d61-898a-1efe-2ac3e0b94b6f);
PROC_SpotPlayers_CleanupSpotting("Minsc_Spotting_Jaheira");
PROC_SpotPlayers_CleanupSpotting("Minsc_Spotting_Naheira");
PROC_SpotPlayers_CleanupSpotting("Jaheira_Spotting_Minsc");

IF
DB_PermaDefeated(S_LOW_CountingHouse_JaheiraClone_4da802f5-3237-40b8-afff-d728016e3047, _, _, _, _)
THEN
NOT DB_CombatReact_AD_OnNextTurn(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, LOW_MinscHideout_AD_MinscSeesTwoJaheiras_8fecde5c-0d61-898a-1efe-2ac3e0b94b6f);
PROC_SpotPlayers_CleanupSpotting("Minsc_Spotting_Jaheira");
PROC_SpotPlayers_CleanupSpotting("Minsc_Spotting_Naheira");
PROC_SpotPlayers_CleanupSpotting("Jaheira_Spotting_Minsc");

IF
EnteredCombat(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, _, _, _, _)
AND NOT
DB_GlobalFlag(ORI_Minsc_State_SavedFromAbsolute_62e1d5ec-7c7e-70c2-68de-cadc7c7f5f20, _, _, _, _)
AND
DB_Players(S_Player_Jaheira_91b6b200-7d00-4d62-8dc9-99e8339dfa1a, _, _, _, _)
THEN
DB_SpotPlayers(S_Player_Jaheira_91b6b200-7d00-4d62-8dc9-99e8339dfa1a, "Jaheira_Spotting_Minsc", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers_IncludeExtra(S_Player_Jaheira_91b6b200-7d00-4d62-8dc9-99e8339dfa1a, "Jaheira_Spotting_Minsc", S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba);
DB_SpotPlayers_Continuous(S_Player_Jaheira_91b6b200-7d00-4d62-8dc9-99e8339dfa1a, "Jaheira_Spotting_Minsc");
DB_SpotPlayers_HasTag(S_Player_Jaheira_91b6b200-7d00-4d62-8dc9-99e8339dfa1a, "Jaheira_Spotting_Minsc", MINSC_26fb71ce-d2c8-44b5-90d6-cb08705cb531, 1);
DB_SpotPlayers_IgnoreCombat(S_Player_Jaheira_91b6b200-7d00-4d62-8dc9-99e8339dfa1a, "Jaheira_Spotting_Minsc");

IF
DB_SpotPlayers_Spotted(S_Player_Jaheira_91b6b200-7d00-4d62-8dc9-99e8339dfa1a, "Jaheira_Spotting_Minsc", S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, _, _)
AND NOT
DB_GlobalFlag(ORI_Minsc_State_SavedFromAbsolute_62e1d5ec-7c7e-70c2-68de-cadc7c7f5f20, _, _, _, _)
THEN
DB_CombatReact_AD_OnNextTurn(S_Player_Jaheira_91b6b200-7d00-4d62-8dc9-99e8339dfa1a, LOW_MinscHideout_PAD_Jaheira_PleadingSaveMinsc_f04b7667-ed80-21b0-5c47-b0f8bc7f2161);
PROC_SpotPlayers_CleanupSpotting("Jaheira_Spotting_Minsc");

IF
DB_PermaDefeated(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, _, _, _, _)
THEN
PROC_LOW_MinscHideout_CleanupEvilMinscCombatADs();

IF
FlagSet(ORI_Minsc_State_SavedFromAbsolute_62e1d5ec-7c7e-70c2-68de-cadc7c7f5f20, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_LOW_MinscHideout_CleanupEvilMinscCombatADs();

PROC
PROC_LOW_MinscHideout_CleanupEvilMinscCombatADs()
THEN
TimerLaunch("LOW_MinscHideout_CleanupEvilMinscCombatADs", 1000);

IF
TimerFinished("LOW_MinscHideout_CleanupEvilMinscCombatADs", _, _, _, _)
THEN
PROC_SpotPlayers_CleanupSpotting("Minsc_Spotting_Jaheira");
PROC_SpotPlayers_CleanupSpotting("Minsc_Spotting_Naheira");
PROC_SpotPlayers_CleanupSpotting("Jaheira_Spotting_Minsc");
NOT DB_CombatReact_AD_OnDeathOther(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, S_LOW_CountingHouse_JaheiraClone_4da802f5-3237-40b8-afff-d728016e3047, LOW_MinscHideout_AD_MinscSeesNaheiraDie_678d96b9-d84e-74ab-5808-c190e9ba51d4);
NOT DB_CombatReact_AD_OnNextTurn(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, LOW_MinscHideout_AD_MinscSeesTwoJaheiras_8fecde5c-0d61-898a-1efe-2ac3e0b94b6f);
NOT DB_CombatReact_AD_OnDeathOther(S_Player_Jaheira_91b6b200-7d00-4d62-8dc9-99e8339dfa1a, S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, LOW_MinscHideout_PAD_Jaheira_MinscDies_c9655ab3-3364-2308-6156-5540514fb8f3);
NOT DB_CombatReact_AD_OnNextTurn(S_Player_Jaheira_91b6b200-7d00-4d62-8dc9-99e8339dfa1a, LOW_MinscHideout_PAD_Jaheira_PleadingSaveMinsc_f04b7667-ed80-21b0-5c47-b0f8bc7f2161);

IF
DialogEnded(LOW_MinscHideout_RoahBribe_041941c1-00ba-ad43-6da9-6f7a597053b3, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_LOW_MinscHideout_FightStarts();

PROC
PROC_LOW_MinscHideout_FightStarts()
THEN
PROC_SceneOver("LOW_MinscHideout_ZhentBribe");
PROC_SetRelationToPlayers(ACT3_LOW_MinscHideout_MinscsGang_2cc8f4c1-33ee-460b-9c0a-6f516cbbad1b, 0);
PROC_LOW_MinscHideout_ZhentLeaderEscaping();

IF
EnteredCombat(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, _, _, _, _)
AND
DB_SceneTriggerManager("LOW_MinscHideout_ZhentBribe", _, _, _, _)
THEN
PROC_SceneOver("LOW_MinscHideout_ZhentBribe");

PROC
PROC_LOW_MinscHideout_ZhentLeaderEscaping()
THEN
SetFlag(LOW_MinscHideout_State_ZhentLeaderEscaping_4333a451-024f-4c41-aea1-7046afdf0b4a);

IF
FlagSet(LOW_MinscHideout_State_ZhentLeaderEscaped_0a08b808-b6e2-4923-936c-c12f2774ce61, _, _, _, _)
AND
DB_LOW_Guildhall_ZhentRepresentative(_Var3, _, _, _, _)
THEN
SetFaction(_Var3, ACT3_LOW_Guildhall_Zhent_0a9246a5-88ee-4b47-85d4-c86aba7d62dd);

IF
DialogEnded(LOW_MinscHideout_RoahBribe_041941c1-00ba-ad43-6da9-6f7a597053b3, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_GlobalFlag(LOW_MinscsHideout_State_PlayerInterfered_c3df81f4-d6d2-8563-b971-730c61de99b7, _Var1, _Var1, _Var1, _Var1)
AND
DB_DialogPlayers(_Var1, _Var2, _, _Var1, _Var1)
THEN
EnterCombat(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, _Var2);

PROC
PROC_SceneOver("LOW_MinscHideout_ZhentBribe", _, _, _, _)
THEN
PROC_RemoveDialog(S_LOW_CountingHouse_JaheiraClone_4da802f5-3237-40b8-afff-d728016e3047);
PROC_RemoveDialog(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba);
DB_SpotPlayers(S_LOW_CountingHouse_JaheiraClone_4da802f5-3237-40b8-afff-d728016e3047, "LOW_MinscHideout_JaheiraCloneSpotting", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_Dialogs(S_LOW_CountingHouse_JaheiraClone_4da802f5-3237-40b8-afff-d728016e3047, LOW_MinscHideout_JaheiraDoppelganger_c219aa04-4d87-9e92-579d-28e89ac3bb55);

PROC
PROC_SpotPlayers_Spotted((CHARACTER)_Var1, "LOW_MinscHideout_JaheiraCloneSpotting", (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
QRY_StartDialog(LOW_MinscHideout_JaheiraDoppelganger_c219aa04-4d87-9e92-579d-28e89ac3bb55, _Var1, _Var2, _Var1, _Var1)
THEN
PROC_LOW_MinscHideout_FightStarts();

IF
DB_PermaDefeated(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, _, _, _, _)
AND NOT
DB_GlobalFlag(ORI_Minsc_State_SavedFromAbsolute_62e1d5ec-7c7e-70c2-68de-cadc7c7f5f20, _, _, _, _)
AND NOT
DB_PermaDefeated(S_GLO_Boo_d49e3b49-a089-4465-b453-28dc79e82bb3, _, _, _, _)
THEN
PROC_LOW_MinscHideout_BooComesToMinscCorpse();

PROC
PROC_LOW_MinscHideout_BooComesToMinscCorpse()
THEN
TeleportTo(S_GLO_Boo_d49e3b49-a089-4465-b453-28dc79e82bb3, S_LOW_MinscHideout_BooCaveEntrance_0549affd-3bca-41da-8609-6c1272e5c809, "LOW_MinscHideout_MinscDeath_BooTeleportedToCaveEntrance");

IF
EntityEvent(S_GLO_Boo_d49e3b49-a089-4465-b453-28dc79e82bb3, "LOW_MinscHideout_MinscDeath_BooTeleportedToCaveEntrance", _, _, _)
THEN
PROC_SetOnStage(S_GLO_Boo_d49e3b49-a089-4465-b453-28dc79e82bb3, 1);
ObjectTimerLaunch(S_GLO_Boo_d49e3b49-a089-4465-b453-28dc79e82bb3, "LOW_MinscHideout_MinscDeath_WaitsToSqueakAngrily", 2000);

IF
ObjectTimerFinished(S_GLO_Boo_d49e3b49-a089-4465-b453-28dc79e82bb3, "LOW_MinscHideout_MinscDeath_WaitsToSqueakAngrily", _, _, _)
THEN
PROC_TryStartAD(LOW_MinscHideout_AD_MinscDied_BooAngry_15c5dcd7-c7e4-8987-815e-deb168d149c5, S_GLO_Boo_d49e3b49-a089-4465-b453-28dc79e82bb3);
DB_AD_Dialog(S_GLO_Boo_d49e3b49-a089-4465-b453-28dc79e82bb3, LOW_MinscHideout_AD_MinscDied_BooAngry_15c5dcd7-c7e4-8987-815e-deb168d149c5);

PROC
PROC_LongRest()
AND
DB_GlobalFlag(LOW_MinscHideout_BooSittingAtMinscCorpse_f0a36d0c-70cb-4987-9332-36e5989d3327, _, _, _, _)
AND
QRY_OnlyOnce("LOW_MinscHideout_BooAtMinscBody_GoesOffStage", _, _, _, _)
THEN
PROC_SetOnStage(S_GLO_Boo_d49e3b49-a089-4465-b453-28dc79e82bb3, 0);

IF
UseFinished((CHARACTER)_Var1, (ITEM)_Var2, 1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_MinscHideout_RelicVB(_Var2, _, _Var4, _Var1, _Var1)
AND NOT
QRY_LOW_Guildhall_RelicPADPlaying()
THEN
StartVoiceBark(_Var4, _Var1);

QRY
QRY_LOW_Guildhall_RelicPADPlaying()
AND
DB_LOW_MinscHideout_RelicVB(_, _Var2, _, _, _)
AND
DB_DialogName(_Var2, _, _, _, _)
THEN
DB_NOOP(1);

IF
TextEvent("MinscHideout_PostHeist", _, _, _, _)
THEN
PROC_State_Progress(S_LOW_Guildhall_SUB_adf8c225-5a74-4c9b-86ea-198aca6fabae, "LOW_Guildhall_State", "LOW_Guildhall_State_PostHeist");

IF
TextEvent("MinscHideout_SetupRoahBribe", _, _, _, _)
THEN
PROC_State_Progress(S_LOW_Guildhall_SUB_adf8c225-5a74-4c9b-86ea-198aca6fabae, "LOW_Guildhall_State", "LOW_Guildhall_State_PreCoup");

IF
FlagSet(Debug_Teleport_LOW_AbandonedCisternSetupZhentBribe_274c43f5-6fa9-417a-be07-6a75edb31445, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_LOW_MinscHideout_SetupZhentBribe();

PROC
PROC_LOW_MinscHideout_SetupZhentBribe()
THEN
ClearFlag(Debug_Teleport_LOW_AbandonedCisternSetupZhentBribe_274c43f5-6fa9-417a-be07-6a75edb31445);
PROC_State_Progress(S_LOW_Guildhall_SUB_adf8c225-5a74-4c9b-86ea-198aca6fabae, "LOW_Guildhall_State", "LOW_Guildhall_State_PreCoup");

PROC
PROC_LOW_MinscHideout_DelayedSetupZhentBribe()
AND
DB_GlobalFlag(Debug_Teleport_LOW_AbandonedCisternSetupZhentBribe_274c43f5-6fa9-417a-be07-6a75edb31445, _, _, _, _)
THEN
PROC_LOW_MinscHideout_SetupZhentBribe();


EXITSECTION
ENDEXITSECTION

ParentTargetEdge "Act3b"
