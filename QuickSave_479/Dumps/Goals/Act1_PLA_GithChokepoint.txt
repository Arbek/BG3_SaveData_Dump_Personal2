Version 1
SubGoalCombiner SGC_AND

INITSECTION
DB_Dialogs(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, PLA_GithChokepoint_TieflingScout_c7d900d8-9e51-740d-99b7-d8913d135c7d);
DB_AD_Dialog(S_PLA_GithChokepoint_Sign_f45068f8-eb3b-4aca-b9e9-42a120a17286, PLA_GithChokepoint_Sign_AD_e6ed1b75-aabc-3431-293c-940947e99f20);
DB_GLO_CharacterCorpseDialog(S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, PLA_GithCaptain_Dead_84fe8d48-0763-669b-d09b-c55e2b7a4d31);
DB_GLO_CharacterCorpseDialog(S_PLA_DeadZorruFriend_2e5a05d0-66ef-407c-806d-a12d4ab0c1df, PLA_GithChokepoint_ZorruFriend_Dead_84d47c66-4c56-7484-80ec-2db0cbcb18a9);
DB_Dialogs(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, DIALOGRESOURCEGUID_PLA_GithChokepoint_Confrontation_81aa25b6-850b-16bf-81c9-68c19208db5e);
DB_PLA_GithChokepoint_ExtraConfrontationSpeakers(PLA_GithChokepoint_Confrontation_81aa25b6-850b-16bf-81c9-68c19208db5e, S_GLO_GithRaider_002_5dd3bb4a-97fa-48b6-9489-5cd577d217f2);
DB_PLA_GithChokepoint_ExtraConfrontationSpeakers(PLA_GithChokepoint_Confrontation_81aa25b6-850b-16bf-81c9-68c19208db5e, S_GLO_GithRaider_003_353152d2-d8c9-4257-bcba-4e682b4463df);
DB_PLA_GithChokepoint_ExtraConfrontationSpeakers(PLA_GithChokepoint_Confrontation_81aa25b6-850b-16bf-81c9-68c19208db5e, S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f);
DB_PLA_GithChokepoint_ExtraConfrontationSpeakers(PLA_GithChokepoint_ConfrontationLaezel_dfb80d70-8cfe-1a55-bae7-826f164def60, S_GLO_GithRaider_002_5dd3bb4a-97fa-48b6-9489-5cd577d217f2);
DB_PLA_GithChokepoint_ExtraConfrontationSpeakers(PLA_GithChokepoint_ConfrontationLaezel_dfb80d70-8cfe-1a55-bae7-826f164def60, S_GLO_GithRaider_003_353152d2-d8c9-4257-bcba-4e682b4463df);
DB_PLA_GithChokepoint_ExtraConfrontationSpeakers(PLA_GithChokepoint_ConfrontationLaezel_dfb80d70-8cfe-1a55-bae7-826f164def60, S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f);
DB_PLA_GithChokepoint_Confrontation(PLA_GithChokepoint_Confrontation_81aa25b6-850b-16bf-81c9-68c19208db5e, 0);
DB_PLA_GithChokepoint_Confrontation(PLA_GithChokepoint_OM_Laezel_AOM_OOM_af67b6d8-d1a0-61f9-e74b-a3535279cb94, 1);
DB_PLA_GithChokepoint_Confrontation(PLA_GithChokepoint_OM_Laezel_COM_f2710677-54ec-4c88-ea70-df755e0f730f, 1);
DB_PLA_GithChokepoint_Confrontation(PLA_GithChokepoint_ConfrontationLaezel_dfb80d70-8cfe-1a55-bae7-826f164def60, 1);
DB_DropMutingStatussesDialog(PLA_GithChokepoint_DragonEvent_3eb22b2c-bc59-03de-7a6e-68940620b16c);
DB_DialogBlockTradeButton(PLA_GithChokepoint_DragonEvent_3eb22b2c-bc59-03de-7a6e-68940620b16c);
DB_DialogBlockTradeButton(PLA_GithChokepoint_CINE_RiderAndDragonLeave_3ad8ad7a-b3f0-7537-3303-507dc8c3dfc4);
DB_GLO_Cinematic_PositionedDialog(PLA_GithChokepoint_DragonEvent_3eb22b2c-bc59-03de-7a6e-68940620b16c, "PLA_GithChokepoint_DragonEvent");
DB_GLO_Cinematic_PositionFlags("PLA_GithChokepoint_DragonEvent", S_PLA_GithFootbridgeBox_9c7ab7c2-85d0-40af-9b93-ac99c1e83371, PLA_GithChokepoint_Event_FootbridgePosition_8c8dd86f-07cb-4f97-b734-33d593b064d1);
DB_GLO_Cinematic_PositionFlags("PLA_GithChokepoint_DragonEvent", S_PLA_GithFeatherfallBox_cb46c6bc-6219-475f-806b-8b17c0f17fac, PLA_GithChokepoint_Event_FeatherfallPosition_a8778da0-4bd3-45c1-9da0-a0947bbb868c);
DB_GLO_Cinematic_PositionFlags("PLA_GithChokepoint_DragonEvent", S_PLA_GithSlopeBox_19249168-77a0-47e6-8a3a-8b37c1831a16, PLA_GithChokepoint_Event_SlopePosition_237f7d37-308f-4fbb-8cc2-36849b16536c);
DB_GLO_Cinematic_PositionFlags("PLA_GithChokepoint_DragonEvent", S_PLA_GithLadderTopBox_39d8ea17-5bb2-43c8-aeef-2e3bb4de00db, PLA_GithChokepoint_Event_LadderTopPosition_f42ee636-fb95-4873-8d99-c848def4ac44);
DB_Dialog_AddAllNearbyPlayersAtStart(GLO_GithChokepoint_PartyReaction_5dd64d54-c8f3-96f3-07c6-c39d85ffa5c0);
DB_Dialog_AddAllNearbyPlayersAtStart(PLA_PreGithChokepoint_WRD_Laezel_3c5e4463-ad9f-c79f-6167-7e0e4c4f45fa);
PROC_TriggerRegisterForPlayers(S_PLA_GithRaceCheckSphere_e92009dc-1d11-43ae-b15d-9afa61d21d35);
PROC_TriggerRegisterForPlayers(S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb);
PROC_TriggerRegisterForPlayers(S_PLA_DragonShadow_Box_38005c53-9dd1-4f79-8581-0a4f30370baf);
PROC_TriggerRegisterForPlayers(S_PLA_GithEventPoly_4f1d2ca3-8ebe-4ebd-a4e5-8e92944ff1d1);
PROC_TriggerRegisterForPlayers(S_PLA_GithChorpseSphere_84fce832-8d59-438f-a440-ab483c22d9e7);
PROC_TriggerRegisterForPlayers(S_PLA_GithKnight_SneakBox_c43fdf39-8d20-403d-aca1-ac993f8fb8d4);
PROC_TriggerRegisterForPlayers(S_PLA_GithChokepoint_OngoingSceneArea_6f67dee0-2720-4617-a263-68a58da5681c);
TriggerRegisterForCharacter(S_PLA_NPCInterruptionBox_198849d7-7f06-4520-a9e6-1ddedfe38660, S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6);
SetOnStage(S_PLA_DragonShadow_817589f4-8bda-49be-8567-57fe21374cf0, 0);
AddPreferredAiTargetTag(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, REALLY_GITHYANKI_e49c027c-6ec6-4158-9afb-8b59236d10fd);
PROC_SetCanFight(S_GLO_GithRaider_001_6b265792-c6ce-4eb0-94cd-a12b7bbe590d, 0);
SetCanJoinCombat(S_GLO_GithRaider_001_6b265792-c6ce-4eb0-94cd-a12b7bbe590d, 0);
SetHasDialog(S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, 0);
SetOnStage(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 0);
SetOnStage(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, 0);
DB_PLA_GithChokepoint_Gith(S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, S_PLA_GithRaiderCaptainPoint_d77e5bc2-a83f-4c87-9f4a-cc4bbbe92d63);
DB_PLA_GithChokepoint_Gith(S_GLO_GithRaider_001_6b265792-c6ce-4eb0-94cd-a12b7bbe590d, NULL_00000000-0000-0000-0000-000000000000);
DB_PLA_GithChokepoint_Gith(S_GLO_GithRaider_002_5dd3bb4a-97fa-48b6-9489-5cd577d217f2, S_PLA_GithRaiderPoint_002_717be1e7-b5b2-49ad-8a89-d1f93817e2b9);
DB_PLA_GithChokepoint_Gith(S_GLO_GithRaider_003_353152d2-d8c9-4257-bcba-4e682b4463df, S_PLA_GithRaiderPoint_003_2f7f60ad-957e-4111-a6f9-12e97adea67f);
DB_PLA_GithChokepoint_Fodder(S_PLA_GithFodder_001_ab8515a1-cd07-41ae-a5b4-cb50ffb9da4b, "c2ad8bad-d5fd-aa07-6af0-915b3dbe9526", "Main");
DB_PLA_GithChokepoint_Fodder(S_PLA_GithFodder_002_7d9d5ef6-da86-433c-8a53-adfeee5c56b8, "", "");
DB_PLA_GithChokepoint_Fodder(S_PLA_GithFodder_003_5d9c2cad-e4cc-4d10-9f00-265b930d7572, "", "");
DB_PLA_GithChokepoint_Fodder(S_PLA_GithFodder_004_f8b1afb2-f3f7-41a0-9ac4-a5a4585f569b, "", "");
DB_PLA_GithChokepoint_LevelRequirement("WLD_Main_A", 5);
DB_DropMutingStatussesDialog(GLO_GithChokepoint_PartyReaction_5dd64d54-c8f3-96f3-07c6-c39d85ffa5c0);
DB_DropMutingStatussesDialog(PLA_PreGithChokepoint_WRD_Laezel_3c5e4463-ad9f-c79f-6167-7e0e4c4f45fa);
DB_PLA_GithChokepoint_PreReaction_Slots(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 1);
DB_PLA_GithChokepoint_PreReaction_Slots(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, 2);
DB_PLA_GithChokepoint_PreReaction_Slots(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, 3);
DB_PLA_GithChokepoint_PreReaction_Slots(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, 4);
DB_Origin_TemporaryLeaveReason("LaezelRanToKnight");
PROC_DefineSingleOriginMoment(PLA_GithChokepoint_Confrontation_81aa25b6-850b-16bf-81c9-68c19208db5e, REALLY_LAEZEL_b5682d1d-c395-489c-9675-1f9b0c328ea5, PLA_GithChokepoint_OM_Laezel_AOM_OOM_af67b6d8-d1a0-61f9-e74b-a3535279cb94, PLA_GithChokepoint_OM_Laezel_COM_f2710677-54ec-4c88-ea70-df755e0f730f, PLA_GithChokepoint_OM_Laezel_AOM_OOM_af67b6d8-d1a0-61f9-e74b-a3535279cb94);
DB_PLA_GithChokepoint_OM(PLA_GithChokepoint_OM_Laezel_AOM_OOM_af67b6d8-d1a0-61f9-e74b-a3535279cb94);
DB_PLA_GithChokepoint_OM(PLA_GithChokepoint_OM_Laezel_COM_f2710677-54ec-4c88-ea70-df755e0f730f);
DB_OriginMoment_ExtraNPCs(PLA_GithChokepoint_OM_Laezel_AOM_OOM_af67b6d8-d1a0-61f9-e74b-a3535279cb94, S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259);
DB_OriginMoment_ExtraNPCs(PLA_GithChokepoint_OM_Laezel_AOM_OOM_af67b6d8-d1a0-61f9-e74b-a3535279cb94, S_GLO_GithRaider_002_5dd3bb4a-97fa-48b6-9489-5cd577d217f2);
DB_OriginMoment_ExtraNPCs(PLA_GithChokepoint_OM_Laezel_AOM_OOM_af67b6d8-d1a0-61f9-e74b-a3535279cb94, S_GLO_GithRaider_003_353152d2-d8c9-4257-bcba-4e682b4463df);
DB_OriginMoment_ExtraNPCs(PLA_GithChokepoint_OM_Laezel_AOM_OOM_af67b6d8-d1a0-61f9-e74b-a3535279cb94, S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f);
DB_OriginMoment_ExtraNPCs(PLA_GithChokepoint_OM_Laezel_COM_f2710677-54ec-4c88-ea70-df755e0f730f, S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259);
DB_OriginMoment_ExtraNPCs(PLA_GithChokepoint_OM_Laezel_COM_f2710677-54ec-4c88-ea70-df755e0f730f, S_GLO_GithRaider_002_5dd3bb4a-97fa-48b6-9489-5cd577d217f2);
DB_OriginMoment_ExtraNPCs(PLA_GithChokepoint_OM_Laezel_COM_f2710677-54ec-4c88-ea70-df755e0f730f, S_GLO_GithRaider_003_353152d2-d8c9-4257-bcba-4e682b4463df);
DB_OriginMoment_ExtraNPCs(PLA_GithChokepoint_OM_Laezel_COM_f2710677-54ec-4c88-ea70-df755e0f730f, S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f);
DB_QuestDef_State(GLO_GithChokepoint_Quest_GithLeave_8b2f94b5-9373-36ab-edfe-419764fbb85a, "HIDDEN_WLD_Boosters", "PLA_GithChokepoint_Fooled");
SetOnStage(S_PLA_ChokepointShield_2614ee9a-b62a-4bac-942c-526227c12690, 0);
DB_PLA_Orpheus_GithChokepoint_Confrontation(PLA_GithChokepoint_Confrontation_81aa25b6-850b-16bf-81c9-68c19208db5e);
DB_PLA_Orpheus_GithChokepoint_Confrontation(PLA_GithChokepoint_ConfrontationLaezel_dfb80d70-8cfe-1a55-bae7-826f164def60);
DB_PLA_GithChokepoint_ValidInterruptions("EnteredCombat");
DB_PLA_GithChokepoint_ValidInterruptions("Attacked");
DB_PLA_GithChokepoint_ValidInterruptions("Died");
PROC_PLA_GithChokepoint_Init();
DB_Origins_BlockTransferReasons("TurnedHostileAtChokepoint");
DB_AutoSaveTrigger(S_PLA_Gith_Autosave_e97285c9-d08a-464a-9e8b-98cb034d29a9);

KBSECTION
IF
TextEvent("interruptgc", _, _, _, _)
THEN
PROC_PLA_GithChokepoint_InterruptScene();

IF
TextEvent("plascoutimmortal", (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
GetTextEventParamInteger(1, _Var1, _Var1, _Var1, _Var1)
THEN
SetImmortal(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, _Var1);
PROC_SetInvulnerable(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, _Var1);

IF
TextEvent("plascouttogith", _, _, _, _)
THEN
SetOnStage(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, 1);
TeleportTo(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, S_PLA_GithWanderAnchor_4b1b348c-5c53-4ba3-ba1e-a632f6e6c92f);

IF
TextEvent("plagcinterrupt", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SceneInterrupted(S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, _Var1, "PLA_GithChokepoint", "Attacked");

IF
TextEvent("plagctotavern", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_OnlyOnce("GLO_GithChokepoint_DragonFlyOver");
DB_OnlyOnce("PLA_GithChokepoint_StartDragonScene");
PROC_PLA_GithChokepoint_MakeDragonLeave(0);
TeleportTo(_Var1, S_Debug_PlainsChokepoint_0667b0a8-c78e-4c72-9e7d-443df93682a9);

IF
TextEvent("plagctotavern", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_GithChokepoint_Gith(_Var1, _, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var1, S_Debug_PlainsChokepoint_0667b0a8-c78e-4c72-9e7d-443df93682a9);

IF
TextEvent("gcshadow", (REAL)_Var1, (REAL)_Var1, (REAL)_Var1, (REAL)_Var1)
AND
DB_PLA_GithChokepoint_Debug_Speed(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_PLA_GithChokepoint_Debug_Speed(_Var1);

IF
TextEvent("gcshadow", _, _, _, _)
THEN
NOT DB_PLA_GithChokepoint_Debug_DoFrightened(1);

IF
TextEvent("gcshadow", (REAL)_Var1, (REAL)_Var1, (REAL)_Var1, (REAL)_Var1)
AND
GetTextEventParamReal(1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_PLA_GithChokepoint_Debug_Speed(_Var1);

IF
TextEvent("gcshadow", _, _, _, _)
AND
GetTextEventParamInteger(2, 1, _, _, _)
THEN
DB_PLA_GithChokepoint_Debug_DoFrightened(1);

IF
TextEvent("gcshadow", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
StopAnimation(S_PLA_DragonShadow_817589f4-8bda-49be-8567-57fe21374cf0, 0);
PROC_PLA_GithChokepoint_Debug_CheckSpeed();
PROC_PLA_GithChokepoint_Debug_MoveShadow(_Var1);

PROC
PROC_PLA_GithChokepoint_Debug_CheckSpeed()
AND NOT
DB_PLA_GithChokepoint_Debug_Speed(_, _, _, _, _)
THEN
DB_PLA_GithChokepoint_Debug_Speed(12);

PROC
PROC_PLA_GithChokepoint_Debug_MoveShadow((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_GithChokepoint_Debug_Speed(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_PLA_GithChokepoint_Debug_Speed(_Var2);
PROC_GithChokepoint_DragonFlyOver(_Var2);

PROC
PROC_PLA_GithChokepoint_Debug_MoveShadow((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_GithChokepoint_Debug_DoFrightened(1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_OnlyOnce("PLA_GithChokepoint_DragonShadowVB");
NOT DB_PLA_GithChokepoint_Debug_DoFrightened(1);
PROC_PLA_GithChokepoint_InitFrightenedSavingThrow(_Var1);

IF
TextEvent("beargithchokepoint", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Is_WildShaped(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
ApplyStatus(_Var1, "WILDSHAPE_BEAR_POLAR_PLAYER", -1, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
TextEvent("wsgithchokepoint", _, _, _, _)
THEN
ApplyStatus(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "WILDSHAPE_BEAR_POLAR_PLAYER", -1, 1, NULL_00000000-0000-0000-0000-000000000000);
ApplyStatus(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "WILDSHAPE_WOLF_DIRE_PLAYER", -1, 1, NULL_00000000-0000-0000-0000-000000000000);
ApplyStatus(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, "WILDSHAPE_RAVEN_PLAYER", -1, 1, NULL_00000000-0000-0000-0000-000000000000);
ApplyStatus(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, "WILDSHAPE_DEEP_ROTHE_PLAYER", -1, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
FlagSet((FLAG)_Var1, (CHARACTER)_Var2, _, (FLAG)_Var1, (FLAG)_Var1)
AND
DB_Debug_CharacterAddFlags(_Var1, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _Var1, _Var1)
AND
DB_GlobalFlag(ORI_LaezelRecruitment_State_PlainsVersionInitiated_59bda4f5-708b-4f23-aaba-d5f387ae95c2, _Var1, _Var1, _Var1, _Var1)
THEN
ClearFlag(ORI_LaezelRecruitment_State_PlainsVersionInitiated_59bda4f5-708b-4f23-aaba-d5f387ae95c2, NULL_00000000-0000-0000-0000-000000000000);
ClearFlag(PLA_LaezelRecruitment_Event_NormalFlow_4c50a81b-38ac-4365-914e-64c19d3880b8);
TeleportTo(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var2);

IF
DB_PLA_GithChokepoint_Fodder(_Var1, _, _, _Var1, _Var1)
THEN
PROC_SetCanFight(_Var1, 0);
SetCanJoinCombat(_Var1, 0);
SetCanTrade(_Var1, 0);

PROC
PROC_PLA_GithChokepoint_Init()
AND
DB_PLA_GithChokepoint_Gith(_Var1, _, _Var1, _Var1, _Var1)
THEN
DB_GLO_DefeatCounter(_Var1, "PLA_GithChokepoint_DefeatCounter");
DB_SceneManager(_Var1, "PLA_GithChokepoint");
SetCanTrade(_Var1, 0);

PROC
PROC_PLA_GithChokepoint_Init()
AND
DB_PLA_GithChokepoint_Fodder(_Var1, _, _, _Var1, _Var1)
THEN
DB_SceneManager(_Var1, "PLA_GithChokepoint");

PROC
PROC_PLA_GithChokepoint_Init()
THEN
DB_SceneManager(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, "PLA_GithChokepoint");
DB_SceneManager(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, "PLA_GithChokepoint");
PROC_PLA_GithChokepoint_SetKeyCharImmortal(1);
SetCanTrade(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 0);

PROC
PROC_PLA_GithChokepoint_SetKeyCharImmortal((INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
THEN
SetImmortal(S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, _Var1);
SetImmortal(S_PLA_GithFodder_001_ab8515a1-cd07-41ae-a5b4-cb50ffb9da4b, _Var1);
PROC_SetInvulnerable(S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, _Var1);
PROC_SetInvulnerable(S_PLA_GithFodder_001_ab8515a1-cd07-41ae-a5b4-cb50ffb9da4b, _Var1);

IF
DB_PLA_GithChokepoint_Confrontation(_Var1, _, _Var1, _Var1, _Var1)
THEN
DB_DialogBlockTradeButton(_Var1);

IF
EnteredTrigger((GUIDSTRING)_Var1, S_PLA_DragonShadow_Box_38005c53-9dd1-4f79-8581-0a4f30370baf, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_GlobalFlag(GLO_GithChokepoint_DragonAppear_cf1be49e-50fb-b2e1-fa39-efbf7fdd4abf, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_OnlyOnce("PLA_GithChokepoint_StartDragonScene", _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("GLO_GithChokepoint_DragonFlyOver", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TriggerUnregisterForPlayers(S_PLA_DragonShadow_Box_38005c53-9dd1-4f79-8581-0a4f30370baf);
PROC_GithChokepoint_DragonFlyOver(12);
PROC_PLA_GithChokepoint_InitFrightenedSavingThrow(_Var1);

PROC
PROC_GithChokepoint_DragonFlyOver((REAL)_Var1, (REAL)_Var1, (REAL)_Var1, (REAL)_Var1, (REAL)_Var1)
THEN
SetFlag(PLA_GithChokepoint_Knows_SawDragonShadow_93c4f67f-2f8a-4556-bf66-de1645caedf9, NULL_00000000-0000-0000-0000-000000000000);
TriggerRegisterForItems(S_PLA_ScoutDragonDetectionBox_f3cde32c-792f-46e6-84f2-f1f2dc3f5870);
ObjectTimerLaunch(S_PLA_DragonShadow_817589f4-8bda-49be-8567-57fe21374cf0, "S_PLA_DragonShadow_PlaySound", 200, 0);

IF
ObjectTimerFinished(S_PLA_DragonShadow_817589f4-8bda-49be-8567-57fe21374cf0, "S_PLA_DragonShadow_PlaySound", _, _, _)
THEN
PlaySound(S_PLA_DragonShadow_817589f4-8bda-49be-8567-57fe21374cf0, "Dragon_Rig_DFLT_CUST_Fly_Over_01_Roar");

PROC
PROC_PLA_GithChokepoint_InitFrightenedSavingThrow((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PartyMembers(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_CantAct(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_IsInRange(_Var2, _Var1, 10, _Var1, _Var1)
THEN
PROC_PLA_GithChokepoint_DoFrightenedSavingThrow(_Var2);

PROC
PROC_PLA_GithChokepoint_DoFrightenedSavingThrow(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
THEN
SetFlag(ORI_Laezel_Quest_SawDragonRider_b82787bc-316b-417a-ae95-a1abc1f7116a, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
ObjectTimerLaunch(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "PLA_GithChokepoint_DragonShadowVBTimer", 1500);

PROC
PROC_PLA_GithChokepoint_DoFrightenedSavingThrow((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
_Var1 != S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12
AND
IsTagged(_Var1, REALLY_GITHYANKI_e49c027c-6ec6-4158-9afb-8b59236d10fd, _Var2, _Var1, _Var1)
AND
DB_Players(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
IsImmuneToStatusGroup(_Var1, "SG_Frightened", _Var3, 0, _Var1)
AND
QRY_OnlyOnce("PLA_GithChokepoint_FrightenedCheck", _Var1, _Var1, _Var1, _Var1)
THEN
RequestPassiveRoll(_Var1, S_PLA_DragonShadow_817589f4-8bda-49be-8567-57fe21374cf0, "SavingThrow", "Wisdom", DC_Legacy_15_bddbb9b8-a242-4c3e-a2eb-3fd274c0c539, _Var2, "PLA_GithChokepoint_FrightenedSV");

IF
RollResult("PLA_GithChokepoint_FrightenedSV", (CHARACTER)_Var1, S_PLA_DragonShadow_817589f4-8bda-49be-8567-57fe21374cf0, (INTEGER)_Var2, _, _, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
_Var2 != 1
THEN
PROC_PLA_GithChokepoint_ApplyFrightened(_Var1);

PROC
PROC_PLA_GithChokepoint_ApplyFrightened((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_Is_InCombat(_Var1, _, _Var1, _Var1, _Var1)
THEN
ApplyStatus(_Var1, "PLA_GITHCHOKEPOINT_FRIGHTENED", 4, 0, S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f);
SetFlag(PLA_GithChokepoint_State_FailedFrightenedSV_5023eadd-b2c2-61d8-9aac-51272b77ec18, _Var1);

PROC
PROC_PLA_GithChokepoint_ApplyFrightened((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Is_InCombat(_Var1, _, _Var1, _Var1, _Var1)
THEN
ApplyStatus(_Var1, "PLA_GITHCHOKEPOINT_FRIGHTENED", 2, 0, S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f);
SetFlag(PLA_GithChokepoint_State_FailedFrightenedSV_5023eadd-b2c2-61d8-9aac-51272b77ec18, _Var1);

IF
RollResult("PLA_GithChokepoint_FrightenedSV", (GUIDSTRING)_Var1, S_PLA_DragonShadow_817589f4-8bda-49be-8567-57fe21374cf0, _, _, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
ObjectTimerLaunch(_Var1, "PLA_GithChokepoint_DragonShadowVBTimer", 1500);

IF
ObjectTimerFinished((GUIDSTRING)_Var1, "PLA_GithChokepoint_DragonShadowVBTimer", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_CantTalk(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_GithChokepoint_DragonShadowVB", _Var1, _Var1, _Var1, _Var1)
THEN
StartVoiceBark(PLA_GithChokepoint_VB_DragonShadow_8da03e13-b4db-3bcf-f5d0-264d3edf11c9, _Var1);

IF
ItemEnteredTrigger(S_PLA_DragonShadow_817589f4-8bda-49be-8567-57fe21374cf0, S_PLA_ScoutDragonDetectionBox_f3cde32c-792f-46e6-84f2-f1f2dc3f5870, _, _, _)
AND
IsInTrigger(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, S_PLA_ScoutReactionSphere_1d08709b-706e-4136-8a7b-9de3371f573f, 1, _, _)
THEN
PROC_TryStartAD(PLA_GithChokepoint_AD_ScoutReactsToDragon_4dc8829a-4d30-f9f0-0034-3bf28ba64309, S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6);

IF
ItemEnteredTrigger(S_PLA_DragonShadow_817589f4-8bda-49be-8567-57fe21374cf0, S_PLA_ScoutDragonDetectionBox_f3cde32c-792f-46e6-84f2-f1f2dc3f5870, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
TriggerUnregisterForItems(S_PLA_ScoutDragonDetectionBox_f3cde32c-792f-46e6-84f2-f1f2dc3f5870);

IF
DialogStarted(PLA_GithChokepoint_TieflingScout_c7d900d8-9e51-740d-99b7-d8913d135c7d, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DialogGetInvolvedPlayer(_Var1, 1, _Var2, _Var1, _Var1)
THEN
PROC_GLO_GithChokepoint_CheckLevel(_Var2);

IF
EnteredTrigger(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, S_PLA_NPCInterruptionBox_198849d7-7f06-4520-a9e6-1ddedfe38660, _, _, _)
THEN
DB_PLA_GithChokepoint_ScoutMessesUpScene(1);
PROC_SceneInterrupted(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, NULL_00000000-0000-0000-0000-000000000000, "PLA_GithChokepoint", "PLA_GithChokepoint_ScoutPushedDown");
SetEntityEvent(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, "ClearCrimeReturn", 1);

QRY
QRY_CRIME_BlockRegisterCrime(_, _, _, S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, _)
AND
IsInTrigger(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, S_PLA_NPCInterruptionBox_198849d7-7f06-4520-a9e6-1ddedfe38660, 1, _, _)
THEN
SetEntityEvent(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, "ClearCrimeReturn", 1);

PROC
PROC_PLA_GithChokepoint_DragonSceneEnded()
THEN
PROC_PLA_GithChokepoint_CheckResolveScout();

PROC
PROC_PLA_GithChokepoint_CheckResolveScout()
AND
IsInTrigger(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, S_PLA_NPCInterruptionBox_198849d7-7f06-4520-a9e6-1ddedfe38660, 1, _, _)
THEN
PROC_PLA_GithChokepoint_ScoutTryLeaveCombat();
SetEntityEvent(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, "ClearCrimeReturn", 1);

PROC
PROC_PLA_GithChokepoint_CheckResolveScout()
AND NOT
DB_PLA_GithChokepoint_ScoutMessesUpScene(1, _, _, _, _)
THEN
PROC_PLA_GithChokepoint_ScoutTryLeaveCombat();
DB_OnlyOnce("PLA_ChokepointScout_Disappear");

IF
FlagSet(PLA_GithChokepoint_Event_AllGithsDefeated_b329e2d8-31c8-4861-ae87-224e86f51682, NULL_00000000-0000-0000-0000-000000000000, _, _, _)
AND
QRY_OnlyOnce("PLA_ChokepointScout_Disappear", _, _, _, _)
THEN
DB_NOOP(1);

IF
FlagSet(FactionHostileToPlayerGroupAfterDialog_d73ce44b-1b9a-2e02-f29a-d8e9e68c7edc, S_PLA_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, _, (INTEGER)_, (INTEGER)_)
THEN
DB_PLA_GithChokepoint_TieflingScout_AttackRequested(1);

IF
DB_OnDialogAttackRequested(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, _Var1, 0, _Var1, _Var1)
THEN
DB_PLA_GithChokepoint_TieflingScout_AttackRequested(1);

IF
DialogEnded(PLA_GithChokepoint_TieflingScout_c7d900d8-9e51-740d-99b7-d8913d135c7d, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND NOT
DB_HostileToPlayerGroupAfterDialog(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PLA_GithChokepoint_TieflingScout_AttackRequested(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_ChokepointScout_Disappear", _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_StateSet_Defeated(PLA_GithChokepoint_TieflingScout_c7d900d8-9e51-740d-99b7-d8913d135c7d, _, _, _, _)
AND
QRY_OnlyOnce("PLA_ChokepointScout_Disappear", _, _, _, _)
THEN
DB_NOOP(1);

IF
DB_OnlyOnce("PLA_ChokepointScout_Disappear", _, _, _, _)
AND NOT
DB_CantTalk(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, _, _, _, _)
AND NOT
DB_CantMove(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, _, _, _, _)
AND NOT
DB_EnterCombatRequested(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, _, _, _, _)
THEN
PROC_TryStartAD(PLA_GithChokepoint_AD_ScoutLeaves_031b4116-1e7d-712f-74b0-c6e4e8febb87, S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6);
PROC_SetCanFight(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, 0);
SetCanJoinCombat(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, 0);
PROC_DisappearOutOfSightTo(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, S_PLA_ScoutDisappearPoint_ab57d0ef-73a8-4d11-b15d-ead5f0ddf75d, "Run", 0, "");

PROC
PROC_PLA_GithChokepoint_ScoutTryLeaveCombat()
AND
DB_Is_InCombat(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, _, _, _, _)
THEN
PROC_SetCanFight(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, 0);
SetCanJoinCombat(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, 0);

PROC
PROC_PLA_GithChokepoint_DragonSceneEnded_NotifyScout()
AND
QRY_PLA_GithChokepoint_ScoutAtGith()
THEN
PROC_SceneInterrupted(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, NULL_00000000-0000-0000-0000-000000000000, "PLA_GithChokepoint", "PLA_GithChokepoint_ScoutPushedDown");

PROC
PROC_PLA_GithChokepoint_SetScoutHostile()
AND
QRY_PLA_GithChokepoint_ScoutAtGith()
THEN
NOT DB_OnlyOnce("PLA_ChokepointScout_Disappear");
PROC_SetCanFight(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, 1);
SetCanJoinCombat(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, 1);
SetFaction(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, ACT1_PLA_ChokepointScout_Hostile_80dd7a29-f7b2-495d-8f10-70868dcda4a7);
DB_GLO_DefeatCounter(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, "PLA_GithChokepoint_DefeatCounter");

QRY
QRY_PLA_GithChokepoint_ScoutAtGith()
AND NOT
DB_Defeated(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, _, _, _, _)
AND
IsInTrigger(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, S_PLA_NPCInterruptionBox_198849d7-7f06-4520-a9e6-1ddedfe38660, 1, _, _)
AND
IsOnStage(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, 1, _, _, _)
THEN
DB_NOOP(1);

IF
DB_InRegion(_Var1, S_PLA_GithEventPoly_4f1d2ca3-8ebe-4ebd-a4e5-8e92944ff1d1, _Var1, _Var1, _Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Defeated(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_GithChokepoint_CheckStartDragonScene(_Var1);

PROC
PROC_PLA_GithChokepoint_CheckStartDragonScene((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
QRY_OnlyOnce("PLA_GithChokepoint_StartDragonScene", _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(PLA_GithChokepoint_Knows_SawDragonShadow_93c4f67f-2f8a-4556-bf66-de1645caedf9, NULL_00000000-0000-0000-0000-000000000000);
SetFlag(PLA_GithChokepoint_Event_DragonEventStarts_046af9e7-4d1a-4a9b-80a9-826c171a25b0, NULL_00000000-0000-0000-0000-000000000000);
SetHasDialog(S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, 1);
PROC_TriggerUnregisterForPlayers(S_PLA_GithEventPoly_4f1d2ca3-8ebe-4ebd-a4e5-8e92944ff1d1);
TriggerUnregisterForCharacter(S_PLA_NPCInterruptionBox_198849d7-7f06-4520-a9e6-1ddedfe38660, S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6);
PROC_PLA_GithChokepoint_TriggeredScene(_Var1);

PROC
PROC_PLA_GithChokepoint_TriggeredScene((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
PROC_ForceStopDialog(_Var1);
PROC_PLA_GithChokepoint_SetKeyCharImmortal(0);
PROC_PLA_GithChokepoint_StartDragonScene(_Var1);

PROC
PROC_PLA_GithChokepoint_StartDragonScene(_, _, _, _, _)
AND
DB_PLA_GithChokepoint_Fodder(_Var2, _, _, _, _)
THEN
NOT DB_SceneManager(_Var2, "PLA_GithChokepoint");

PROC
PROC_PLA_GithChokepoint_StartDragonScene(_, _, _, _, _)
AND
DB_PLA_GithChokepoint_Gith(_Var2, _, _, _, _)
AND
DB_Is_InCombat(_Var2, _, _, _, _)
THEN
LeaveCombat(_Var2);

PROC
PROC_PLA_GithChokepoint_StartDragonScene((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
QRY_StartDialogCustom(PLA_GithChokepoint_DragonEvent_3eb22b2c-bc59-03de-7a6e-68940620b16c, S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, S_PLA_GithFodder_001_ab8515a1-cd07-41ae-a5b4-cb50ffb9da4b, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, _Var1, 0, 0, 0, 0)
THEN
PROC_PLA_GithChokepoint_DragonSceneFailed();

PROC
PROC_PLA_GithChokepoint_StartDragonScene(_, (CHARACTER)_, (CHARACTER)_, (CHARACTER)_, (CHARACTER)_)
THEN
TriggerLaunchIterator(S_PLA_GithBridgeOnBox_cacfc8c6-ecb1-46c6-9163-e8307ed3aa63, "PLA_GithChokepoint_OnBridge", "");

IF
EntityEvent((GUIDSTRING)_Var1, "PLA_GithChokepoint_OnBridge", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_PLA_GithChokepoint_Fodder(_Var1, _, _, _Var1, _Var1)
AND NOT
DB_PLA_GithChokepoint_Gith(_Var1, _, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var1, S_PLA_GithBridgeOutPoint_4e9c6115-836d-44c4-b0cb-bcf1f553443a, "");

PROC
PROC_StartDialog_AddExtraSpeakers(PLA_GithChokepoint_DragonEvent_3eb22b2c-bc59-03de-7a6e-68940620b16c, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_GLO_GithRaider_002_5dd3bb4a-97fa-48b6-9489-5cd577d217f2);
PROC_DialogAddSpeakingActor(_Var1, S_GLO_GithRaider_003_353152d2-d8c9-4257-bcba-4e682b4463df);
PROC_DialogAddSpeakingActor(_Var1, S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea);
PROC_DialogAddSpeakingActor(_Var1, S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f);
PROC_PLA_GithChokepoint_DragonSceneStarted();

IF
DialogActorJoined(PLA_GithChokepoint_DragonEvent_3eb22b2c-bc59-03de-7a6e-68940620b16c, (INTEGER)_Var1, (GUIDSTRING)_Var2, _, (INTEGER)_Var1)
AND
DB_PartyMembers(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_GithChokepoint_DragonSceneStarted", _Var1, _Var1, _Var1, _Var1)
THEN
DB_PLA_GithChokepoint_AddOtherPlayers(PLA_GithChokepoint_DragonEvent_3eb22b2c-bc59-03de-7a6e-68940620b16c);
DB_AddCharactersInTriggerToDialog(PLA_GithChokepoint_DragonEvent_3eb22b2c-bc59-03de-7a6e-68940620b16c, S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb, 1, 1, 1);

PROC
PROC_PLA_GithChokepoint_DragonSceneStarted()
THEN
PROC_PLA_LaezelRecruit_DragonSceneStarted();

PROC
PROC_PLA_GithChokepoint_DragonSceneStarted()
AND
DB_PLA_GithChokepoint_Gith(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
_Var2 != NULL_00000000-0000-0000-0000-000000000000
THEN
TeleportTo(_Var1, _Var2, "");

PROC
PROC_PLA_GithChokepoint_DragonSceneStarted()
AND
DB_PLA_GithChokepoint_Fodder(_Var1, "", "", _Var1, _Var1)
THEN
SetDetached(_Var1, 1);
TeleportTo(_Var1, S_PLA_GithBridgeOutPoint_4e9c6115-836d-44c4-b0cb-bcf1f553443a, "");

IF
DialogStarted(PLA_GithChokepoint_DragonEvent_3eb22b2c-bc59-03de-7a6e-68940620b16c, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
DestroyPlatform(S_PLA_GithChokepointBridge_PLT_67721125-597f-4cc8-a8a5-5ffaaf5d44d7);

PROC
PROC_PLA_GithChokepoint_DragonSceneFailed()
THEN
PROC_PLA_GithChokepoint_DragonSceneStarted();
PROC_PLA_GithChokepoint_DragonSceneEnded();

IF
FlagSet(GLO_GithChokepoint_DragonAppear_cf1be49e-50fb-b2e1-fa39-efbf7fdd4abf, _, (INTEGER)_Var2, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
DB_NOOP(1);

IF
DialogEnded(PLA_GithChokepoint_DragonEvent_3eb22b2c-bc59-03de-7a6e-68940620b16c, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_PLA_GithChokepoint_DragonSceneEnded();

PROC
PROC_PLA_GithChokepoint_DragonSceneEnded()
AND
QRY_OnlyOnce("PLA_GithChokepoint_DragonSceneEnded_Cleanup2", _, _, _, _)
THEN
PROC_SetOnStage(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 1);
PROC_SetOnStage(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, 1);
SetImmortal(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 1);
SetImmortal(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, 1);
PROC_SetInvulnerable(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 1);
PROC_SetInvulnerable(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, 1);
TriggerLaunchIterator(S_PLA_GithCollapsedBridgeOnBox_f5ed7468-b5d2-4138-9a13-963757256477, "PLA_GithChokepoint_OnCollapsedBridge", "");
TriggerLaunchIterator(S_PLA_GithCollapsedBridgeOnVoidBox_a392fd55-153c-4a8d-bf58-889fc0a65c74, "PLA_GithChokepoint_OnCollapsedBridge", "");

IF
LeftLevel(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, "WLD_Main_A", _, _, _)
AND
IsImmortal(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 1, _, _, _)
THEN
SetImmortal(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 0);
PROC_SetInvulnerable(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 0);

IF
LeftLevel(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, "WLD_Main_A", _, _, _)
AND
IsImmortal(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, 1, _, _, _)
THEN
SetImmortal(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, 0);
PROC_SetInvulnerable(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, 0);

IF
EntityEvent((GUIDSTRING)_Var1, "PLA_GithChokepoint_OnCollapsedBridge", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
TeleportTo(_Var1, S_PLA_GithCollapsedDeathEdgeCasePoint_d9e96cbe-db24-40d7-9c85-fa095154777a, "");

IF
EntityEvent((CHARACTER)_Var1, "PLA_GithChokepoint_OnCollapsedBridge", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
Die(_Var1, 0, S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 0, 1);

IF
EntityEvent((CHARACTER)_Var1, "PLA_GithChokepoint_OnCollapsedBridge", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
Die(_Var1, 0, NULL_00000000-0000-0000-0000-000000000000, 1, 1);

PROC
PROC_PLA_GithChokepoint_DragonSceneEnded()
AND
QRY_OnlyOnce("PLA_GithChokepoint_DragonSceneEnded_Cleanup1", _, _, _, _)
THEN
SetFlag(GLO_GithChokepoint_DragonEventEnd_ded1de27-9668-418f-93f6-4b5a789b5640, NULL_00000000-0000-0000-0000-000000000000, 0);
Die(S_PLA_GithBridgeCollapsedHelper_a777c47b-b54e-4286-93c7-72c1fc5b5828);
PROC_PLA_GithChokepoint_KillFodderAndBridge();
NOT DB_OnlyOnce("PLA_GithChokepoint_InterruptedScene");
DB_SceneTriggerManager("PLA_GithChokepoint", S_PLA_ChokepointConfrontSceneBox_00cb3901-cdb0-4505-bffb-6b24390db71b);
PROC_TriggerRegisterForPlayers(S_PLA_ChokepointConfrontSceneBox_00cb3901-cdb0-4505-bffb-6b24390db71b);
PROC_PLA_GithChokepoint_DragonSceneEnded_NotifyScout();

PROC
PROC_PLA_GithChokepoint_KillFodderAndBridge()
AND
DB_PLA_GithChokepoint_Fodder(_Var1, _, _, _Var1, _Var1)
THEN
TeleportTo(_Var1, S_PLA_GithFodderTPTrigger_234397bb-f6f8-4880-82fd-6450f3a7091c, "");
SetOnStage(_Var1, 0);

PROC
PROC_PLA_GithChokepoint_KillFodderAndBridge()
THEN
DestroyPlatform(S_PLA_GithChokepointBridge_PLT_67721125-597f-4cc8-a8a5-5ffaaf5d44d7);

IF
DialogEnded(PLA_GithChokepoint_DragonEvent_3eb22b2c-bc59-03de-7a6e-68940620b16c, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_DialogPlayers(_Var1, _Var2, _, _Var1, _Var1)
THEN
DB_PLA_GithChokepoint_PlayersInDragonEventDialog(_Var2);

IF
DialogEnded(PLA_GithChokepoint_DragonEvent_3eb22b2c-bc59-03de-7a6e-68940620b16c, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND NOT
QRY_PLA_GithChokepoint_SkipReaction()
AND
DialogGetInvolvedPlayer(_Var1, 1, _Var2, _Var1, _Var1)
AND
QRY_GithChokepoint_SetHookPlayer(_Var2, S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb, _Var1, _Var1, _Var1)
THEN
TimerLaunch("GLO_GithChokepoint_PlayerReaction_Timer", 200);

QRY
QRY_PLA_GithChokepoint_SkipReaction()
AND
DB_PLA_GithChokepoint_ScoutMessesUpScene(1, _, _, _, _)
THEN
PROC_PLA_GithChokepoint_ClearFading();
PROC_PLA_LaezelRecruit_ReactionEnded();

PROC
PROC_PLA_GithChokepoint_ClearFading()
AND
DB_PLA_GithChokepoint_PlayersInDragonEventDialog(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_PLA_GithChokepoint_PlayersInDragonEventDialog(_Var1);
PROC_ClearScreenFadeTimeline(_Var1, 0.5);

QRY
QRY_GithChokepoint_SetHookPlayer((GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_CantAct(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_GLO_GithChokepoint_PlayerReaction(_Var1);

QRY
QRY_GithChokepoint_SetHookPlayer((CHARACTER)_Var1, (TRIGGER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_GLO_GithChokepoint_PlayerReaction(_, _Var1, _Var1, _Var1, _Var1)
AND
QRY_GetBestAvatarForCompanion(_Var1, 1, 0, _Var1, _Var1)
AND
DB_QRYRTN_GetBestAvatarForCompanion(_Var1, _Var4, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var4, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_CantAct(_Var4, _Var1, _Var1, _Var1, _Var1)
THEN
DB_GLO_GithChokepoint_PlayerReaction(_Var4);

QRY
QRY_GithChokepoint_SetHookPlayer(_, (TRIGGER)_Var2, _, _, _)
AND NOT
DB_GLO_GithChokepoint_PlayerReaction(_, _, _, _, _)
AND
DB_Avatars(_Var4, _, _, _, _)
AND NOT
DB_GLO_GithChokepoint_PlayerReaction(_, _, _, _, _)
AND
DB_InRegion(_Var4, _Var2, _, _, _)
AND NOT
DB_CantAct(_Var4, _, _, _, _)
THEN
DB_GLO_GithChokepoint_PlayerReaction(_Var4);

QRY
QRY_GithChokepoint_SetHookPlayer((CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_GLO_GithChokepoint_PlayerReaction(_, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_CantAct(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_GLO_GithChokepoint_PlayerReaction(_Var1);

QRY
QRY_GithChokepoint_SetHookPlayer((CHARACTER)_Var1, (TRIGGER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_GLO_GithChokepoint_PlayerReaction(_, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var4, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GLO_GithChokepoint_PlayerReaction(_, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var4, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_CantAct(_Var4, _Var1, _Var1, _Var1, _Var1)
THEN
DB_GLO_GithChokepoint_PlayerReaction(_Var4);

IF
TimerFinished("GLO_GithChokepoint_PlayerReaction_Timer", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GLO_GithChokepoint_PlayerReaction(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GLO_GithChokepoint_CheckLevel(_Var1);
PROC_GLO_GithChokepoint_CompanionReactionDialog(_Var1);
NOT DB_GLO_GithChokepoint_PlayerReaction(_Var1);

PROC
PROC_GLO_GithChokepoint_CheckLevel((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_CurrentLevel(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_GithChokepoint_LevelRequirement(_Var2, _Var3, _Var1, _Var1, _Var1)
AND
GetLevel(_Var1, _Var4, _Var1, _Var1, _Var1)
AND
_Var4 >= _Var3
AND
SysCount("DB_Players", 1, _Var5, _Var1, _Var1)
AND
_Var5 >= 3
THEN
SetFlag(GLO_GithChokepoint_State_MeetsLevel_a57d969d-dbb0-246e-c97a-7d2d0a9d77b2, NULL_00000000-0000-0000-0000-000000000000, 0);

PROC
PROC_GLO_GithChokepoint_CompanionReactionDialog((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
_Var1 != S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12
AND
DB_Players(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Avatars(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailableAndInDialogRange(_Var1, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 0, 1, _Var1)
AND
QRY_OnlyOnce("PLA_GithChokepoint_PlayerReaction_OnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GLO_GithChokepoint_CompanionReactionDialog(_Var1, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);

PROC
PROC_GLO_GithChokepoint_CompanionReactionDialog((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_OnlyOnce("PLA_GithChokepoint_PlayerReaction_OnlyOnce", _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != _Var2
AND NOT
DB_Avatars(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
IsTagged(_Var2, REALLY_GITHYANKI_e49c027c-6ec6-4158-9afb-8b59236d10fd, 1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailableAndInDialogRange(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_GithChokepoint_PlayerReaction_OnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GLO_GithChokepoint_CompanionReactionDialog(_Var1, _Var2);

PROC
PROC_GLO_GithChokepoint_CompanionReactionDialog((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_OnlyOnce("PLA_GithChokepoint_PlayerReaction_OnlyOnce", _Var1, _Var1, _Var1, _Var1)
AND
QRY_PLA_GithChokepoint_FindCompanionReactionCompanion(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_QRYRTN_PLA_GithChokepoint_FindCompanionReactionCompanion(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_GithChokepoint_PlayerReaction_OnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GLO_GithChokepoint_CompanionReactionDialog(_Var1, _Var2);

QRY
QRY_PLA_GithChokepoint_FindCompanionReactionCompanion((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_GithChokepoint_PreReaction_Slots(_Var2, _Var3, _Var1, _Var1, _Var1)
AND
_Var1 != _Var2
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Avatars(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailableAndInDialogRange(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
QRY_PLA_GithChokepoint_PreReaction_IsBetterCompanionReactionCompanion(_Var2, _Var3, _Var1, _Var1, _Var1)
THEN
DB_QRYRTN_PLA_GithChokepoint_FindCompanionReactionCompanion(_Var2);

QRY
QRY_PLA_GithChokepoint_PreReaction_IsBetterCompanionReactionCompanion(_, _, _, _, _)
AND NOT
DB_QRYRTN_PLA_GithChokepoint_FindCompanionReactionCompanion(_, _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_PLA_GithChokepoint_PreReaction_IsBetterCompanionReactionCompanion((CHARACTER)_Var1, (INTEGER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_QRYRTN_PLA_GithChokepoint_FindCompanionReactionCompanion(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_GithChokepoint_PreReaction_Slots(_Var3, _Var4, _Var1, _Var1, _Var1)
AND
_Var2 < _Var4
THEN
NOT DB_PLA_GithChokepoint_PreReaction_Slots(_Var3, _Var4);

PROC
PROC_GLO_GithChokepoint_CompanionReactionDialog((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_OnlyOnce("PLA_GithChokepoint_PlayerReaction_OnlyOnce", _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != _Var2
AND NOT
DB_PLA_GithChokepoint_PreReaction_Slots(_Var2, _, _Var1, _Var1, _Var1)
AND NOT
DB_Avatars(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailableAndInDialogRange(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_GithChokepoint_PlayerReaction_OnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GLO_GithChokepoint_CompanionReactionDialog(_Var1, _Var2);

PROC
PROC_GLO_GithChokepoint_CompanionReactionDialog((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_OnlyOnce("PLA_GithChokepoint_PlayerReaction_OnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(PLA_GithChokepoint_Event_SoloReaction_5065f076-bc0e-4b89-a058-d36b5c9d3eaf, NULL_00000000-0000-0000-0000-000000000000);
PROC_GLO_GithChokepoint_CompanionReactionDialog(_Var1, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_GLO_GithChokepoint_CompanionReactionDialog((CHARACTER)_Var1, NULL_00000000-0000-0000-0000-000000000000, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
QRY_StartDialogCustom(GLO_GithChokepoint_PartyReaction_5dd64d54-c8f3-96f3-07c6-c39d85ffa5c0, _Var1, NULL_00000000-0000-0000-0000-000000000000, 0, 0, 1, 0, _Var1, _Var1, _Var1)
THEN
PROC_PLA_LaezelRecruit_ReactionEnded();

PROC
PROC_GLO_GithChokepoint_CompanionReactionDialog((CHARACTER)_Var1, (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
_Var2 != NULL_00000000-0000-0000-0000-000000000000
AND
_Var2 != S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12
AND NOT
QRY_StartDialogCustom(GLO_GithChokepoint_PartyReaction_5dd64d54-c8f3-96f3-07c6-c39d85ffa5c0, _Var2, _Var1, 0, 0, 1, 0, _Var1, _Var1, _Var1)
THEN
PROC_PLA_LaezelRecruit_ReactionEnded();

IF
DialogEnded(GLO_GithChokepoint_PartyReaction_5dd64d54-c8f3-96f3-07c6-c39d85ffa5c0, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_PLA_LaezelRecruit_ReactionEnded();

PROC
PROC_PLA_LaezelRecruit_ReactionEnded()
THEN
DB_NOOP(1);

PROC
PROC_GLO_GithChokepoint_CompanionReactionDialog((GUIDSTRING)_Var1, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
QRY_StartDialog_Fixed(PLA_PreGithChokepoint_WRD_Laezel_3c5e4463-ad9f-c79f-6167-7e0e4c4f45fa, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
DialogEnded(PLA_PreGithChokepoint_WRD_Laezel_3c5e4463-ad9f-c79f-6167-7e0e4c4f45fa, _, _, _, _)
AND
QRY_GetBestAvatarForCompanion(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
DB_QRYRTN_GetBestAvatarForCompanion(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var2, _, _, _)
THEN
DB_GLO_PartyMembers_BlockReturnToRecruitmentPosition(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
DB_CompanionLeaving(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var2);
PROC_Origins_CompanionLeavePermanently(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "LaezelRanToKnight");
DB_PLA_GithChokepoint_LaezelIsWithKnight(_Var2);
SetFlag(PLA_GithChokepoint_Event_LaezelLeftParty_7bdf419f-d3d5-48bb-a6ed-636afc48f50a, NULL_00000000-0000-0000-0000-000000000000);
PROC_TriggerRegisterForPlayers(S_PLA_ChokepointAbandonVBSphere_a7512987-5a65-47f7-a4f5-b2d58762fe0f);
TriggerRegisterForCharacter(S_PLA_ChokepointLaezelADArea_b0ef4dd5-b22a-43cd-8129-ad52b532eba1, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
PROC_PLA_GithChokepoint_LaezelRunToKnight(_Var2);

IF
EnteredTrigger(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_PLA_ChokepointLaezelADArea_b0ef4dd5-b22a-43cd-8129-ad52b532eba1, _, _, _)
THEN
TriggerUnregisterForCharacter(S_PLA_ChokepointLaezelADArea_b0ef4dd5-b22a-43cd-8129-ad52b532eba1, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
PROC_TryStartAD(PLA_GithChokepoint_AD_LaezelRunsToKnight_b461e25a-f0cb-909d-d0be-f196ba5e54fa, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);

QRY
QRY_CRA_LaezelRecruit_BlockCRAVersion()
AND NOT
DB_GlobalFlag(PLA_GithChokepoint_State_SceneDone_2fa4006f-12e5-4666-931b-e31dee737f2f, _, _, _, _)
AND
IsInTrigger(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_PLA_LaezelChokepointProxSphere_62e2c26f-1019-4289-b377-ff36d02e5772, 1, _, _)
THEN
PROC_PLA_LaezelRecruit_MergeIntoPLAVersion();

IF
Resurrected(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
DB_GlobalFlag(ORI_LaezelRecruitment_State_ChapelVersionInitiated_e6015bdf-276e-47b2-9a43-9bc0c981e1ad, _, _, _, _)
AND NOT
DB_Players(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND NOT
DB_GlobalFlag(PLA_GithChokepoint_State_SceneDone_2fa4006f-12e5-4666-931b-e31dee737f2f, _, _, _, _)
AND
IsInTrigger(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_PLA_LaezelChokepointProxSphere_62e2c26f-1019-4289-b377-ff36d02e5772, 1, _, _)
THEN
PROC_PLA_LaezelRecruit_MergeIntoPLAVersion();

PROC
PROC_PLA_LaezelRecruit_MergeIntoPLAVersion()
AND NOT
DB_GlobalFlag(ORI_LaezelRecruitment_State_PlainsVersionInitiated_59bda4f5-708b-4f23-aaba-d5f387ae95c2, _, _, _, _)
THEN
PROC_CRA_LaezelRecruit_EndCrashVersion();
PROC_TriggerUnregisterForPlayers(S_PLA_UpdateLaezelRecruitBox_1a1deda3-7203-4e57-a017-7ccb1c6ed181);
PROC_GlobalSetFlagAndCache(ORI_LaezelRecruitment_State_PlainsVersionInitiated_59bda4f5-708b-4f23-aaba-d5f387ae95c2);
SetFlag(ORI_LaezelRecruitment_State_ResurrectedAtChokepoint_244e5e8c-849c-4a93-a129-4da54d32f779, NULL_00000000-0000-0000-0000-000000000000);

IF
DB_InRegion(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_PLA_NPCInterruptionBox_198849d7-7f06-4520-a9e6-1ddedfe38660, _, _, _)
AND NOT
DB_Players(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND NOT
DB_Defeated(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
THEN
TriggerUnregisterForCharacter(S_PLA_NPCInterruptionBox_198849d7-7f06-4520-a9e6-1ddedfe38660, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
PROC_SceneInterrupted(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, NULL_00000000-0000-0000-0000-000000000000, "PLA_GithChokepoint", "PLA_GithChokepoint_LaezelResurrected");

PROC
PROC_PLA_LaezelRecruit_ReAddFailed((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
SetFlag(PLA_GithChokepoint_State_LaezelFailedJoinFullParty_194dbfd6-8702-4c41-aa43-4ad438048401, NULL_00000000-0000-0000-0000-000000000000);
SetFlag(ORI_LaezelRecruitment_State_PlainsVersionInitiated_59bda4f5-708b-4f23-aaba-d5f387ae95c2, NULL_00000000-0000-0000-0000-000000000000);
PROC_PLA_LaezelRecruit_SetSecondRecruitmentDialog();

IF
EnteredTrigger((CHARACTER)_Var1, S_PLA_UpdateLaezelRecruitBox_1a1deda3-7203-4e57-a017-7ccb1c6ed181, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(ORI_LaezelRecruitment_State_PlainsVersionInitiated_59bda4f5-708b-4f23-aaba-d5f387ae95c2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_PLA_LaezelRecruit_TryResolvePreviousRecruitment()
THEN
PROC_PLA_LaezelRecruit_CheckPrepSecondRecruitment();

QRY
QRY_PLA_LaezelRecruit_TryResolvePreviousRecruitment()
AND
DB_GlobalFlag(ORI_LaezelRecruitment_State_CrashVersionInitiated_a80f2bd8-ffa1-4065-a92a-d01d59907637, _, _, _, _)
AND
DB_GlobalFlag(ORI_LaezelRecruitment_Event_CrashVersionDone_df73c46d-ed94-47de-be8b-36df1dbd973f, _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_PLA_LaezelRecruit_TryResolvePreviousRecruitment()
AND
DB_GlobalFlag(ORI_LaezelRecruitment_State_ChapelVersionInitiated_e6015bdf-276e-47b2-9a43-9bc0c981e1ad, _, _, _, _)
AND
DB_GlobalFlag(CHA_LaezelTieflings_State_SceneOver_b6fcc020-c718-45d3-964d-2099f95a70c1, _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_PLA_LaezelRecruit_TryResolvePreviousRecruitment()
AND
DB_GlobalFlag(ORI_LaezelRecruitment_State_ChapelVersionInitiated_e6015bdf-276e-47b2-9a43-9bc0c981e1ad, _, _, _, _)
AND NOT
DB_GlobalFlag(CHA_LaezelTieflings_State_SceneOver_b6fcc020-c718-45d3-964d-2099f95a70c1, _, _, _, _)
AND NOT
QRY_CHA_LaezelRecruit_PlayersRemaining()
THEN
PROC_CHA_LaezelRecruit_ResolveScene();

PROC
PROC_PLA_LaezelRecruit_CheckPrepSecondRecruitment()
AND NOT
DB_IronFlasked(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND NOT
DB_PartOfTheTeam(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
IsPlayer(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 0, _, _, _)
AND
IsDead(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 0, _, _, _)
AND
GetFlag(ORI_LaezelRecruitment_Event_InvitedToCamp_5ac352a5-58c2-a8ed-1957-199d8bc284da, NULL_00000000-0000-0000-0000-000000000000, 0, _, _)
THEN
PROC_TriggerUnregisterForPlayers(S_PLA_UpdateLaezelRecruitBox_1a1deda3-7203-4e57-a017-7ccb1c6ed181);
PROC_GlobalSetFlagAndCache(ORI_LaezelRecruitment_State_PlainsVersionInitiated_59bda4f5-708b-4f23-aaba-d5f387ae95c2);
PROC_PLA_LaezelRecruit_SetSecondRecruitmentDialog();
PROC_PLA_LaezelRecruit_PrepSecondRecruitment();
PROC_PLA_LaezelRecruit_GiveNewEquipment();

PROC
PROC_PLA_LaezelRecruit_SetSecondRecruitmentDialog()
THEN
PROC_GLO_Origins_SetRecruitmentDialog(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, Laezel_Recruitment_Plains_962cb218-6f76-a571-02c0-28070bd09fed);

PROC
PROC_PLA_LaezelRecruit_PrepSecondRecruitment()
THEN
TeleportTo(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_PLA_LaezelRunStartPoint_7e9f70e8-a0f4-4d31-a878-873f90ede4eb);
SetOnStage(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 0);
SetLevel(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 4);
RemoveHarmfulStatuses(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
PROC_GlobalSetFlagAndCache(PLA_LaezelRecruitment_Event_NormalFlow_4c50a81b-38ac-4365-914e-64c19d3880b8);

PROC
PROC_PLA_LaezelRecruit_GiveNewEquipment()
AND NOT
GetEquippedItem(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "Breast", _, _, _)
AND
CreateAtObject(ARM_Hide_b78fabcc-d2df-4c74-b5d4-1eda6dc4c071, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 0, 0, "", 0, _Var2, _, _, _)
THEN
Equip(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var2, 1, 0, 1);

PROC
PROC_PLA_LaezelRecruit_GiveNewEquipment()
AND NOT
GetEquippedWeapon(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
CreateAtObject(WPN_GOB_Scimitar_A_288356cc-0c6b-43c1-b049-dde418faf1f2, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 0, 0, "", 0, _Var2, _, _, _)
THEN
Equip(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var2, 1, 0, 1);

PROC
PROC_PLA_LaezelRecruit_DragonSceneStarted()
AND
DB_GlobalFlag(PLA_LaezelRecruitment_Event_NormalFlow_4c50a81b-38ac-4365-914e-64c19d3880b8, _, _, _, _)
THEN
TeleportTo(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_PLA_LaezelRunStartPoint_7e9f70e8-a0f4-4d31-a878-873f90ede4eb);
SetOnStage(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 1);

PROC
PROC_PLA_LaezelRecruit_ReactionEnded()
AND
DB_GlobalFlag(PLA_LaezelRecruitment_Event_NormalFlow_4c50a81b-38ac-4365-914e-64c19d3880b8, _, _, _, _)
THEN
TriggerRegisterForCharacter(S_PLA_LaezelRunningADBox_03ec992f-6384-42df-a1df-a08b100bbb9f, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
DB_PLA_GithChokepoint_RunningToKnight(1);
PROC_PLA_GithChokepoint_LaezelRunToKnight(NULL_00000000-0000-0000-0000-000000000000);

IF
EnteredTrigger(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_PLA_LaezelRunningADBox_03ec992f-6384-42df-a1df-a08b100bbb9f, _, _, _)
AND
DB_MovingTo(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_PLA_LaezelRecruitPoint_9f9daa3c-b446-4d03-a2a1-0a9383adccbe, _, _Var2, _)
THEN
TriggerUnregisterForCharacter(S_PLA_LaezelRunningADBox_03ec992f-6384-42df-a1df-a08b100bbb9f, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
PROC_TryStartAD(PLA_GithChokepoint_AD_LaezelRunsToKnight_b461e25a-f0cb-909d-d0be-f196ba5e54fa, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);

PROC
PROC_ClearStoryMove(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
DB_PLA_GithChokepoint_RunningToKnight(1, _, _, _, _)
THEN
NOT DB_PLA_GithChokepoint_RunningToKnight(1);
TriggerUnregisterForCharacter(S_PLA_LaezelRunningADBox_03ec992f-6384-42df-a1df-a08b100bbb9f, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);

IF
EntityEvent(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "GLO_GithChokepoint_LaezelRanUpToKnight", _, _, _)
THEN
TriggerUnregisterForCharacter(S_PLA_LaezelRunningADBox_03ec992f-6384-42df-a1df-a08b100bbb9f, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);

QRY
QRY_PLA_GithChokepoint_StartConfrontationLaezel((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_PLA_LaezelRecruit_IsAtPlains()
AND
QRY_StartDialogCustom(PLA_GithChokepoint_ConfrontationLaezel_dfb80d70-8cfe-1a55-bae7-826f164def60, S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_LaezelRecruit_SetSecondRecruitmentDialog();

PROC
PROC_PLA_LaezelRecruit_CheckStartReaction()
THEN
ObjectTimerLaunch(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "PLA_LaezelRecruit_ChokepointReaction", 1500);

IF
ObjectTimerFinished(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "PLA_LaezelRecruit_ChokepointReaction", _, _, _)
AND
QRY_PLA_LaezelRecruit_IsAtPlains()
THEN
SetFlag(ORI_Laezel_State_NPCLaezelAtGithChokepoint_52bc45fb-11c3-44fc-82be-679be13d3f81);
PROC_TryStartAD(PLA_GithChokepoint_AD_LaezelPostConfrontation_d48b01a4-30b8-fb22-84e2-5eee99e864df, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);

QRY
QRY_PLA_LaezelRecruit_IsAtPlains()
AND
DB_GlobalFlag(ORI_LaezelRecruitment_State_PlainsVersionInitiated_59bda4f5-708b-4f23-aaba-d5f387ae95c2, _, _, _, _)
AND NOT
DB_Defeated(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
IsInTrigger(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_PLA_GithRaceCheckSphere_e92009dc-1d11-43ae-b15d-9afa61d21d35, 1, _, _)
THEN
DB_NOOP(1);

IF
FlagSet(OriginAddToParty_4870b2cd-210c-0fdc-9c58-4d0142bdae29, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_DialogName(Laezel_Recruitment_Plains_962cb218-6f76-a571-02c0-28070bd09fed, _Var1, _Var1, _Var1, _Var1)
AND
DB_DialogPlayers(_Var1, _Var2, 1, _Var1, _Var1)
AND
GetFlag(PLA_GithChokepoint_State_LetLaezelSpeak_f0c1618b-fc4a-fe1c-75ab-1dffc21eee28, _Var2, 1, _Var1, _Var1)
AND
ChangeApprovalRating(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var2, 0, 5, _)
THEN
DB_NOOP(1);

PROC
PROC_PLA_GithChokepoint_LaezelRunToKnight(_, (CHARACTER)_, (CHARACTER)_, (CHARACTER)_, (CHARACTER)_)
THEN
DB_SceneManager(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "PLA_GithChokepoint");
SetFlag(PLA_GithChokepoint_Event_LaezelRunsToKnight_5f5d15e8-ecbb-4b3f-8ac8-da29ef763d92, NULL_00000000-0000-0000-0000-000000000000);
SetHasDialog(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 0);
PROC_CharacterMoveTo(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_PLA_LaezelRecruitPoint_9f9daa3c-b446-4d03-a2a1-0a9383adccbe, "Run", "GLO_GithChokepoint_LaezelRanUpToKnight");
DB_CustomDialogRange(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 20);
DB_CustomDialogRange(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, 20);

IF
EntityEvent(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "GLO_GithChokepoint_LaezelRanUpToKnight", _, _, _)
THEN
SetFlag(PLA_GithChokepoint_State_TalkingToLaezel_12b26742-cb8e-48cb-8249-75c62902c75f, S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea);

IF
Dying(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_GithChokepoint_LaezelIsWithKnight(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_PLA_GithChokepoint_LaezelIsWithKnight(_Var1);

IF
LeftTrigger((CHARACTER)_Var1, S_PLA_ChokepointAbandonVBSphere_a7512987-5a65-47f7-a4f5-b2d58762fe0f, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_CantTalk(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_GithChokepoint_LaezelIsWithKnight(_, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_GithChokepoint_AbandonLaezel", _Var1, _Var1, _Var1, _Var1)
AND
IsInTrigger(_Var1, S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb, 1, _Var1, _Var1)
THEN
PROC_TriggerUnregisterForPlayers(S_PLA_ChokepointAbandonVBSphere_a7512987-5a65-47f7-a4f5-b2d58762fe0f);
StartVoiceBark(PLA_GithChokepoint_VB_LeavingLaezelBehind_74b04ddb-cb89-4161-52ad-6808acadde62, _Var1);

PROC
PROC_GLO_GithChokepoint_CheckReAddLaezel()
THEN
PROC_CheckPartyFull();

PROC
PROC_GLO_GithChokepoint_CheckReAddLaezel()
AND
DB_PLA_GithChokepoint_LaezelIsWithKnight(_, _, _, _, _)
AND
QRY_PLA_GithChokepoint_GetLaezelBestAvatar()
AND
DB_PLA_GithChokepoint_LaezelIsWithKnight(_Var2, _, _, _, _)
AND
GetFlag(GEN_MaxPlayerCountReached_823b5064-8aa4-c0b7-1b8c-657b46987ccd, NULL_00000000-0000-0000-0000-000000000000, _Var3, _, _)
THEN
NOT DB_PLA_GithChokepoint_LaezelIsWithKnight(_Var2);
PROC_GLO_GithChokepoint_ReAddLaezel(_Var2, _Var3);

PROC
PROC_GLO_GithChokepoint_ReAddLaezel((CHARACTER)_Var1, 1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_PLA_LaezelRecruit_ReAddFailed(_Var1);

PROC
PROC_GLO_GithChokepoint_ReAddLaezel((GUIDSTRING)_Var1, 0, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
NOT DB_SceneManager(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "PLA_GithChokepoint");
PROC_GLO_PartyMembers_Add(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1);
ClearTag(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, BLOCK_RESURRECTION_22a75dbb-1588-407e-b559-5aa4e6d4e6a6);

QRY
QRY_PLA_GithChokepoint_GetLaezelBestAvatar()
AND
DB_PLA_GithChokepoint_LaezelIsWithKnight(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_PLA_GithChokepoint_LaezelIsWithKnight(_Var1);

QRY
QRY_PLA_GithChokepoint_GetLaezelBestAvatar()
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PLA_GithChokepoint_LaezelIsWithKnight(_, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailableAndInDialogRange(_Var1, S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, _Var1, _Var1, _Var1)
THEN
DB_PLA_GithChokepoint_LaezelIsWithKnight(_Var1);

QRY
QRY_PLA_GithChokepoint_GetLaezelBestAvatar()
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PLA_GithChokepoint_LaezelIsWithKnight(_, _Var1, _Var1, _Var1, _Var1)
THEN
DB_PLA_GithChokepoint_LaezelIsWithKnight(_Var1);

QRY
QRY_PLA_GithChokepoint_GetLaezelBestAvatar()
THEN
DB_NOOP(1);

IF
LeftTrigger((CHARACTER)_Var1, S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(GLO_GithChokepoint_DragonEventEnd_ded1de27-9668-418f-93f6-4b5a789b5640, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_OnlyOnce("PLA_GithChokepoint_StartConfrontation", _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_CheckOtherPlayersInTrigger(NULL_00000000-0000-0000-0000-000000000000, S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_GithChokepoint_KillLaezel", _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Players(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1, _Var1)
AND
IsInTrigger(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb, 1, _Var1, _Var1)
THEN
DB_PLA_GithChokepoint_LaezelDiedAlone(1);
TeleportTo(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_PLA_LaezelRecruitPoint_9f9daa3c-b446-4d03-a2a1-0a9383adccbe);
Die(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 0, NULL_00000000-0000-0000-0000-000000000000, 0, 1);
PROC_GlobalSetFlagAndCache(PLA_GithChokepoint_State_LaezelDiedAlone_236d8e71-4727-4b88-9a2b-fcd558b2b8b3);
PROC_PLA_GithChokepoint_MakeDragonLeave(0);
TriggerRegisterForCharacter(S_PLA_GithChorpseSphere_84fce832-8d59-438f-a440-ab483c22d9e7, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
PROC_PLA_GithChokepoint_AddCorpse(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
PROC_GithChokepoint_Cancel("PLA");

IF
DB_Defeated(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1, _Var1)
AND
DB_Sees(_Var1, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_GithChokepoint_LaezelDiedAlone(1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_PLA_GithChokepoint_LaezelDiedAlone(1);
StartVoiceBark(PLA_GithChokepoint_VB_LaezelKilledByGith_5a1da769-d221-fe41-8fe9-4f8a516b4f0b, _Var1);

IF
Resurrected(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
DB_PLA_GithChokepoint_LaezelDiedAlone(1, _, _, _, _)
THEN
NOT DB_PLA_GithChokepoint_LaezelDiedAlone(1);

PROC
PROC_PLA_GithChokepoint_CheckLaezelSide()
AND NOT
DB_OnlyOnce("PLA_GithChokepoint_StartConfrontation", _, _, _, _)
AND NOT
DB_Players(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND NOT
DB_Defeated(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
IsInTrigger(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_PLA_GithRaceCheckSphere_e92009dc-1d11-43ae-b15d-9afa61d21d35, 1, _, _)
THEN
PROC_PLA_GithChokepoint_LaezelSidesWithGith();

PROC
PROC_PLA_GithChokepoint_LaezelSidesWithGith()
THEN
SetFlag(ORI_Laezel_State_HostileAtGithChokepoint_fc58ccc7-55ec-49b8-b8c0-d8d2c581c0be, NULL_00000000-0000-0000-0000-000000000000);
SetTag(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, BLOCK_RESURRECTION_22a75dbb-1588-407e-b559-5aa4e6d4e6a6);
DB_PLA_GithChokepoint_Gith(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, NULL_00000000-0000-0000-0000-000000000000);
DB_GLO_DefeatCounter(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "PLA_GithChokepoint_DefeatCounter");
QuestUpdate("ORI_COM_Laezel", "CompanionHostile");
DB_PLA_GithChokepoint_ReactToPlayerBetrayal(1);

IF
TurnStarted(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
DB_PLA_GithChokepoint_ReactToPlayerBetrayal(1, _, _, _, _)
THEN
NOT DB_PLA_GithChokepoint_ReactToPlayerBetrayal(1);
PROC_PLA_GithChokepoint_CheckReactToPlayerBetrayal();

PROC
PROC_PLA_GithChokepoint_CheckReactToPlayerBetrayal()
AND
QRY_PLA_GithChokepoint_AnyPlayerSeesLaezel()
THEN
PROC_TryStartAD(PLA_GithChokepoint_AD_LaezelSidesWithGith_ff56a4b4-5cb1-7141-9cac-c697fafe8a6e, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);

QRY
QRY_PLA_GithChokepoint_AnyPlayerSeesLaezel()
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Sees(_Var1, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_SceneInterrupted((CHARACTER)_Var1, NULL_00000000-0000-0000-0000-000000000000, "PLA_GithChokepoint", "LeftTrigger", (CHARACTER)_Var1)
AND
DB_PLA_GithChokepoint_Gith(_Var1, _, _Var1, _Var1, _Var1)
THEN
PROC_PLA_GithChokepoint_MakeDragonLeave(0);

PROC
PROC_SceneInterrupted(_, (CHARACTER)_Var2, "PLA_GithChokepoint", (STRING)_Var3, _)
AND
DB_PLA_GithChokepoint_ValidInterruptions(_Var3, _, _, _, _)
AND
QRY_PLA_GithChokepoint_ValidSource(_Var2, _, _, _, _)
AND
QRY_OnlyOnce("PLA_GithChokepoint_InterruptedScene", _, _, _, _)
THEN
DB_PLA_GithChokepoint_Interrupted(_Var2);
PROC_PLA_GithChokepoint_InterruptScene();

QRY
QRY_PLA_GithChokepoint_ValidSource((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
_Var1 != S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f
THEN
DB_NOOP(1);

PROC
PROC_SceneInterrupted(_, (CHARACTER)_Var2, "PLA_GithChokepoint", "PLA_GithChokepoint_ScoutPushedDown", _)
AND
QRY_OnlyOnce("PLA_GithChokepoint_InterruptedScene", _, _, _, _)
THEN
DB_PLA_GithChokepoint_Interrupted(_Var2);
PROC_PLA_GithChokepoint_InterruptScene();

PROC
PROC_SceneInterrupted(_, (CHARACTER)_Var2, "PLA_GithChokepoint", "PLA_GithChokepoint_LaezelResurrected", _)
AND NOT
DB_OnlyOnce("PLA_GithChokepoint_StartDragonScene", _, _, _, _)
AND
QRY_OnlyOnce("PLA_GithChokepoint_InterruptedScene", _, _, _, _)
THEN
DB_PLA_GithChokepoint_Interrupted(_Var2);
PROC_PLA_GithChokepoint_InterruptScene();

PROC
PROC_PLA_GithChokepoint_InterruptScene()
AND
DB_OnlyOnce("PLA_GithChokepoint_StartDragonScene", _, _, _, _)
THEN
NOT DB_CustomDialogRange(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 20);
NOT DB_CustomDialogRange(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, 20);
PROC_PLA_GithChokepoint_CheckLaezelSide();
PROC_PLA_GithChokepoint_MakeDragonLeave(0);
PROC_PLA_GithChokepoint_CancelConfrontation();

PROC
PROC_PLA_GithChokepoint_InterruptScene()
AND NOT
DB_OnlyOnce("PLA_GithChokepoint_StartDragonScene", _, _, _, _)
AND NOT
QRY_PLA_GithChokepoint_ForceStartDragonScene()
THEN
PROC_PLA_GithChokepoint_StartDragonScene(NULL_00000000-0000-0000-0000-000000000000);

QRY
QRY_PLA_GithChokepoint_ForceStartDragonScene()
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsDead(_Var1, 0, _Var1, _Var1, _Var1)
AND
IsInTrigger(_Var1, S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb, 1, _Var1, _Var1)
THEN
PROC_PLA_GithChokepoint_CheckStartDragonScene(_Var1);

PROC
PROC_PLA_GithChokepoint_CancelConfrontation()
THEN
PROC_TriggerUnregisterForPlayers(S_PLA_ChokepointConfrontSceneBox_00cb3901-cdb0-4505-bffb-6b24390db71b);
PROC_TriggerUnregisterForPlayers(S_PLA_GithKnight_SneakBox_c43fdf39-8d20-403d-aca1-ac993f8fb8d4);
DB_OnlyOnce("PLA_GithChokepoint_StartConfrontation");

IF
DB_InRegion(_Var1, S_PLA_GithKnight_SneakBox_c43fdf39-8d20-403d-aca1-ac993f8fb8d4, _Var1, _Var1, _Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_WildShaped(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_OnlyOnce("PLA_GithChokepoint_StartDragonScene", _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_OnlyOnce("PLA_GithChokepoint_StartConfrontation", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TriggerUnregisterForPlayers(S_PLA_GithKnight_SneakBox_c43fdf39-8d20-403d-aca1-ac993f8fb8d4);
PROC_SceneInterrupted(NULL_00000000-0000-0000-0000-000000000000, _Var1, "PLA_GithChokepoint", "Attacked");

IF
DB_InRegion(_Var1, S_PLA_GithKnight_SneakBox_c43fdf39-8d20-403d-aca1-ac993f8fb8d4, _Var1, _Var1, _Var1)
AND
DB_PlayerSummons(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_OnlyOnce("PLA_GithChokepoint_StartDragonScene", _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_OnlyOnce("PLA_GithChokepoint_StartConfrontation", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TriggerUnregisterForPlayers(S_PLA_GithKnight_SneakBox_c43fdf39-8d20-403d-aca1-ac993f8fb8d4);
PROC_SceneInterrupted(NULL_00000000-0000-0000-0000-000000000000, _Var1, "PLA_GithChokepoint", "Attacked");

IF
DB_InRegion(_Var1, S_PLA_ChokepointConfrontSceneBox_00cb3901-cdb0-4505-bffb-6b24390db71b, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_HiddenCharacters(_Var1, _, _Var1, _Var1, _Var1)
AND NOT
DB_Is_WildShaped(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_GithChokepoint_StartConfrontation", _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(PLA_GithChokepoint_Event_ConfrontationStarts_81a6ce09-a457-4eb8-aacc-676778a6d9e7, NULL_00000000-0000-0000-0000-000000000000);
SetFlag(PLA_GithChokepoint_State_ConfrontationIsOngoing_9c3fc7db-3ac3-4b6d-b895-106601db5d4a, NULL_00000000-0000-0000-0000-000000000000);
PROC_GLO_GithChokepoint_CheckReAddLaezel();
PROC_PLA_GithChokepoint_StartConfrontation(_Var1);

PROC
PROC_PLA_GithChokepoint_StartConfrontation((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
QRY_PLA_GithChokepoint_StartConfrontationLaezel(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_PLA_GithChokepoint_StartLaezelOM(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_StartDialogCustom(DIALOGRESOURCEGUID_PLA_GithChokepoint_Confrontation_81aa25b6-850b-16bf-81c9-68c19208db5e, S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, _Var1, 0, 0, 0, 0, _Var1, _Var1)
AND NOT
DB_OriginDialog(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, PLA_GithChokepoint_OM_Laezel_AOM_OOM_af67b6d8-d1a0-61f9-e74b-a3535279cb94, _Var1, _Var1, _Var1)
AND NOT
DB_OriginDialog(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, PLA_GithChokepoint_OM_Laezel_COM_f2710677-54ec-4c88-ea70-df755e0f730f, _Var1, _Var1, _Var1)
THEN
PROC_PLA_GithChokepoint_MakeDragonLeave(0);

QRY
QRY_PLA_GithChokepoint_StartLaezelOM((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_SpeakerIsAvailableAndInDialogRange(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, _Var1, _Var1, _Var1)
AND
QRY_PLA_GithChokepoint_StartLaezelOM_TryOriginalAvatar()
THEN
DB_PLA_GithChokepoint_LaezelOMStarted(1);

QRY
QRY_PLA_GithChokepoint_StartLaezelOM((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_PLA_GithChokepoint_LaezelOMStarted(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailableAndInDialogRange(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, _Var1, _Var1, _Var1)
AND
QRY_PLA_GithChokepoint_StartLaezelOM_TryAnyOtherAvatar(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_PLA_GithChokepoint_LaezelOMStarted(1);

QRY
QRY_PLA_GithChokepoint_StartLaezelOM_TryOriginalAvatar()
AND
QRY_GetBestAvatarForCompanion(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 1, 1, _, _)
AND
DB_QRYRTN_GetBestAvatarForCompanion(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailableAndInDialogRange(_Var1, S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(DIALOGRESOURCEGUID_PLA_GithChokepoint_Confrontation_81aa25b6-850b-16bf-81c9-68c19208db5e, S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, _Var1, 0, 0, 0, 0, _Var1, _Var1)
THEN
DB_PLA_GithChokepoint_LaezelOMStarted(1);

QRY
QRY_PLA_GithChokepoint_StartLaezelOM_TryAnyOtherAvatar((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_Avatars(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailableAndInDialogRange(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, _Var1, _Var1, _Var1)
AND
QRY_GetClosestAvailableCharacterTo(_Var1, 0, _Var1, _Var1, _Var1)
AND
DB_ClosestAvailableCharacterTo_PreferAvatar(_Var2, _Var1, _Var3, 1, _Var1)
AND
_Var3 <= 15
AND
QRY_StartDialogCustom(PLA_GithChokepoint_OM_Laezel_COM_f2710677-54ec-4c88-ea70-df755e0f730f, S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var2, S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, 0, 0, 0, 0, _Var1)
THEN
DB_PLA_GithChokepoint_LaezelOMStarted(1);

PROC
PROC_StartDialog_AddExtraSpeakers((DIALOGRESOURCE)_Var1, (INTEGER)_Var2, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND
DB_PLA_GithChokepoint_ExtraConfrontationSpeakers(_Var1, _Var3, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var2, _Var3);

IF
DialogStarted((GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PLA_GithChokepoint_Confrontation(_Var1, _, _Var1, _Var1, _Var1)
THEN
DB_PLA_GithChokepoint_ActiveConfrontation(_Var1);

PROC
PROC_StartDialog_AddExtraSpeakers((DIALOGRESOURCE)_Var1, (INTEGER)_Var2, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND
DB_PLA_GithChokepoint_Confrontation(_Var1, _, _Var1, _Var1, _Var1)
AND
DB_Players(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, _Var1, _Var1, _Var1, _Var1)
AND
GetDistanceTo(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, _Var4, _Var1, _Var1)
AND
_Var4 <= 20
THEN
PROC_DialogAddSpeakingActor(_Var2, S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679);

IF
DialogActorJoined((DIALOGRESOURCE)_Var1, (INTEGER)_Var2, (CHARACTER)_Var3, _, (DIALOGRESOURCE)_Var1)
AND
DB_Players(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_GithChokepoint_ActiveConfrontation(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PLA_GithChokepoint_OM(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PLA_GithChokepoint_AddOtherPlayers(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_PLA_GithChokepoint_AddOtherPlayers(_Var1);
DB_AddCharactersInTriggerToDialog(_Var1, S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb, 1, 1, 1);

IF
FlagSet(GLO_GithChokepoint_Event_LaezelOMStarted_84283682-101d-1531-7aae-33aa56999a70, NULL_00000000-0000-0000-0000-000000000000, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_DialogName(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_GithChokepoint_ActiveConfrontation(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PLA_GithChokepoint_AddOtherPlayers(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
DB_PLA_GithChokepoint_AddOtherPlayers(_Var2);
DB_AddCharactersInTriggerToDialog(_Var2, S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb, 1, 1, 1);

IF
DialogEnded((GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PLA_GithChokepoint_AddOtherPlayers(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_PLA_GithChokepoint_AddOtherPlayers(_Var1);
PROC_AddCharactersInTriggerToDialog_Clear(_Var1, S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb);

IF
DialogEnded((DIALOGRESOURCE)_Var1, (INTEGER)_Var2, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND
DB_PLA_GithChokepoint_Confrontation(_Var1, 1, _Var1, _Var1, _Var1)
AND
GetFlag(PLA_GithChokepoint_Event_ContinueFromLaezel_1987005a-f786-30f9-662a-c5d83f92cd4d, NULL_00000000-0000-0000-0000-000000000000, 1, _Var1, _Var1)
THEN
PROC_PLA_GithChokepoint_ContinueFromLaezel(_Var1, _Var2);

PROC
PROC_PLA_GithChokepoint_ContinueFromLaezel((DIALOGRESOURCE)_Var1, _, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
THEN
NOT DB_PLA_GithChokepoint_ActiveConfrontation(_Var1);

PROC
PROC_PLA_GithChokepoint_ContinueFromLaezel(_, (INTEGER)_Var2, _, _, _)
AND
DB_DialogPlayers(_Var2, _Var3, _, _, _)
AND
_Var3 != S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12
AND
QRY_OnlyOnce("PLA_GithChokepoint_ContinueFromLaezel", _, _, _, _)
AND NOT
QRY_StartDialog(DIALOGRESOURCEGUID_PLA_GithChokepoint_Confrontation_81aa25b6-850b-16bf-81c9-68c19208db5e, S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, _Var3, _)
THEN
PROC_PLA_GithChokepoint_MakeDragonLeave(0);

IF
DialogStarted((GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PLA_GithChokepoint_Confrontation(_Var1, _, _Var1, _Var1, _Var1)
AND
_Var1 != PLA_GithChokepoint_ConfrontationLaezel_dfb80d70-8cfe-1a55-bae7-826f164def60
THEN
PROC_PLA_GithChokepoint_CheckPresenceOfNonGith();

PROC
PROC_PLA_GithChokepoint_CheckPresenceOfNonGith()
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_PLA_GithRaceCheckSphere_e92009dc-1d11-43ae-b15d-9afa61d21d35, _Var1, _Var1, _Var1)
AND NOT
DB_HiddenCharacters(_Var1, _, _Var1, _Var1, _Var1)
AND NOT
DB_Defeated(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsTagged(_Var1, GITHYANKI_677ffa76-2562-4217-873e-2253d4720ba4, 0, _Var1, _Var1)
THEN
SetFlag(PLA_GithChokepoint_State_NonGithInTow_dc0e7d2a-9000-432d-872a-ceab5bc055bc, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_PLA_GithChokepoint_MakeDragonLeave((INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
THEN
DB_PLA_GithChokepoint_Outcome(_Var1);

PROC
PROC_PLA_GithChokepoint_MakeDragonLeave(_, _, _, _, _)
AND NOT
DB_PLA_GithChokepoint_Interrupted(_, _, _, _, _)
THEN
DB_AddCharactersInTriggerToDialog(PLA_GithChokepoint_CINE_RiderAndDragonLeave_3ad8ad7a-b3f0-7537-3303-507dc8c3dfc4, S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb, 1, 1, 1);
PROC_PLA_GithChokepoint_CheckStartDragonLeaveCine();

PROC
PROC_PLA_GithChokepoint_MakeDragonLeave(_, _, _, _, _)
AND
DB_PLA_GithChokepoint_Interrupted(_, _, _, _, _)
THEN
PROC_PLA_GithChokepoint_VossAndDragonLeaveInGameplay();
PROC_GLO_GithChokepoint_Outcome(0);

PROC
PROC_GLO_GithChokepoint_Outcome(0, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_ClearScreenFadeTimeline(_Var1, 0.5);

PROC
PROC_PLA_GithChokepoint_CheckStartDragonLeaveCine()
AND NOT
QRY_PLA_GithChokepoint_StartWithPlayer()
AND NOT
QRY_PLA_GithChokepoint_StartWithoutPlayer()
THEN
PROC_PLA_GithChokepoint_DragonEvent_FinishDragonLeaving();

QRY
QRY_PLA_GithChokepoint_StartWithPlayer()
AND
DB_InRegion(_Var1, S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailable(_Var1, 1, 1, _Var1, _Var1)
AND
QRY_StartDialogCustom(PLA_GithChokepoint_CINE_RiderAndDragonLeave_3ad8ad7a-b3f0-7537-3303-507dc8c3dfc4, S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, _Var1, 0, 0, 0, 0, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_PLA_GithChokepoint_StartWithoutPlayer()
AND
QRY_CheckOtherPlayersInTrigger(NULL_00000000-0000-0000-0000-000000000000, S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb, _, _, _)
AND
QRY_StartDialogCustom(PLA_GithChokepoint_CINE_RiderAndDragonLeave_3ad8ad7a-b3f0-7537-3303-507dc8c3dfc4, S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, NULL_00000000-0000-0000-0000-000000000000, 0, 0, 0, 0, _, _)
THEN
DB_NOOP(1);

IF
DialogEnded(PLA_GithChokepoint_CINE_RiderAndDragonLeave_3ad8ad7a-b3f0-7537-3303-507dc8c3dfc4, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_PLA_GithChokepoint_DragonEvent_FinishDragonLeaving();

PROC
PROC_PLA_GithChokepoint_VossAndDragonLeaveInGameplay()
THEN
SetCanJoinCombat(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 0);
SetDetached(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 1);
DB_PLA_GithChokepoint_DragonLeavingInGameplay(1);
PlayAnimation(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, CUST_TakeOff_01_5f3d7746-eb42-4599-849e-cdd8e6fecce6, "");
UseSpell(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, "Shout_GLO_Voss_TeleportOut", S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea);

IF
AnimationEvent(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, "AnimationSetOffStage", _, _, _)
AND
DB_PLA_GithChokepoint_DragonLeavingInGameplay(1, _, _, _, _)
THEN
NOT DB_PLA_GithChokepoint_DragonLeavingInGameplay(1);
PROC_PLA_GithChokepoint_DragonEvent_FinishDragonLeaving();

PROC
PROC_PLA_GithChokepoint_DragonEvent_FinishDragonLeaving()
AND
DB_PLA_GithChokepoint_Outcome(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_CustomDialogRange(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 20);
NOT DB_CustomDialogRange(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, 20);
NOT DB_PLA_GithChokepoint_Outcome(_Var1);
ClearFlag(PLA_GithChokepoint_State_ConfrontationIsOngoing_9c3fc7db-3ac3-4b6d-b895-106601db5d4a, NULL_00000000-0000-0000-0000-000000000000);
PurgeOsirisQueue(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f);
PurgeOsirisQueue(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea);
PROC_SetOnStage(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 0);
PROC_SetOnStage(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, 0);
PROC_PLA_GithChokepoint_MakeKnightAndDragonMortals();
SetCanJoinCombat(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 1);
SetDetached(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 0);
PROC_GLO_GithChokepoint_Outcome(_Var1);

PROC
PROC_PLA_GithChokepoint_MakeKnightAndDragonMortals()
THEN
SetImmortal(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 0);
SetImmortal(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, 0);
PROC_SetInvulnerable(S_GLO_GithDragon_9e21fba4-5a6d-4ca0-9738-2add3c967b3f, 0);
PROC_SetInvulnerable(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, 0);

IF
DB_Dead(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_PLA_GithChorpseSphere_84fce832-8d59-438f-a440-ab483c22d9e7, _Var1, _Var1, _Var1)
AND NOT
DB_PLA_GithChokepoint_PlayerCorpses(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_PLA_GithChokepoint_PlayerCorpses(_Var1);
PROC_PLA_GithChokepoint_AddCorpse(_Var1);

PROC
PROC_PLA_GithChokepoint_AddCorpse((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
_Var1 != S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604
AND
DB_PLA_GithChokepoint_Gith(_Var2, _, _Var1, _Var1, _Var1)
AND NOT
DB_Defeated(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
SetDualEntityEvent(_Var2, _Var1, "PLA_GithChokepoint_AddCorpseToList");

IF
DB_PLA_GithChokepoint_PlayerCorpses(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Dead(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_PLA_GithChokepoint_PlayerCorpses(_Var1);
PROC_PLA_GithChokepoint_RemoveCorpse(_Var1);

IF
DB_PLA_GithChokepoint_PlayerCorpses(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_InRegion(_Var1, S_PLA_GithChorpseSphere_84fce832-8d59-438f-a440-ab483c22d9e7, _Var1, _Var1, _Var1)
THEN
NOT DB_PLA_GithChokepoint_PlayerCorpses(_Var1);
PROC_PLA_GithChokepoint_RemoveCorpse(_Var1);

PROC
PROC_PLA_GithChokepoint_RemoveCorpse((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_GithChokepoint_Gith(_Var2, _, _Var1, _Var1, _Var1)
THEN
SetDualEntityEvent(_Var2, _Var1, "PLA_GithChokepoint_RemoveCorpseFromList");

PROC
PROC_PLA_GithChokepoint_StopLookingForCorpses()
THEN
PROC_TriggerUnregisterForPlayers(S_PLA_GithChorpseSphere_84fce832-8d59-438f-a440-ab483c22d9e7);
TriggerUnregisterForCharacter(S_PLA_GithChorpseSphere_84fce832-8d59-438f-a440-ab483c22d9e7, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);

PROC
PROC_PLA_GithChokepoint_StopLookingForCorpses()
AND
DB_PLA_GithChokepoint_PlayerCorpses(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_PLA_GithChokepoint_PlayerCorpses(_Var1);
PROC_PLA_GithChokepoint_RemoveCorpse(_Var1);

IF
DialogEnded((GUIDSTRING)_Var1, (INTEGER)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PLA_GithChokepoint_ActiveConfrontation(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetFlag(GLO_GithChokepoint_Quest_GithLeave_8b2f94b5-9373-36ab-edfe-419764fbb85a, NULL_00000000-0000-0000-0000-000000000000, _Var3, _Var1, _Var1)
THEN
PROC_PLA_GithChokepoint_MakeDragonLeave(_Var3);
NOT DB_PLA_GithChokepoint_ActiveConfrontation(_Var1);

PROC
PROC_GLO_GithChokepoint_Outcome(1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_GithChokepoint_Gith(_Var1, _, _Var1, _Var1, _Var1)
THEN
PROC_DisappearOutOfSight(_Var1, "Sprint", 0, "");

PROC
PROC_GLO_GithChokepoint_Outcome(1, _, _, _, _)
THEN
PROC_PLA_GithChokepoint_Ended_JournalHook();
PROC_PLA_LaezelRecruit_CheckStartReaction();
PROC_PLA_GithChokepoint_CheckStartWRD();
PROC_PLA_GithChokepoint_StopLookingForCorpses();
PROC_PLA_GithChokepoint_SetPeacefulResolutionXP();

PROC
PROC_PLA_GithChokepoint_SetPeacefulResolutionXP()
AND
DB_PLA_GithChokepoint_Gith(_Var1, _, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PeacefulResolve(_Var1);

PROC
PROC_GLO_GithChokepoint_Outcome(0, _, _, _, _)
AND
QRY_OnlyOnce("PLA_GithChokepoint_FightStarted", _, _, _, _)
THEN
PROC_SetCanFight(S_GLO_GithRaider_001_6b265792-c6ce-4eb0-94cd-a12b7bbe590d, 1);
SetCanJoinCombat(S_GLO_GithRaider_001_6b265792-c6ce-4eb0-94cd-a12b7bbe590d, 1);
ClearOwnership(S_GLO_GithCrecheMap_480f350e-79ae-46f6-aee7-e7ab63d2a011);
PROC_PLA_GithChokepoint_PrepareLaezelBetrayalAD();
PROC_PLA_GithChokepoint_SetRaidersHostile();
PROC_PLA_GithChokepoint_SetScoutHostile();
PROC_PLA_GithChokepoint_SetCombatGroupsAndEnterCombat();

PROC
PROC_GLO_GithChokepoint_Outcome(_, (INTEGER)_, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_PLA_GithChokepoint_CleanUp();

PROC
PROC_PLA_GithChokepoint_SetRaidersHostile()
AND
QRY_OnlyOnce("PLA_GithChokepoint_SetRaidersHostile", _, _, _, _)
AND
DB_PLA_GithChokepoint_Gith(_Var1, _, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFaction(_Var1, ACT1_PLA_GithChokepointHostile_ae4c996b-5040-4c68-b682-0314e0334d35);

PROC
PROC_PLA_GithChokepoint_SetCombatGroupsAndEnterCombat()
AND
DB_PLA_GithChokepoint_Interrupted(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetCombatGroupAndEnterCombat(_Var1, "fc52998f-783d-b3ab-e533-bc914db98c7a", S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259);

PROC
PROC_PLA_GithChokepoint_SetCombatGroupsAndEnterCombat()
AND
DB_PLA_GithChokepoint_Interrupted(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_GithChokepoint_Gith(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _Var1, _Var1, _Var1)
THEN
PROC_Origins_CompanionLeavePermanently(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "TurnedHostileAtChokepoint");
PROC_SetRelationToPlayers(Origin_Laezel_bee8449b-d682-93c8-e7da-9e4bad369476, 0);
SetCombatGroupAndEnterCombat(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "fc52998f-783d-b3ab-e533-bc914db98c7a", S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259);

PROC
PROC_PLA_GithChokepoint_PrepareLaezelBetrayalAD()
AND NOT
DB_Players(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND NOT
DB_PLA_GithChokepoint_Gith(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND NOT
DB_Defeated(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
DB_SceneManager(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "PLA_GithChokepoint", _, _, _)
THEN
DB_PLA_GithChokepoint_LZBetrayalAD(1);

IF
TurnStarted(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
DB_PLA_GithChokepoint_LZBetrayalAD(1, _, _, _, _)
AND
QRY_PLA_GithChokepoint_InCombatAgainstGith(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
THEN
NOT DB_PLA_GithChokepoint_LZBetrayalAD(1);
PROC_TryStartAD(PLA_GithChokepoint_AD_LaezelBetrayed_45a44fb6-9630-ba25-c43e-921b5edb7ace, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);

IF
TurnStarted(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
DB_PLA_GithChokepoint_LZBetrayalAD(1, _, _, _, _)
AND NOT
QRY_PLA_GithChokepoint_InCombatAgainstGith(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
THEN
NOT DB_PLA_GithChokepoint_LZBetrayalAD(1);

QRY
QRY_PLA_GithChokepoint_InCombatAgainstGith((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Is_InCombat(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_PLA_GithChokepoint_Gith(_Var3, _, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var3, _Var2, _Var1, _Var1, _Var1)
AND
IsEnemy(_Var1, _Var3, 1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
EnteredCombat((CHARACTER)_Var1, (GUIDSTRING)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_GithChokepoint_Gith(_Var1, _, _Var1, _Var1, _Var1)
AND NOT
DB_PLA_GithChokepoint_Gith(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(ORI_LaezelRecruitment_State_CrashVersionInitiated_a80f2bd8-ffa1-4065-a92a-d01d59907637, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(ORI_LaezelRecruitment_Event_CrashVersionDone_df73c46d-ed94-47de-be8b-36df1dbd973f, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(ORI_LaezelRecruitment_State_ResurrectedAtChokepoint_244e5e8c-849c-4a93-a129-4da54d32f779, _Var1, _Var1, _Var1, _Var1)
THEN
DB_PLA_GithChokepoint_CombatGuid(_Var2);

IF
DB_Is_InCombat(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_GithChokepoint_CombatGuid(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(ORI_LaezelRecruitment_State_ResurrectedAtChokepoint_244e5e8c-849c-4a93-a129-4da54d32f779, NULL_00000000-0000-0000-0000-000000000000);

IF
FlagSet(ORI_LaezelRecruitment_State_ResurrectedAtChokepoint_244e5e8c-849c-4a93-a129-4da54d32f779, NULL_00000000-0000-0000-0000-000000000000, _, _, _)
AND
DB_PLA_GithChokepoint_CombatGuid(_Var2, _, _, _, _)
THEN
NOT DB_PLA_GithChokepoint_CombatGuid(_Var2);

PROC
PROC_GLO_DefeatCounter_AllDefeated("PLA_GithChokepoint_DefeatCounter", _, _, _, _)
THEN
SetFlag(PLA_GithChokepoint_Event_AllGithsDefeated_b329e2d8-31c8-4861-ae87-224e86f51682, NULL_00000000-0000-0000-0000-000000000000);
NOT DB_PLA_GithChokepoint_LZBetrayalAD(1);
PROC_PLA_GithChokepoint_Ended_JournalHook();
PROC_PLA_GithChokepoint_CheckStartWRD();
PROC_PLA_LaezelRecruit_CheckStartReaction();
PROC_PLA_GithChokepoint_StopLookingForCorpses();

PROC
PROC_PLA_GithChokepoint_Ended_JournalHook()
THEN
DB_NOOP(1);

PROC
PROC_GLO_DefeatCounter_AllDefeated("PLA_GithChokepoint_DefeatCounter", _, _, _, _)
AND
DB_Avatars(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND NOT
DB_Defeated(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
QRY_PLA_GithChokepoint_CloseToGith(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
QRY_OnlyOnce("PLA_GithChokepoint_AvatarLaezelRespondsAfterCombat", _, _, _, _)
THEN
PROC_TryStartAD(PLA_GithChokepoint_PAD_LaezelPostFight_9b68f31d-f0ca-ff6f-9d85-a880f2ce3e27, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);

QRY
QRY_PLA_GithChokepoint_CloseToGith((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_GithChokepoint_Gith(_Var2, _, _Var1, _Var1, _Var1)
AND
GetDistanceTo(_Var1, S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, _Var4, _Var1, _Var1)
AND
_Var4 <= 30
THEN
DB_NOOP(1);

IF
RemovedFrom((ITEM)_Var1, S_GLO_GithCaptain_27fa0802-fa38-4eea-9c03-496f2e022259, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_GLO_GithMap(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(PLA_GithChokepoint_State_MapRemovedFromBaretha_dadbfa61-e396-4372-a415-ea926969b4aa, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_GithChokepoint_Cancel("PLA", _, _, _, _)
THEN
PROC_PLA_GithChokepoint_MakeKnightAndDragonMortals();

PROC
PROC_PLA_GithChokepoint_CleanUp()
THEN
PROC_SceneOver("PLA_GithChokepoint");
PROC_PLA_GithChokepoint_CancelConfrontation();
SetFlag(PLA_GithChokepoint_State_SceneDone_2fa4006f-12e5-4666-931b-e31dee737f2f, NULL_00000000-0000-0000-0000-000000000000);
TriggerUnregisterForCharacter(S_PLA_NPCInterruptionBox_198849d7-7f06-4520-a9e6-1ddedfe38660, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
PROC_TriggerUnregisterForPlayers(S_PLA_DragonShadow_Box_38005c53-9dd1-4f79-8581-0a4f30370baf);

PROC
PROC_PLA_GithChokepoint_Ended_JournalHook()
THEN
DB_NOOP(1);

IF
LevelLoaded("SCL_Main_A", _, _, _, _)
AND
DB_OnlyOnce("PLA_GithChokepoint_StartDragonScene", _, _, _, _)
THEN
PROC_GithChokepoint_Cancel("PLA");
GoalCompleted;

IF
DB_GlobalFlag(GLO_GithChokepoint_DragonEventEnd_ded1de27-9668-418f-93f6-4b5a789b5640, _, _, _, _)
AND
DB_GlobalFlag(PLA_GithChokepoint_State_SceneDone_2fa4006f-12e5-4666-931b-e31dee737f2f, _, _, _, _)
AND NOT
DB_GithChokepoint_SafeForBanter(1, _, _, _, _)
THEN
DB_GithChokepoint_SafeForBanter(1);

PROC
PROC_LongRest()
AND
DB_GithChokepoint_SafeForBanter(1, _, _, _, _)
THEN
PROC_RegisterWorldGossipTrigger(S_PartyBanterTrigger_PLA_GithResolved_3264c97b-d523-43dc-bc3b-0fb4b5fd2b0f);

IF
FlagSet(PLA_GithChokepoint_State_SceneDone_2fa4006f-12e5-4666-931b-e31dee737f2f, NULL_00000000-0000-0000-0000-000000000000, _, _, _)
AND
DB_QuestIsAccepted("ORI_COM_Laezel", _, _, _, _)
AND NOT
DB_GlobalFlag(PLA_GithChokepoint_State_LaezelDiedAlone_236d8e71-4727-4b88-9a2b-fcd558b2b8b3, _, _, _, _)
THEN
SetFlag(PLA_GithChokepoint_State_MonitorIntroRequirementMet_4d226b35-cc1b-4750-a06b-30f231b0633c, NULL_00000000-0000-0000-0000-000000000000);

IF
DialogStarted(Laezel_Recruitment_Plains_962cb218-6f76-a571-02c0-28070bd09fed, _, _, _, _)
AND
DB_QuestIsAccepted("ORI_COM_Laezel", _, _, _, _)
AND
DB_GlobalFlag(PLA_GithChokepoint_State_LaezelDiedAlone_236d8e71-4727-4b88-9a2b-fcd558b2b8b3, _, _, _, _)
THEN
SetFlag(PLA_GithChokepoint_State_MonitorIntroRequirementMet_4d226b35-cc1b-4750-a06b-30f231b0633c, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_PLA_GithChokepoint_KillFodderAndBridge()
THEN
SetOnStage(S_PLA_ChokepointShield_2614ee9a-b62a-4bac-942c-526227c12690, 1);

IF
AddedTo(S_PLA_ChokepointShield_2614ee9a-b62a-4bac-942c-526227c12690, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_ChokepointShield", _Var1, _Var1, _Var1, _Var1)
THEN
StartVoiceBark(PLA_GithChokepoint_VB_Shield_f05ec898-8c68-7e54-0a91-5a41ad2e9ca3, _Var1);

IF
MovedBy(S_PLA_ChokepointShield_2614ee9a-b62a-4bac-942c-526227c12690, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_ChokepointShield", _Var1, _Var1, _Var1, _Var1)
THEN
StartVoiceBark(PLA_GithChokepoint_VB_Shield_f05ec898-8c68-7e54-0a91-5a41ad2e9ca3, _Var1);

IF
DialogEnded((DIALOGRESOURCE)_Var1, (INTEGER)_Var2, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND
DB_PLA_Orpheus_GithChokepoint_Confrontation(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_Orpheus_GithChokepoint_TryDefineRD(_Var2);

IF
DialogEnded(PLA_GithChokepoint_CINE_RiderAndDragonLeave_3ad8ad7a-b3f0-7537-3303-507dc8c3dfc4, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
THEN
PROC_PLA_Orpheus_GithChokepoint_TryDefineRD(_Var1);

PROC
PROC_PLA_Orpheus_GithChokepoint_TryDefineRD((INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_GlobalFlag(PLA_GithChokepoint_Event_MentionedWeapon_569656de-2acb-6d5d-236c-c86df165e9b6, _Var1, _Var1, _Var1, _Var1)
AND
DB_DialogPlayers(_Var1, _Var2, _, _Var1, _Var1)
AND
DB_Avatars(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_Orpheus_GithChokepoint_StartRDTimer(_Var2);

PROC
PROC_PLA_Orpheus_GithChokepoint_StartRDTimer((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_Avatars(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SameUser(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PLA_Orpheus_GithChokepoint_TimerLaunched(1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_PLA_Orpheus_GithChokepoint_TimerLaunched(1);
ObjectTimerLaunch(_Var1, "PLA_Orpheus_RD_GithChokepoint_Timer", 5000);

PROC
PROC_PLA_Orpheus_GithChokepoint_StartRDTimer((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_PLA_Orpheus_GithChokepoint_TimerLaunched(1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_PLA_Orpheus_GithChokepoint_TimerLaunched(1);
ObjectTimerLaunch(_Var1, "PLA_Orpheus_RD_GithChokepoint_Timer", 1500);

PROC
PROC_LevelLoadedOnce("INT_Main_A", _, _, _, _)
AND NOT
DB_GlobalFlag(PLA_GithChokepoint_State_Cancelled_125f66fd-d046-4daa-ac1c-eb4fc29cfb1c, _, _, _, _)
THEN
SetFlag(PLA_GithChokepoint_State_Cancelled_125f66fd-d046-4daa-ac1c-eb4fc29cfb1c);

IF
LeftLevel(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, "WLD_Main_A", _, _, _)
AND
QRY_OnlyOnce("PROC_PLA_GithChokepoint_Cancel", _, _, _, _)
THEN
PROC_PLA_GithChokepoint_Cancel();

IF
DB_GlobalFlag(PLA_GithChokepoint_State_Cancelled_125f66fd-d046-4daa-ac1c-eb4fc29cfb1c, _, _, _, _)
AND
QRY_OnlyOnce("PROC_PLA_GithChokepoint_Cancel", _, _, _, _)
THEN
PROC_PLA_GithChokepoint_Cancel();

PROC
PROC_PLA_GithChokepoint_Cancel()
THEN
NOT DB_CustomDialogRange(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 20);
NOT DB_CustomDialogRange(S_GLO_GithKnight_2adce2df-0799-49dc-b867-ba7ca21e9aea, 20);
PROC_TriggerUnregisterForPlayers(S_PLA_DragonShadow_Box_38005c53-9dd1-4f79-8581-0a4f30370baf);
PROC_TriggerUnregisterForPlayers(S_PLA_GithRaceCheckSphere_e92009dc-1d11-43ae-b15d-9afa61d21d35);
PROC_TriggerUnregisterForPlayers(S_PLA_ChokepointControlSphere_ca3e6cb3-bd1e-456f-8e12-4b75be7f3fdb);
PROC_TriggerUnregisterForPlayers(S_PLA_GithEventPoly_4f1d2ca3-8ebe-4ebd-a4e5-8e92944ff1d1);
PROC_TriggerUnregisterForPlayers(S_PLA_GithChorpseSphere_84fce832-8d59-438f-a440-ab483c22d9e7);
PROC_TriggerUnregisterForPlayers(S_PLA_GithKnight_SneakBox_c43fdf39-8d20-403d-aca1-ac993f8fb8d4);
PROC_TriggerUnregisterForPlayers(S_PLA_NPCInterruptionBox_198849d7-7f06-4520-a9e6-1ddedfe38660);
PROC_TriggerUnregisterForPlayers(S_PLA_GithChokepoint_OngoingSceneArea_6f67dee0-2720-4617-a263-68a58da5681c);

PROC
PROC_PLA_GithChokepoint_Cancel()
THEN
PROC_SceneOver("PLA_GithChokepoint");
DB_PLA_GithChokepoint_Cancelled(1);

IF
DB_PLA_GithChokepoint_Cancelled(1, _, _, _, _)
AND
DB_CurrentLevel("WLD_Main_A", _, _, _, _)
AND
DB_PLA_GithChokepoint_Gith(_Var1, _, _Var1, _Var1, _Var1)
THEN
SetOnStage(_Var1, 0);

IF
DB_PLA_GithChokepoint_Cancelled(1, _, _, _, _)
AND
DB_CurrentLevel("WLD_Main_A", _, _, _, _)
AND
DB_PLA_GithChokepoint_Fodder(_Var1, _, _, _Var1, _Var1)
THEN
SetOnStage(_Var1, 0);

IF
DB_PLA_GithChokepoint_Cancelled(1, _, _, _, _)
AND
DB_CurrentLevel("WLD_Main_A", _, _, _, _)
AND NOT
DB_GlobalFlag(GLO_GithCreche_State_EverEnteredBefore_3ebdfeaa-4e83-4878-90db-01adb9fdf629, _, _, _, _)
THEN
PROC_SetOnStage(S_GLO_ChokepointScout_627e03ed-d23c-42fa-90c8-1e8d6f927fd6, 0);


EXITSECTION
ENDEXITSECTION

ParentTargetEdge "Act1"
