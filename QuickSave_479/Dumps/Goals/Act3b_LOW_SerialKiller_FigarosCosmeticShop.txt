Version 1
SubGoalCombiner SGC_AND

INITSECTION
DB_Dialogs(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, LOW_Figaro_SellingThings_aac70e59-5957-5b56-bea7-fd00b13ab95a);
DB_Dialogs(S_LOW_SerialKiller_Figaro_Assistant_000_b503ab77-c714-47de-9def-2a07aaf51d9f, LOW_SerialKiller_Figaro_Assistant_000_173022ff-f99a-81dc-27be-86f96808cd1d);
DB_Dialogs(S_LOW_SerialKiller_Figaro_Assistant_001_d8dc6cf0-2063-49e8-831e-64d998d77061, LOW_SerialKiller_Figaro_Assistant_001_8823a9d1-1595-2644-f1c1-753a20577944);
DB_DeadEvent(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, LOW_SerialKiller_State_Figaro_IsDead_34b421f0-c8d8-4b31-9f96-962dbf981260);
SetOnStage(S_LOW_SerialKiller_SymbolOfTheAbsolute_Figaro_0bc127ca-8f4a-4edb-a15a-6c5ec3f3a397, 0);
DB_LOW_SerialKiller_FigarosDoors(S_LOW_SerialKiller_FigaroDoor_Far_02e41e0d-6b50-44dd-8dfd-1d135762903c, LOW_SerialKiller_State_Figaro_PlayersUseFarDoor_25d159d9-fcb0-4172-944f-22f89617f665);
DB_LOW_SerialKiller_FigarosDoors(S_LOW_SerialKiller_FigaroDoor_Near_6a089d5e-febd-4d0c-84b1-52610a4a7bb1, LOW_SerialKiller_State_Figaro_PlayersUseNearDoor_47db30b5-35eb-4910-a876-8050ccdbe316);
DB_LOW_SerialKiller_SceneAtFigaros(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, S_LOW_Figaros_TPDolor_083e02ea-63da-4cf4-959a-0e67cd0bbc5f, NULL_00000000-0000-0000-0000-000000000000);
DB_LOW_SerialKiller_SceneAtFigaros(S_LOW_SerialKiller_Figaro_Doppelganger_000_9fd43e05-2158-487c-9c08-57b0c2caf7d8, S_LOW_DoppelgangerTrigger_000_f9c9c13c-29d7-4528-8773-69ff01d0fe90, LOW_SerialKiller_Figaro_Doppelganger_000_bae5e7e9-d0c3-0644-43cc-d6b7bf85bfc3);
DB_LOW_SerialKiller_SceneAtFigaros(S_LOW_SerialKiller_Figaro_Doppelganger_001_a4f560e6-8869-4316-a674-aee94da4cee0, S_LOW_DoppelgangerTrigger_001_8d8addb0-e4c7-415b-8e35-55c8e79a1460, LOW_SerialKiller_Figaro_Doppelganger_001_7b1ccbf6-3c39-aaf5-75e6-60fb1b3d54ef);
DB_LOW_SerialKiller_SceneAtFigaros(S_LOW_SerialKiller_Figaro_Doppelganger_002_bc6b17c7-b681-4607-bc4a-c578aa3cb55d, S_LOW_DoppelgangerTrigger_002_94a5d852-82d6-4068-b6d0-f0750b73f61c, LOW_SerialKiller_Figaro_Doppelganger_002_edf98f9c-0d08-c702-0eda-0588772e904b);
DB_LOW_SerialKiller_SceneAtFigaros(S_LOW_SerialKiller_Figaro_Doppelganger_003_e1ea7d43-2b85-45da-9778-3e4f6197dd9a, S_LOW_DoppelgangerTrigger_003_657de47e-b9ca-40f9-bfe7-a36e9c93de19, LOW_SerialKiller_Figaro_Doppelganger_003_a3c743b4-901b-07c3-d0c3-3d18e974ee37);
DB_LOW_SerialKiller_SceneAtFigaros(S_LOW_SerialKiller_Figaro_Doppelganger_005_d2ad989b-3e08-448e-bd66-ab132d83fafd, S_LOW_SerialKiller_DoppelgangerInside_002_b2a45091-5b7d-4c0a-b0c2-f398f6eedc70, NULL_00000000-0000-0000-0000-000000000000);
DB_LOW_SerialKiller_SceneAtFigaros(S_LOW_SerialKiller_Figaro_Doppelganger_006_3344edd8-94a2-42f7-b2a3-4cd4aa639a12, S_LOW_SerialKiller_DoppelgangerInside_003_b6a7cf95-cec4-4580-b2f2-ddecc686c157, NULL_00000000-0000-0000-0000-000000000000);
DB_LOW_SerialKiller_SceneAtFigaros(S_LOW_SerialKiller_Figaro_Doppelganger_007_15884103-c8b3-4c5f-b3b5-67ae481074c6, S_LOW_SerialKiller_DoppelgangerInside_004_2da32045-291f-4f14-8535-72e91e43d71a, NULL_00000000-0000-0000-0000-000000000000);
DB_LOW_SerialKiller_SceneAtFigaros(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, S_LOW_SerialKiller_DevellaTeleport_4c1c2468-8f66-4759-bbce-e58a2dd02488, LOW_SerialKiller_Figaro_Devella_AfterParalysis_5683b9b3-136d-d860-bc93-376b8bc78c23);
DB_OneShotPlayerTrigger(S_LOW_SerialKiller_FigaroSecureZone_b8f776cf-e2f7-4202-a30d-823d20e74392);
DB_Dialogs(S_LOW_Figaros_CivilianWaiting_a302cea3-9950-48cb-828d-b8b35e397975, LOW_Figaros_CivilianWaiting_8e621a57-a36d-4ffd-a42e-93b71fa995d3);
DB_CombatReact_AD_OnNextTurn(S_LOW_Elfsong_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, LOW_Elfsong_AD_Devella_Fountainhead_Turn1_bbafc977-e559-c425-14c3-08a45be52061);
DB_CombatReact_AD_OnNextTurn(S_LOW_Elfsong_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, LOW_Elfsong_AD_Devella_Fountainhead_Turn2_080e9cdc-cec9-c4cb-21e8-a70200c7bc8b);
DB_CombatReact_AD_OnNextTurn(S_LOW_Elfsong_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, LOW_Elfsong_AD_Devella_Fountainhead_Turn3_c484f4c2-f4a9-de1e-1da3-3bdf46beed3c);
DB_ItemOwnerShipTriggers("CTY_Main_A", S_LOW_Figaro_Ownership_7758eeea-fd29-4944-a366-1364aef16a0b, S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09);
DB_ItemOwnerShipTriggersFallback(S_LOW_Figaro_Ownership_7758eeea-fd29-4944-a366-1364aef16a0b, S_LOW_SerialKiller_Figaro_Assistant_000_b503ab77-c714-47de-9def-2a07aaf51d9f);
DB_ItemShopTrigger(S_LOW_Figaro_Shopping_b68f02db-3b2e-43f5-b3b3-e77cf3f2fbab, S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09);
TriggerRegisterForCharacter(S_LOW_SerialKiller_Figaro_StoreReceptionTrigger_fe602663-ef4f-4539-a308-8e3bbbadabd7, S_LOW_SerialKiller_Figaro_Assistant_000_b503ab77-c714-47de-9def-2a07aaf51d9f);
DB_LOW_SerialKiller_DevellaIgnoreCrimes("PrisonEscape_AD");
DB_LOW_SerialKiller_DevellaIgnoreCrimes("PrisonEscape");

KBSECTION
IF
EnteredTrigger(S_LOW_SerialKiller_Figaro_Assistant_000_b503ab77-c714-47de-9def-2a07aaf51d9f, S_LOW_SerialKiller_Figaro_StoreReceptionTrigger_fe602663-ef4f-4539-a308-8e3bbbadabd7, _, _, _)
THEN
SetFlag(LOW_SerialKiller_Figaros_State_CanChatter_a9dea102-5bc1-4224-b26c-2078b4794311);

IF
LeftTrigger(S_LOW_SerialKiller_Figaro_Assistant_000_b503ab77-c714-47de-9def-2a07aaf51d9f, S_LOW_SerialKiller_Figaro_StoreReceptionTrigger_fe602663-ef4f-4539-a308-8e3bbbadabd7, _, _, _)
THEN
ClearFlag(LOW_SerialKiller_Figaros_State_CanChatter_a9dea102-5bc1-4224-b26c-2078b4794311);

PROC
PROC_LOW_SerialKiller_FigarosSetupCommon()
AND NOT
DB_Defeated(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _, _, _, _)
AND NOT
DB_State_Current(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "LOW_Dolor", "MurderTribunal", _, _)
THEN
PROC_SetRelationMutual(Act3_LOW_Dolor_15f56a1e-42e3-458d-bf8d-140ed313b928, Act3_LOW_FlamingFistGuards_86d2eaf4-1da3-4dbe-94c0-7cf3b240f428, 50);
PROC_SetRelationToPlayers(Act3_LOW_Dolor_15f56a1e-42e3-458d-bf8d-140ed313b928, 50);
PROC_State_Progress(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "LOW_Dolor", "Figaro");
PROC_LOW_SerialKiller_MoveDolorAndDoppelgangersToFigaro();
SetFlag(LOW_SerialKiller_Event_DolorRevealHimself_b9cb8e1a-5ade-1834-7d6d-992f6a232063);
SetFlag(LOW_SerialKiller_State_DolorAtFigaro_0c0df309-ff40-f3ef-9df4-c37b86f6e666);
TeleportTo(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, S_LOW_Figaros_TPFigaro_ecf89204-8305-4cdd-9ed4-34b4481b4af7);
Use(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, S_LOW_SerialKiller_Figaro_TortureChair_2186f0dc-4d25-4156-9c0b-f31cc54a33d7, 1, 1, "");
PROC_SetAnubisConfig(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, "DefaultCharacter");
PROC_RemoveDialog(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134);
SetStoryDisplayName(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "SerialKiller_Dolor_Name");
PROC_CharacterDisableAllCrimes(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09);
PROC_LOW_SerialKiller_CloseFigaroDoors();
PROC_TriggerUnregisterForParty(S_LOW_SerialKiller_FigaroSecureZone_b8f776cf-e2f7-4202-a30d-823d20e74392);
DB_OneShotPlayerTrigger(S_LOW_SerialKiller_TriggerSoliloquy_bdf8d2c4-a5f0-4643-b597-07238364872e);
DB_GLO_DieFlag(LOW_SerialKiller_Event_DolorKillsFigaro_f0d3cf6c-3139-f174-b286-7f952381469f, S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, 0, S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134);
TeleportTo(S_LOW_SerialKiller_Figaro_Assistant_000_b503ab77-c714-47de-9def-2a07aaf51d9f, S_LOW_SerialKiller_Figaros_ParalysisPoint_Assistant000_00e6752c-07ba-4232-850a-7e6a8fab173c);
TeleportTo(S_LOW_SerialKiller_Figaro_Assistant_001_d8dc6cf0-2063-49e8-831e-64d998d77061, S_LOW_SerialKiller_Figaros_ParalysisPoint_Assistant001_34aca35e-a27c-4eb4-bfc9-4da75c79b676);
ApplyStatus(S_LOW_SerialKiller_Figaro_Assistant_000_b503ab77-c714-47de-9def-2a07aaf51d9f, "UNCONSCIOUS", -1, 1, NULL_00000000-0000-0000-0000-000000000000);
ApplyStatus(S_LOW_SerialKiller_Figaro_Assistant_001_d8dc6cf0-2063-49e8-831e-64d998d77061, "UNCONSCIOUS", -1, 1, NULL_00000000-0000-0000-0000-000000000000);
SetOnStage(S_LOW_Figaros_CivilianWaiting_a302cea3-9950-48cb-828d-b8b35e397975, 0);
DB_CombatReact_AD_OnNextTurn(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, LOW_SerialKiller_AD_Dolor_Threat1_0a001db5-97ee-e6f7-6a3f-e38e99f0dfc6);
DB_CombatReact_AD_OnNextTurn(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, LOW_SerialKiller_AD_Dolor_Threat2_a172cb99-0ba6-d0af-fe34-4c2ee42077b9);

PROC
PROC_LOW_SerialKiller_FigarosSetupCommon()
AND NOT
DB_Defeated(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _, _, _, _)
AND
DB_State_Current(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "LOW_Dolor", "MurderTribunal", _, _)
THEN
PROC_SetRelationToPlayers(Act3_LOW_Dolor_FigarosDoppelgangers_b8f157f8-161f-4915-b131-b585402e60a5, 0);
PROC_SetRelationToPlayers(Act3_LOW_Dolor_15f56a1e-42e3-458d-bf8d-140ed313b928, 50);
PROC_SetRelationMutual(Act3_LOW_Dolor_15f56a1e-42e3-458d-bf8d-140ed313b928, Act3_LOW_FlamingFistGuards_86d2eaf4-1da3-4dbe-94c0-7cf3b240f428, 50);
PROC_LOW_SerialKiller_MoveDolorAndDoppelgangersToFigaro();
SetFlag(LOW_SerialKiller_Event_DolorRevealHimself_b9cb8e1a-5ade-1834-7d6d-992f6a232063);
TeleportTo(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, S_LOW_Figaros_TPFigaro_ecf89204-8305-4cdd-9ed4-34b4481b4af7);
Die(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, 0, S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, 0, 1, 1);
SetStoryDisplayName(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "SerialKiller_Dolor_Name");
PROC_LOW_SerialKiller_CloseFigaroDoors();
TeleportTo(S_LOW_SerialKiller_Figaro_Assistant_000_b503ab77-c714-47de-9def-2a07aaf51d9f, S_LOW_SerialKiller_Figaros_ParalysisPoint_Assistant000_00e6752c-07ba-4232-850a-7e6a8fab173c);
TeleportTo(S_LOW_SerialKiller_Figaro_Assistant_001_d8dc6cf0-2063-49e8-831e-64d998d77061, S_LOW_SerialKiller_Figaros_ParalysisPoint_Assistant001_34aca35e-a27c-4eb4-bfc9-4da75c79b676);
ApplyStatus(S_LOW_SerialKiller_Figaro_Assistant_000_b503ab77-c714-47de-9def-2a07aaf51d9f, "UNCONSCIOUS", -1, 1, NULL_00000000-0000-0000-0000-000000000000);
ApplyStatus(S_LOW_SerialKiller_Figaro_Assistant_001_d8dc6cf0-2063-49e8-831e-64d998d77061, "UNCONSCIOUS", -1, 1, NULL_00000000-0000-0000-0000-000000000000);
SetOnStage(S_LOW_Figaros_CivilianWaiting_a302cea3-9950-48cb-828d-b8b35e397975, 0);
PROC_LOW_SerialKiller_AddFigarosCharactersToCombatGroupButDolor();

PROC
PROC_LOW_SerialKiller_FigarosSetupCommon()
AND
DB_Defeated(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _, _, _, _)
AND NOT
DB_Dead(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _, _, _, _)
THEN
TeleportTo(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, S_LOW_Figaros_TPFigaro_ecf89204-8305-4cdd-9ed4-34b4481b4af7);
Die(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, 0, S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, 0, 1, 1);
ToInventory(S_LOW_SerialKiller_Hand_Figaro_f494ba51-9973-4328-b3fd-04b116281448, S_LOW_SerialKiller_DolorBag_43404e7f-b5a9-491d-b0ef-f3fc7f002229, 1, 0, 1);

PROC
PROC_LOW_SerialKiller_FigarosSetupCommon()
AND
DB_Defeated(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _, _, _, _)
THEN
PROC_SetRelationToPlayers(Act3_LOW_Dolor_15f56a1e-42e3-458d-bf8d-140ed313b928, 50);
PROC_SetRelationMutual(Act3_LOW_Dolor_15f56a1e-42e3-458d-bf8d-140ed313b928, Act3_LOW_FlamingFistGuards_86d2eaf4-1da3-4dbe-94c0-7cf3b240f428, 50);
PROC_SetRelationToPlayers(Act3_LOW_Dolor_FigarosDoppelgangers_b8f157f8-161f-4915-b131-b585402e60a5, 0);
SetFlag(LOW_SerialKiller_State_FigaroAlreadyDeadSetup_ed3aa8f2-b822-4073-b1dc-aacc13aa28f5);
PROC_LOW_SerialKiller_MoveDolorAndDoppelgangersToFigaro();
PROC_State_Progress(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "LOW_Dolor", "MurderTribunal");
PROC_RemoveDialog(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134);
SetStoryDisplayName(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "SerialKiller_Dolor_Name");
PROC_LOW_SerialKiller_CloseFigaroDoors();
PROC_TriggerUnregisterForParty(S_LOW_SerialKiller_FigaroSecureZone_b8f776cf-e2f7-4202-a30d-823d20e74392);
DB_OneShotPlayerTrigger(S_LOW_SerialKiller_TriggerSoliloquy_bdf8d2c4-a5f0-4643-b597-07238364872e);
TeleportTo(S_LOW_SerialKiller_Figaro_Assistant_000_b503ab77-c714-47de-9def-2a07aaf51d9f, S_LOW_SerialKiller_Figaros_ParalysisPoint_Assistant000_00e6752c-07ba-4232-850a-7e6a8fab173c);
TeleportTo(S_LOW_SerialKiller_Figaro_Assistant_001_d8dc6cf0-2063-49e8-831e-64d998d77061, S_LOW_SerialKiller_Figaros_ParalysisPoint_Assistant001_34aca35e-a27c-4eb4-bfc9-4da75c79b676);
ApplyStatus(LOW_SerialKiller_Figaro_Assistant_000_173022ff-f99a-81dc-27be-86f96808cd1d, "UNCONSCIOUS", -1, 1, NULL_00000000-0000-0000-0000-000000000000);
ApplyStatus(S_LOW_SerialKiller_Figaro_Assistant_001_d8dc6cf0-2063-49e8-831e-64d998d77061, "UNCONSCIOUS", -1, 1, NULL_00000000-0000-0000-0000-000000000000);
PROC_LOW_SerialKiller_AddFigarosCharactersToCombatGroupButDolor();
ToInventory(S_LOW_SerialKiller_NoteFromOrin_FigarosBody_fd96ca11-3ad0-4eeb-b550-d5e800e92592, S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, 1, 0, 1);

PROC
PROC_LOW_SerialKiller_FigarosSetupCommon()
AND NOT
DB_Defeated(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, _, _, _, _)
AND NOT
DB_Defeated(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _, _, _, _)
THEN
DB_GLO_CharacterCorpseDialog(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, LOW_SerialKiller_Devella_Dead_b08454c0-23bd-8cbf-42c3-52bff94c25ab);
SetFaction(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, ACT3_LOW_SerialKiller_DevellaAtFigaros_67d694d6-e90e-43f6-a6e3-5c5e94977799);
PROC_RemoveDialog(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81);
DB_Dialogs(S_LOW_Elfsong_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, LOW_SerialKiller_Figaro_Devella_AfterParalysis_5683b9b3-136d-d860-bc93-376b8bc78c23);
DB_GLO_DieFlag(LOW_SerialKiller_Event_DolorKillsFigaro_f0d3cf6c-3139-f174-b286-7f952381469f, S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, 0, S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134);
SetFlag(LOW_Elfsong_Event_DvellaStopSpotting_5fceb72f-1060-4754-9b65-99211513aac6);
ApplyStatus(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, "LOW_SERIALKILLER_PARALYSED_DEVELLA", -1, 1, NULL_00000000-0000-0000-0000-000000000000);
DB_LOW_SerialKiller_DevellaWillIgnoreCrime(1);

PROC
PROC_LOW_SerialKiller_FigarosSetupCommon()
AND
DB_GlobalFlag(LOW_Figaro_SellingThings_State_FigaroKnowsTargetList_cd785159-9139-4b7f-28d7-9bd6993c3569, _, _, _, _)
AND NOT
DB_Defeated(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _, _, _, _)
THEN
TemplateAddTo(WPN_HUM_Dagger_A_0_569b0f3d-abcd-4b01-aaf0-979091288163, S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, 1, 0);

PROC
PROC_LOW_SerialKiller_FigarosSetupCommon()
AND
DB_Defeated(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _, _, _, _)
AND NOT
DB_Defeated(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, _, _, _, _)
THEN
Die(S_LOW_Elfsong_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, 0, S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, 0, 1, 1);
DB_GLO_CharacterCorpseDialog(S_LOW_Elfsong_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, LOW_SerialKiller_Devella_Dead_b08454c0-23bd-8cbf-42c3-52bff94c25ab);

IF
DB_State_Current(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "LOW_Dolor", "Figaro", _, _)
THEN
DB_LOW_SerialKiller_DolorWasInFigaros(1);

PROC
PROC_State_Progress(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "LOW_Dolor", "MurderTribunal", _, _)
AND
DB_LOW_SerialKiller_DolorWasInFigaros(1, _, _, _, _)
THEN
NOT DB_LOW_SerialKiller_DolorWasInFigaros(1);
PROC_SetRelationToPlayers(Act3_LOW_Dolor_FigarosDoppelgangers_b8f157f8-161f-4915-b131-b585402e60a5, 0);
PROC_SetRelationToPlayers(Act3_LOW_Dolor_OutsideDoppelgangers_f7fa73a1-1ea0-40e2-9897-30c4c3d647ee, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_FigarosDoppelgangers_b8f157f8-161f-4915-b131-b585402e60a5, ACT3_LOW_SerialKiller_FlamingFists_b1603934-1816-4a16-a400-46af52b5afa2, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_FigarosDoppelgangers_b8f157f8-161f-4915-b131-b585402e60a5, ACT3_LOW_SerialKiller_DevellaAtFigaros_67d694d6-e90e-43f6-a6e3-5c5e94977799, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_FigarosDoppelgangers_b8f157f8-161f-4915-b131-b585402e60a5, Act3_LOW_Figaro_d91dd3bb-b2b5-4d72-857b-e875cbbc2744, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_OutsideDoppelgangers_f7fa73a1-1ea0-40e2-9897-30c4c3d647ee, ACT3_LOW_SerialKiller_FlamingFists_b1603934-1816-4a16-a400-46af52b5afa2, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_OutsideDoppelgangers_f7fa73a1-1ea0-40e2-9897-30c4c3d647ee, ACT3_LOW_SerialKiller_DevellaAtFigaros_67d694d6-e90e-43f6-a6e3-5c5e94977799, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_15f56a1e-42e3-458d-bf8d-140ed313b928, ACT3_LOW_SerialKiller_FlamingFists_b1603934-1816-4a16-a400-46af52b5afa2, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_OutsideDoppelgangers_f7fa73a1-1ea0-40e2-9897-30c4c3d647ee, Act3_LOW_FlamingFistGuards_86d2eaf4-1da3-4dbe-94c0-7cf3b240f428, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_FigarosDoppelgangers_b8f157f8-161f-4915-b131-b585402e60a5, Act3_LOW_FlamingFistGuards_86d2eaf4-1da3-4dbe-94c0-7cf3b240f428, 0);
RemoveStatus(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, "LOW_SERIALKILLER_PARALYSED_DEVELLA", NULL_00000000-0000-0000-0000-000000000000);
ApplyStatus(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, "LOW_SERIALKILLER_PARALYSED_DEVELLA", 18, 1, NULL_00000000-0000-0000-0000-000000000000);
RemoveStatus(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, "LOW_SERIALKILLER_PARALYZED", NULL_00000000-0000-0000-0000-000000000000);
ApplyStatus(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, "LOW_SERIALKILLER_PARALYZED", 18, 1, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_State_Progress(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "LOW_Dolor", "MurderTribunal", _, _)
THEN
SetCombatGroupID(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "");
PROC_RemoveOneShotTrigger(S_LOW_SerialKiller_TriggerSoliloquy_bdf8d2c4-a5f0-4643-b597-07238364872e);
NOT DB_LOW_SerialKiller_FigarosDoors(S_LOW_SerialKiller_FigaroDoor_Far_02e41e0d-6b50-44dd-8dfd-1d135762903c, LOW_SerialKiller_State_Figaro_PlayersUseFarDoor_25d159d9-fcb0-4172-944f-22f89617f665);
NOT DB_LOW_SerialKiller_FigarosDoors(S_LOW_SerialKiller_FigaroDoor_Near_6a089d5e-febd-4d0c-84b1-52610a4a7bb1, LOW_SerialKiller_State_Figaro_PlayersUseNearDoor_47db30b5-35eb-4910-a876-8050ccdbe316);

PROC
PROC_LOW_FigarosSetup_NotLongRest("NotKillCora", _, _, _, _)
AND
DB_GlobalFlag(LOW_SerialKiller_State_PlayersKillSecondTargetList_68c5736d-8b62-4e30-bc9c-0f3bcae40629, _, _, _, _)
AND
DB_State_Current(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "LOW_Dolor", "WineFestival", _, _)
THEN
PROC_State_Progress(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "LOW_Dolor", "MurderTribunal");

PROC
PROC_LOW_FigarosSetup_NotLongRest("NotKillCora", _, _, _, _)
AND NOT
QRY_LOW_SerialKiller_CharactersNearFigaro()
THEN
PROC_LOW_SerialKiller_FigarosSetupCommon();

PROC
PROC_LOW_FigarosSetup_NotLongRest("NotKillCora", _, _, _, _)
AND
QRY_LOW_SerialKiller_CharactersNearFigaro()
THEN
DB_LOW_SerialKiller_WaitingFigaroBeFree("NotKillCora");

PROC
PROC_LOW_FigarosSetup_NotLongRest("KilledCora", _, _, _, _)
AND NOT
QRY_LOW_SerialKiller_CharactersNearFigaro()
THEN
PROC_LOW_SerialKiller_FigarosSetupCommon();
PROC_LOW_DolorHaveCoraHand();

PROC
PROC_LOW_FigarosSetup_NotLongRest("KilledCora", _, _, _, _)
AND
QRY_LOW_SerialKiller_CharactersNearFigaro()
THEN
DB_LOW_SerialKiller_WaitingFigaroBeFree("KilledCora");

PROC
PROC_LOW_SerialKiller_CloseFigaroDoors()
AND
DB_LOW_SerialKiller_FigarosDoors(_Var1, _, _Var1, _Var1, _Var1)
THEN
Close(_Var1);

IF
LeftTrigger((CHARACTER)_Var1, S_LOW_SerialKiller_FigaroSecureZone_b8f776cf-e2f7-4202-a30d-823d20e74392, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_SerialKiller_WaitingFigaroBeFree("KilledCora", _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_LOW_SerialKiller_CharactersNearFigaro()
THEN
NOT DB_LOW_SerialKiller_WaitingFigaroBeFree("KilledCora");
PROC_LOW_FigarosSetup_NotLongRest("KilledCora");

IF
LeftTrigger((CHARACTER)_Var1, S_LOW_SerialKiller_FigaroSecureZone_b8f776cf-e2f7-4202-a30d-823d20e74392, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_SerialKiller_WaitingFigaroBeFree("NotKillCora", _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_LOW_SerialKiller_CharactersNearFigaro()
THEN
NOT DB_LOW_SerialKiller_WaitingFigaroBeFree("NotKillCora");
PROC_LOW_FigarosSetup_NotLongRest("NotKillCora");

PROC
PROC_LOW_SerialKiller_MoveDolorAndDoppelgangersToFigaro()
AND NOT
DB_Defeated(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, _, _, _, _)
AND
DB_LOW_SerialKiller_SceneAtFigaros(_Var1, _Var2, _, _Var1, _Var1)
AND
_Var1 != S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134
THEN
TeleportTo(_Var1, _Var2);
SetOnStage(_Var1, 1);

PROC
PROC_LOW_SerialKiller_MoveDolorAndDoppelgangersToFigaro()
AND NOT
DB_Defeated(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, _, _, _, _)
AND
DB_LOW_SerialKiller_SceneAtFigaros(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, _Var1, _, _Var1, _Var1)
AND
DB_State_Current(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "LOW_Dolor", "Figaro", _Var1, _Var1)
THEN
TeleportTo(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, _Var1);
SetOnStage(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, 1);

PROC
PROC_LOW_SerialKiller_MoveDolorAndDoppelgangersToFigaro()
AND NOT
DB_Defeated(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, _, _, _, _)
AND
DB_LOW_SerialKiller_SceneAtFigaros(_Var1, _, _Var3, _Var1, _Var1)
AND
_Var3 != NULL_00000000-0000-0000-0000-000000000000
THEN
DB_Dialogs(_Var1, _Var3);

PROC
PROC_LOW_DolorHaveCoraHand()
AND NOT
DB_GlobalFlag(LOW_SerialKiller_State_Cora_SeveredHand_d8c2c89a-235d-486c-9bf7-4f5aed0b84e7, _, _, _, _)
THEN
ToInventory(S_LOW_SerialKiller_Hand_Cora_e8b086d8-1b22-47ac-adf8-7e165fdf99ab, S_LOW_SerialKiller_DolorBag_43404e7f-b5a9-491d-b0ef-f3fc7f002229, 1, 0, 1);

PROC
PROC_OneShotTriggerEntered((CHARACTER)_Var1, S_LOW_SerialKiller_ADFigaroOut_d3ba3393-3e60-4d3c-9807-d8e67fb64e80, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_TryStartAD(LOW_SerialKiller_Figaro_Doppelganger_001_AD_FigaroClosedStore_b4ae65ee-0d99-6e13-cb07-b0a4c09b30ca, S_LOW_SerialKiller_Figaro_Doppelganger_001_a4f560e6-8869-4316-a674-aee94da4cee0);

IF
KilledBy(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, (INTEGER)_Var1, (INTEGER)_Var1)
THEN
PROC_LOW_SerialKiller_DolorTryToEscape("LOW_SerialKiller_FigaroKilled");
SetFlag(LOW_SerialKiller_Event_DolorKillsFigaro_f0d3cf6c-3139-f174-b286-7f952381469f);

IF
EntityEvent(_, "LOW_SerialKiller_FigaroKilled", (GUIDSTRING)_, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_State_Progress(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "LOW_Dolor", "MurderTribunal");

PROC
PROC_OneShotTriggerEntered((CHARACTER)_Var1, S_LOW_SerialKiller_TriggerSoliloquy_bdf8d2c4-a5f0-4643-b597-07238364872e, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Defeated(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_StartDialog(LOW_SerialKiller_Dolor_Soliloquy_e9dbbe8f-06f1-073a-e58a-0ff49ef5ecae, S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _Var1, _Var1)
THEN
SetFlag(LOW_SerialKiller_State_SoliloquyCannotBeTriggered_2daea396-6a7d-4f79-9f1d-f8e40f968e64);
PROC_LOW_SerialKiller_HostilityAtFigaro(_Var1);
RemoveStatus(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, "LOW_SERIALKILLER_PARALYSED_DEVELLA", NULL_00000000-0000-0000-0000-000000000000);
ApplyStatus(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, "LOW_SERIALKILLER_PARALYSED_DEVELLA", 18, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
UseStarted((CHARACTER)_Var1, (ITEM)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_SerialKiller_FigarosDoors(_Var2, _Var3, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsTagged(_Var1, HUMANOID_7fbed0d4-cabc-4a9d-804e-12ca6088a0a8, 1, _Var1, _Var1)
AND
DB_State_Current(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "LOW_Dolor", "Figaro", _Var1, _Var1)
AND
QRY_OnlyOnce("LOW_SerialKiller_DolorSoliloquy", _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialog(LOW_SerialKiller_Dolor_Soliloquy_e9dbbe8f-06f1-073a-e58a-0ff49ef5ecae, S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _Var1, _Var1)
THEN
SetFlag(_Var3);
PROC_LOW_SerialKiller_AddFigarosCharactersToCombatGroup();

PROC
PROC_StartDialog_AddExtraSpeakers(LOW_SerialKiller_Dolor_Soliloquy_e9dbbe8f-06f1-073a-e58a-0ff49ef5ecae, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND NOT
DB_PermaDefeated(S_LOW_Elfsong_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_LOW_Elfsong_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81);

IF
DialogEnded(LOW_SerialKiller_Dolor_Soliloquy_e9dbbe8f-06f1-073a-e58a-0ff49ef5ecae, _, _, _, _)
AND NOT
DB_Dead(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, _, _, _, _)
THEN
RemoveStatus(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, "LOW_SERIALKILLER_PARALYSED_DEVELLA", NULL_00000000-0000-0000-0000-000000000000);
ApplyStatus(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, "LOW_SERIALKILLER_PARALYSED_DEVELLA", 18, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
DialogEnded(LOW_SerialKiller_Dolor_Soliloquy_e9dbbe8f-06f1-073a-e58a-0ff49ef5ecae, _, _, _, _)
AND NOT
DB_Dead(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _, _, _, _)
THEN
ApplyStatus(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, "LOW_SERIALKILLER_PARALYZED", -1, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
FlagSet(LOW_SerialKiller_Figaro_Event_SuccessHiding_46ea804c-37d3-48d0-8259-b2fd6be2da44, (GUIDSTRING)_Var1, (INTEGER)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
DB_LOW_SerialKiller_HidingDone(1);
TeleportTo(_Var1, S_LOW_SerialKiller_HidingSoliloquyPoint_77c5eb3c-f41d-4073-9428-b81252d325be, "", 0, 1, 1, 0, 1);

PROC
PROC_LOW_SerialKiller_AddFigarosCharactersToCombatGroup()
AND
DB_LOW_SerialKiller_SceneAtFigaros(_Var1, _, _, _Var1, _Var1)
THEN
SetCombatGroupID(_Var1, "LOW_SerialKiller_DolorAtFigarosCG");

PROC
PROC_LOW_SerialKiller_AddFigarosCharactersToCombatGroupButDolor()
AND
DB_LOW_SerialKiller_SceneAtFigaros(_Var1, _, _, _Var1, _Var1)
AND
_Var1 != S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134
THEN
SetCombatGroupID(_Var1, "LOW_SerialKiller_FigarosButNotDolor");

QRY
QRY_SerialKiller_IgnorePrisonEscape((STRING)_Var1, (STRING)_Var1, (STRING)_Var1, (STRING)_Var1, (STRING)_Var1)
AND
DB_LOW_SerialKiller_DevellaIgnoreCrimes(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_CharacterRegisterCrimeHandleIgnoresAfter((INTEGER)_Var1, (CHARACTER)_Var2, (STRING)_Var3, _, _)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SerialKiller_IgnorePrisonEscape(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_SerialKiller_DevellaWillIgnoreCrime(1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_LOW_SerialKiller_IgnoredCrimesIDs(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_LOW_SerialKiller_IgnoredCrimesIDs(_Var1);
CrimeIgnoreCrime(_Var1, S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81);

QRY
QRY_LOW_SerialKiller_CharactersNearFigaro()
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_LOW_SerialKiller_FigaroSecureZone_b8f776cf-e2f7-4202-a30d-823d20e74392, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
AttackedBy(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, (CHARACTER)_Var1, _, _, _, _, (INTEGER)_Var6, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_State_Current(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "LOW_Dolor", "Figaro", _Var1, _Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("LOW_SerialKiller_DolorBeingAttackedFigaro", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_ForceStopDialog(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134);
PROC_TryStartAD(LOW_SerialKiller_AD_DolorBeingAttackedFigaro_56118f56-464d-5e9c-69d7-25d0835c1e83, S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134);
PROC_LOW_SerialKiller_HostilityAtFigaro(_Var1);

IF
DB_Is_InCombat(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_LOW_SerialKiller_PlayersIncombat_Figaros(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_State_Current(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, "LOW_Dolor", "Figaro", _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_LOW_SerialKiller_PlayersIncombat_Figaros(_Var1, _Var2);

IF
CombatEnded((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_SerialKiller_PlayersIncombat_Figaros(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_Defeated(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Defeated(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("LOW_SerialKiller_FinishedCombatAtFigaro", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_RemoveDialog(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09);
PROC_SetAnubisConfig(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, "LOW_SerialKiller_Figaro");
DB_Dialogs(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, LOW_Figaro_SellingThings_aac70e59-5957-5b56-bea7-fd00b13ab95a);

IF
CombatEnded((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_SerialKiller_PlayersIncombat_Figaros(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_Defeated(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Defeated(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _Var1, _Var1, _Var1, _Var1)
THEN
AddAttitudeTowardsPlayer(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _Var2, 100);

IF
CombatEnded((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_SerialKiller_PlayersIncombat_Figaros(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_Defeated(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, _Var1, _Var1, _Var1, _Var1)
THEN
RemoveStatus(S_LOW_SerialKiller_Figaro_Assistant_001_d8dc6cf0-2063-49e8-831e-64d998d77061, "UNCONSCIOUS", NULL_00000000-0000-0000-0000-000000000000);
RemoveStatus(S_LOW_SerialKiller_Figaro_Assistant_000_b503ab77-c714-47de-9def-2a07aaf51d9f, "UNCONSCIOUS", NULL_00000000-0000-0000-0000-000000000000);
PROC_CharacterMoveTo(S_LOW_SerialKiller_Figaro_Assistant_001_d8dc6cf0-2063-49e8-831e-64d998d77061, LOW_SerialKiller_Figaro_BackstoreWanderPoint_fc15ef62-5426-4388-a789-edbf83e0ec1b, "Walk", "");
PROC_CharacterMoveTo(S_LOW_SerialKiller_Figaro_Assistant_000_b503ab77-c714-47de-9def-2a07aaf51d9f, S_LOW_SerialKiller_AfterDolorTrigger_Assistant_000_d5a8a4e5-9f0f-4af7-b73d-dc731c2329e1, "Walk", "");
PROC_AppearOutOfSightTo(S_LOW_Figaros_CivilianWaiting_a302cea3-9950-48cb-828d-b8b35e397975, LOW_SerialKiller_Figaro_BackstoreWanderPoint_fc15ef62-5426-4388-a789-edbf83e0ec1b, S_LOW_Figaros_CivilianWaiting_a302cea3-9950-48cb-828d-b8b35e397975, "");
PROC_DisappearOutOfSight(S_LOW_SerialKiller_Figaro_CivilianOutside_000_bc6b17c7-b681-4607-bc4a-c578aa3cb55d, "Walk", 0, "");
PROC_DisappearOutOfSight(S_LOW_SerialKiller_Figaro_CivilianOutside_001_9fd43e05-2158-487c-9c08-57b0c2caf7d8, "Walk", 0, "");

IF
CombatEnded((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_SerialKiller_PlayersIncombat_Figaros(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _Var1, _Var1, _Var1, _Var1)
THEN
RemoveStatus(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, "LOW_SERIALKILLER_PARALYZED", NULL_00000000-0000-0000-0000-000000000000);

IF
CombatEnded((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_SerialKiller_PlayersIncombat_Figaros(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, _Var1, _Var1, _Var1, _Var1)
THEN
TriggerUnregisterForCharacter(S_LOW_SerialKiller_Figaro_SUB_13409b18-250a-4259-826f-e30733e12783, S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81);
ClearFlag(LOW_Elfsong_Event_DvellaStopSpotting_5fceb72f-1060-4754-9b65-99211513aac6);
DB_SpotPlayers(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, "LOW_Figaros_DevellaSpotting", NULL_00000000-0000-0000-0000-000000000000, LOW_Elfsong_Event_DvellaStopSpotting_5fceb72f-1060-4754-9b65-99211513aac6);

PROC
PROC_SpotPlayers_Spotted((CHARACTER)_Var1, "LOW_Figaros_DevellaSpotting", (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialog(LOW_SerialKiller_Figaro_Devella_AfterParalysis_5683b9b3-136d-d860-bc93-376b8bc78c23, S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, _Var2, _Var1, _Var1)
THEN
SetFlag(LOW_Elfsong_Event_DvellaStopSpotting_5fceb72f-1060-4754-9b65-99211513aac6);

IF
CombatEnded((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_SerialKiller_PlayersIncombat_Figaros(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_SerialKiller_PlayersIncombat_Figaros(_Var2, _Var1);

IF
DialogEnded(LOW_SerialKiller_Dolor_Soliloquy_e9dbbe8f-06f1-073a-e58a-0ff49ef5ecae, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
GetFlag(LOW_SerialKiller_Event_DolorFigaroAtk_ca877930-7d30-9c1e-d8d8-a7a35dc68eb7, _Var2, 1, _Var1, _Var1)
AND
QRY_OnlyOnce("LOW_SerialKiller_CombatAfterSoliloquy", _Var1, _Var1, _Var1, _Var1)
THEN
ClearFlag(LOW_SerialKiller_Event_DolorFigaroAtk_ca877930-7d30-9c1e-d8d8-a7a35dc68eb7);
PROC_LOW_SerialKiller_HostilityAtFigaro(_Var2);

PROC
PROC_LOW_SerialKiller_HostilityAtFigaro((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
SetHostileAndEnterCombat(Act3_LOW_Dolor_15f56a1e-42e3-458d-bf8d-140ed313b928, Hero_a1542c81-6895-929e-4522-10ce218bb360, S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, _Var1);
SetHostileAndEnterCombat(Act3_LOW_Dolor_OutsideDoppelgangers_f7fa73a1-1ea0-40e2-9897-30c4c3d647ee, Hero_a1542c81-6895-929e-4522-10ce218bb360, S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, _Var1);
PROC_SetRelationToPlayers(Act3_LOW_Dolor_FigarosDoppelgangers_b8f157f8-161f-4915-b131-b585402e60a5, 0);
PROC_SetRelationToPlayers(Act3_LOW_Dolor_OutsideDoppelgangers_f7fa73a1-1ea0-40e2-9897-30c4c3d647ee, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_FigarosDoppelgangers_b8f157f8-161f-4915-b131-b585402e60a5, ACT3_LOW_SerialKiller_FlamingFists_b1603934-1816-4a16-a400-46af52b5afa2, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_FigarosDoppelgangers_b8f157f8-161f-4915-b131-b585402e60a5, ACT3_LOW_SerialKiller_DevellaAtFigaros_67d694d6-e90e-43f6-a6e3-5c5e94977799, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_OutsideDoppelgangers_f7fa73a1-1ea0-40e2-9897-30c4c3d647ee, ACT3_LOW_SerialKiller_FlamingFists_b1603934-1816-4a16-a400-46af52b5afa2, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_OutsideDoppelgangers_f7fa73a1-1ea0-40e2-9897-30c4c3d647ee, ACT3_LOW_SerialKiller_DevellaAtFigaros_67d694d6-e90e-43f6-a6e3-5c5e94977799, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_15f56a1e-42e3-458d-bf8d-140ed313b928, ACT3_LOW_SerialKiller_FlamingFists_b1603934-1816-4a16-a400-46af52b5afa2, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_15f56a1e-42e3-458d-bf8d-140ed313b928, ACT3_LOW_SerialKiller_DevellaAtFigaros_67d694d6-e90e-43f6-a6e3-5c5e94977799, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_15f56a1e-42e3-458d-bf8d-140ed313b928, Act3_LOW_FlamingFistGuards_86d2eaf4-1da3-4dbe-94c0-7cf3b240f428, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_OutsideDoppelgangers_f7fa73a1-1ea0-40e2-9897-30c4c3d647ee, Act3_LOW_FlamingFistGuards_86d2eaf4-1da3-4dbe-94c0-7cf3b240f428, 0);
PROC_SetRelationMutual(Act3_LOW_Dolor_FigarosDoppelgangers_b8f157f8-161f-4915-b131-b585402e60a5, Act3_LOW_FlamingFistGuards_86d2eaf4-1da3-4dbe-94c0-7cf3b240f428, 0);

IF
DialogEnded(LOW_SerialKiller_Dolor_Soliloquy_e9dbbe8f-06f1-073a-e58a-0ff49ef5ecae, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_LOW_SerialKiller_HidingDone(1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_SerialKiller_HidingDone(1);
PROC_SetRelationToPlayers(Act3_LOW_Dolor_15f56a1e-42e3-458d-bf8d-140ed313b928, 0);
PROC_SetRelationToPlayers(Act3_LOW_Dolor_OutsideDoppelgangers_f7fa73a1-1ea0-40e2-9897-30c4c3d647ee, 0);

IF
GameBookInterfaceClosed(S_LOW_SerialKiller_NoteFromOrin_9c029a99-2636-4c19-9ff3-c7564a91cd35, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_OnlyOnce("LOW_SerialKiller_ReadOrinNote", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(LOW_SerialKiller_PAD_ReadingDolorsNote_c695d271-ed3a-a61b-6a61-9bebf5e67b7a, _Var1);

PROC
PROC_LongRest()
AND
DB_PermaDefeated(S_LOW_Dolor_55837c0f-0171-4020-a4a3-dd6de7ffc134, _, _, _, _)
AND NOT
DB_PermaDefeated(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, _, _, _, _)
THEN
PROC_SetAnubisConfig(S_LOW_Elfsong_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, "DefaultCharacter");
PROC_RemoveDialog(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81);
TeleportTo(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, S_LOW_SerialKiller_FinalDevellaPoint_477f0e94-4227-45ff-96c7-02e2d2d252cb);
PROC_SetOnStage(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, 1);
DB_Dialogs(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, LOW_Devella_Fountainhead_BasiliskGate_OneLiner_2a6af5aa-697c-593e-65e5-5c9d22782ef9);
SetFlag(LOW_SerialKiller_State_DevellaOnBasiliskGate_c35f72bb-834c-496a-9d02-99679c612bc2);

IF
DB_GlobalFlag(LOW_SerialKiller_Event_DevellaGoingBasiliskGate_274ab2d5-a9cb-a8cd-d21d-39ac3949c108, _, _, _, _)
AND NOT
DB_Defeated(S_LOW_Elfsong_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, _, _, _, _)
THEN
PROC_SetAnubisConfig(S_LOW_Elfsong_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, "DefaultCharacter");
PROC_DisappearOutOfSight(S_LOW_Elfsong_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, "Run", 1, "LOW_SerialKiller_DevellaGoingToBasilisk");
ClearFlag(LOW_SerialKiller_Event_DevellaGoingBasiliskGate_274ab2d5-a9cb-a8cd-d21d-39ac3949c108);

IF
DB_GlobalFlag(LOW_SerialKiller_Event_DevellaGoingBasiliskGate_274ab2d5-a9cb-a8cd-d21d-39ac3949c108, _, _, _, _)
AND NOT
DB_Defeated(S_LOW_Elfsong_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, _, _, _, _)
AND
DB_LOW_SerialKiller_IgnoredCrimesIDs(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_SerialKiller_IgnoredCrimesIDs(_Var1);
CrimeStopIgnoringCrime(_Var1, S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81);

IF
EntityEvent(S_LOW_Elfsong_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, "LOW_SerialKiller_DevellaGoingToBasilisk", _, _, _)
THEN
PROC_AppearOutOfSightTo(S_LOW_Elfsong_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, S_LOW_SerialKiller_FinalDevellaPoint_477f0e94-4227-45ff-96c7-02e2d2d252cb, S_LOW_SerialKiller_FinalDevellaPoint_477f0e94-4227-45ff-96c7-02e2d2d252cb, "");
SetFlag(LOW_SerialKiller_State_DevellaOnBasiliskGate_c35f72bb-834c-496a-9d02-99679c612bc2);
PROC_RemoveDialog(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81);
DB_Dialogs(S_LOW_Devella_Fountainhead_048defbd-d386-4272-a5b7-40c1a9e75b81, LOW_Devella_Fountainhead_BasiliskGate_OneLiner_2a6af5aa-697c-593e-65e5-5c9d22782ef9);

IF
DB_PermaDefeated(S_LOW_Figaro_3ff2b7ea-3de2-4bdc-a600-c973f290bc09, _Var1, _Var1, _Var1, _Var1)
AND
GetClosestPlayer(S_LOW_SerialKiller_Figaro_Assistant_000_b503ab77-c714-47de-9def-2a07aaf51d9f, _Var1, _, _Var1, _Var1)
THEN
PROC_SetCustomTradeTreasure(S_LOW_SerialKiller_Figaro_Assistant_000_b503ab77-c714-47de-9def-2a07aaf51d9f, "LOW_Figaro_Assistant");

IF
DB_GlobalFlag(LOW_SerialKiller_Figaros_State_WaitingToChatter_3455890f-78e8-4671-b568-b129712e86c6, _, _, _, _)
THEN
PROC_TryStartAD(LOW_SerialKiller_Figaro_AD_AssistantsChatting_b0be71e0-2c50-3ba2-9c18-1640a6bbefd8, S_LOW_SerialKiller_Figaro_Assistant_000_b503ab77-c714-47de-9def-2a07aaf51d9f, S_LOW_SerialKiller_Figaro_Assistant_001_d8dc6cf0-2063-49e8-831e-64d998d77061);


EXITSECTION
ENDEXITSECTION

ParentTargetEdge "Act3b"
