Version 1
SubGoalCombiner SGC_AND

INITSECTION
DB_CampNight_ForceOnLevelSwap(NIGHT_AstarionHungerA_ec01fb84-d9ef-47b6-8b32-6620edd67d50, "ReadyCheck_ToCrecheFromGoblinCamp", 1, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_AstarionHungerA_ec01fb84-d9ef-47b6-8b32-6620edd67d50, "ReadyCheck_ToCrecheFromPlains", 1, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_AstarionHungerA_ec01fb84-d9ef-47b6-8b32-6620edd67d50, "ReadyCheck_ToSCLFromUnderdark", 1, 1);
DB_CampNight_ResurrectWhenForced(NIGHT_AstarionHungerA_ec01fb84-d9ef-47b6-8b32-6620edd67d50, S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);
DB_CampNight_ForceOnLevelSwap(NIGHT_AstarionHungerC_Bite_fe3fd3a0-70d1-4bc4-8a7f-4614f89ac23d, "ReadyCheck_ToCrecheFromGoblinCamp", 1, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_AstarionHungerC_Bite_fe3fd3a0-70d1-4bc4-8a7f-4614f89ac23d, "ReadyCheck_ToCrecheFromPlains", 1, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_AstarionHungerC_Bite_fe3fd3a0-70d1-4bc4-8a7f-4614f89ac23d, "ReadyCheck_ToSCLFromUnderdark", 1, 1);
DB_CampNight_ResurrectWhenForced(NIGHT_AstarionHungerC_Bite_fe3fd3a0-70d1-4bc4-8a7f-4614f89ac23d, S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);
DB_CampNight_ForceOnLevelSwap(NIGHT_Astarion_ScarReading_Fallback_bd01fc04-00ce-4e32-bbee-aa248728a116, "ReadyCheck_ToSCL02FromCRE", 0, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_Astarion_ScarReading_Fallback_bd01fc04-00ce-4e32-bbee-aa248728a116, "ReadyCheck_ToBGFromSCL", 0, 1);
DB_CampNight_ResurrectWhenForced(NIGHT_Astarion_ScarReading_Fallback_bd01fc04-00ce-4e32-bbee-aa248728a116, S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);
DB_CampNight_ForceOnLevelSwap(NIGHT_Astarion_CazadorNightmare_SecondDream_c4214d0e-ed58-49ba-9d44-e1ce8366fc87, "ReadyCheck_ToBGFromSCL", 0, 1);
DB_CampNight_ResurrectWhenForced(NIGHT_Astarion_CazadorNightmare_SecondDream_c4214d0e-ed58-49ba-9d44-e1ce8366fc87, S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);
DB_CampNight_ForceOnLevelSwap(NIGHT_Astarion_RaphaelsRevelation_3a3b2dca-7e94-47af-b81f-93194944c633, "ReadyCheck_ToBGFromSCL", 0, 1);
DB_CampNight_ResurrectWhenForced(NIGHT_Astarion_CazadorNightmare_SecondDream_c4214d0e-ed58-49ba-9d44-e1ce8366fc87, S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);
DB_CampNight_ForceOnLevelSwap(NIGHT_DaisyDream1_52669b07-9584-4c9d-8219-49679811fd4f, "ReadyCheck_ToCrecheFromGoblinCamp", 2, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_DaisyDream1_52669b07-9584-4c9d-8219-49679811fd4f, "ReadyCheck_ToCrecheFromPlains", 2, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_DaisyDream1_52669b07-9584-4c9d-8219-49679811fd4f, "ReadyCheck_ToSCLFromUnderdark", 2, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_InfernalBoxAppears_47942a99-c44e-4e90-a0a2-6956bed9dc5b, "ReadyCheck_ToCrecheFromGoblinCamp", 10, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_InfernalBoxAppears_47942a99-c44e-4e90-a0a2-6956bed9dc5b, "ReadyCheck_ToCrecheFromPlains", 10, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_InfernalBoxAppears_47942a99-c44e-4e90-a0a2-6956bed9dc5b, "ReadyCheck_ToSCLFromUnderdark", 10, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_DarkUrge_MurderOfAlfira_b0e97b06-b2f8-4376-829f-23d4b4bcf78d, "ReadyCheck_ToCrecheFromGoblinCamp", 11, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_DarkUrge_MurderOfAlfira_b0e97b06-b2f8-4376-829f-23d4b4bcf78d, "ReadyCheck_ToCrecheFromPlains", 11, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_DarkUrge_MurderOfAlfira_b0e97b06-b2f8-4376-829f-23d4b4bcf78d, "ReadyCheck_ToSCLFromUnderdark", 11, 1);
DB_FallbackCamp_ResurrectDarkUrge(NIGHT_DarkUrge_MurderOfAlfira_b0e97b06-b2f8-4376-829f-23d4b4bcf78d);
DB_CampNight_ForceOnLevelSwap(NIGHT_DarkUrge_ButlerIntro_e3dc106b-02f0-41ef-9642-ed7ccf971248, "ReadyCheck_ToCrecheFromGoblinCamp", 2, 0);
DB_CampNight_ForceOnLevelSwap(NIGHT_DarkUrge_ButlerIntro_e3dc106b-02f0-41ef-9642-ed7ccf971248, "ReadyCheck_ToCrecheFromPlains", 2, 0);
DB_CampNight_ForceOnLevelSwap(NIGHT_DarkUrge_ButlerIntro_e3dc106b-02f0-41ef-9642-ed7ccf971248, "ReadyCheck_ToSCLFromUnderdark", 2, 0);
DB_CampNight_ForceOnLevelSwap(NIGHT_DarkUrge_ButlerIntro_e3dc106b-02f0-41ef-9642-ed7ccf971248, "ReadyCheck_ToGoblinCampFromCreche", 2, 0);
DB_CampNight_ForceOnLevelSwap(NIGHT_DarkUrge_ButlerIntro_e3dc106b-02f0-41ef-9642-ed7ccf971248, "ReadyCheck_ToPlainsFromCreche", 2, 0);
DB_CampNight_ForceOnLevelSwap(NIGHT_DarkUrge_ButlerIntro_e3dc106b-02f0-41ef-9642-ed7ccf971248, "ReadyCheck_ToWLDFromSCL", 2, 0);
DB_CampNight_ForceOnLevelSwap(NIGHT_DarkUrge_ButlerIntro_e3dc106b-02f0-41ef-9642-ed7ccf971248, "ReadyCheck_ToBGFromSCL", 2, 0);
DB_FallbackCamp_ResurrectDarkUrge(NIGHT_DarkUrge_ButlerIntro_e3dc106b-02f0-41ef-9642-ed7ccf971248);
DB_CampNight_ForceOnLevelSwap(NIGHT_DarkUrge_KilledIsobel_c46aba07-a156-4bcd-a2da-3411651f28c2, "ReadyCheck_ToBGFromSCL", 0, 0);
DB_FallbackCamp_ResurrectDarkUrge(NIGHT_DarkUrge_KilledIsobel_c46aba07-a156-4bcd-a2da-3411651f28c2);
DB_CampNight_ForceOnLevelSwap(NIGHT_DarkUrge_SkippedTempleFinale_aa87947e-9ae0-4a2d-a3ed-fb2c9ca6be5c, "ReadyCheck_ToWYRFromLOW", 0, 0);
DB_FallbackCamp_ResurrectDarkUrge(NIGHT_DarkUrge_SkippedTempleFinale_aa87947e-9ae0-4a2d-a3ed-fb2c9ca6be5c);
DB_CampNight_ForceOnLevelSwap(NIGHT_Gale_TressymJoin_7ca98d47-e9fa-4f87-8728-8e56c4ee652d, "ReadyCheck_ToCrecheFromGoblinCamp", 0, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_Gale_TressymJoin_7ca98d47-e9fa-4f87-8728-8e56c4ee652d, "ReadyCheck_ToCrecheFromPlains", 0, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_Gale_TressymJoin_7ca98d47-e9fa-4f87-8728-8e56c4ee652d, "ReadyCheck_ToSCLFromUnderdark", 0, 1);
DB_CampNight_ResurrectWhenForced(NIGHT_Gale_TressymJoin_7ca98d47-e9fa-4f87-8728-8e56c4ee652d, S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604);
DB_CampNight_ForceOnLevelSwap(NIGHT_ORI_Gale_ElminsterVisit_a58e9b3e-b458-48be-b32a-a88a2c65bed5, "ReadyCheck_ToBGFromSCL", 0, 0);
DB_CampNight_ResurrectWhenForced(NIGHT_ORI_Gale_ElminsterVisit_a58e9b3e-b458-48be-b32a-a88a2c65bed5, S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604);
DB_CampNight_ForceOnLevelSwap(NIGHT_Gale_Fallback_AskFirstMagicItem_7ee4663c-cabf-4b57-b092-99e6b6eadbac, "ReadyCheck_ToCrecheFromGoblinCamp", 0, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_Gale_Fallback_AskFirstMagicItem_7ee4663c-cabf-4b57-b092-99e6b6eadbac, "ReadyCheck_ToCrecheFromPlains", 0, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_Gale_Fallback_AskFirstMagicItem_7ee4663c-cabf-4b57-b092-99e6b6eadbac, "ReadyCheck_ToSCLFromUnderdark", 0, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_PaladinsOfTyr_Forced_3a1be30d-8a75-4bee-b717-0b2e4d7bd1e9, "ReadyCheck_ToCrecheFromGoblinCamp", 0, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_PaladinsOfTyr_Forced_3a1be30d-8a75-4bee-b717-0b2e4d7bd1e9, "ReadyCheck_ToCrecheFromPlains", 0, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_PaladinsOfTyr_Forced_3a1be30d-8a75-4bee-b717-0b2e4d7bd1e9, "ReadyCheck_ToSCLFromUnderdark", 0, 1);
DB_CampNight_ResurrectWhenForced(NIGHT_PaladinsOfTyr_Forced_3a1be30d-8a75-4bee-b717-0b2e4d7bd1e9, S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c);
DB_CampNight_ForceOnLevelSwap(NIGHT_Laezel_PostCrecheDestruction_d8518d06-c176-4d5c-932d-c7b55d0802ab, "ReadyCheck_ToSCL02FromCRE", 3, 0);
DB_CampNight_ForceOnLevelSwap(NIGHT_Laezel_PostCrecheDestruction_d8518d06-c176-4d5c-932d-c7b55d0802ab, "ReadyCheck_ToGoblinCampFromCreche", 3, 0);
DB_CampNight_ForceOnLevelSwap(NIGHT_Laezel_PostCrecheDestruction_d8518d06-c176-4d5c-932d-c7b55d0802ab, "ReadyCheck_ToPlainsFromCreche", 3, 0);
DB_CampNight_ResurrectWhenForced(NIGHT_Laezel_PostCrecheDestruction_d8518d06-c176-4d5c-932d-c7b55d0802ab, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
DB_CampNight_ForceOnLevelSwap(NIGHT_Laezel_VlaakithBetrayal_bdaa7b4d-e60f-477d-a870-197bd3f4f83e, "ReadyCheck_ToSCL02FromCRE", 2, 0);
DB_CampNight_ForceOnLevelSwap(NIGHT_Laezel_VlaakithBetrayal_bdaa7b4d-e60f-477d-a870-197bd3f4f83e, "ReadyCheck_ToGoblinCampFromCreche", 2, 0);
DB_CampNight_ForceOnLevelSwap(NIGHT_Laezel_VlaakithBetrayal_bdaa7b4d-e60f-477d-a870-197bd3f4f83e, "ReadyCheck_ToPlainsFromCreche", 2, 0);
DB_CampNight_ResurrectWhenForced(NIGHT_Laezel_VlaakithBetrayal_bdaa7b4d-e60f-477d-a870-197bd3f4f83e, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
DB_CampNight_ForceOnLevelSwap(NIGHT_Laezel_PostZaithisk_8b11150d-e948-448e-99d1-104d0164a0df, "ReadyCheck_ToSCL02FromCRE", 1, 0);
DB_CampNight_ForceOnLevelSwap(NIGHT_Laezel_PostZaithisk_8b11150d-e948-448e-99d1-104d0164a0df, "ReadyCheck_ToGoblinCampFromCreche", 1, 0);
DB_CampNight_ForceOnLevelSwap(NIGHT_Laezel_PostZaithisk_8b11150d-e948-448e-99d1-104d0164a0df, "ReadyCheck_ToPlainsFromCreche", 1, 0);
DB_CampNight_ResurrectWhenForced(NIGHT_Laezel_PostZaithisk_8b11150d-e948-448e-99d1-104d0164a0df, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
DB_CampNight_ForceOnLevelSwap(NIGHT_Laezel_VossCampConfrontation_d6828c76-0e03-4aa1-b980-886fcf49f8a9, "ReadyCheck_ToSCL02FromCRE", 0, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_Laezel_VossCampConfrontation_d6828c76-0e03-4aa1-b980-886fcf49f8a9, "ReadyCheck_ToGoblinCampFromCreche", 0, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_Laezel_VossCampConfrontation_d6828c76-0e03-4aa1-b980-886fcf49f8a9, "ReadyCheck_ToPlainsFromCreche", 0, 1);
DB_CampNight_ResurrectWhenForced(NIGHT_Laezel_VossCampConfrontation_d6828c76-0e03-4aa1-b980-886fcf49f8a9, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
DB_CampNight_ForceOnLevelSwap(NIGHT_NightsongShadowheartVisit_5cf06d9e-44ce-4431-a1c6-839bfdad5f79, "ReadyCheck_ToBGFromSCL", 0, 0);
DB_CampNight_ResurrectWhenForced(NIGHT_NightsongShadowheartVisit_5cf06d9e-44ce-4431-a1c6-839bfdad5f79, S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679);
DB_CampNight_ForceOnLevelSwap(NIGHT_Wyll_MizorasJudgement_ad448187-17b4-45a1-9acc-eb8b016e1dd2, "ReadyCheck_ToCrecheFromGoblinCamp", 0, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_Wyll_MizorasJudgement_ad448187-17b4-45a1-9acc-eb8b016e1dd2, "ReadyCheck_ToCrecheFromPlains", 0, 1);
DB_CampNight_ForceOnLevelSwap(NIGHT_Wyll_MizorasJudgement_ad448187-17b4-45a1-9acc-eb8b016e1dd2, "ReadyCheck_ToSCLFromUnderdark", 0, 1);
DB_CampNight_ResurrectWhenForced(NIGHT_Wyll_MizorasJudgement_ad448187-17b4-45a1-9acc-eb8b016e1dd2, S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d);

KBSECTION
PROC
PROC_FallbackCamp_CheckSpecialConditions((STRING)_Var1, (STRING)_Var1, (STRING)_Var1, (STRING)_Var1, (STRING)_Var1)
AND
DB_Act1a_MainQuestFallback_BlockTeleport(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_InCamp(S_GLO_JergalAvatar_0133f2ad-e121-4590-b5f0-a79413919805, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GLO_Jergal_MoveToCamp();
DB_Camp_RequiredTalks(S_GLO_JergalAvatar_0133f2ad-e121-4590-b5f0-a79413919805);

PROC
PROC_FallbackCamp_CheckSpecialConditions((STRING)_Var1, (STRING)_Var1, (STRING)_Var1, (STRING)_Var1, (STRING)_Var1)
AND
DB_Act1a_MainQuestFallback_BlockTeleport(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GLO_MonitorIntro_HadIntro(1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_GLO_Monitor_DismissToCamp(1);
DB_Camp_RequiredTalks(S_GLO_Monitor_f65becd6-5cd7-4c88-b85e-6dd06b60f7b8);
SetFlag(CAMP_MonitorIntro_ForcedEncounter_532bba9f-d7e8-cf36-db86-87bf8c4d22c8);

PROC
PROC_FallbackCamp_LeftCamp(_, _, _, _, _)
AND
DB_GLO_Monitor_DismissToCamp(1, _, _, _, _)
THEN
DB_GLO_MonitorIntro_HadIntro(1);
NOT DB_GLO_Monitor_DismissToCamp(1);
PROC_RemoveAllDialogEntriesForSpeaker(S_GLO_Monitor_f65becd6-5cd7-4c88-b85e-6dd06b60f7b8);
PROC_Poof(S_GLO_Monitor_f65becd6-5cd7-4c88-b85e-6dd06b60f7b8);

QRY
QRY_FallbackCamp_CampNightMeetsRequirements(NIGHT_AstarionHungerA_ec01fb84-d9ef-47b6-8b32-6620edd67d50, _, _, _, _)
AND
DB_Avatars(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
AND NOT
DB_GlobalFlag(GEN_SoloPlayer_29e32f83-2001-0dbc-7df9-3ca2b3bc4349, _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_FallbackCamp_CampNightMeetsRequirements(NIGHT_AstarionHungerC_Bite_fe3fd3a0-70d1-4bc4-8a7f-4614f89ac23d, _, _, _, _)
AND
DB_Players(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
AND NOT
DB_Avatars(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_FallbackCamp_CampNightMeetsRequirements(NIGHT_Astarion_ScarReading_Fallback_bd01fc04-00ce-4e32-bbee-aa248728a116, _, _, _, _)
AND
DB_GlobalFlag(ORI_Astarion_Knows_Vampireness_43c71ab0-1aca-484a-950d-54106ae46da5, _, _, _, _)
AND
DB_GlobalFlag(ORI_Astarion_Knows_CazadorMaster_7236c69b-fe20-afdb-a6fa-15c1fb9fb6ae, _, _, _, _)
AND
DB_Players(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
AND NOT
DB_Avatars(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
THEN
DB_NOOP(1);

IF
TextEvent("fallbackcamp_ScarReading", _, _, _, _)
THEN
SetFlag(ORI_Astarion_Knows_Vampireness_43c71ab0-1aca-484a-950d-54106ae46da5);
SetFlag(ORI_Astarion_Knows_CazadorMaster_7236c69b-fe20-afdb-a6fa-15c1fb9fb6ae);

QRY
QRY_FallbackCamp_CampNightMeetsRequirements(NIGHT_Astarion_CazadorNightmare_SecondDream_c4214d0e-ed58-49ba-9d44-e1ce8366fc87, _, _, _, _)
AND
DB_Avatars(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
AND NOT
DB_GlobalFlag(ORI_Astarion_State_GotQuestFromRaphael_21b2c417-9d93-4df3-87b6-027e5d1cd4c5, _, _, _, _)
AND NOT
DB_GlobalFlag(SHA_Orthon_State_DefeatedOnce_8dd589d6-90fc-4a3b-b369-10440bd56520, _, _, _, _)
THEN
DB_NOOP(1);

IF
TextEvent("fallbackcamp_CazadorNightmare", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DebugText(_Var1, "Preparing forced night: Astarion_CazadorNightmare");
ClearFlag(ORI_Astarion_State_GotQuestFromRaphael_21b2c417-9d93-4df3-87b6-027e5d1cd4c5);
ClearFlag(SHA_Orthon_State_DefeatedOnce_8dd589d6-90fc-4a3b-b369-10440bd56520);

QRY
QRY_FallbackCamp_CampNightMeetsRequirements(NIGHT_Astarion_RaphaelsRevelation_3a3b2dca-7e94-47af-b81f-93194944c633, _, _, _, _)
AND
DB_Players(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
AND
DB_GlobalFlag(ORI_Astarion_State_GotQuestFromRaphael_21b2c417-9d93-4df3-87b6-027e5d1cd4c5, _, _, _, _)
AND
DB_GlobalFlag(SHA_Orthon_State_DefeatedOnce_8dd589d6-90fc-4a3b-b369-10440bd56520, _, _, _, _)
THEN
DB_NOOP(1);

IF
TextEvent("fallbackcamp_RaphaelsRevelation", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DebugText(_Var1, "Preparing forced night: Astarion_RaphaelsRevelation");
SetFlag(ORI_Astarion_State_GotQuestFromRaphael_21b2c417-9d93-4df3-87b6-027e5d1cd4c5);
SetFlag(SHA_Orthon_State_DefeatedOnce_8dd589d6-90fc-4a3b-b369-10440bd56520);

QRY
QRY_FallbackCamp_CampNightMeetsRequirements(NIGHT_InfernalBoxAppears_47942a99-c44e-4e90-a0a2-6956bed9dc5b, _, _, _, _)
AND NOT
DB_GlobalFlag(GLO_InfernalBox_State_TeamHasBox_d8b25e35-ec84-45e5-8395-5ce6faa36fbd, _, _, _, _)
THEN
DB_NOOP(1);

IF
TextEvent("fallbackcamp_InfernalBoxAppears", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DebugText(_Var1, "Preparing forced night: InfernalBoxAppears");
ClearFlag(GLO_InfernalBox_State_TeamHasBox_d8b25e35-ec84-45e5-8395-5ce6faa36fbd);

QRY
QRY_FallbackCamp_CampNightMeetsRequirements(NIGHT_DaisyDream1_52669b07-9584-4c9d-8219-49679811fd4f, _, _, _, _)
THEN
DB_NOOP(1);

PROC
PROC_FallbackCamp_OnCampNightQueued(NIGHT_DaisyDream1_52669b07-9584-4c9d-8219-49679811fd4f, _, _, _, _)
THEN
NOT DB_CampNight_IVB(NIGHT_DaisyDream1_52669b07-9584-4c9d-8219-49679811fd4f, CAMP_Daisy1_IVB_dc0d3343-7256-e2a6-c211-14680236c139, NULL_00000000-0000-0000-0000-000000000000);
NOT DB_CampNight_CFM(NIGHT_DaisyDream1_52669b07-9584-4c9d-8219-49679811fd4f, CAMP_Daisy1_CRD_Laezel_BeforeDream_1375618b-f1e6-7f74-4748-beabc24cdc96);

QRY
QRY_FallbackCamp_CampNightMeetsRequirements(NIGHT_DarkUrge_MurderOfAlfira_b0e97b06-b2f8-4376-829f-23d4b4bcf78d, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_ORI_DarkUrge(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
TextEvent("fallbackcamp_ButlerIntro", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DebugText(_Var1, "Preparing forced night: DarkUrge_ButlerIntro");
SetFlag(NIGHT_DarkUrge_MurderOfAlfira_b0e97b06-b2f8-4376-829f-23d4b4bcf78d);

IF
TextEvent("fallbackcamp_KilledIsobel", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DebugText(_Var1, "Preparing forced night: DarkUrge_KilledIsobel");
SetFlag(ORI_DarkUrge_KilledIsobel_Requirement_b19523f2-d4bf-42f7-9834-2d19e04b2119);

IF
TextEvent("fallbackcamp_SkippedTempleFinale", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DebugText(_Var1, "Preparing forced night: DarkUrge_SkippedTempleFinale");
SetFlag(ORI_DarkUrge_State_MissedTempleFinale_640cb288-0b40-434a-b13c-0c871d931bcc);

PROC
PROC_FallbackCamp_EnsureResurrections()
AND
DB_FallbackCamp_ResurrectDarkUrge(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Camp_QueuedNight(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_ORI_DarkUrge(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
Resurrect(_Var2);

QRY
QRY_FallbackCamp_CampNightMeetsRequirements(NIGHT_Gale_TressymJoin_7ca98d47-e9fa-4f87-8728-8e56c4ee652d, _, _, _, _)
AND
DB_Avatars(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, _, _, _, _)
THEN
DB_NOOP(1);

IF
TextEvent("fallbackcamp_ElminsterVisit", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DebugText(_Var1, "Preparing forced night: Gale_ElminsterVisit");
SetFlag(ORI_Gale_State_GotOneMagicItem_6fec5439-a66e-4aff-b62b-69f88648c34d);
SysCompleteGoal("ORI_Gale_Elminster_Setup");
PROC_ORI_Gale_Elminster_SetupBackupMorningCFM();

QRY
QRY_FallbackCamp_CampNightMeetsRequirements(NIGHT_PaladinsOfTyr_Forced_3a1be30d-8a75-4bee-b717-0b2e4d7bd1e9, _, _, _, _)
AND NOT
DB_Avatars(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, _, _, _, _)
AND
DB_PartOfTheTeam(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, _, _, _, _)
AND NOT
DB_GlobalFlag(ORI_Karlach_Knows_InfernalEngineExists_9b6d609a-2081-b5de-7dd6-12c425a8bc17, _, _, _, _)
THEN
DB_NOOP(1);

IF
FlagSet(PLA_PaladinsOfTyr_Event_BlockActChange_530b707f-4af2-52bb-6d7b-e3971e6bae54, _, _, _, _)
AND
DB_FallbackCamp_QueuedLevelswap(_Var3, _Var4, _Var5, _, _)
THEN
NOT DB_FallbackCamp_QueuedLevelswap(_Var3, _Var4, _Var5);

IF
FlagSet(PLA_PaladinsOfTyr_Event_BlockActChange_530b707f-4af2-52bb-6d7b-e3971e6bae54, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
SetFlag(ORI_Karlach_State_PromisedToDealWithPaladins_41e9f88c-0f3e-427a-911f-5df379642fe4, NULL_00000000-0000-0000-0000-000000000000);
ClearFlag(PLA_PaladinsOfTyr_Event_BlockActChange_530b707f-4af2-52bb-6d7b-e3971e6bae54, NULL_00000000-0000-0000-0000-000000000000);

IF
DB_Camp_QueuedNight(NIGHT_PaladinsOfTyr_Forced_3a1be30d-8a75-4bee-b717-0b2e4d7bd1e9, _Var1, _Var1, _Var1, _Var1)
AND
DB_HandlingRelationshipDialog(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, _Var1, _Var2, _, _, _, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != CAMP_Karlach_CRD_PaladinsOfTyrAndEngine_d2af9413-43fa-05a3-bd83-0d7164aa5100
THEN
PROC_CancelRelationshipDialog(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, _Var1, _Var2);

QRY
QRY_FallbackCamp_CampNightMeetsRequirements(NIGHT_Laezel_VossCampConfrontation_d6828c76-0e03-4aa1-b980-886fcf49f8a9, _, _, _, _)
AND
DB_PartOfTheTeam(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
DB_GlobalFlag(ORI_Laezel_State_BetrayedByVlaakith_175d8487-99dc-4009-9b45-6e9f29708cd7, _, _, _, _)
THEN
DB_NOOP(1);

IF
TextEvent("fallbackcamp_PostCrecheDestruction", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DebugText(_Var1, "Preparing forced night: Laezel_PostCrecheDestruction");
SetFlag(ORI_Laezel_State_CrecheExploded_31ee1ed3-b163-4d1a-84f3-d37521900a87);

IF
TextEvent("fallbackcamp_VlaakithBetrayal", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DebugText(_Var1, "Preparing forced night: Laezel_VlaakithBetrayal");
SetFlag(ORI_Laezel_State_BetrayedByVlaakith_175d8487-99dc-4009-9b45-6e9f29708cd7);

IF
TextEvent("fallbackcamp_PostZaithisk", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DebugText(_Var1, "Preparing forced night: Laezel_PostZaithisk");
SetFlag(CRE_GithInfirmary_Knows_DiscoveredZaithisk_27f56752-1bc6-46a1-a167-1bcfa12a5fff);

IF
TextEvent("fallbackcamp_NightsongShadowheartVisit", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DebugText(_Var1, "Preparing forced night: NightsongShadowheartVisit");
SetFlag(SCE_Epilogue_State_HasStarted_9b4bae0b-6464-4b0e-a0e3-41201c0c3c9e);
PROC_SCE_StartSetupDebrief();
PROC_GLO_Nightsong_GiveNightsongEquipment();
PROC_CharacterFullRestore(S_GLO_Nightsong_6c55edb0-901b-4ba4-b9e8-3475a8392d9b);
PROC_State_Progress(S_GLO_Nightsong_6c55edb0-901b-4ba4-b9e8-3475a8392d9b, "SHA_Nightsong", "SHA_State_Nightsong_KethericDefeated");
PROC_SCE_NightsongIsobelReunion_MoveNightsongToCamp();
RemoveStatus(S_GLO_Nightsong_6c55edb0-901b-4ba4-b9e8-3475a8392d9b, "SHA_NIGHTSONG_SOULCAGE", NULL_00000000-0000-0000-0000-000000000000);
PROC_SceneOver("SHA_NightsongPrison_MeetingNightsong");
PROC_SceneOver("SCE_IsobelNightsongReunion_Scene_MainReunion");

QRY
QRY_FallbackCamp_CampNightMeetsRequirements(NIGHT_Wyll_MizorasJudgement_ad448187-17b4-45a1-9acc-eb8b016e1dd2, _, _, _, _)
AND
DB_PartOfTheTeam(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, _, _, _, _)
AND NOT
DB_GlobalFlag(CAMP_MizorasJudgement_Event_Judged_c6d2140f-312d-65d4-e66e-92de4258b3f4, _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(ORI_WyllConfrontation_State_ResolvedPeacefuly_fa3b8420-26bc-361d-8fbf-c6da37353446);


EXITSECTION
ENDEXITSECTION

ParentTargetEdge "ModWrapper_Gustav"
