Version 1
SubGoalCombiner SGC_AND

INITSECTION
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_GondianWorker01_PostIRNPosition_04f31a76-fa0f-4f31-a904-7009865a2799, S_LOW_GondianWorker01_92010ea3-cd5e-4896-97fc-1f1e7942fcf5);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_GondianWorker08_PostIRNPosition_f4ef5ecb-f5dc-4436-8afd-a06e3c6f9ddb, S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer02_AfterIRNPos_778532e4-4c63-4d57-8654-89bd949c04f0, S_LOW_BaneiteOfficer02_de084b09-99c6-426e-9159-f692d180d418);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer17_AfterIRNPos_23c156ab-6ff3-4366-867f-4c46040128d8, S_LOW_BaneiteOfficer17_f6614259-eec4-4c38-b87b-cf5c806be6fd);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer03_AfterIRNPos_5cc1e98b-b111-43f5-95b5-8abfad08966a, S_LOW_BaneiteOfficer03_71dbaf54-1274-4671-ae51-c7e512f02835);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_GondianWorker09_AfterIRNPos_44871f76-fa92-40df-b129-df98c6a39ce7, S_LOW_GondianWorker09_2fb2c297-3c00-4b98-8412-41aea0087db5);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer07_AfterIRNPos_7a43e10a-322c-49ec-a215-4a1461e70e4c, S_LOW_BaneiteOfficer07_2dc326b9-73f4-40a6-af7f-54955e3b1ebd);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer18_AfterIRNPos_fbdcd679-d34a-44f6-a836-74aec1b45fbd, S_LOW_BaneiteOfficer18_f4a8f9e0-564c-41ed-8598-4c350b88f0e8);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer08_AfterIRNPos_6bbc9fd3-3905-40ef-bb37-f30877f44952, S_LOW_BaneiteOfficer08_015d02bd-0c8e-41c8-a6da-df92d71084d2);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_LabRoomWatcher01_AfterIRNPos_eead7c8e-adcd-49a0-a413-1194baaca35b, S_LOW_LabRoomWatcher01_d48bb47b-7e55-45ab-ac19-708bd91e6eb4);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer10_AfterIRNPos_a46dd58c-8f16-4a68-877a-1d850d04fe7a, S_LOW_BaneiteOfficer10_Leader_a2db5bf9-03a9-408e-971f-fc63741308bb);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_GondianWorker06_AfterIRNPos_dde562b4-761d-41ac-9f03-3adb0c2128b4, S_LOW_GondianWorker06_53a85a70-979b-480a-afb1-ec8d9239e0f8);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer06_AfterIRNPos_2886b652-6689-4c63-98a3-373a80682986, S_LOW_BaneiteOfficer06_0ce716ac-f6fa-4b7d-8fda-456b0e74f90f);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer09_AfterIRNPos_092065ab-b77f-4b77-a35d-7c4e47beff62, S_LOW_BaneiteOfficer09_0c5259f6-3c86-4e84-b61e-42e9f31691ce);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer21_AfterIRNPos_a9dd9a01-171c-4387-be4f-75207048e20b, S_LOW_BaneiteOfficer21_9a64e678-c5aa-43ed-8765-33882e9f1ab9);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer14_AfterIRNPos_d1bc41cf-368c-4e3e-96ad-bc586cf2f71e, S_LOW_BaneiteOfficer14_750a35b3-b0c5-4007-ae1a-4446c95a56ae);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer15_AfterIRNPos_74543758-b504-4c3c-8da2-156409569b66, S_LOW_BaneiteOfficer15_0b5a37de-60f3-403c-b5e8-b74afd50fa3d);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer19_AfterIRNPos_355eba4f-6012-4dd6-9eab-1086ab029d07, S_LOW_BaneiteOfficer19_f5a48aa9-d67a-4fcd-9fe8-15e933314ca1);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer20_AfterIRNPos_f9aa723c-9b54-4f64-8530-646b4cfcda42, S_LOW_BaneiteOfficer20_4b2f8018-f988-4dfd-bb59-962dc90070f3);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_GondianWorker04_AfterIRNPos_c59924b9-6615-415a-8f98-26fec2df5341, S_LOW_GondianWorker04_6cc09c40-6b09-4e92-ad36-4e5ad72f7c43);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_GondianWorker05_AfterIRNPos_88e3de6b-dd3e-4fd3-89af-866d6ccf889d, S_LOW_GondianWorker05_e86d2e9b-f55b-4eaf-9ba6-0245d17b6d1c);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_GondianWorker10_AfterIRNPos_24831fcc-333c-437e-8d70-f5b6f7b833cb, S_LOW_GondianWorker10_ffc8a25f-6ceb-4081-8e07-eca2205989c5);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer01_AfterIRNPos_f895031c-9c8f-41af-b131-e4e1cde58066, S_LOW_BaneiteOfficer01_db345b42-35f7-4a31-b5f4-1c4b86ebd25c);
DB_LOW_SteelWatchFoundry_AfterIRNPositions(S_LOW_BaneiteOfficer16_AfterIRNPos_5fefb855-109d-4f75-8d1b-22345378c8a4, S_LOW_BaneiteOfficer16_38d84851-00b5-400c-81eb-7767a861e8e0);
DB_LOW_SteelWatchFoundry_AfterIRNBaneites(S_LOW_BaneiteOfficer_PostIRN01_36c0bb47-a8cc-4381-882b-a2ded38d0b5c);
DB_LOW_SteelWatchFoundry_AfterIRNBaneites(S_LOW_BaneiteOfficer_PostIRN02_2cc225cf-794a-450a-bbb7-4b3400cb3c74);
PROC_SetOnStage(S_LOW_BaneiteOfficer_PostIRN01_36c0bb47-a8cc-4381-882b-a2ded38d0b5c, 0);
PROC_SetOnStage(S_LOW_BaneiteOfficer_PostIRN02_2cc225cf-794a-450a-bbb7-4b3400cb3c74, 0);
DB_GLO_DefeatCounter(S_LOW_BaneiteOfficer02_de084b09-99c6-426e-9159-f692d180d418, "LOW_SteelWatchFoundry_WorkroomOriginalBaneites");
DB_GLO_DefeatCounter(S_LOW_BaneiteOfficer17_f6614259-eec4-4c38-b87b-cf5c806be6fd, "LOW_SteelWatchFoundry_WorkroomOriginalBaneites");
DB_GLO_DefeatCounter(S_LOW_BaneiteOfficer03_71dbaf54-1274-4671-ae51-c7e512f02835, "LOW_SteelWatchFoundry_WorkroomOriginalBaneites");
DB_GLO_DefeatCounter_AllDefeatedGlobalFlag("LOW_SteelWatchFoundry_WorkroomOriginalBaneites", LOW_SteelWatchFoundry_State_OriginalWorkroomBaneitesDefeated_e33e6570-c885-4a61-8b26-16e1d2784137);
DB_GLO_DefeatCounter(S_LOW_BaneiteOfficer_PostIRN01_36c0bb47-a8cc-4381-882b-a2ded38d0b5c, "LOW_SteelWatchFoundry_WorkroomPostIRNBaneites");
DB_GLO_DefeatCounter(S_LOW_BaneiteOfficer_PostIRN02_2cc225cf-794a-450a-bbb7-4b3400cb3c74, "LOW_SteelWatchFoundry_WorkroomPostIRNBaneites");
DB_GLO_DefeatCounter_AllDefeatedGlobalFlag("LOW_SteelWatchFoundry_WorkroomPostIRNBaneites", LOW_SteelWatchFoundry_State_PostIRNWorkroomBaneitesDefeated_1c0a4b23-9bc2-4d25-9c89-c066ee42f6c7);
DB_GLO_DefeatCounter(S_LOW_GondianWorker01_92010ea3-cd5e-4896-97fc-1f1e7942fcf5, "LOW_SteelWatchFoundry_WorkroomOriginalGondians");
DB_GLO_DefeatCounter(S_LOW_GondianWorker02_a13a0681-de86-45f2-922c-85cb1fad1cfc, "LOW_SteelWatchFoundry_WorkroomOriginalGondians");
DB_GLO_DefeatCounter(S_LOW_GondianWorker03_b28f2395-a5d4-4a4a-afcd-cddf9949a089, "LOW_SteelWatchFoundry_WorkroomOriginalGondians");
DB_GlobalFlagReactionAfterDialog(LOW_SteelWatchFoundry_Event_GondianWorker01_Leaves_deb4318d-300b-cc4d-6d7d-2040736fbbe8, LOW_SteelWatchFoundry_GondianWorker01_AfterIRN_4ceda54b-1f3f-66a1-e0f8-89d5f81e01d4);
DB_HasItemTemplateScriptFlag(1, LOW_SteelWatchFoundry_FundangoLosesHope_d8add8fe-7b67-4830-7f00-0b10ce3a549c, LOOT_GEN_Runepowder_Time_Bomb_A_9a711e91-04d0-4300-8ca8-b4cc07529a56, 2);
DB_GlobalFlagReactionAfterDialog(LOW_SteelWatchFoundry_State_FundangoWalkedOff_3ac36df2-ef73-4fa4-8800-0f694388073a, LOW_SteelWatchFoundry_FundangoLosesHope_d8add8fe-7b67-4830-7f00-0b10ce3a549c);
PROC_SetOnStage(S_LOW_GondianWorker_PostIRN01_a4eb6135-5656-430f-b5f6-a217feb6eb0d, 0);
PROC_SetOnStage(S_LOW_GondianWorker_PostIRN02_b264c860-f30a-45a8-b35d-9f03a0d393b1, 0);
DB_Dialogs(S_LOW_GondianWorker_PostIRN01_a4eb6135-5656-430f-b5f6-a217feb6eb0d, LOW_SteelWatchFoundry_GondianWorker_PostIRN01_cab1183c-3730-dab7-f6d6-1019d66b3a47);
DB_Dialogs(S_LOW_GondianWorker_PostIRN02_b264c860-f30a-45a8-b35d-9f03a0d393b1, LOW_SteelWatchFoundry_GondianWorker_PostIRN02_378637d3-e666-6c37-5a54-10c6436e6e65);
DB_GlobalFlagReactionAfterDialog(LOW_SteelWatchFoundry_State_ZannerLeavesFoundry_b54f53d7-fedc-8fe5-f2e1-5121d157018c, LOW_SteelWatchFoundry_GondianWorker08_Leader_AfterIRN_419df89c-ab1e-a95c-25c6-77651b70386f);

KBSECTION
IF
TextEvent("LOW_Foundry_FundangoFollower", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TeleportTo(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, _Var1, "", 0, 0, 0, 1, 1);
SetFlag(LOW_SteelWatchFoundry_State_FundangoFollower_a3021d6d-9cc1-3545-54f3-53a35d44d89b);
AddPartyFollower(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, _Var1);
DB_LOW_SteelWatchFoundry_FundangoFollowerOf(_Var1);

IF
TextEvent("LOW_IRN_PrisonersSaved", _, _, _, _)
THEN
PROC_LOW_SteelWatchFoundry_SetUpAllPrisonersSaved();

IF
TextEvent("LOW_IRN_PrisonersDead", _, _, _, _)
THEN
PROC_LOW_SteelWatchFoundry_SetUpAllPrisonersDead();

PROC
PROC_LOW_SteelWatchFoundry_SetUpAllPrisonersDead()
THEN
SetFlag(LOW_SteelWatchFoundry_State_ReturnedFromIronThrone_16f58dd6-71c1-41e8-b053-b32991ac8fa1);
SetFlag(IRN_IronThrone_State_Visited_5b3fb5a7-61e8-44a9-a0a1-b6b45b59a23c);
SetFlag(IRN_IronThrone_State_Destroyed_91795368-af06-4b56-9ac1-b78995aa9ea9);
SetFlag(LOW_SteelWatchFoundry_State_AllIronThronePrisonersDead_4fefe27f-7cd6-44b1-9322-a57b22246271);
SetFlag(LOW_SteelWatchFoundry_State_MajorityIronThronePrisonersDead_6c40a75d-32ae-4402-a54c-062805f7ee7d);
SetFlag(LOW_SteelWatchFoundry_State_AnyIronThronePrisonersDead_5d6c4329-ee56-4084-8220-d627b716ac87);

PROC
PROC_LOW_SteelWatchFoundry_SetUpMajorityPrisonersDead()
THEN
ClearFlag(LOW_SteelWatchFoundry_State_AllIronThronePrisonersDead_4fefe27f-7cd6-44b1-9322-a57b22246271);
SetFlag(LOW_SteelWatchFoundry_State_MajorityIronThronePrisonersDead_6c40a75d-32ae-4402-a54c-062805f7ee7d);
SetFlag(LOW_SteelWatchFoundry_State_AnyIronThronePrisonersDead_5d6c4329-ee56-4084-8220-d627b716ac87);
SetFlag(LOW_SteelWatchFoundry_State_ReturnedFromIronThrone_16f58dd6-71c1-41e8-b053-b32991ac8fa1);
SetFlag(IRN_IronThrone_State_Visited_5b3fb5a7-61e8-44a9-a0a1-b6b45b59a23c);
SetFlag(IRN_IronThrone_State_Destroyed_91795368-af06-4b56-9ac1-b78995aa9ea9);

PROC
PROC_LOW_SteelWatchFoundry_SetUpMajorityPrisonersSaved()
THEN
ClearFlag(LOW_SteelWatchFoundry_State_AllIronThronePrisonersDead_4fefe27f-7cd6-44b1-9322-a57b22246271);
ClearFlag(LOW_SteelWatchFoundry_State_MajorityIronThronePrisonersDead_6c40a75d-32ae-4402-a54c-062805f7ee7d);
SetFlag(LOW_SteelWatchFoundry_State_AnyIronThronePrisonersDead_5d6c4329-ee56-4084-8220-d627b716ac87);
SetFlag(LOW_SteelWatchFoundry_State_ReturnedFromIronThrone_16f58dd6-71c1-41e8-b053-b32991ac8fa1);
SetFlag(IRN_IronThrone_State_Visited_5b3fb5a7-61e8-44a9-a0a1-b6b45b59a23c);
SetFlag(IRN_IronThrone_State_Destroyed_91795368-af06-4b56-9ac1-b78995aa9ea9);

PROC
PROC_LOW_SteelWatchFoundry_SetUpAllPrisonersSaved()
THEN
ClearFlag(LOW_SteelWatchFoundry_State_AllIronThronePrisonersDead_4fefe27f-7cd6-44b1-9322-a57b22246271);
ClearFlag(LOW_SteelWatchFoundry_State_MajorityIronThronePrisonersDead_6c40a75d-32ae-4402-a54c-062805f7ee7d);
ClearFlag(LOW_SteelWatchFoundry_State_AnyIronThronePrisonersDead_5d6c4329-ee56-4084-8220-d627b716ac87);
SetFlag(LOW_SteelWatchFoundry_State_ReturnedFromIronThrone_16f58dd6-71c1-41e8-b053-b32991ac8fa1);
SetFlag(IRN_IronThrone_State_Visited_5b3fb5a7-61e8-44a9-a0a1-b6b45b59a23c);
SetFlag(IRN_IronThrone_State_Destroyed_91795368-af06-4b56-9ac1-b78995aa9ea9);

IF
DB_GlobalFlag(Debug_LOW_SteelWatchFoundry_PrisonersKilled_20b8992f-c8c5-4d8a-ac66-dd6c6a44b189, _, _, _, _)
THEN
PROC_LOW_SteelWatchFoundry_SetUpAllPrisonersDead();

IF
DB_GlobalFlag(Debug_LOW_SteelWatchFoundry_MajorityPrisonersKilled_2c837826-72f9-434a-9f79-900fb2a1436a, _, _, _, _)
THEN
PROC_LOW_SteelWatchFoundry_SetUpMajorityPrisonersDead();

IF
DB_GlobalFlag(Debug_LOW_SteelWatchFoundry_MajorityPrisonersSaved_64a811a5-9686-4eae-9054-bcc4bc93e210, _, _, _, _)
THEN
PROC_LOW_SteelWatchFoundry_SetUpMajorityPrisonersSaved();

IF
DB_GlobalFlag(Debug_LOW_SteelWatchFoundry_PrisonersSaved_35d5b758-3486-44ff-bf93-af8efd7ff063, _, _, _, _)
THEN
PROC_LOW_SteelWatchFoundry_SetUpAllPrisonersSaved();

IF
DB_CurrentLevel("CTY_Main_A", _, _, _, _)
AND
DB_GlobalFlag(IRN_IronThrone_State_Visited_5b3fb5a7-61e8-44a9-a0a1-b6b45b59a23c, _, _, _, _)
AND
DB_GlobalFlag(IRN_IronThrone_State_Destroyed_91795368-af06-4b56-9ac1-b78995aa9ea9, _, _, _, _)
AND
QRY_OnlyOnce("LOW_SteelWatchFounry_PostIRNStateSetUp", _, _, _, _)
THEN
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN();
SetFlag(LOW_SteelWatchFoundry_State_ReturnedFromIronThrone_16f58dd6-71c1-41e8-b053-b32991ac8fa1);

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
AND
DB_LOW_SteelWatchFoundry_AfterIRNPositions(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var2, _Var1, "", 0, 0, 0, 1, 1);
PROC_SetOnStage(_Var2, 1);

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
THEN
PROC_SetOnStage(S_LOW_BaneiteOfficer_PostIRN01_36c0bb47-a8cc-4381-882b-a2ded38d0b5c, 1);
PROC_SetOnStage(S_LOW_BaneiteOfficer_PostIRN02_2cc225cf-794a-450a-bbb7-4b3400cb3c74, 1);

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
THEN
PROC_RemoveDialog(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d);
DB_Dialogs(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, LOW_SteelWatchFoundry_GondianWorker08_Leader_AfterIRN_419df89c-ab1e-a95c-25c6-77651b70386f);
PROC_RemoveDialog(S_LOW_GondianWorker01_92010ea3-cd5e-4896-97fc-1f1e7942fcf5);
DB_Dialogs(S_LOW_GondianWorker01_92010ea3-cd5e-4896-97fc-1f1e7942fcf5, LOW_SteelWatchFoundry_GondianWorker01_AfterIRN_4ceda54b-1f3f-66a1-e0f8-89d5f81e01d4);
PROC_SceneOver("LOW_SteelWatchFoundry_WorkroomEncounter");

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
AND
DB_SpotPlayers(_Var1, "LOW_SteelWatchFoundry_WorkroomEncounter", _, _, _Var1)
THEN
PROC_SpotPlayers_StopSpotting(_Var1, "LOW_SteelWatchFoundry_WorkroomEncounter");

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
THEN
PROC_TriggerUnregisterForPlayers(S_LOW_DeadMansSwitchThreatCineStartArea_9a2e2fde-2084-492e-9fd9-1485eb10a9da);

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
THEN
DB_SpotPlayers(S_LOW_GondianWorker01_92010ea3-cd5e-4896-97fc-1f1e7942fcf5, "LOW_SteelWatchFoundry_PostIRNConfrontaiton", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, "LOW_SteelWatchFoundry_PostIRNConfrontaiton", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers(S_LOW_BaneiteOfficer_PostIRN01_36c0bb47-a8cc-4381-882b-a2ded38d0b5c, "LOW_SteelWatchFoundry_PostIRNConfrontaiton", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers(S_LOW_BaneiteOfficer_PostIRN02_2cc225cf-794a-450a-bbb7-4b3400cb3c74, "LOW_SteelWatchFoundry_PostIRNConfrontaiton", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers_SpotTrigger(S_LOW_GondianWorker01_92010ea3-cd5e-4896-97fc-1f1e7942fcf5, "LOW_SteelWatchFoundry_PostIRNConfrontaiton", S_LOW_AfterIRN_ConfrontationZone_bfb70bf1-0a92-4753-8538-7b1b54c194d5);
DB_SpotPlayers_SpotTrigger(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, "LOW_SteelWatchFoundry_PostIRNConfrontaiton", S_LOW_AfterIRN_ConfrontationZone_bfb70bf1-0a92-4753-8538-7b1b54c194d5);
DB_SpotPlayers_SpotTrigger(S_LOW_BaneiteOfficer_PostIRN01_36c0bb47-a8cc-4381-882b-a2ded38d0b5c, "LOW_SteelWatchFoundry_PostIRNConfrontaiton", S_LOW_AfterIRN_ConfrontationZone_bfb70bf1-0a92-4753-8538-7b1b54c194d5);
DB_SpotPlayers_SpotTrigger(S_LOW_BaneiteOfficer_PostIRN02_2cc225cf-794a-450a-bbb7-4b3400cb3c74, "LOW_SteelWatchFoundry_PostIRNConfrontaiton", S_LOW_AfterIRN_ConfrontationZone_bfb70bf1-0a92-4753-8538-7b1b54c194d5);

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
AND
DB_Defeated(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, _, _, _, _)
THEN
PROC_LOW_SteelWatchFoundry_FailedRevolution();

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
AND
DB_LOW_Gondians(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFaction(_Var1, ACT3_LOW_SteelWatchFoundry_Gondians_98cec50e-60d9-4b18-a1f3-88e8b425d682);

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
THEN
PROC_LOW_SteelWatchFoundry_SetAllBaneitesNeutral();

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
AND NOT
DB_Defeated(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, _, _, _, _)
THEN
SetFlag(LOW_SteelWatchFoundry_Event_FundangoSignalsGondians_321b9521-b937-4cd9-8e49-ad02e5dc9bea);
PROC_SetRelationToPlayers(ACT3_LOW_SteelWatchFoundry_Gondians_98cec50e-60d9-4b18-a1f3-88e8b425d682, 100);

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
AND NOT
DB_Defeated(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, _, _, _, _)
AND
DB_LOW_Gondians(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetCanFight(_Var1, 1);
SetCanJoinCombat(_Var1, 1);

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
THEN
PROC_RemoveOneShotAD(S_LOW_InstallationRoom_ca9a227a-afc2-4dc9-9984-41e6bb8baefd);
PROC_RemoveOneShotAD(S_LOW_ClueADZone01_64b145c0-37ce-48ac-9eb9-5793cabc54f8);
PROC_RemoveOneShotAD(S_LOW_ClueADZone02_d5943fcb-aa49-45e0-9df5-07400d4e228a);

PROC
PROC_GlobalFlagReactionAfterDialog(LOW_SteelWatchFoundry_Event_GondianWorker01_Leaves_deb4318d-300b-cc4d-6d7d-2040736fbbe8, _, _, _, _)
THEN
PROC_DisappearOutOfSight(S_LOW_GondianWorker01_92010ea3-cd5e-4896-97fc-1f1e7942fcf5, "Run", 0, "");

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
THEN
DB_CombatReact_AD_OnTurn(S_LOW_GondianWorker10_ffc8a25f-6ceb-4081-8e07-eca2205989c5, LOW_SteelWatchFoundry_AD_GondianWorker10_CombatRevolution_9f730af0-9b1e-1450-6e43-f2db20b91aeb, 1);
DB_CombatReact_AD_OnTurn(S_LOW_GondianWorker10_ffc8a25f-6ceb-4081-8e07-eca2205989c5, LOW_SteelWatchFoundry_AD_GondianWorker10_CombatRevolution_9f730af0-9b1e-1450-6e43-f2db20b91aeb, 2);
DB_CombatReact_AD_OnTurn(S_LOW_GondianWorker10_ffc8a25f-6ceb-4081-8e07-eca2205989c5, LOW_SteelWatchFoundry_AD_GondianWorker10_CombatRevolution_9f730af0-9b1e-1450-6e43-f2db20b91aeb, 3);
DB_CombatReact_AD_OnTurn(S_LOW_GondianWorker10_ffc8a25f-6ceb-4081-8e07-eca2205989c5, LOW_SteelWatchFoundry_AD_GondianWorker10_CombatRevolution_9f730af0-9b1e-1450-6e43-f2db20b91aeb, 4);
DB_CombatReact_AD_OnTurn(S_LOW_GondianWorker04_6cc09c40-6b09-4e92-ad36-4e5ad72f7c43, LOW_SteelWatchFoundry_AD_GondianWorker04_CombatRevolution_7b5a0d5d-cf08-0013-2998-c2a67de76dac, 1);
DB_CombatReact_AD_OnTurn(S_LOW_GondianWorker04_6cc09c40-6b09-4e92-ad36-4e5ad72f7c43, LOW_SteelWatchFoundry_AD_GondianWorker04_CombatRevolution_7b5a0d5d-cf08-0013-2998-c2a67de76dac, 2);
DB_CombatReact_AD_OnTurn(S_LOW_GondianWorker04_6cc09c40-6b09-4e92-ad36-4e5ad72f7c43, LOW_SteelWatchFoundry_AD_GondianWorker04_CombatRevolution_7b5a0d5d-cf08-0013-2998-c2a67de76dac, 3);
DB_CombatReact_AD_OnTurn(S_LOW_GondianWorker04_6cc09c40-6b09-4e92-ad36-4e5ad72f7c43, LOW_SteelWatchFoundry_AD_GondianWorker04_CombatRevolution_7b5a0d5d-cf08-0013-2998-c2a67de76dac, 4);
DB_CombatReact_AD_OnTurn(S_LOW_GondianWorker05_e86d2e9b-f55b-4eaf-9ba6-0245d17b6d1c, LOW_SteelWatchFoundry_AD_GondianWorker05_CombatRevolution_a190ca87-352a-59ed-81fc-aacfa4560536, 1);
DB_CombatReact_AD_OnTurn(S_LOW_GondianWorker05_e86d2e9b-f55b-4eaf-9ba6-0245d17b6d1c, LOW_SteelWatchFoundry_AD_GondianWorker05_CombatRevolution_a190ca87-352a-59ed-81fc-aacfa4560536, 2);
DB_CombatReact_AD_OnTurn(S_LOW_GondianWorker05_e86d2e9b-f55b-4eaf-9ba6-0245d17b6d1c, LOW_SteelWatchFoundry_AD_GondianWorker05_CombatRevolution_a190ca87-352a-59ed-81fc-aacfa4560536, 3);
DB_CombatReact_AD_OnTurn(S_LOW_GondianWorker05_e86d2e9b-f55b-4eaf-9ba6-0245d17b6d1c, LOW_SteelWatchFoundry_AD_GondianWorker05_CombatRevolution_a190ca87-352a-59ed-81fc-aacfa4560536, 4);
DB_CombatReact_AD_OnTurn(S_LOW_BaneiteOfficer06_0ce716ac-f6fa-4b7d-8fda-456b0e74f90f, LOW_SteelWatchFoundry_AD_BaneiteOfficer06_CombatRevolution_2769d2a7-ca7a-9f9e-515a-1eb745778dcc, 1);
DB_CombatReact_AD_OnTurn(S_LOW_BaneiteOfficer06_0ce716ac-f6fa-4b7d-8fda-456b0e74f90f, LOW_SteelWatchFoundry_AD_BaneiteOfficer06_CombatRevolution_2769d2a7-ca7a-9f9e-515a-1eb745778dcc, 2);
DB_CombatReact_AD_OnTurn(S_LOW_BaneiteOfficer06_0ce716ac-f6fa-4b7d-8fda-456b0e74f90f, LOW_SteelWatchFoundry_AD_BaneiteOfficer06_CombatRevolution_2769d2a7-ca7a-9f9e-515a-1eb745778dcc, 3);
DB_CombatReact_AD_OnTurn(S_LOW_BaneiteOfficer06_0ce716ac-f6fa-4b7d-8fda-456b0e74f90f, LOW_SteelWatchFoundry_AD_BaneiteOfficer06_CombatRevolution_2769d2a7-ca7a-9f9e-515a-1eb745778dcc, 4);
DB_CombatReact_AD_OnTurn(S_LOW_BaneiteOfficer10_Leader_a2db5bf9-03a9-408e-971f-fc63741308bb, LOW_SteelWatchFoundry_AD_BaneiteOfficer10_CombatRevolution_962fffa3-cdea-d9a1-09eb-b3989a5a82d0, 1);
DB_CombatReact_AD_OnTurn(S_LOW_BaneiteOfficer10_Leader_a2db5bf9-03a9-408e-971f-fc63741308bb, LOW_SteelWatchFoundry_AD_BaneiteOfficer10_CombatRevolution_962fffa3-cdea-d9a1-09eb-b3989a5a82d0, 2);
DB_CombatReact_AD_OnTurn(S_LOW_BaneiteOfficer10_Leader_a2db5bf9-03a9-408e-971f-fc63741308bb, LOW_SteelWatchFoundry_AD_BaneiteOfficer10_CombatRevolution_962fffa3-cdea-d9a1-09eb-b3989a5a82d0, 3);
DB_CombatReact_AD_OnTurn(S_LOW_BaneiteOfficer10_Leader_a2db5bf9-03a9-408e-971f-fc63741308bb, LOW_SteelWatchFoundry_AD_BaneiteOfficer10_CombatRevolution_962fffa3-cdea-d9a1-09eb-b3989a5a82d0, 4);

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
AND
DB_LOW_LabGondians(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SelfHealing_Disable(_Var1);
ApplyDamage(_Var1, 12, "Slashing", NULL_00000000-0000-0000-0000-000000000000);
SetCombatGroupID(_Var1, "57e22865-626b-4c85-a5e8-9dc77342d4e5");
CreateSurface(_Var1, "SurfaceBlood", 2.5, -1, _Var1);

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
AND
DB_LOW_LabBaneites(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SelfHealing_Disable(_Var1);
ApplyDamage(_Var1, 15, "Slashing", NULL_00000000-0000-0000-0000-000000000000);
SetCombatGroupID(_Var1, "57e22865-626b-4c85-a5e8-9dc77342d4e5");
CreateSurface(_Var1, "SurfaceBlood", 1, -1, _Var1);

PROC
PROC_GLO_DefeatCounter_Notify("LOW_SteelWatchFoundry_WorkroomOriginalGondians", _, (INTEGER)_Var2, (INTEGER)_Var3, _)
AND
IntegerSum(_Var2, _Var3, _Var4, _, _)
AND
DB_LOW_SteelWatchFoundry_DefeatedWorkroomGondianCount(_Var5, _, _, _, _)
THEN
NOT DB_LOW_SteelWatchFoundry_DefeatedWorkroomGondianCount(_Var5);
DB_LOW_SteelWatchFoundry_DefeatedWorkroomGondianCount(_Var4);

PROC
PROC_GLO_DefeatCounter_Notify("LOW_SteelWatchFoundry_WorkroomOriginalGondians", _, (INTEGER)_Var2, (INTEGER)_Var3, _)
AND
IntegerSum(_Var2, _Var3, _Var4, _, _)
AND NOT
DB_LOW_SteelWatchFoundry_DefeatedWorkroomGondianCount(_, _, _, _, _)
THEN
DB_LOW_SteelWatchFoundry_DefeatedWorkroomGondianCount(_Var4);

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
AND NOT
DB_GlobalFlag(LOW_SteelWatchFoundry_State_FundangoPermadefeated_8fbcef5a-d738-4a7a-be04-58e6ae551b9b, _, _, _, _)
AND
DB_LOW_SteelWatchFoundry_DefeatedWorkroomGondianCount(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 > 1
THEN
PROC_SetOnStage(S_LOW_GondianWorker_PostIRN01_a4eb6135-5656-430f-b5f6-a217feb6eb0d, 1);
DB_LOW_Gondians(S_LOW_GondianWorker_PostIRN01_a4eb6135-5656-430f-b5f6-a217feb6eb0d);

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
AND NOT
DB_GlobalFlag(LOW_SteelWatchFoundry_State_FundangoPermadefeated_8fbcef5a-d738-4a7a-be04-58e6ae551b9b, _, _, _, _)
AND
DB_LOW_SteelWatchFoundry_DefeatedWorkroomGondianCount(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 > 2
THEN
PROC_SetOnStage(S_LOW_GondianWorker_PostIRN02_b264c860-f30a-45a8-b35d-9f03a0d393b1, 1);
DB_LOW_Gondians(S_LOW_GondianWorker_PostIRN02_b264c860-f30a-45a8-b35d-9f03a0d393b1);

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
AND
DB_LOW_Baneites(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetWeaponUnsheathed(_Var1, 1, 1);

PROC
PROC_LOW_SteelWatchFoundry_SetUpAfterIRN()
AND
DB_LOW_Gondians(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetWeaponUnsheathed(_Var1, 1, 1);

PROC
PROC_SpotPlayers_Spotted(_, "LOW_SteelWatchFoundry_PostIRNConfrontaiton", (CHARACTER)_Var2, _, _)
AND NOT
DB_OnlyOnce("LOW_SteelWatchFoundry_ToobinConfrontation", _, _, _, _)
AND
QRY_StartDialog(LOW_SteelWatchFoundry_Confrontation_AfterIRN_00ab0c07-17d9-a5b1-a900-9857bf839428, S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, S_LOW_BaneiteOfficer_PostIRN01_36c0bb47-a8cc-4381-882b-a2ded38d0b5c, S_LOW_BaneiteOfficer_PostIRN02_2cc225cf-794a-450a-bbb7-4b3400cb3c74, _Var2)
THEN
DB_OnlyOnce("LOW_SteelWatchFoundry_ToobinConfrontation");

IF
DialogEnded(LOW_SteelWatchFoundry_Confrontation_AfterIRN_00ab0c07-17d9-a5b1-a900-9857bf839428, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_LOW_SteelWatchFoundry_SetAllBaneitesFullHostile();

IF
EnteredCombat((GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_SteelWatchFoundry_AfterIRNBaneites(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_SteelWatchFoundry_SetAllBaneitesFullHostile();

IF
DB_InRegion(_Var1, S_LOW_InstallationRoom_ca9a227a-afc2-4dc9-9984-41e6bb8baefd, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(IRN_IronThrone_State_Visited_5b3fb5a7-61e8-44a9-a0a1-b6b45b59a23c, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("LOW_SteelWatchFoundry_GondiansStartFighting", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_SteelWatchFoundry_SetAllBaneitesFullHostile();
PROC_EnterCombat(S_LOW_BaneiteOfficer06_0ce716ac-f6fa-4b7d-8fda-456b0e74f90f, _Var1);

PROC
PROC_LOW_SteelWatchFoundry_SetAllBaneitesNeutral()
AND
DB_LOW_Baneites(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFaction(_Var1, ACT3_LOW_SteelWatchFoundry_Banites_86e92ff2-c3fb-4bab-945b-24d728ac40d9);
PROC_SetRelationToPlayers(ACT3_LOW_SteelWatchFoundry_Banites_86e92ff2-c3fb-4bab-945b-24d728ac40d9, 50);

PROC
PROC_LOW_SteelWatchFoundry_SetAllBaneitesFullHostile()
THEN
PROC_SetRelationToPlayers(ACT3_LOW_SteelWatchFoundry_Banites_86e92ff2-c3fb-4bab-945b-24d728ac40d9, 0);
PROC_SetRelationMutual(ACT3_LOW_SteelWatchFoundry_Banites_86e92ff2-c3fb-4bab-945b-24d728ac40d9, ACT3_LOW_SteelWatchFoundry_Gondians_98cec50e-60d9-4b18-a1f3-88e8b425d682, 0);

PROC
PROC_LOW_GondianCollarsGoOff()
THEN
PROC_LOW_SteelWatchFoundry_TryStartFundangoLostHope();

PROC
PROC_LOW_SteelWatchFoundry_TryStartFundangoLostHope()
AND
DB_GlobalFlag(LOW_SteelWatchFoundry_State_FundangoFollower_a3021d6d-9cc1-3545-54f3-53a35d44d89b, _, _, _, _)
AND
DB_LOW_SteelWatchFoundry_FundangoFollowerOf(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_SpeakerIsAvailableAndInDialogRange(_Var1, S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, _Var1, _Var1, _Var1)
THEN
ObjectTimerLaunch(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, "LOW_SteelWatchFoundry_FundangoLostHope_RestartTimer", 6000, 0);
DB_LOW_SteelWatchFoundry_ToobinWaitingToLoseHope(1);

IF
ObjectTimerFinished(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, "LOW_SteelWatchFoundry_FundangoLostHope_RestartTimer", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_SteelWatchFoundry_FundangoFollowerOf(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_NotifyWhenReadyToMoveOn(_Var1, "DB_LOW_SteelWatchFoundry_FundangoLostHopeStartDialog");

PROC
PROC_ReadyToMoveOn((CHARACTER)_Var1, "DB_LOW_SteelWatchFoundry_FundangoLostHopeStartDialog", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_SteelWatchFoundry_ToobinWaitingToLoseHope(1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_SteelWatchFoundry_TryStartFundangoLostHope();

PROC
PROC_LOW_SteelWatchFoundry_TryStartFundangoLostHope()
AND
DB_GlobalFlag(LOW_SteelWatchFoundry_State_FundangoFollower_a3021d6d-9cc1-3545-54f3-53a35d44d89b, _, _, _, _)
AND
DB_LOW_SteelWatchFoundry_FundangoFollowerOf(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailableAndInDialogRange(_Var1, S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, _Var1, _Var1, _Var1)
AND
QRY_StartDialog(LOW_SteelWatchFoundry_FundangoLosesHope_d8add8fe-7b67-4830-7f00-0b10ce3a549c, S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_SteelWatchFoundry_ToobinWaitingToLoseHope(1);

IF
DB_PermaDefeated(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, _, _, _, _)
AND
DB_LOW_SteelWatchFoundry_ToobinWaitingToLoseHope(1, _, _, _, _)
THEN
ObjectTimerCancel(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, "LOW_SteelWatchFoundry_FundangoLostHope_RestartTimer");
NOT DB_LOW_SteelWatchFoundry_ToobinWaitingToLoseHope(1);

IF
DB_GlobalFlag(LOW_SteelWatchFoundry_State_Destroyed_cdfffe24-5082-4e41-b7c2-f1fef6da3a8a, _, _, _, _)
AND
DB_LOW_SteelWatchFoundry_ToobinWaitingToLoseHope(1, _, _, _, _)
THEN
ObjectTimerCancel(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, "LOW_SteelWatchFoundry_FundangoLostHope_RestartTimer");
NOT DB_LOW_SteelWatchFoundry_ToobinWaitingToLoseHope(1);

IF
EnteredCombat(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
QRY_IsEnemyToAnyPlayerInCombat(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, _Var1, _Var1, _Var1, _Var1)
THEN
ObjectTimerCancel(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, "LOW_SteelWatchFoundry_FundangoLostHope_RestartTimer");
NOT DB_LOW_SteelWatchFoundry_ToobinWaitingToLoseHope(1);

PROC
PROC_GlobalFlagReactionAfterDialog(LOW_SteelWatchFoundry_State_FundangoWalkedOff_3ac36df2-ef73-4fa4-8800-0f694388073a, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_SteelWatchFoundry_FundangoFollowerOf(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
RemovePartyFollower(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, _Var1);
PROC_DisappearOutOfSight(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, "Walk", 0, "LOW_SteelWatchFoundry_FundangoDisappeared");

IF
EntityEvent((GUIDSTRING)_Var1, "LOW_SteelWatchFoundry_FundangoDisappeared", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
TeleportTo(_Var1, LOW_SteelWatchFoundry_AsylumPos_66106ef1-3213-4b8d-a06a-c8f68dfcbf29, "", 0, 0, 0, 1, 1);
SetOnStage(_Var1, 1);

IF
DB_GlobalFlag(LOW_SteelWatchFoundry_State_OriginalWorkroomBaneitesDefeated_e33e6570-c885-4a61-8b26-16e1d2784137, _, _, _, _)
AND
DB_GlobalFlag(LOW_SteelWatchFoundry_State_PostIRNWorkroomBaneitesDefeated_1c0a4b23-9bc2-4d25-9c89-c066ee42f6c7, _, _, _, _)
AND
DB_LOW_WorkroomGondians(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(LOW_SteelWatchFoundry_State_WorkerLiberated_32da4560-217f-41d3-b5bb-526e2665a83d, _Var1);

PROC
PROC_GlobalFlagReactionAfterDialog(LOW_SteelWatchFoundry_State_ZannerLeavesFoundry_b54f53d7-fedc-8fe5-f2e1-5121d157018c, _, _, _, _)
THEN
Unlock(S_LOW_FoundryFrontDoor_98556121-7aba-4b50-9336-e183b9906650, NULL_00000000-0000-0000-0000-000000000000);
Unlock(S_LOW_FoundryFenceGateFront_2a65f70a-40a1-42e2-bff1-100c3a7fc506, NULL_00000000-0000-0000-0000-000000000000);
PROC_CharacterMoveTo(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, S_LOW_SteelWatchOutcomeLocation_672c319c-ecc6-4797-8447-16eeca161146, "Run", "");

PROC
PROC_GLO_DefeatCounter_AllDefeated("LOW_SteelWatchFoundry_InstallLabBaneites", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_LabGondians(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SelfHealing_Enable(_Var1);
SetFlag(LOW_SteelWatchFoundry_State_WorkerLiberated_32da4560-217f-41d3-b5bb-526e2665a83d, _Var1);

PROC
PROC_GLO_DefeatCounter_AllDefeated("LOW_SteelWatchFoundry_InstallLabBaneites", _, _, _, _)
THEN
TimerLaunch("LOW_SteelWatchFoundry_LabroomSurvivorsWaitBeforeLeaving", 20000);
Unlock(S_LOW_FoundryFrontDoor_98556121-7aba-4b50-9336-e183b9906650, NULL_00000000-0000-0000-0000-000000000000);
Unlock(S_LOW_FoundryFenceGateFront_2a65f70a-40a1-42e2-bff1-100c3a7fc506, NULL_00000000-0000-0000-0000-000000000000);
Unlock(S_LOW_SecurityOfficeDoor02_49fe647b-5f63-4511-8e77-3ff3b199a17d, NULL_00000000-0000-0000-0000-000000000000);

IF
TimerFinished("LOW_SteelWatchFoundry_LabroomSurvivorsWaitBeforeLeaving", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_LabGondians(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Defeated(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_CharacterMoveTo(_Var1, S_LOW_GenericGondianEscapeLocation_001_85bf4cb6-2440-4120-afe3-4f33513a0c92, "Run", "");

PROC
PROC_GLO_DefeatCounter_AllDefeated("LOW_SteelWatchFoundry_WorkroomOriginalBaneites", _, _, _, _)
AND
DB_GlobalFlag(IRN_IronThrone_State_Visited_5b3fb5a7-61e8-44a9-a0a1-b6b45b59a23c, _, _, _, _)
THEN
DB_LOW_SteelWatchFoundry_WorkroomPostIRNFightFinished(1);

PROC
PROC_GLO_DefeatCounter_AllDefeated("LOW_SteelWatchFoundry_WorkroomPostIRNBaneites", _, _, _, _)
AND
DB_GlobalFlag(IRN_IronThrone_State_Visited_5b3fb5a7-61e8-44a9-a0a1-b6b45b59a23c, _, _, _, _)
THEN
DB_LOW_SteelWatchFoundry_WorkroomPostIRNFightFinished(1);

IF
DB_LOW_SteelWatchFoundry_WorkroomPostIRNFightFinished(1, _, _, _, _)
AND NOT
DB_Defeated(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, _, _, _, _)
THEN
TeleportTo(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, S_LOW_GondianWorker08_PostIRNPosition_f4ef5ecb-f5dc-4436-8afd-a06e3c6f9ddb, "", 0, 0, 0, 1, 1);

IF
DB_LOW_SteelWatchFoundry_WorkroomPostIRNFightFinished(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Is_InCombat(_Var1, _, _Var1, _Var1, _Var1)
AND NOT
DB_LOW_SteelWatchFoundry_ActiveSwitch(_, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(IRN_IronThrone_State_Visited_5b3fb5a7-61e8-44a9-a0a1-b6b45b59a23c, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_LOW_WorkRoom_7cc75beb-1004-40bb-a33c-7b8b128ae9dc, _Var1, _Var1, _Var1)
AND
DB_InRegion(S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, S_LOW_WorkRoom_7cc75beb-1004-40bb-a33c-7b8b128ae9dc, _Var1, _Var1, _Var1)
AND NOT
DB_OnlyOnce("LOW_SteelWatchFoundry_WorkRoomPostIRNThrone_Dialog", _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialog(LOW_SteelWatchFoundry_GondianWorker08_Leader_9d7d9cf1-437a-bba8-b087-456483f85edc, S_LOW_GondianWorker08_Leader_3607ec31-f939-41aa-a7d2-e32f8c46979d, _Var1, _Var1, _Var1)
THEN
DB_OnlyOnce("LOW_SteelWatchFoundry_WorkRoomPostIRNThrone_Dialog");


EXITSECTION
ENDEXITSECTION

ParentTargetEdge "Act3b"
