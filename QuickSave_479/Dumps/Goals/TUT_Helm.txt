Version 1
SubGoalCombiner SGC_AND

INITSECTION
DB_GlobalFlagReactionAfterDialog(TUT_Helm_State_GithMindControlled_d2872586-f053-4753-b793-1a7718ee5583, TUT_Helm_MindflayerCall_de5c59ce-274f-0450-df3d-1d0754631c84);
DB_GlobalFlagReactionAfterDialog(TUT_Helm_State_StatedNerveFocus_f01cd6e7-f4c8-4a1c-9e8e-953a5560486c, TUT_Helm_MindflayerCall_de5c59ce-274f-0450-df3d-1d0754631c84);
DB_IgnoreMutingStatussesDialog(TUT_Helm_AD_CreatureCantUseTransponder_1e44dd42-e7ca-2792-7b05-86cb23b40668);
DB_IgnoreMutingStatussesDialog(TUT_Helm_PAD_PlayerOutsideHelm_2f7e5f09-381e-6b25-88b8-8cdcc05cc1b6);
DB_TUT_Helm_DisablingStatus("TUT_CHARACTERINPOD");
DB_TUT_Helm_DisablingStatus("TUT_SAPPED");
DB_TUT_Helm_NPCsFromOtherAreas(S_TUT_Lab_IntellectDevourer_40bd6b82-2728-410a-bb8a-a805f98556a1);
DB_TUT_Helm_NPCsFromOtherAreas(S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558);
DB_TUT_Helm_NPCsFromOtherAreas(S_TUT_TransformChamber_DrainVictim_000_5bc43df4-6274-4b73-baed-c7f5268b2fc7);
DB_TUT_Helm_NPCsFromOtherAreas(S_TUT_TransformChamber_DrainVictim_001_dd1d4bcf-da0e-441a-b700-7273bad6579e);
DB_TUT_Helm_NPCsFromOtherAreas(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679);
DB_TUT_Helm_NPCsFromOtherAreas(S_FirstFight_Imp_Melee_01_07f1512b-efe9-4eb8-8ade-783435e9d7c9);
DB_TUT_Helm_NPCsFromOtherAreas(S_FirstFight_Imp_Ranged_01_38d1ce2f-4f19-4266-971d-61f08bc1a895);
DB_TUT_Helm_NPCsFromOtherAreas(S_FirstFight_Imp_Melee_02_5c5bd50b-147e-42e5-93cb-59a754df91ec);
DB_TUT_Helm_NPCsFromOtherAreas(S_FirstFight_Imp_Ranged_02_df44fa65-5399-47d6-b5bb-70e4b8e63314);
DB_TUT_Helm_RoundsRubble(2);
DB_TUT_Helm_RoundsRubble(3);
DB_TUT_Helm_RoundsRubble(5);
DB_TUT_Helm_Devils(S_TUT_Helm_Devil_000_1650c758-c9c2-d487-387d-22a269fd7918);
DB_TUT_Helm_Devils(S_TUT_Helm_Devil_001_8262153a-b469-d119-2041-8316e0648ae0);
DB_TUT_Helm_Devils(S_TUT_Helm_Devil_003_139971a8-86c5-4ee9-b201-18da4a2cb0ed);
DB_TUT_Helm_Devils(S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e);
DB_GLO_DefeatCounter_IgnoreWaitForCombatEnd("TUT_Helm_DevilsDefeated");
DB_TUT_Helm_Devils_BackUp(S_TUT_Helm_DevilBackUp_001_c6b3a323-d7cf-4b02-8a21-fefeaf3e7a0a);
DB_TUT_Helm_Devils_BackUp(S_TUT_Helm_DevilBackUp_002_4afad8cc-436e-4d16-8b33-7e59a470d4a8);
DB_TUT_Helm_Devils_BackUp(S_TUT_Helm_DevilBackUp_003_a73bd45a-99b6-4486-a280-846ddd586b78);
DB_TUT_Helm_Devils_BackUpCambions(S_TUT_Helm_BackUpCambion_001_dfd44248-1212-4eb9-a6b4-8d7335ad57f7);
DB_TUT_Helm_Devils_BackUpCambions(S_TUT_Helm_BackUpCambion_002_5a7d3c96-3b98-4601-85ba-67f6bea52959);
DB_TUT_Helm_RoundCount(0);
PROC_TUT_Helm_Init();
DB_AddCharactersInTriggerToDialog(TUT_Helm_DragonAppears_6ffc2909-a928-4b8b-6901-02d823e68880, S_TUT_Helm_RoomArea_6806969b-43d7-40c2-95b9-49e9b21d2c04, 1, 1);
DB_TUT_Helm_TempUsStatus("TUT_LOBOTOMIZED_US");
DB_TUT_Helm_TempUsStatus("TUT_NEWBORN_INTDEV");
PROC_TriggerRegisterForParty(S_TUT_StartHelmNPCTrigger_fe1e10c1-20ba-4353-99e1-de7b8501dd46);
PROC_TriggerRegisterForPlayers(S_TUT_Helm_MindMeldTrigger_3e0656be-0613-4e7d-9c1b-894628e812f6);
PROC_TriggerRegisterForParty(S_TUT_Helm_MindflayerCall_StartTrigger_189c40a7-a355-467d-be80-dbfd754fc67b);
PROC_TriggerRegisterForParty(S_TUT_Helm_FinalCombatTeleportingTrigger_53dd14f6-1571-4cae-b223-83b42cd3bc3a);
DB_GlobalFlagReactionAfterDialog(TUT_Helm_TransponderActivated_40d32a6d-8d41-4ceb-a4e9-bbd34d0664e4, TUT_Helm_Transponder_d1cac06a-9fa7-237d-1f25-5e9de38ecd2c);
DB_TUT_Helm_ClosestToGuide(NULL_00000000-0000-0000-0000-000000000000, 9999);
PROC_TriggerRegisterForPlayers(S_TUT_Helm_DragonTrigger_3ca543c8-75b7-4f1f-9415-941c83904fda);
PROC_TriggerRegisterForPlayers(S_TUT_Helm_RoomArea_6806969b-43d7-40c2-95b9-49e9b21d2c04);
DB_Inclusion_CombatInclusionDialog(TUT_Helm_MindflayerCall_de5c59ce-274f-0450-df3d-1d0754631c84);
DB_AddCharactersInTriggerToDialog(TUT_Helm_MindflayerCall_de5c59ce-274f-0450-df3d-1d0754631c84, S_TUT_Helm_MindMeldTrigger_3e0656be-0613-4e7d-9c1b-894628e812f6, 1, 1);
DB_Inclusion_NPCDialog(TUT_Helm_MindflayerCall_de5c59ce-274f-0450-df3d-1d0754631c84, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
DB_Inclusion_NPCDialog(TUT_Helm_MindflayerCall_de5c59ce-274f-0450-df3d-1d0754631c84, S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558);
DB_IgnoreMutingStatussesDialog(TUT_Helm_MindflayerCall_de5c59ce-274f-0450-df3d-1d0754631c84);
DB_Inclusion_CombatInclusionDialog(TUT_Helm_DragonAppears_6ffc2909-a928-4b8b-6901-02d823e68880);
DB_AddCharactersInTriggerToDialog(TUT_Helm_DragonAppears_6ffc2909-a928-4b8b-6901-02d823e68880, S_TUT_Helm_RoomArea_6806969b-43d7-40c2-95b9-49e9b21d2c04, 1, 1);
DB_Inclusion_NPCDialog(TUT_Helm_DragonAppears_6ffc2909-a928-4b8b-6901-02d823e68880, S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846);
DB_TUT_Helm_CambionAndMindFlayer(S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846);
DB_TUT_Helm_CambionAndMindFlayer(S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e);
DB_DeadEvent(S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e, TUT_Helm_Event_CambionDies_fcfd8b70-e8ca-05b4-5cca-2c2190d6c459);
PROC_TriggerRegisterForPlayers(S_TUT_Helm_LastReminder_e0132d4a-3abb-4298-a688-c44e260d6a01);
DB_TUT_GuideDialogues("LastReminder", S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, TUT_Helm_AD_LaezelRemindsNerves_d4d65341-eba6-94a5-9aa1-6c5ee1ba973a);
DB_Inclusion_NPCDialog(TUT_Helm_MindflayerCall_de5c59ce-274f-0450-df3d-1d0754631c84, S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679);
DB_DialogStarted_IgnoreStopConditions(TUT_Helm_Transponder_d1cac06a-9fa7-237d-1f25-5e9de38ecd2c);
DB_TUT_Helm_ScrollingObjects(LT_GLO_TUT_Avernus_TemplateWrap_B_000_0495f79d-a9d3-409b-879a-2373cefa8f53);
DB_TUT_Helm_ScrollingObjects(LT_GLO_TUT_Avernus_TemplateWrap_D_000_452976b4-0c3e-4681-bd9d-f9585b98b44a);
DB_TUT_Helm_ScrollingObjects(LT_GLO_TUT_Avernus_TemplateWrap_E_000_934476c8-5556-4ba0-9c38-64c921467584);
DB_TUT_Helm_ScrollingObjects(LT_GLO_TUT_Avernus_TemplateWrap_C_000_dbc77f94-139a-4a92-bf95-27ac7634f918);
DB_TUT_Helm_ScrollingObjects(LT_GLO_TUT_Avernus_TemplateWrap_A_000_ade6c04e-70b8-41bf-a7c5-ffb70ae90948);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_001_43298162-293c-4d8b-b3fe-88f3502d924e);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_002_e7912f51-5488-4a4e-902a-a8068dacb533);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_003_f878adff-8415-4bd0-bb2c-acb9d8898948);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_004_fc275a48-480c-4a31-8a33-cd05752803c3);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_005_c37ef025-f1c1-4179-bb26-046137436f1a);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_006_78956fc5-d270-4686-b7c4-4e63fd9a38f1);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_007_91041ca4-e253-4100-b4c9-9f7475c011df);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_008_7453b283-9815-446b-b201-5d647d54f6f6);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_009_50f89c9c-541e-4a79-a586-16330c7b92af);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_010_9d4b3513-5056-4034-ac65-3f5633d53ccc);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_011_7fab05ea-1372-4553-b77e-56625cdcd250);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_012_7132ec2d-7609-4573-bab2-1fd7baebca32);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_013_9bf31d73-5508-41cf-beca-579f9302ae0c);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_014_c2cdf0f6-6f70-4f0a-96bb-992ee818ccd9);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_015_1e03c83b-aac4-46fe-91c7-2d0ae4ea7511);
DB_TUT_Helm_BacktrackingFireTriggers(S_TUT_Helm_BacktrackingFireTrigger_016_f54db981-62fb-4f85-a489-9b0d9df4e5e4);
PROC_TriggerRegisterForPlayers(S_TUT_Helm_PointOfNoReturn_6c4f1de5-89c5-4944-bda3-f1304c7fbc6a);
PROC_TriggerRegisterForPlayers(S_TUT_Helm_GameOverTrigger_c77c73c4-94e2-4cbc-9206-743777e3ed24);
PROC_TriggerRegisterForPlayers(S_TUT_Helm_GuideBacktrackWarning_41479227-6954-4a4d-a075-c00255c69399);
PROC_TriggerRegisterForParty(S_TUT_Helm_ScreenShake_7b08ca7a-3188-4b72-8120-1a39630a48b5);
PROC_TriggerRegisterForParty(S_TUT_IncinerateTrigger_2a7c57ad-970d-457a-a5aa-269e24c0fb5e);
TriggerRegisterForCharacter(S_TUT_IncinerateTrigger_2a7c57ad-970d-457a-a5aa-269e24c0fb5e, S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558);
DB_TUT_GuideDialogues("Backtrack", S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, TUT_Helm_AD_LaezelGoToHelmReminder_47f1ebb2-7620-5deb-a402-cd8d984e641c);
DB_TUT_GuideDialogues("Backtrack", S_TUT_GithGuide_201a0ee6-6411-4564-aaea-1ca057bfea04, TUT_Helm_AD_GuideWarningBacktrack_77856c6a-5ae5-16b9-6b77-6cfd1ab3236e);
DB_TUT_Helm_GameOverFire(S_TUT_Helm_GameOverFire_007_30816f2b-c14c-41f0-a56a-f28d3a8ae9fb);
DB_TUT_Helm_GameOverFire(S_TUT_Helm_GameOverFire_000_97034a53-7ec4-4495-ab7e-e3378e14194c);
DB_TUT_Helm_GameOverFire(S_TUT_Helm_GameOverFire_001_85724e7e-3ac5-45f8-8950-ca2b99c69ac9);
DB_TUT_Helm_GameOverFire(S_TUT_Helm_GameOverFire_002_150380e1-8c2d-4276-9028-2deba8cfd784);
DB_TUT_Helm_GameOverFire(S_TUT_Helm_GameOverFire_003_245fe268-6c51-4800-905c-29d929cf9b07);
DB_TUT_Helm_GameOverFire(S_TUT_Helm_GameOverFire_004_63e1ea95-928a-4cac-8956-f6bd73ac951a);
DB_TUT_Helm_GameOverFire(S_TUT_Helm_GameOverFire_008_b4793870-68ea-482d-abdd-818fd0bf7ca4);
DB_TUT_Helm_GameOverExplosion(S_TUT_Helm_GameOverExplosion_000_d693b513-fade-45bb-8d7e-45c2deb121ed);
DB_TUT_Helm_GameOverExplosion(S_TUT_Helm_GameOverExplosion_008_b115ee39-ff67-4c77-b62c-25708952122a);
DB_TUT_Helm_GameOverExplosion(S_TUT_Helm_GameOverExplosion_007_15b7b7ad-3fd6-4389-9e23-0b6f34f365b4);
DB_TUT_Helm_GameOverExplosion(S_TUT_Helm_GameOverExplosion_006_a5faff6c-c386-47f3-bbaa-146f2f0c12d6);
DB_TUT_Helm_GameOverExplosion(S_TUT_Helm_GameOverExplosion_003_6da3ba92-beb7-495c-a20f-b394cff39fd7);
DB_TUT_Helm_GameOverExplosion(S_TUT_Helm_GameOverExplosion_001_ef90ef2f-df04-4e62-9c1c-c81c23eb82a4);
DB_TUT_Helm_GameOverExplosion(S_TUT_Helm_GameOverExplosion_002_4bf4d393-2302-4554-8d0a-27a65e2a8585);
DB_TUT_Helm_GameOverExplosion(S_TUT_Helm_GameOverExplosion_004_8cab90da-621f-47c3-ba8d-fce053999d5d);
DB_TUT_Helm_GameOverExplosion(S_TUT_Helm_GameOverExplosion_005_60a22421-0ebd-43ec-99a3-e690602432ec);
DB_TUT_Helm_GameOverExplosion(S_TUT_Helm_GameOverExplosion_009_bdcc7b0b-6158-4973-a422-4ef8a9034645);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_GithGuide_201a0ee6-6411-4564-aaea-1ca057bfea04);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_LowerDeck_Devil_000_2c7caf64-3ae8-4d4e-b884-084541a043f7);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_UpperDeck_InjuredThrall_002_ab4dc5a8-88d4-4b85-8c15-ae524874097d);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_UpperDeck_InjuredThrall_000_97b94ef8-88b7-49e3-9e9d-030fe286a9e1);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_TransformChamber_DrainVictim_000_5bc43df4-6274-4b73-baed-c7f5268b2fc7);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_UpperDeck_IntellectDevourer_001_04ec0756-f633-4ce4-85a2-87b0ebb642d7);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Helm_Devil_006_06b30605-e1da-47a0-85da-370541af4976);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Helm_DevilBackUp_003_a73bd45a-99b6-4486-a280-846ddd586b78);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_UpperDeck_Thrall_002_2fa74de8-486e-476d-b184-d2265ceebd37);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Lab_IntellectDevourer_40bd6b82-2728-410a-bb8a-a805f98556a1);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Helm_Devil_003_139971a8-86c5-4ee9-b201-18da4a2cb0ed);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_UpperDeck_Thrall_001_5944faf9-c37e-4886-9dbc-1210e9de4911);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_LowerDeck_Mindflayer_001_21f24385-259d-4118-90ed-61d02620bc6a);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Helm_BackUpCambion_001_dfd44248-1212-4eb9-a6b4-8d7335ad57f7);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_LowerDeck_IntellectDevourerDead_001_12afa6a2-8788-4adf-b078-7dcfcf3733c5);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Helm_DevilBackUp_001_c6b3a323-d7cf-4b02-8a21-fefeaf3e7a0a);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_LowerDeck_IntellectDevourerDead_002_3d2cc1e0-4491-4dec-8aad-c1fb0ea28a15);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Helm_MindFlayer_001_2e51d3cc-8102-4bb9-9272-d9846f2810af);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_TransformChamber_DrainVictim_001_dd1d4bcf-da0e-441a-b700-7273bad6579e);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Helm_DevilBackUp_002_4afad8cc-436e-4d16-8b33-7e59a470d4a8);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_LowerDeck_MindflayerDead_001_16bebcc5-41d7-4fea-9e34-6f042fbc5ca2);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Helm_BackUpCambion_002_5a7d3c96-3b98-4601-85ba-67f6bea52959);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Lab_DevourerVictim_37f50067-bc94-4b77-9e3c-95d73222b575);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_LowerDeck_Devil_003_7419e20d-39e1-43e3-8e77-6a7006379b19);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_UpperDeck_RedDragon_9f961755-3f61-4458-a210-45cf9e40bec5);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_UpperDeck_MindflayerThrall_002_d5881b05-f542-4bd7-86f6-402bd5e88f51);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_UpperDeck_MindflayerThrall_001_aac007dc-1877-47fe-8f82-88c7dfdf463d);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_UpperDeck_Imp_001_f5ffc471-aeab-4a86-942c-7fc8034a2773);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_UpperDeck_Imp_000_67fc495e-5938-4754-842e-5dc16cb26f92);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_LowerDeck_Devil_001_cbd409e7-2cc2-4c8a-bab6-117635c0ede2);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Helm_Devil_004_307d7d95-96f3-40db-9c2b-65ed63aa5c1d);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Helm_Devil_001_8262153a-b469-d119-2041-8316e0648ae0);
DB_TUT_Helm_GameOver_NPCSToDie(S_TUT_Helm_Devil_000_1650c758-c9c2-d487-387d-22a269fd7918);
DB_TUT_Helm_GameOver_NPCSToIncinerate(S_TUT_Helm_MindFlayer_001_2e51d3cc-8102-4bb9-9272-d9846f2810af);
DB_TUT_Helm_GameOver_NPCSToIncinerate(S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846);
DB_TUT_Helm_GameOver_NPCSToIncinerate(S_TUT_Helm_Devil_000_1650c758-c9c2-d487-387d-22a269fd7918);
DB_TUT_Helm_GameOver_NPCSToIncinerate(S_TUT_Helm_Devil_001_8262153a-b469-d119-2041-8316e0648ae0);
DB_TUT_Helm_GameOver_NPCSToIncinerate(S_TUT_Helm_Devil_003_139971a8-86c5-4ee9-b201-18da4a2cb0ed);
DB_TUT_Helm_GameOver_NPCSToIncinerate(S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e);
DB_TUT_Helm_GameOver_NPCSToIncinerate(S_TUT_Helm_Devil_006_06b30605-e1da-47a0-85da-370541af4976);
DB_TUT_Helm_GameOver_NPCSToIncinerate(S_TUT_Helm_BackUpCambion_001_dfd44248-1212-4eb9-a6b4-8d7335ad57f7);
DB_TUT_Helm_GameOver_NPCSToIncinerate(S_TUT_Helm_BackUpCambion_002_5a7d3c96-3b98-4601-85ba-67f6bea52959);
DB_TUT_Helm_GameOver_NPCSToIncinerate(S_TUT_Helm_DevilBackUp_001_c6b3a323-d7cf-4b02-8a21-fefeaf3e7a0a);
DB_TUT_Helm_GameOver_NPCSToIncinerate(S_TUT_Helm_DevilBackUp_002_4afad8cc-436e-4d16-8b33-7e59a470d4a8);
DB_TUT_Helm_GameOver_NPCSToIncinerate(S_TUT_Helm_DevilBackUp_003_a73bd45a-99b6-4486-a280-846ddd586b78);
DB_TUT_Helm_GameOver_NPCSToIncinerate(S_TUT_TransformChamber_DrainVictim_000_5bc43df4-6274-4b73-baed-c7f5268b2fc7);
DB_TUT_Helm_GameOver_NPCSToIncinerate(S_TUT_TransformChamber_DrainVictim_001_dd1d4bcf-da0e-441a-b700-7273bad6579e);
DB_CombatReact_AD_OnDeathOther(S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e, S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846, TUT_Helm_AD_DevilAfterDeadMindFlayer_d882e17c-172d-ed4f-adac-02d858cc542e);
DB_CombatReact_AD_OnEntered(S_TUT_Helm_BackUpCambion_001_dfd44248-1212-4eb9-a6b4-8d7335ad57f7, TUT_Helm_AD_CambionTaunt_001_15dc0137-4568-a263-7262-21178f5b5557);
DB_CombatReact_AD_OnNextTurn(S_TUT_Helm_BackUpCambion_001_dfd44248-1212-4eb9-a6b4-8d7335ad57f7, TUT_Helm_AD_CambionTaunt_002_14f91e2f-5471-d6c1-124e-6a6532bea83b);

KBSECTION
PROC
PROC_TUT_Helm_Init()
AND
DB_TUT_Helm_Devils(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_GLO_DefeatCounter(_Var1, "TUT_Helm_Devils");

PROC
PROC_TUT_Helm_Init()
THEN
PROC_SetCanFight(S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846, 0);
PROC_SetCanFight(S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e, 0);

PROC
PROC_TUT_Helm_Init()
AND
DB_TUT_Helm_Devils_BackUpCambions(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetOnStage(_Var1, 0);

PROC
PROC_TUT_Helm_Init()
AND
DB_TUT_Helm_Devils(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e
THEN
AddPreferredAiTargetTag(_Var1, AVATAR_306b9b05-1057-4770-aa17-01af21acd650);
AddPreferredAiTargetTag(_Var1, REALLY_LAEZEL_b5682d1d-c395-489c-9675-1f9b0c328ea5);
AddPreferredAiTargetTag(_Var1, INTELLECT_DEVOURER_69901347-23cb-4f60-abf3-527f23cdf0db);
PROC_SetOnStage(_Var1, 0);

PROC
PROC_TUT_Helm_Init()
THEN
SetTag(S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846, AI_USESPELL_A_33aa698c-aea0-43e2-bd16-582aa718fd3e);
AddPreferredAiTargetTag(S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846, AI_USESPELL_B_3297ed55-ccc1-473e-8475-ac4162a63fdd);
SetTag(S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e, AI_USESPELL_B_3297ed55-ccc1-473e-8475-ac4162a63fdd);
AddPreferredAiTargetTag(S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e, AI_USESPELL_A_33aa698c-aea0-43e2-bd16-582aa718fd3e);
PROC_FaceEachother(S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846, S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e);
DB_DoNotFace(S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846);

PROC
PROC_TUT_Helm_Init()
THEN
SetTag(S_TUT_Helm_MindFlayer_001_2e51d3cc-8102-4bb9-9272-d9846f2810af, AI_USESPELL_A_33aa698c-aea0-43e2-bd16-582aa718fd3e);
AddPreferredAiTargetTag(S_TUT_Helm_MindFlayer_001_2e51d3cc-8102-4bb9-9272-d9846f2810af, AI_USESPELL_B_3297ed55-ccc1-473e-8475-ac4162a63fdd);
SetTag(S_TUT_Helm_Devil_006_06b30605-e1da-47a0-85da-370541af4976, AI_USESPELL_B_3297ed55-ccc1-473e-8475-ac4162a63fdd);
AddPreferredAiTargetTag(S_TUT_Helm_Devil_006_06b30605-e1da-47a0-85da-370541af4976, AI_USESPELL_A_33aa698c-aea0-43e2-bd16-582aa718fd3e);

IF
DB_TUT_Helm_CambionAndMindFlayer(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetAiHint(_Var1, AI_HINT_UNIQUE_1902723d-dd16-4e7a-87d6-7b07f63add79);

IF
DB_Dead(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_TUT_Helm_CambionAndMindFlayer(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_TUT_Helm_CambionAndMindFlayer(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
SetAiHint(_Var2, NULL_00000000-0000-0000-0000-000000000000);

IF
DB_TutorialCompanion(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TriggerRegisterForCharacter(S_TUT_Helm_MindflayerCall_StartTrigger_189c40a7-a355-467d-be80-dbfd754fc67b, _Var1);

IF
UseStarted((CHARACTER)_Var1, S_TUT_Helm_Door_001_8a665e33-fcb6-4a94-a567-41b643e96c3a, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_TUT_Helm_PartyMember(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_TUT_Helm_CallDialogPlayer(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_TUT_Helm_CallDialogPlayer(_Var1);

IF
UseStarted((CHARACTER)_Var1, S_TUT_Helm_Door_001_8a665e33-fcb6-4a94-a567-41b643e96c3a, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_TUT_Helm_PartyMember(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
SysCount("DB_Avatars", 1, 1, _Var1, _Var1)
THEN
DB_TUT_Helm_CallDialogPlayer(_Var1);
ReadyCheckGlobal("TUT_Helm_EnterHelmCheck", "TUT_Helm_EnterHelmCheck", 0, _Var1);

IF
UseStarted((GUIDSTRING)_Var1, S_TUT_Helm_Door_001_8a665e33-fcb6-4a94-a567-41b643e96c3a, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
QRY_TUT_Helm_PartyMember(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
SysCount("DB_Avatars", 1, 1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_MindflayerCall_DialogStartOnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
DB_TUT_Helm_CallDialogPlayer(_Var1);
PROC_TUT_Helm_EnterHelm(_Var1);

IF
ReadyCheckPassed("TUT_Helm_EnterHelmCheck", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_TUT_Helm_CallDialogPlayer(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_MindflayerCall_DialogStartOnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
DB_TUT_Helm_DidReadyCheck(1);
PROC_TUT_Helm_EnterHelm(_Var1);

PROC
PROC_TUT_Helm_EnterHelm((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
PROC_ItemUnlockAndOpen(S_TUT_Helm_Door_001_8a665e33-fcb6-4a94-a567-41b643e96c3a);
PROC_SetOnStage(S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e, 1);
PROC_SetOnStage(S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846, 1);
SetCanInteract(S_TUT_Helm_Door_001_8a665e33-fcb6-4a94-a567-41b643e96c3a, 0);
PROC_TUT_Helm_StartCallDialog(_Var1);

IF
DB_InRegion(_Var1, S_TUT_Helm_MindflayerCall_StartTrigger_189c40a7-a355-467d-be80-dbfd754fc67b, _Var1, _Var1, _Var1)
AND
QRY_TUT_Helm_PartyMember(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_MindflayerCall_DialogStartOnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
DB_TUT_Helm_CallDialogPlayer(_Var1);
PROC_TUT_Helm_StartCallDialog(_Var1);

IF
DB_InRegion(_Var1, S_TUT_Helm_MindflayerCall_StartTrigger_189c40a7-a355-467d-be80-dbfd754fc67b, _Var1, _Var1, _Var1)
AND NOT
QRY_TUT_Helm_PartyMember(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
CharacterGetOwner(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
QRY_IsPartyMember(_Var2, 1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_MindflayerCall_DialogStartOnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var2, S_TUT_NautiloidEscape_Helm_b784add8-f417-4650-aa47-080cb29dc6d0, "", 0, 0, 0, 0, 0);
DB_TUT_Helm_CallDialogPlayer(_Var2);
PROC_TUT_Helm_StartCallDialog(_Var2);

PROC
PROC_TUT_Helm_StartCallDialog((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
QRY_StartDialogCustom(TUT_Helm_MindflayerCall_de5c59ce-274f-0450-df3d-1d0754631c84, S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846, _Var1, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_StartFinalCombat();

PROC
PROC_StartDialog_AddExtraSpeakers(TUT_Helm_MindflayerCall_de5c59ce-274f-0450-df3d-1d0754631c84, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_TUT_Helm_CallDialogPlayer(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_PartyMembers(S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558, S_TUT_Helm_FinalCombatTeleportingTrigger_53dd14f6-1571-4cae-b223-83b42cd3bc3a, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558);

PROC
PROC_StartDialog_AddExtraSpeakers(TUT_Helm_MindflayerCall_de5c59ce-274f-0450-df3d-1d0754631c84, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_TUT_Guide(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var2, S_TUT_Helm_FinalCombatTeleportingTrigger_53dd14f6-1571-4cae-b223-83b42cd3bc3a, _Var1, _Var1, _Var1)
AND
DB_TUT_Helm_CallDialogPlayer(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
_Var2 != _Var3
THEN
PROC_DialogAddSpeakingActor(_Var1, _Var2);

IF
AttackedBy((CHARACTER)_Var1, (GUIDSTRING)_Var2, (GUIDSTRING)_Var3, _, _, _, _, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_TUT_Helm_CambionAndMindFlayer(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(TUT_Helm_JoinedMindflayerFight_ec25d7dc-f9d6-47ff-92c9-8921d6e32f54, _Var1, _Var1, _Var1, _Var1)
AND
QRY_GetCharacterOwnerIfItemSummon(_Var2, _Var3, _Var1, _Var1, _Var1)
AND
DB_QRYRTN_GetCharacterOwnerIfItemSummon(_Var8, _Var1, _Var1, _Var1, _Var1)
AND
QRY_TUT_Helm_PartyMember(_Var8, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_MindflayerCall_DialogStartOnlyOnce", _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_StartDialogCustom(TUT_Helm_MindflayerCall_de5c59ce-274f-0450-df3d-1d0754631c84, S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846, _Var8, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_StartFinalCombat();

IF
AttackedBy((CHARACTER)_Var1, (GUIDSTRING)_Var2, (GUIDSTRING)_Var3, _, _, _, _, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_TUT_Helm_CambionAndMindFlayer(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(TUT_Helm_JoinedMindflayerFight_ec25d7dc-f9d6-47ff-92c9-8921d6e32f54, _Var1, _Var1, _Var1, _Var1)
AND
QRY_GetCharacterOwnerIfItemSummon(_Var2, _Var3, _Var1, _Var1, _Var1)
AND
DB_QRYRTN_GetCharacterOwnerIfItemSummon(_Var8, _Var1, _Var1, _Var1, _Var1)
AND
QRY_IsPartyMember(_Var8, 1, _Var1, _Var1, _Var1)
AND NOT
QRY_TUT_Helm_PartyMember(_Var8, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_MindflayerCall_DialogStartOnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_StartFinalCombat();

IF
EnteredCombat((CHARACTER)_Var1, (GUIDSTRING)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_GlobalFlag(TUT_Helm_JoinedMindflayerFight_ec25d7dc-f9d6-47ff-92c9-8921d6e32f54, _Var1, _Var1, _Var1, _Var1)
AND
QRY_TUT_Helm_PartyMember(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_TUT_Helm_CambionAndMindFlayer(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var3, _Var4, _Var1, _Var1, _Var1)
AND
_Var2 == _Var4
AND
QRY_OnlyOnce("TUT_Helm_MindflayerCall_DialogStartOnlyOnce", _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_StartDialogCustom(TUT_Helm_MindflayerCall_de5c59ce-274f-0450-df3d-1d0754631c84, S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846, _Var1, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_StartFinalCombat();

IF
EnteredCombat((CHARACTER)_Var1, (GUIDSTRING)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_IsPartyMember(_Var1, 1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(TUT_Helm_JoinedMindflayerFight_ec25d7dc-f9d6-47ff-92c9-8921d6e32f54, _Var1, _Var1, _Var1, _Var1)
AND
DB_TUT_Helm_CambionAndMindFlayer(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var3, _Var4, _Var1, _Var1, _Var1)
AND
_Var2 == _Var4
AND NOT
QRY_TUT_Helm_PartyMember(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_MindflayerCall_DialogStartOnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_StartFinalCombat();

QRY
QRY_TUT_Helm_PartyMember((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_TUT_Helm_PartyMember((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_TutorialCompanion(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
DB_Dead(S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846, _, _, _, _)
THEN
PROC_ForceStopDialog(S_TUT_Helm_MindflayerHelper_efd4c6ae-90cb-4109-adb1-165b25387aac);

IF
DB_GlobalFlag(TUT_Helm_Event_TeleportToHelm_da46bc45-e134-4be9-a8d2-19eb9d460f74, _, _, _, _)
AND
QRY_OnlyOnce("TUT_Helm_TeleportInside", _, _, _, _)
THEN
PROC_TUT_Helm_Teleport();

IF
DialogEnded(TUT_Helm_MindflayerCall_de5c59ce-274f-0450-df3d-1d0754631c84, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
QRY_OnlyOnce("TUT_Helm_TeleportInside", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_Teleport();

PROC
PROC_TUT_Helm_Teleport()
AND
DB_TUT_Helm_DidReadyCheck(1, _, _, _, _)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_TUT_Helm_FinalCombatTeleportingTrigger_53dd14f6-1571-4cae-b223-83b42cd3bc3a, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var1, S_TUT_Helm_PointOfNoReturn_6c4f1de5-89c5-4944-bda3-f1304c7fbc6a, "", 0, 1, 1, 0, 1);

PROC
PROC_TUT_Helm_Teleport()
AND NOT
DB_TUT_Helm_DidReadyCheck(1, _, _, _, _)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_TUT_Helm_FinalCombatTeleportingTrigger_53dd14f6-1571-4cae-b223-83b42cd3bc3a, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var1, S_TUT_Helm_PointOfNoReturn_6c4f1de5-89c5-4944-bda3-f1304c7fbc6a, "", 0, 0, 0, 0, 1);

PROC
PROC_TUT_Helm_StartWarningFires()
AND
DB_TUT_Helm_BacktrackingFireTriggers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
Random(1500, _Var2, _Var1, _Var1, _Var1)
THEN
ObjectTimerLaunch(_Var1, "TUT_Helm_MakeFireWarning", _Var2);

IF
DialogEnded(TUT_Helm_MindflayerCall_de5c59ce-274f-0450-df3d-1d0754631c84, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
THEN
PROC_TUT_Helm_StartFinalCombat();

PROC
PROC_TUT_Helm_StartFinalCombat()
AND
QRY_OnlyOnce("TUT_Helm_StartNarrativeCombat", _, _, _, _)
THEN
PROC_GLO_NarrativeCombat_StartCombat("TUT_Helm_FinalCombat");
PROC_TUT_Helm_HandleNarrativeCombat();

IF
DB_Sees(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _, _Var1, _Var1, _Var1)
AND
DB_GLO_NarrativeCombat_Participant("TUT_Helm_FinalCombat", _, _Var2, _Var1, _Var1)
AND NOT
QRY_TUT_Helm_CantJoinNarrativeCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GLO_NarrativeCombat_JoinCombat("TUT_Helm_FinalCombat", _Var1);

IF
StatusRemoved((GUIDSTRING)_Var1, (STRING)_Var2, _, _, (GUIDSTRING)_Var1)
AND
DB_TUT_Helm_DisablingStatus(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _, _Var1, _Var1, _Var1)
AND NOT
DB_GLO_NarrativeCombat_Participant("TUT_Helm_FinalCombat", _, _Var1, _Var1, _Var1)
AND
DB_GLO_NarrativeCombat_Participant("TUT_Helm_FinalCombat", _, _Var8, _Var1, _Var1)
AND
CanSee(_Var1, _Var8, 1, _Var1, _Var1)
THEN
PROC_GLO_NarrativeCombat_JoinCombat("TUT_Helm_FinalCombat", _Var1);

PROC
PROC_GLO_NarrativeCombat_CharacterEnteredRegion((GUIDSTRING)_Var1, S_TUT_Helm_HelmNarrativeCombatRegion_5a670796-d16f-4b10-bea5-56393263d251, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
PROC_GLO_NarrativeCombat_JoinCombat("TUT_Helm_FinalCombat", _Var1);

QRY
QRY_TUT_Helm_CantJoinNarrativeCombat((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_TUT_Helm_DisablingStatus(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
HasActiveStatus(_Var1, _Var2, 1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_TUT_Helm_HandleNarrativeCombat()
AND
DB_TUT_Helm_Devils(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsOnStage(_Var1, 0, _Var1, _Var1, _Var1)
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _, _Var1, _Var1, _Var1)
THEN
PROC_Appear(_Var1);
PROC_GLO_NarrativeCombat_JoinCombat("TUT_Helm_FinalCombat", _Var1);

PROC
PROC_TUT_Helm_HandleNarrativeCombat()
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SetCanFight(S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846, 1);
PROC_SetCanFight(S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e, 1);
PROC_GLO_NarrativeCombat_JoinCombat("TUT_Helm_FinalCombat", S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846);
PROC_GLO_NarrativeCombat_JoinCombat("TUT_Helm_FinalCombat", S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e);

PROC
PROC_TUT_Helm_HandleNarrativeCombat()
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TriggerRegisterForParty(S_TUT_Helm_HelmNarrativeCombatRegion_5a670796-d16f-4b10-bea5-56393263d251);
DB_GLO_NarrativeCombat_Region("TUT_Helm_FinalCombat", S_TUT_Helm_HelmNarrativeCombatRegion_5a670796-d16f-4b10-bea5-56393263d251);
SetFlag(TUT_Misc_Quest_ReachedHelm_f61440b7-4118-4936-b165-40677fff1a9c, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_TUT_Helm_HandleNarrativeCombat()
AND
DB_TUT_Helm_NPCsFromOtherAreas(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_CheckNPCReachedHelm(_Var1);

PROC
PROC_TUT_Helm_CheckNPCReachedHelm((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
IsInTrigger(_Var1, S_TUT_Helm_HelmNarrativeCombatRegion_5a670796-d16f-4b10-bea5-56393263d251, 1, _Var1, _Var1)
THEN
PROC_GLO_NarrativeCombat_JoinCombat("TUT_Helm_FinalCombat", _Var1);

PROC
PROC_TUT_Helm_CheckNPCReachedHelm((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
IsInTrigger(_Var1, S_TUT_Helm_HelmNarrativeCombatRegion_5a670796-d16f-4b10-bea5-56393263d251, 0, _Var1, _Var1)
THEN
TriggerRegisterForCharacter(S_TUT_Helm_HelmNarrativeCombatRegion_5a670796-d16f-4b10-bea5-56393263d251, _Var1);

PROC
PROC_TUT_Helm_HandleNarrativeCombat()
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _, _, _, _)
AND
DB_PartyMembers(_Var2, _, _, _, _)
AND
IsInTrigger(_Var2, S_TUT_Helm_PointOfNoReturn_6c4f1de5-89c5-4944-bda3-f1304c7fbc6a, 1, _, _)
THEN
PROC_GLO_NarrativeCombat_JoinCombat("TUT_Helm_FinalCombat", _Var2);

IF
EnteredCombat((CHARACTER)_Var1, (GUIDSTRING)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _Var2, _Var1, _Var1, _Var1)
AND
DB_TUT_Helm_FinalCombatPaused(1, _Var1, _Var1, _Var1, _Var1)
THEN
ResumeCombat(_Var2);

IF
CombatPaused((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_TUT_Helm_FinalCombatPaused(1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_TUT_Helm_FinalCombatPaused(1);

IF
CombatResumed((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _Var1, _Var1, _Var1, _Var1)
AND
DB_TUT_Helm_FinalCombatPaused(1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_TUT_Helm_FinalCombatPaused(1);

IF
LeftCombat((GUIDSTRING)_Var1, (GUIDSTRING)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _Var2, _Var1, _Var1, _Var1)
AND
CombatGetInvolvedPartyMembersCount(_Var2, 0, _Var1, _Var1, _Var1)
THEN
PauseCombat(_Var2);

IF
DB_Is_InCombat(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _Var2, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_StartHelmTimer", _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(TUT_Helm_JoinedMindflayerFight_ec25d7dc-f9d6-47ff-92c9-8921d6e32f54);
TurnBasedTimerLaunch(_Var1, "TUT_Helm_Timer", "TUT_Helm_TransponderTimer", 90000);

PROC
PROC_TUT_Helm_RoundEvent(16, _, _, _, _)
AND NOT
DB_TUT_Helm_TransponderUser(_, _, _, _, _)
THEN
PROC_TUT_Helm_GameOver();

PROC
PROC_CounterDecreased("TUT_Helm_DevilCount", (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_GlobalCounter("TUT_Helm_DevilCount", _Var1, _Var1, _Var1, _Var1)
AND
_Var1 == 0
THEN
NOT DB_GlobalCounter("TUT_Helm_DevilCount", _Var1);

PROC
PROC_GLO_DefeatCounter_Notify("TUT_Helm_Devils", _, _, _, _)
AND
QRY_GLO_DefeatCounter_Count("TUT_Helm_Devils", "Active", _, _, _)
AND
DB_QRYRTN_GLO_DefeatCounter_Count(_Var4, _, _, _, _)
AND
_Var4 <= 2
AND
DB_OnlyOnce("TUT_Helm_PlayerJoinedCombat", _, _, _, _)
THEN
DB_GlobalCounter("TUT_Helm_DevilCount", 2);
PROC_CounterDecreased("TUT_Helm_DevilCount");

IF
TurnStarted((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_TUT_Helm_RubbleDelayed(1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _Var2, _Var1, _Var1, _Var1)
THEN
NOT DB_TUT_Helm_RubbleDelayed(1);
PROC_TUT_Helm_RubbleFall();

IF
TurnStarted((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _Var2, _Var1, _Var1, _Var1)
THEN
DB_TUT_Helm_PlayerTurn(1);

IF
TurnEnded((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _Var2, _Var1, _Var1, _Var1)
THEN
NOT DB_TUT_Helm_PlayerTurn(1);

PROC
PROC_TUT_Helm_RubbleFall()
AND
DB_TUT_Helm_PlayerTurn(1, _, _, _, _)
THEN
DB_TUT_Helm_RubbleDelayed(1);

PROC
PROC_TUT_Helm_RubbleFall()
AND NOT
DB_TUT_Helm_PlayerTurn(1, _, _, _, _)
THEN
PROC_LoopEffect(VFX_Script_Tutorial_CameraShake_01_0661ac5d-e5e7-79ad-0a1e-538a31a4ce0a, S_TUT_Helm_RubbleHelper_bd53b9a1-2231-4239-abd7-eb53ca56802f, "TUT_Helm_RubbleCollapse", "TUT_Avernus_C", "");
ObjectTimerLaunch(S_TUT_Helm_RubbleHelper_bd53b9a1-2231-4239-abd7-eb53ca56802f, "TUT_Helm_RubbleCollapse", 5000);

IF
ObjectTimerFinished((GUIDSTRING)_Var1, "TUT_Helm_RubbleCollapse", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
PROC_StopLoopEffect(_Var1, "TUT_Helm_RubbleCollapse");

IF
Fell((ITEM)_Var1, _, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
GetTemplate(_Var1, Quest_CMB_StalkBulb_Gravity_10c7fb61-9c54-4910-a152-78ae743e51fb, _Var1, _Var1, _Var1)
THEN
Die(_Var1);

IF
CombatRoundStarted((GUIDSTRING)_Var1, (INTEGER)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _Var1, _Var1, _Var1, _Var1)
AND
DB_TUT_Helm_RoundCount(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
IntegerSum(_Var3, 1, _Var4, _Var1, _Var1)
THEN
NOT DB_TUT_Helm_RoundCount(_Var3);
DB_TUT_Helm_RoundCount(_Var4);
PROC_TUT_Helm_RoundEvent(_Var4);

PROC
PROC_TUT_Helm_RoundEvent((INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_TUT_Helm_RoundsRubble(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_RubbleFall();

PROC
PROC_TUT_Helm_RoundEvent(1, _, _, _, _)
THEN
DB_GLO_DefeatCounter_Target("TUT_Helm_DevilCount", 2);

PROC
PROC_TUT_Helm_RoundEvent(2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_GlobalCounter("TUT_Helm_DevilCount", 2);
PROC_CounterDecreased("TUT_Helm_DevilCount");

PROC
PROC_TUT_Helm_RoundEvent(4, _, _, _, _)
THEN
DB_GlobalCounter("TUT_Helm_DevilCount", 2);
PROC_CounterDecreased("TUT_Helm_DevilCount");

PROC
PROC_TUT_Helm_RoundEvent(5, _, _, _, _)
THEN
DB_GlobalCounter("TUT_Helm_DevilCount", 2);
PROC_CounterDecreased("TUT_Helm_DevilCount");

PROC
PROC_TUT_Helm_RoundEvent(6, _, _, _, _)
AND
CheckRulesetModifierString(cac2d8bd-c197-4a84-9df1-f86f54ad4521, "MEDIUM", 1, _, _)
AND
DB_TUT_Helm_Devils_BackUpCambions(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_SpawnCambionBackUp_OnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_SpawnCambionBackUp();

PROC
PROC_TUT_Helm_RoundEvent(5, _, _, _, _)
AND
CheckRulesetModifierString(cac2d8bd-c197-4a84-9df1-f86f54ad4521, "HARD", 1, _, _)
AND
DB_TUT_Helm_Devils_BackUpCambions(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_SpawnCambionBackUp_OnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_SpawnCambionBackUp();

PROC
PROC_TUT_Helm_RoundEvent(8, _, _, _, _)
AND
CheckRulesetModifierString(cac2d8bd-c197-4a84-9df1-f86f54ad4521, "EASY", 1, _, _)
AND
DB_TUT_Helm_Devils_BackUpCambions(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_SpawnCambionBackUp_OnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_SpawnCambionBackUp();

PROC
PROC_TUT_Helm_RoundEvent(9, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_TUT_Helm_Devils_BackUpCambions(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_SpawnCambionBackUp_OnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_SpawnCambionBackUp();

IF
DB_TUT_Helm_Devils_BackUpCambions(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TriggerRegisterForCharacter(S_TUT_Helm_ConsolePointArea_870b647f-5853-4f1a-9c39-a4915808201a, _Var1);
TriggerRegisterForCharacter(S_TUT_Helm_CambionBackUpCombatJoin_2c4780faS_TUT_Helm_CambionBackUpCombatJoin_2c4780fa-2697-4ad8-99c0-3571ba505277, _Var1);

IF
EnteredTrigger((CHARACTER)_Var1, S_TUT_Helm_ConsolePointArea_870b647f-5853-4f1a-9c39-a4915808201a, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
TriggerUnregisterForCharacter(S_TUT_Helm_ConsolePointArea_870b647f-5853-4f1a-9c39-a4915808201a, _Var1);
SetFlag(TUT_Helm_Event_ReachedTransponder_f48e0c6e-495f-44c3-b0bf-b30819cd0e6e, _Var1);

IF
Died((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_TUT_Helm_CambionAndMindFlayer(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_TUT_Helm_CambionAndMindFlayer(_Var1);
PROC_TUT_Helm_CheckCambionAndMindFlayerAreDead();

PROC
PROC_TUT_Helm_CheckCambionAndMindFlayerAreDead()
AND NOT
DB_TUT_Helm_CambionAndMindFlayer(_, _, _, _, _)
AND
QRY_OnlyOnce("TUT_Helm_SpawnCambionBackUp_OnlyOnce", _, _, _, _)
THEN
PROC_TUT_Helm_SpawnCambionBackUp();

PROC
PROC_TUT_Helm_SpawnCambionBackUp()
AND NOT
DB_TUT_Helm_GameOver(1, _, _, _, _)
AND
DB_TUT_Helm_Devils_BackUpCambions(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_Appear(_Var1);
DB_SpotPlayers(_Var1, "TUT_Helm_CambionSpot", NULL_00000000-0000-0000-0000-000000000000, TUT_Helm_State_CambionStopSpotting_7f58caad-625b-4eea-96fa-906021cb688f);
DB_SpotPlayers_IgnoreCombat(_Var1, "TUT_Helm_CambionSpot");
DB_SpotPlayers_CustomRadius(_Var1, "TUT_Helm_CambionSpot", 8);
DB_SpotPlayers_TargetIgnoreCantTalk(_Var1, "TUT_Helm_CambionSpot");
DB_SpotPlayers_IncludeWildshapedPlayers(_Var1, "TUT_Helm_CambionSpot");

IF
WentOnStage((GUIDSTRING)_Var1, 1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_TUT_Helm_Devils_BackUpCambions(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _Var2, _Var1, _Var1, _Var1)
THEN
PROC_GLO_NarrativeCombat_JoinCombat("TUT_Helm_FinalCombat", _Var1);

PROC
PROC_SpotPlayers_Spotted((CHARACTER)_Var1, "TUT_Helm_CambionSpot", (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_TUT_Helm_Devils_BackUpCambions(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_CambionSpottedPlayer", _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(TUT_Helm_State_CambionStopSpotting_7f58caad-625b-4eea-96fa-906021cb688f, NULL_00000000-0000-0000-0000-000000000000);
PROC_TryStartAD(TUT_Helm_AD_BackUpCambion_d25cd41c-b0e4-551b-7d46-2ccead0b8393, _Var1);

PROC
PROC_TUT_Helm_Init()
THEN
DB_TUT_Helm_CombatPlayerADs(TUT_Helm_VB_FirstWarning_d532434e-80d5-6f2f-df02-129dae65d36b, 1);
DB_TUT_Helm_CombatPlayerADs(TUT_Helm_VB_LastWarning_2a416f95-ffaf-f5c9-ddfc-7bebd9bb4244, 4);
DB_TUT_Helm_CombatNpcADs(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, NULL_00000000-0000-0000-0000-000000000000, 99);

IF
TurnStarted((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(TUT_Helm_JoinedMindflayerFight_ec25d7dc-f9d6-47ff-92c9-8921d6e32f54, _Var1, _Var1, _Var1, _Var1)
AND
DB_TUT_Helm_CombatNPCADQueued(_Var1, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_TUT_Helm_CombatNpc_AssaultReactionAD(_Var1, _, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailable(_Var1, 1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(_Var2, _Var1);
NOT DB_TUT_Helm_CombatNPCADQueued(_Var1, _Var2);

IF
TurnStarted((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_GlobalFlag(TUT_Helm_JoinedMindflayerFight_ec25d7dc-f9d6-47ff-92c9-8921d6e32f54, _Var1, _Var1, _Var1, _Var1)
AND
DB_TUT_Helm_CombatNpc_AssaultReactionAD(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailable(_Var1, 1, _Var1, _Var1, _Var1)
THEN
SetEntityEventReal(_Var1, "GLO_CombatWait", 2);
PROC_TryStartAD(_Var2, _Var1);
NOT DB_TUT_Helm_CombatNpc_AssaultReactionAD(_Var1, _Var2);

IF
TurnStarted((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(TUT_Helm_JoinedMindflayerFight_ec25d7dc-f9d6-47ff-92c9-8921d6e32f54, _Var1, _Var1, _Var1, _Var1)
AND
DB_TUT_Helm_CombatPlayerADQueued(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailable(_Var1, 1, _Var1, _Var1, _Var1)
THEN
StartVoiceBark(_Var2, _Var1);
NOT DB_TUT_Helm_CombatPlayerADQueued(_Var2);

PROC
PROC_TUT_Helm_RoundEvent((INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_TUT_Helm_CombatPlayerADs(_Var2, _Var3, _Var1, _Var1, _Var1)
AND
_Var1 >= _Var3
AND NOT
DB_TUT_Helm_CombatPlayerADQueued(_, _Var1, _Var1, _Var1, _Var1)
THEN
DB_TUT_Helm_CombatPlayerADQueued(_Var2);
NOT DB_TUT_Helm_CombatPlayerADs(_Var2, _Var3);

PROC
PROC_TUT_Helm_RoundEvent((INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_TUT_Helm_CombatNpcADs(_Var2, _Var3, _Var4, _Var1, _Var1)
AND
_Var3 != NULL_00000000-0000-0000-0000-000000000000
AND
_Var1 >= _Var4
AND NOT
DB_TUT_Helm_CombatNPCADQueued(_Var2, _, _Var1, _Var1, _Var1)
THEN
DB_TUT_Helm_CombatNPCADQueued(_Var2, _Var3);
NOT DB_TUT_Helm_CombatNpcADs(_Var2, _Var3, _Var4);

IF
AttackedBy(S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e, (GUIDSTRING)_Var1, (GUIDSTRING)_Var2, _, _, _, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GlobalFlag(TUT_Helm_JoinedMindflayerFight_ec25d7dc-f9d6-47ff-92c9-8921d6e32f54, _Var1, _Var1, _Var1, _Var1)
AND
QRY_GetCharacterOwnerIfItemSummon(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_QRYRTN_GetCharacterOwnerIfItemSummon(_Var7, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var7, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_CombatNpc_AssaultReactionAD", _Var1, _Var1, _Var1, _Var1)
THEN
DB_TUT_Helm_CombatNpc_AssaultReactionAD(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, TUT_Helm_AD_LaezelIgnoreCambion_381314d8-ad7b-8a33-d48a-6931f3f8ee2b);
DB_TUT_Helm_CombatNpc_AssaultReactionAD(S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846, TUT_Helm_AD_MindFlayerIgnoreCambion_8031bf13-8468-dd39-0782-402aca59d6a8);

IF
DB_TUT_Helm_Devils_BackUp(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetOnStage(_Var1, 0);
AddPreferredAiTargetTag(_Var1, AVATAR_306b9b05-1057-4770-aa17-01af21acd650);
AddPreferredAiTargetTag(_Var1, REALLY_LAEZEL_b5682d1d-c395-489c-9675-1f9b0c328ea5);
AddPreferredAiTargetTag(_Var1, INTELLECT_DEVOURER_69901347-23cb-4f60-abf3-527f23cdf0db);

IF
DialogEnded(TUT_Helm_DragonAppears_6ffc2909-a928-4b8b-6901-02d823e68880, _, _, _, _)
AND
DB_TUT_Helm_Devils_BackUp(_Var2, _, _, _, _)
AND
GetPosition(_Var2, _Var3, _Var4, _Var5, _)
THEN
AppearAtPosition(_Var2, _Var3, _Var4, _Var5, 1, CUST_ImpDrop_01_0bf529ab-710a-46cc-9c4b-f3b54c47f25f, "");
PROC_GLO_NarrativeCombat_JoinCombat("TUT_Helm_FinalCombat", _Var2);

QRY
QRY_TUT_Helm_CheckWildshape((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Is_WildShaped(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_RemoveAllPolymorphs(_Var1);

QRY
QRY_TUT_Helm_CheckWildshape((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_Is_WildShaped(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_TUT_Helm_CheckIfActive((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SameUser(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
DB_TUT_Helm_MakePlayerActive(_Var2);

QRY
QRY_TUT_Helm_CheckIfActive((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_TUT_Helm_PlayersInDialog((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
_Var2 != _Var1
AND
IsSpeakerReserved(_Var2, 1, _Var1, _Var1, _Var1)
AND
SpeakerGetDialog(_Var2, 1, _Var3, _Var4, _Var1)
THEN
DB_TUT_Helm_InterruptedDialogs(_Var4, _Var1);
DialogRequestStop(_Var2);

IF
DialogEnded(_, (INTEGER)_Var2, _, _, _)
AND
DB_TUT_Helm_InterruptedDialogs(_Var2, _Var3, _, _, _)
THEN
NOT DB_TUT_Helm_InterruptedDialogs(_Var2, _Var3);
PROC_TUT_Helm_RetryTransponder(_Var3);

PROC
PROC_TUT_Helm_RetryTransponder((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_TUT_Helm_InterruptedDialogs(_, _, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_TryTransponder(_Var1);

IF
UseStarted((CHARACTER)_Var1, S_TUT_Helm_ControlPanel_bcbba417-6403-40a6-aef6-6785d585df2a, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PlayerSummons(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(TUT_Helm_AD_CreatureCantUseTransponder_1e44dd42-e7ca-2792-7b05-86cb23b40668, _Var1);

IF
UseStarted(S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558, S_TUT_Helm_ControlPanel_bcbba417-6403-40a6-aef6-6785d585df2a, _, _, _)
THEN
PROC_TryStartAD(TUT_Helm_AD_CreatureCantUseTransponder_1e44dd42-e7ca-2792-7b05-86cb23b40668, S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558);

IF
UseStarted((GUIDSTRING)_Var1, S_TUT_Helm_ControlPanel_bcbba417-6403-40a6-aef6-6785d585df2a, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
_Var1 != S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558
AND NOT
DB_PlayerSummons(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_TryTransponder(_Var1);

PROC
PROC_TUT_Helm_TryTransponder((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
QRY_TUT_Helm_CheckWildshape(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_TUT_Helm_CheckIfActive(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_TUT_Helm_PlayersInDialog(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_StartHelm_Dialog", _Var1, _Var1, _Var1, _Var1)
THEN
DB_TUT_Helm_TransponderUser(_Var1);
PROC_TUT_Helm_Transponder(_Var1);

PROC
PROC_TUT_Helm_Transponder((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
QRY_StartDialogCustom(TUT_Helm_Transponder_d1cac06a-9fa7-237d-1f25-5e9de38ecd2c, _Var1, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_StartDialog_AddExtraSpeakers(TUT_Helm_Transponder_d1cac06a-9fa7-237d-1f25-5e9de38ecd2c, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
THEN
DialogSetTeleportPartyToLevelOnEnded(_Var1, "WLD_Main_A");

PROC
PROC_StartDialog_AddExtraSpeakers(TUT_Helm_Transponder_d1cac06a-9fa7-237d-1f25-5e9de38ecd2c, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
HasAppliedStatus(_Var2, "DOWNED", 1, _Var1, _Var1)
THEN
SetHitpointsPercentage(_Var2, 100);

PROC
PROC_StartDialog_AddExtraSpeakers(TUT_Helm_Transponder_d1cac06a-9fa7-237d-1f25-5e9de38ecd2c, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_TutorialCompanion(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_TUT_Helm_TransponderUser(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddListeningActor(_Var1, _Var2);

PROC
PROC_StartDialog_AddExtraSpeakers(TUT_Helm_Transponder_d1cac06a-9fa7-237d-1f25-5e9de38ecd2c, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_TUT_Helm_TransponderUser(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddListeningActor(_Var1, _Var2);

IF
DialogEnded(TUT_Helm_Transponder_d1cac06a-9fa7-237d-1f25-5e9de38ecd2c, _, _, _, _)
AND
DB_TUT_Helm_MakePlayerActive(_Var2, _, _, _, _)
THEN
NOT DB_TUT_Helm_MakePlayerActive(_Var2);
MakePlayerActive(_Var2);

IF
DialogStarted(TUT_Helm_Transponder_d1cac06a-9fa7-237d-1f25-5e9de38ecd2c, _, _, _, _)
AND
DB_Players(_Var2, _, _, _, _)
THEN
TurnBasedTimerCancel(_Var2, "TUT_Helm_Timer");

PROC
PROC_GlobalFlagReactionAfterDialog(TUT_Helm_TransponderActivated_40d32a6d-8d41-4ceb-a4e9-bbd34d0664e4, _, _, _, _)
THEN
PROC_TUT_Helm_InitiateEndTutorial();

IF
DB_TUT_Guide(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TriggerRegisterForCharacter(S_TUT_Helm_DragonTrigger_3ca543c8-75b7-4f1f-9415-941c83904fda, _Var1);
TriggerRegisterForCharacter(S_TUT_Helm_MindMeldTrigger_3e0656be-0613-4e7d-9c1b-894628e812f6, _Var1);

IF
DB_TutorialCompanion(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, _, _, _, _)
THEN
TriggerRegisterForCharacter(S_TUT_Helm_DragonTrigger_3ca543c8-75b7-4f1f-9415-941c83904fda, S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679);
TriggerRegisterForCharacter(S_TUT_Helm_MindMeldTrigger_3e0656be-0613-4e7d-9c1b-894628e812f6, S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679);

IF
DB_InRegion(_Var1, S_TUT_Helm_DragonTrigger_3ca543c8-75b7-4f1f-9415-941c83904fda, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Defeated(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_TutorialCompanion(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_TUT_Helm_DragonAppearDialogueStart(1);
PROC_TUT_Helm_StartDragonCinematic(_Var1);

IF
DB_InRegion(_Var1, S_TUT_Helm_DragonTrigger_3ca543c8-75b7-4f1f-9415-941c83904fda, _Var1, _Var1, _Var1)
AND
DB_TUT_Guide(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Defeated(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_GetClosestPlayerToGuideAndTriggerDragon(_Var1);

IF
DB_InRegion(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, S_TUT_Helm_DragonTrigger_3ca543c8-75b7-4f1f-9415-941c83904fda, _, _, _)
AND
DB_TutorialCompanion(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, _, _, _, _)
AND NOT
DB_Defeated(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, _, _, _, _)
THEN
PROC_TUT_Helm_GetClosestPlayerToGuideAndTriggerDragon(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679);

PROC
PROC_TUT_Helm_GetClosestPlayerToGuideAndTriggerDragon((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_TUT_Helm_ClosestToGuide(_Var2, _Var3, _Var1, _Var1, _Var1)
THEN
NOT DB_TUT_Helm_ClosestToGuide(_Var2, _Var3);
DB_TUT_Helm_ClosestToGuide(NULL_00000000-0000-0000-0000-000000000000, 9999);

PROC
PROC_TUT_Helm_GetClosestPlayerToGuideAndTriggerDragon((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_TutorialCompanion(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_TutorialCompanion(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Defeated(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var2, S_TUT_Helm_MindMeldTrigger_3e0656be-0613-4e7d-9c1b-894628e812f6, _Var1, _Var1, _Var1)
AND
GetDistanceTo(_Var2, _Var1, _Var3, _Var1, _Var1)
AND
DB_TUT_Helm_ClosestToGuide(_Var4, _Var5, _Var1, _Var1, _Var1)
AND
_Var3 < _Var5
THEN
NOT DB_TUT_Helm_ClosestToGuide(_Var4, _Var5);
DB_TUT_Helm_ClosestToGuide(_Var2, _Var3);

PROC
PROC_TUT_Helm_GetClosestPlayerToGuideAndTriggerDragon((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_TUT_Helm_ClosestToGuide(_Var2, _, _Var1, _Var1, _Var1)
AND
_Var2 != NULL_00000000-0000-0000-0000-000000000000
THEN
DB_TUT_Helm_DragonAppearDialogueStart(1);
PROC_TUT_Helm_StartDragonCinematic(_Var2);

PROC
PROC_TUT_Helm_GetClosestPlayerToGuideAndTriggerDragon((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_TUT_Helm_ClosestToGuide(_Var2, _, _Var1, _Var1, _Var1)
AND
_Var2 == NULL_00000000-0000-0000-0000-000000000000
AND
DB_TUT_Guide(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_TUT_Helm_MindMeldTrigger_3e0656be-0613-4e7d-9c1b-894628e812f6, _Var1, _Var1, _Var1)
THEN
DB_TUT_Helm_DragonAppearDialogueStart(1);
PROC_TUT_Helm_StartDragonCinematic(_Var1);

PROC
PROC_TUT_Helm_GetClosestPlayerToGuideAndTriggerDragon(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_TUT_Helm_ClosestToGuide(_Var1, _, _Var1, _Var1, _Var1)
AND
_Var1 == NULL_00000000-0000-0000-0000-000000000000
AND NOT
DB_Defeated(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, S_TUT_Helm_MindMeldTrigger_3e0656be-0613-4e7d-9c1b-894628e812f6, _Var1, _Var1, _Var1)
THEN
DB_TUT_Helm_DragonAppearDialogueStart(1);
PROC_TUT_Helm_StartDragonCinematic(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679);

PROC
PROC_TUT_Helm_StartDragonCinematic((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_OnlyOnce("TUT_Helm_DragonAppeared", _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(TUT_Helm_DragonAppears_6ffc2909-a928-4b8b-6901-02d823e68880, S_TUT_Helm_DragonCinematicHelper_7a74eb50-dcc9-4830-a83d-61d3568dc850, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, _Var1, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_DragonAppeared", _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_SpeakerIsInDialogRange(S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_TUT_Helm_DragonAppearDialogueStart(1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
DialogEnded(TUT_Helm_DragonAppears_6ffc2909-a928-4b8b-6901-02d823e68880, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
NOT DB_TUT_Helm_DragonAppearDialogueStart(1);

IF
DialogRequestFailed(TUT_Helm_DragonAppears_6ffc2909-a928-4b8b-6901-02d823e68880, _, _, _, _)
AND
QRY_OnlyOnce_Reset("TUT_Helm_DragonAppeared", _, _, _, _)
THEN
DB_NOOP(1);

IF
DB_TUT_Guide(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TriggerRegisterForCharacter(S_TUT_Helm_PointOfNoReturn_6c4f1de5-89c5-4944-bda3-f1304c7fbc6a, _Var1);
TriggerRegisterForCharacter(S_TUT_Helm_GameOverTrigger_c77c73c4-94e2-4cbc-9206-743777e3ed24, _Var1);
TriggerRegisterForCharacter(S_TUT_IncinerateTrigger_2a7c57ad-970d-457a-a5aa-269e24c0fb5e, _Var1);

IF
DB_TUT_Helm_BacktrackingFireTriggers(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TriggerRegisterForPlayers(_Var1);

IF
EnteredTrigger((GUIDSTRING)_Var1, S_TUT_Helm_PointOfNoReturn_6c4f1de5-89c5-4944-bda3-f1304c7fbc6a, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
DB_TUT_Helm_CrossedPointOfNoReturn(_Var1);

IF
EnteredTrigger((CHARACTER)_Var1, S_TUT_Helm_GuideBacktrackWarning_41479227-6954-4a4d-a075-c00255c69399, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_TUT_Helm_CrossedPointOfNoReturn(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_TUT_Guide(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_TUT_Guide(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
GetDistanceTo(_Var1, _Var2, _Var3, _Var1, _Var1)
AND
_Var3 <= 15
AND
DB_TUT_GuideDialogues("Backtrack", _Var2, _Var4, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_BacktrackWarning", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(_Var4, _Var2);

IF
EnteredTrigger((CHARACTER)_Var1, S_TUT_Helm_GuideBacktrackWarning_41479227-6954-4a4d-a075-c00255c69399, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_TUT_Helm_CrossedPointOfNoReturn(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_StartFires", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_CameraShakeAroundObject(_Var1, 2000, 30);
PROC_TUT_Helm_StartWarningFires();

IF
EnteredTrigger((CHARACTER)_Var1, S_TUT_Helm_GuideBacktrackWarning_41479227-6954-4a4d-a075-c00255c69399, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_Avatars(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, _Var1, _Var1, _Var1, _Var1)
AND
DB_TUT_Helm_CrossedPointOfNoReturn(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679
AND
GetDistanceTo(_Var1, S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, _Var2, _Var1, _Var1)
AND
_Var2 <= 15
AND
QRY_OnlyOnce("TUT_Helm_BacktrackWarning", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(TUT_Helm_AD_ShadowheartGoToHelmReminder_17c2dc71-e5e5-26db-3132-9ef7decbb7b0, S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679);

IF
EnteredTrigger((CHARACTER)_Var1, S_TUT_Helm_ScreenShake_7b08ca7a-3188-4b72-8120-1a39630a48b5, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_TUT_Helm_CrossedPointOfNoReturn(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_TUT_Helm_ScreenShake(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_TUT_Helm_ScreenShake(_Var1);
PROC_CameraShakeAroundObject(_Var1, 6000, 30);

IF
EnteredTrigger((CHARACTER)_Var1, S_TUT_Helm_GameOverTrigger_c77c73c4-94e2-4cbc-9206-743777e3ed24, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_TUT_Helm_CrossedPointOfNoReturn(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_GameOver();

PROC
PROC_TUT_Helm_GameOver()
THEN
DB_TUT_Helm_GameOver(1);

PROC
PROC_TUT_Helm_GameOver()
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Dead(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_InRegion(_Var1, S_TUT_IncinerateTrigger_2a7c57ad-970d-457a-a5aa-269e24c0fb5e, _Var1, _Var1, _Var1)
THEN
Die(_Var1, 0, NULL_00000000-0000-0000-0000-000000000000, 0, 0);

PROC
PROC_TUT_Helm_GameOver()
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Dead(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_TUT_IncinerateTrigger_2a7c57ad-970d-457a-a5aa-269e24c0fb5e, _Var1, _Var1, _Var1)
THEN
Die(_Var1, 0, NULL_00000000-0000-0000-0000-000000000000, 0, 0);

PROC
PROC_TUT_Helm_GameOver()
AND
DB_TutorialCompanion(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Dead(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_InRegion(_Var1, S_TUT_IncinerateTrigger_2a7c57ad-970d-457a-a5aa-269e24c0fb5e, _Var1, _Var1, _Var1)
THEN
Die(_Var1, 0, NULL_00000000-0000-0000-0000-000000000000, 0, 0);

PROC
PROC_TUT_Helm_GameOver()
AND
DB_TutorialCompanion(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Dead(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_TUT_IncinerateTrigger_2a7c57ad-970d-457a-a5aa-269e24c0fb5e, _Var1, _Var1, _Var1)
THEN
Die(_Var1, 0, NULL_00000000-0000-0000-0000-000000000000, 0, 0);

PROC
PROC_TUT_Helm_GameOver()
AND
DB_TUT_Helm_GameOver_NPCSToDie(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsOnStage(_Var1, 1, _Var1, _Var1, _Var1)
AND NOT
DB_Dead(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_TUT_Helm_GameOver_NPCSToIncinerate(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
Random(1500, _Var2, _Var1, _Var1, _Var1)
THEN
RealtimeObjectTimerLaunch(_Var1, "TUT_Helm_DieFromFire", _Var2);

PROC
PROC_TUT_Helm_GameOver()
AND
DB_TUT_Helm_GameOver_NPCSToDie(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsOnStage(_Var1, 1, _Var1, _Var1, _Var1)
AND NOT
DB_Dead(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_TUT_Helm_GameOver_NPCSToIncinerate(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
Random(1500, _Var2, _Var1, _Var1, _Var1)
THEN
RealtimeObjectTimerLaunch(_Var1, "TUT_Helm_DieFromBludgeoning", _Var2);

IF
ObjectTimerFinished((GUIDSTRING)_Var1, "TUT_Helm_DieFromFire", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
Die(_Var1, 0, NULL_00000000-0000-0000-0000-000000000000, 0, 0);

IF
ObjectTimerFinished((GUIDSTRING)_Var1, "TUT_Helm_DieFromBludgeoning", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
Die(_Var1, 0, NULL_00000000-0000-0000-0000-000000000000, 0, 0);

PROC
PROC_TUT_Helm_GameOver()
AND
DB_TUT_Helm_GameOverFire(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
CreateSurface(_Var1, "SurfaceFire", 50, -1);
CreateExplosion(_Var1, "Projectile_Fireball", 10);

PROC
PROC_TUT_Helm_GameOver()
AND
DB_TUT_Helm_GameOverExplosion(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
CreateExplosion(_Var1, "Projectile_Fireball", 10);

IF
DB_TUT_Guide(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TriggerRegisterForCharacter(S_TUT_Helm_LastReminder_e0132d4a-3abb-4298-a688-c44e260d6a01, _Var1);

IF
EnteredTrigger((CHARACTER)_Var1, S_TUT_Helm_LastReminder_e0132d4a-3abb-4298-a688-c44e260d6a01, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_TUT_Helm_DevilsDefeated(1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Helm_PlayLastReminder(_Var1);

PROC
PROC_TUT_Helm_PlayLastReminder((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_TUT_Guide(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_TUT_Guide(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Defeated(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsInDialogRange(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_TUT_GuideDialogues("LastReminder", _Var2, _Var3, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_LastReminder", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(_Var3, _Var2);

PROC
PROC_TUT_Helm_PlayLastReminder((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_Avatars(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_TUT_Guide(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679
AND NOT
DB_Defeated(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsInDialogRange(_Var1, S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_LastReminder", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(TUT_Helm_AD_ShadowheartRemindsNerves_6996e9b1-057d-973a-8268-7bdf58fd26dd, S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679);

PROC
PROC_TUT_Helm_PlayLastReminder((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_LastReminder", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(TUT_Helm_PAD_NervesReminder_db278dc4-a593-fe74-7f74-b342713617d3, _Var1);

IF
DB_TUT_Helm_Devils(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e
THEN
DB_GLO_DefeatCounter(_Var1, "TUT_Helm_DevilsDefeated");

IF
WentOnStage((GUIDSTRING)_Var1, 1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_TUT_Helm_Devils_BackUp(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_GLO_DefeatCounter(_Var1, "TUT_Helm_DevilsDefeated");

PROC
PROC_GLO_DefeatCounter_AllDefeated("TUT_Helm_DevilsDefeated", _, _, _, _)
THEN
DB_TUT_Helm_DevilsDefeated(1);

IF
DB_Defeated(S_TUT_Helm_Devil_005_ed103005-fd71-457d-ae6c-39654bbd8f2e, _, _, _, _)
AND
DB_TUT_Helm_DevilsDefeated(1, _, _, _, _)
AND NOT
DB_Defeated(S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846, _, _, _, _)
THEN
PROC_SetRelationToPlayers(ACT0a_TUT_HelmMindflayer_8edc7770-b83c-412e-8a5a-5427a63e5b8a, 0);
PROC_TryStartAD(TUT_Helm_AD_MindFlayerKillsPlayers_a0ceb097-7ad2-db0e-b660-82a57b87f25e, S_TUT_Helm_MindFlayer_22a400ec-5f01-4659-82e1-aed0b203c846);

IF
AutomatedDialogEnded(TUT_Helm_AD_MindFlayerKillsPlayers_a0ceb097-7ad2-db0e-b660-82a57b87f25e, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
DB_TUT_Helm_CombatPlayerADQueued(TUT_Helm_VB_BetrayalReaction_575fd015-690e-63e2-c3b7-7c4b225352de);

PROC
PROC_LevelUnloading("TUT_Avernus_C", _, _, _, _)
AND
IsOnStage(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 0, _, _, _)
THEN
SetOnStage(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 1);

PROC
PROC_LevelUnloading("TUT_Avernus_C", _, _, _, _)
AND NOT
DB_OnlyOnce("TUT_Helm_InitiatedTutorialEnd", _, _, _, _)
THEN
PROC_TUT_Helm_EndTutorial();

IF
DialogStarted(TUT_Helm_Transponder_d1cac06a-9fa7-237d-1f25-5e9de38ecd2c, _, _, _, _)
AND
DB_TUT_Helm_Devils(_Var2, _, _, _, _)
THEN
SetOnStage(_Var2, 0);

IF
DialogStarted(TUT_Helm_Transponder_d1cac06a-9fa7-237d-1f25-5e9de38ecd2c, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
SetFlag(TUT_Helm_State_TutorialEnded_55073953-23b9-448c-bee8-4c44d3d67b6b);

IF
FlagSet(TUT_Helm_State_TutorialEnded_55073953-23b9-448c-bee8-4c44d3d67b6b, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
AutoSave();

IF
DialogStarted(TUT_Helm_Transponder_d1cac06a-9fa7-237d-1f25-5e9de38ecd2c, _, _, _, _)
AND
DB_TUT_Helm_Devils_BackUp(_Var2, _, _, _, _)
THEN
SetOnStage(_Var2, 0);

IF
DialogStarted(TUT_Helm_Transponder_d1cac06a-9fa7-237d-1f25-5e9de38ecd2c, _, _, _, _)
AND
DB_TUT_Helm_Devils_BackUpCambions(_Var2, _, _, _, _)
THEN
SetOnStage(_Var2, 0);

IF
DialogStarted(TUT_Helm_Transponder_d1cac06a-9fa7-237d-1f25-5e9de38ecd2c, _, _, _, _)
AND
DB_TUT_Misc_Tentacles(_Var2, _, _, _, _)
THEN
SetForceUpdate(_Var2, 0);
SetOnStage(_Var2, 0);

IF
FlagSet(TUT_Helm_Event_EnterEtherealPlane_b106d52e-8507-469b-8980-9762f9ba2817, _, _, _, _)
AND
DB_TUT_Helm_ScrollingObjects(_Var3, _, _, _, _)
THEN
UnloadLevelTemplate(_Var3);

PROC
PROC_TUT_Helm_EndTutorial()
AND NOT
QRY_GameOver_AliveCharactersLeft()
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("TUT_Helm_RevivedPlayer", _Var1, _Var1, _Var1, _Var1)
THEN
Resurrect(_Var1);

PROC
PROC_TUT_Helm_EndTutorial()
AND
DB_TUT_Helm_TransponderUser(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_TUT_Helm_TransponderUser(_Var1);

PROC
PROC_TUT_Helm_InitiateEndTutorial()
AND
QRY_OnlyOnce("TUT_Helm_InitiatedTutorialEnd", _, _, _, _)
THEN
PROC_TUT_Helm_EndTutorial();

PROC
PROC_TUT_Helm_EndTutorial()
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _, _, _, _)
THEN
PROC_GLO_NarrativeCombat_EndCombat("TUT_Helm_FinalCombat");

PROC
PROC_TUT_Helm_EndTutorial()
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
ClearFlag(TG_TUT_InNautiloid_416a5f73-8fcb-45d7-976d-dca41009c2ba, _Var1);
RestoreParty(_Var1);

PROC
PROC_TUT_Helm_EndTutorial()
AND
DB_TUT_Lab_DevourerIsFollowing(1, _, _, _, _)
THEN
NOT DB_TUT_Lab_DevourerIsFollowing(1);
PROC_TUT_Misc_TutorialCompanion_RemoveCompanion(S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558, "permanently", "endtutorial");

PROC
PROC_TUT_Helm_EndTutorial()
AND
GetFaction(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, Origin_ShadowHeart_Hostile_68d5b0df-a555-4486-9bf3-391e8f5227d0, _, _, _)
THEN
SetFaction(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, Origin_ShadowHeart_901cd370-86ff-b538-e1e8-574c84135ca0);
SetFlag(ORI_Shadowheart_State_WasHostileInTutorial_1fe1e3ef-3ad0-4e7c-b94e-4cfe5d4cb07c);

PROC
PROC_TUT_Helm_EndTutorial()
AND
GetFaction(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, Origin_Laezel_Hostile_5d2675e2-6d65-4292-bd4b-269fa83d9e07, _, _, _)
THEN
SetFlag(ORI_Laezel_State_WasHostileInTutorial_7cd5c2d5-9a77-4bf5-9dfd-bd967ceb008e);
SetFaction(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, Origin_Laezel_bee8449b-d682-93c8-e7da-9e4bad369476);

PROC
PROC_TUT_Helm_EndTutorial()
AND
DB_TUT_Guide(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TUT_Misc_TutorialCompanion_RemoveCompanion(_Var1, "permanently", "endtutorial");

PROC
PROC_TUT_Helm_EndTutorial()
AND NOT
DB_Avatars(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, _, _, _, _)
THEN
PROC_TUT_Misc_TutorialCompanion_RemoveCompanion(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, "permanently", "endtutorial");

PROC
PROC_TUT_Helm_EndTutorial()
AND
DB_TUT_Guide(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND NOT
DB_Dead(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
THEN
SetFlag(TUT_Guide_LaezelWasGuide_a10b31fe-0e33-41db-876e-40e2676b04af, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_TUT_Helm_EndTutorial()
AND
DB_TUT_Guide(S_TUT_GithGuide_201a0ee6-6411-4564-aaea-1ca057bfea04, _, _, _, _)
THEN
MakeNPC(S_TUT_GithGuide_201a0ee6-6411-4564-aaea-1ca057bfea04);

PROC
PROC_TUT_Helm_EndTutorial()
AND
DB_TUT_Helm_TempUsStatus(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
HasActiveStatus(S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558, _Var1, 1, _Var1, _Var1)
THEN
RemoveStatus(S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558, _Var1);

PROC
PROC_TUT_Helm_EndTutorial()
AND
IsPartyFollower(S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558, 1, _, _, _)
AND
CharacterGetOwner(S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558, _Var1, _Var1, _Var1, _Var1)
THEN
RemovePartyFollower(S_TUT_Lab_TrappedDevourer_6ca92237-eb1e-4ed8-a1ee-18b3bef21558, _Var1);

PROC
PROC_TUT_Helm_EndTutorial()
AND NOT
DB_OnlyOnce("TUT_TransformChamber_FreedShadowheart", _, _, _, _)
THEN
PROC_TUT_TransformChamber_RemoveChairHack();

PROC
PROC_TUT_Helm_EndTutorial()
AND NOT
DB_Players(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, _, _, _, _)
AND
IsOnStage(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, 0, _, _, _)
THEN
SetOnStage(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, 1);

PROC
PROC_TUT_Helm_EndTutorial()
AND NOT
DB_Players(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, _, _, _, _)
THEN
DB_OriginRecruitmentDialog(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, ShadowHeart_Recruitment_f553d51e-18ed-659b-e418-56fdca0d0a0a);
PROC_TUT_Misc_TutorialCompanion_RemoveCompanion(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, "permanently", "endtutorial");

PROC
PROC_TUT_Helm_EndTutorial()
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetReservedUserID(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
CompleteTutorialForUser(_Var2);

PROC
PROC_TUT_Helm_EndTutorial()
AND
DB_TUT_Start_InitialPartySizeAfterTUT(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetMaxPartySizeOverride(_Var1);
NOT DB_TUT_Start_InitialPartySizeAfterTUT(_Var1);

PROC
PROC_LevelLoadedOnce("WLD_Main_A", _, _, _, _)
AND NOT
DB_Players(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, _, _, _, _)
AND
IsTagged(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, IGNORE_DANGEROUS_SURFACES_bbf62461-4af4-4631-807a-eb0bd988d9a6, 1, _, _)
THEN
PROC_TUT_TransformChamber_RemoveChairHack();

PROC
PROC_LevelLoadedOnce("WLD_Main_A", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Dead(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(GLO_TUT_State_WasDeadAtTheEndOfTUT_9118ad6e-b6ea-440e-b788-40bf485fec06, _Var1);

PROC
PROC_LevelLoadedOnce("WLD_Main_A", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_TUT_Guide(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Dead(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(GLO_TUT_State_WasDeadAtTheEndOfTUT_9118ad6e-b6ea-440e-b788-40bf485fec06, _Var1);
TeleportTo(_Var1, S_TUT_GuideDeath_11989862-14e9-44e1-877f-f99c05d574f8, "", 0, 0, 0);

PROC
PROC_LevelLoadedOnce("WLD_Main_A", _, _, _, _)
THEN
PROC_TUT_Helm_EndTutorialCleanUp();

PROC
PROC_TUT_Helm_EndTutorialCleanUp()
THEN
GoalCompleted;

IF
TextEvent("PauseNarrativeCombat", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _, _Var1, _Var1, _Var1)
THEN
PROC_GLO_NarrativeCombat_LeaveCombat("TUT_Helm_FinalCombat", _Var1);

IF
TextEvent("PauseNarrativeCombat", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GLO_NarrativeCombat_ID("TUT_Helm_FinalCombat", _Var1, _Var1, _Var1, _Var1)
THEN
PauseCombat(_Var1);

IF
TextEvent("TUT_Helm_StartFires", (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1)
AND
DB_TUT_Helm_BacktrackingFireTriggers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
Random(1500, _Var2, _Var1, _Var1, _Var1)
THEN
ObjectTimerLaunch(_Var1, "TUT_Helm_MakeFireWarning", _Var2);

IF
ObjectTimerFinished((TRIGGER)_Var1, "TUT_Helm_MakeFireWarning", (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1)
AND NOT
QRY_AnyCharacterInTrigger(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
CreateExplosion(_Var1, "Projectile_Fireball", -1);
CreateSurface(_Var1, "SurfaceFire", 3.5, -1);

IF
TextEvent("TUT_Helm_TestExplosion", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
CreateExplosion(_Var1, "Projectile_Fireball", -1);

IF
TextEvent("TUT_Helm_StartFires", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_CameraShakeAroundObject(_Var1, 2000, 30);


EXITSECTION
PROC_CheckPartyFull();
ENDEXITSECTION

ParentTargetEdge "Tutorial"
