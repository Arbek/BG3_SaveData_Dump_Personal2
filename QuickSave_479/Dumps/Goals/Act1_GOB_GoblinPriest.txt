Version 1
SubGoalCombiner SGC_AND

INITSECTION
DB_Dialogs(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, DIALOGRESOURCEGUID_GOB_GoblinPriest_ca566e7f-421a-61cb-04e0-04e30855d376);
DB_Dialogs(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, GOB_GoblinPriestOgre_4fe7a074-3c8a-884f-eec3-2a6ab7d02c19);
DB_GLO_CharacterCorpseDialog(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, GOB_GoblinPriest_Dead_0828b81f-6790-d49a-c496-c7833f68641d);
DB_HasItemEvent(S_GOB_GoblinPriest_SleepPotion_ac533c0a-c664-40bb-9cd9-ed4b07a6deb6, GOB_GoblinPriest_HasSleepPotion_fdf20a6f-06a9-4d80-82cd-d375ba1b3633);
DB_HasItemEvent(S_GOB_PriestDungeon_ChainsKey_62dda6b7-2992-488b-8ae7-07b82750e0cf, GOB_GoblinPriest_HasChainsKey_541cbd9f-c261-4887-9e02-fe7723d0751d);
DB_OneShot_VoiceBarkTrigger(S_GOB_GoblinPriest_BrandingVB_fb74eb0b-49b1-4fb1-aed6-d747e658b7f8, GOB_GoblinPriest_VB_Branding_e67f6ade-f475-46bd-ae8a-b0d14a285948);
DB_GOB_GoblinPriest_Minions(S_GOB_GoblinLush_d738c9a4-a031-4dd9-912f-93cda8d8d8b7);
DB_GOB_GoblinPriest_Minions(S_GOB_GoblinJolly_59557329-d49b-448b-bdd0-fd66ae0d67f6);
DB_GOB_GoblinPriest_Minions(S_GOB_GoblinGlib_f63f921c-ae35-4574-9a70-30aee55fdb26);
DB_GOB_GoblinPriest_Minions(S_GOB_GoblinBrash_35ffa172-7f23-4452-8f90-5dc24fd3bb6d);
DB_GOB_GoblinPriest_Minions(S_GOB_GoblinWily_d8667091-dd64-499c-8bee-000cf42175fc);
DB_GOB_GoblinPriest_Minions(S_GOB_GoblinSulky_dd21e1d9-c426-4b12-b5a0-ef3445e9e967);
PROC_TriggerRegisterForPlayers(S_GOB_GoblinPriest_ChainedBox_000_d9f4a96e-5f45-462e-b2b5-8b7680135036);
DB_FlagReactionAfterDialog(GOB_GoblinPriest_Event_BreakChains_871ecada-cdde-beff-3be5-5875529bdaab, GOB_GoblinPriest_ChainedCharacter_eecd9977-8ba4-b993-0c0a-066123f79b24);
PROC_TriggerRegisterForPlayers(S_GOB_OgreSpotTrigger_229f5142-3180-4518-9f23-a61f81b1c177);
TriggerRegisterForCharacter(S_GOB_OgreSpotTrigger_229f5142-3180-4518-9f23-a61f81b1c177, S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511);
SetFlag(GOB_GoblinPriest_Event_Branding_bd95af19-d8cc-7311-06a8-4e7ed4aa633e, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);
SetEntityEvent(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, "GOB_GoblinPriest_Event_Branding", 1);
DB_TrespassTrigger(S_GOB_GoblinPriest_OgreTrespassTrigger_e8629a34-2111-4b7d-b50a-13044c445b4a, S_GOB_GoblinPriest_OutDungeonTrigger_58c346df-0c41-48df-9edb-cdba1b67dc4c);
DB_ItemOwnerShipTriggers("WLD_Main_A", S_GOB_GoblinPriest_DungeonOwnershipTrigger_1c35651c-024f-4ad0-bc06-e9b4b012bc76, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);
DB_ItemOwnerShipTriggers("WLD_Main_A", S_GOB_GoblinPriest_ChapelOwnershipTrigger_0fb0d990-5015-463f-9256-9b53b5102c87, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);
DB_ItemOwnerShipTriggersFallback(S_GOB_GoblinPriest_DungeonOwnershipTrigger_1c35651c-024f-4ad0-bc06-e9b4b012bc76, S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511);
DB_NoLowAttitudeDialog(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511);
DB_DialogBlockTradeButton(GOB_GoblinPriest_ChainedCharacter_eecd9977-8ba4-b993-0c0a-066123f79b24);
DB_DialogBlockAttackButton(GOB_GoblinPriest_ChainedCharacter_eecd9977-8ba4-b993-0c0a-066123f79b24);
DB_GOB_GoblinPriest_StatueInUse(S_GoblinPriestess_Statue_01_dc68d2e5-b526-424b-ad9a-316238a75f65, S_GoblinPriestess_StatueDamageBox_01_ba77a85b-d404-42c3-b1c0-269349e515bd, S_GoblinPriestess_InvisHelper_01_a26bc70c-8b80-4e0f-95be-de7962f51a54, "GOB_GoblinPriest_Statue_01");
DB_GOB_GoblinPriest_StatueInUse(S_GoblinPriestess_Statue_02_84e50877-e8b2-4a9c-89f1-c589fdb63643, S_GoblinPriestess_StatueDamageBox_02_7b9637dc-102e-426a-b2a0-deb5d66ac2ef, S_GoblinPriestess_InvisHelper_02_1a1dd4b9-b9c3-49e2-a480-4fb35b591f6e, "GOB_GoblinPriest_Statue_02");
DB_GOB_GoblinPriest_StatueInUse(S_GoblinPriestess_Statue_03_554a7eef-6b57-4b3f-a844-673b300a8f8a, S_GoblinPriestess_StatueDamageBox_03_22060e18-3820-43fb-b794-6fa5319e7c90, S_GoblinPriestess_InvisHelper_03_c9852772-1f95-4489-9ea6-20ea531b3099, "GOB_GoblinPriest_Statue_03");
DB_GOB_GoblinPriest_StatueInUse(S_GoblinPriestess_Statue_04_d00851b1-cc9f-4c72-bb26-477be47ac005, S_GoblinPriestess_StatueDamageBox_04_9aceb6ed-1b96-468e-9b5b-4ac48a7d7658, S_GoblinPriestess_InvisHelper_04_96afadca-bc9d-4dd8-99fb-52bf19bb3a45, "GOB_GoblinPriest_Statue_04");
DB_DefeatedEvent(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, GOB_GoblinPriest_State_Defeated_78f21b35-a10a-4db2-9230-025691645103);
SetTag(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, AI_USESPELL_A_33aa698c-aea0-43e2-bd16-582aa718fd3e);
SetOnStage(S_GOB_Chains_26ece288-8ff4-4c58-aa2b-2af55a0b7bef, 0);
DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_UpperLevel", ACT1_GOB_GoblinPriest_2d0b3c0e-279c-29c5-5e14-57de02a5dce9, PERMA_DEFEATED_867f3a1e-1e4b-48c2-869e-343415231727);
DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_UpperLevel", ACT1_GOB_GoblinPriest_Guards_6d266e80-f605-488d-a2e0-2c4e8ea19384, PERMA_DEFEATED_867f3a1e-1e4b-48c2-869e-343415231727);
DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_UpperLevel", ACT1_GOB_GoblinWily_e7a1f0f7-5f59-438f-91c8-96d6b620495c, PERMA_DEFEATED_867f3a1e-1e4b-48c2-869e-343415231727);
DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_UpperLevel", ACT1_GOB_AbsoluteCultists_58a5996f-0631-9f9d-9ac2-94fe62edcf5f, PERMA_DEFEATED_867f3a1e-1e4b-48c2-869e-343415231727);
DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_UpperLevel", ACT1_GOB_Torturers_8a9e7e9a-1e72-eed1-8175-6c8d50ef7372, PERMA_DEFEATED_867f3a1e-1e4b-48c2-869e-343415231727);
DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_UpperLevel", ACT1_GOB_Bravado_83d9ecec-772f-487a-85f9-79aaee46befb, PERMA_DEFEATED_867f3a1e-1e4b-48c2-869e-343415231727);
DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_UpperLevel", ACT1_FOR_PainPriest_59c586cd-eca6-26bf-7f5a-b6fca6f3e016, PERMA_DEFEATED_867f3a1e-1e4b-48c2-869e-343415231727);
DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_UpperLevel", ACT1_GOB_Guards_f75246c5-0984-ec12-ee44-954231e0a219, PERMA_DEFEATED_867f3a1e-1e4b-48c2-869e-343415231727);
DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_UpperLevel", ACT1_GOB_Leaders_a25829dd-772a-6b00-572f-e036f89471aa, PERMA_DEFEATED_867f3a1e-1e4b-48c2-869e-343415231727);
DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_UpperLevel", ACT1_FOR_PainPriest_59c586cd-eca6-26bf-7f5a-b6fca6f3e016, PERMA_DEFEATED_867f3a1e-1e4b-48c2-869e-343415231727);
DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_GoblinPriestLowerLevel", ACT1_GOB_GoblinPriest_Ogre_fa18e2bb-e9ea-4053-9cf1-2d9acb5bf545, PERMA_DEFEATED_867f3a1e-1e4b-48c2-869e-343415231727);

KBSECTION
IF
TextEvent("gobgut", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsControlled(_Var1, 1, _Var1, _Var1, _Var1)
THEN
ClearFlag(GOB_GoblinPriest_Event_Branding_bd95af19-d8cc-7311-06a8-4e7ed4aa633e, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);
PROC_GOB_GoblinPriest_FadeOut(_Var1);

IF
AttackedBy(S_GOB_GoblinPriest_FallingCage_ad3c12d3-ba91-495f-afbb-c2f91ef27029, _, _, _, _, _, _, (GUIDSTRING)_, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
SetGravity(S_GOB_GoblinPriest_FallingCage_ad3c12d3-ba91-495f-afbb-c2f91ef27029, 0);

IF
PlatformDestroyed(S_PLT_GOB_GoblinPriest_Floor_c0480f7e-acae-46e3-a561-fabdd6501b22, _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(GOB_GoblinPriest_State_DungeonFloorDestroyed_cccb6c09-25b8-4e18-9ff2-51da5487afa2);

IF
Fell(S_GOB_GoblinPriest_FallingCage_ad3c12d3-ba91-495f-afbb-c2f91ef27029, _, (GUIDSTRING)_, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
DestroyPlatform(S_PLT_GOB_GoblinPriest_Floor_c0480f7e-acae-46e3-a561-fabdd6501b22);

IF
DialogEnded(GOB_GoblinPriest_ca566e7f-421a-61cb-04e0-04e30855d376, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND NOT
DB_GOB_GoblinPriest_MovedAwayFromBranding(1, _Var1, _Var1, _Var1, _Var1)
AND
GetFlag(GOB_GoblinPriest_Event_StopBranding_3be36a99-a6bb-7ca3-f678-ffa9559d3406, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, 1, _Var1, _Var1)
AND
DialogGetInvolvedPlayer(_Var1, 1, _Var2, _Var1, _Var1)
THEN
PROC_TriggerRegisterForPlayers(GOB_GoblinPriest_ChapelTrigger_3dc95e64-7fb7-4944-b056-57f8199de53d);
ClearFlag(GOB_GoblinPriest_Event_Branding_bd95af19-d8cc-7311-06a8-4e7ed4aa633e, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);
Unlock(S_GOB_GoblinPriest_ChapelDoor_965b910b-f20f-4ea7-8756-4b2ff6b9a702);
DB_GOB_GoblinPriest_StoppedBrandingPlayer(_Var2);
ClearOwnership(S_GOB_GoblinPriest_ChapelDoor_965b910b-f20f-4ea7-8756-4b2ff6b9a702);

IF
DB_GOB_GoblinPriest_StoppedBrandingPlayer(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_DialogNPCs(_, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _, _Var1, _Var1)
AND NOT
DB_GOB_GoblinPriest_MovedAwayFromBranding(1, _Var1, _Var1, _Var1, _Var1)
AND
GetFlag(GOB_GoblinPriest_Event_StopBranding_3be36a99-a6bb-7ca3-f678-ffa9559d3406, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, 1, _Var1, _Var1)
THEN
PROC_RemoveDialog(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);
PROC_CharacterMoveTo(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, GOB_GoblinPriest_ChapelPoint_b605c292-aa63-423f-9e83-9e8bd29a3ca8, "Walk", "GOB_GoblinPriest_Event_MovedToChapel");
LookFromTrigger(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, S_GOB_GoblinPriest_ChapelPoint_b605c292-aa63-423f-9e83-9e8bd29a3ca8, 0);
PROC_GOB_PlayMovingAwayAD();

IF
EntityEvent(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, "GOB_GoblinPriest_Event_MovedToChapel", _, _, _)
THEN
DB_GOB_GoblinPriest_MovedAwayFromBranding(1);
DB_Dialogs(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, GOB_GoblinPriest_Chapel_a5ab8ece-6d80-b110-4d8f-886420d0914d);
ClearFlag(GOB_GoblinPriest_Event_StartMovingToChapel_919035a6-fb21-1145-77d5-e2c6dfae9651, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);
SetFlag(GOB_GoblinPriest_Event_MovedToChapel_8ff66c21-e6cf-56fc-f9a4-ce15057697fa, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);
ClearTag(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, AI_USESPELL_A_33aa698c-aea0-43e2-bd16-582aa718fd3e);
SetTag(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, AI_USESPELL_C_64d4bb52-dd35-4d61-a112-0bc9a5789597);
PROC_TriggerRegisterForPlayers(TRIGGERGUID_S_GOB_GoblinPriest_CallNearChapelTrigger_c9214324-a2e3-47e2-b847-0d48e2d15dba);

PROC
PROC_GOB_PlayMovingAwayAD()
AND
GetFlag(GOB_GoblinPriest_Branded_1824ac41-a036-cbef-803a-27933fb39876, S_GOB_GoblinBrash_35ffa172-7f23-4452-8f90-5dc24fd3bb6d, 0, _, _)
THEN
PROC_TryStartAD(DIALOGRESOURCEGUID_GOB_GoblinPriest_AD_LeavingBranding_b5f25e01-d800-5ec2-67e8-186cccdb7c01, S_GOB_GoblinSulky_dd21e1d9-c426-4b12-b5a0-ef3445e9e967, S_GOB_GoblinBrash_35ffa172-7f23-4452-8f90-5dc24fd3bb6d);

IF
EnteredTrigger((GUIDSTRING)_Var1, TRIGGERGUID_S_GOB_GoblinPriest_CallNearChapelTrigger_c9214324-a2e3-47e2-b847-0d48e2d15dba, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GOB_GoblinPriest_StoppedBrandingPlayer(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
CanSee(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _Var1, 1, _Var1, _Var1)
THEN
NOT DB_GOB_GoblinPriest_StoppedBrandingPlayer(_Var1);
PlayAnimation(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, CUST_Waving_01_8d682545-f220-4db9-b170-71b1c22c6f2f);
PROC_TryStartAD(DIALOGRESOURCEGUID_GOB_GoblinPriest_AD_Call_47a4b020-945b-2cba-58b7-963a4b38102a, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);

IF
DialogStarted(GOB_GoblinPriest_Chapel_a5ab8ece-6d80-b110-4d8f-886420d0914d, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_TriggerUnregisterForPlayers(TRIGGERGUID_S_GOB_GoblinPriest_CallNearChapelTrigger_c9214324-a2e3-47e2-b847-0d48e2d15dba);

IF
Closed(S_GOB_GoblinPriest_ChapelDoor_965b910b-f20f-4ea7-8756-4b2ff6b9a702, _, _, _, _)
THEN
SetFlag(GOB_GoblinPriest_Event_DoorClosed_ea6bbcaf-b120-73ba-41f5-ce5771b5e1ad, S_Act1_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);

IF
Opened(S_GOB_GoblinPriest_ChapelDoor_965b910b-f20f-4ea7-8756-4b2ff6b9a702, _, _, _, _)
THEN
ClearFlag(GOB_GoblinPriest_Event_DoorClosed_ea6bbcaf-b120-73ba-41f5-ce5771b5e1ad, S_Act1_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);

IF
FlagSet(GOB_GoblinPriest_Event_TryCloseDoor_29b74271-0e8d-608c-f61f-c1a522564935, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _, _, _)
AND
DB_Defeated(S_GOB_GoblinPriest_ChapelDoor_965b910b-f20f-4ea7-8756-4b2ff6b9a702, _, _, _, _)
THEN
SetFlag(GOB_GoblinPriest_Event_CloseDoorFailed_3883b36e-2cf5-3cea-825e-8995177dc4d0, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);

IF
FlagSet(GOB_GoblinPriest_Event_TryCloseDoor_29b74271-0e8d-608c-f61f-c1a522564935, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _, _, _)
AND NOT
DB_Defeated(S_GOB_GoblinPriest_ChapelDoor_965b910b-f20f-4ea7-8756-4b2ff6b9a702, _, _, _, _)
THEN
PROC_ItemCloseAndLock(S_GOB_GoblinPriest_ChapelDoor_965b910b-f20f-4ea7-8756-4b2ff6b9a702, "GOB_GoblinPriest_ChapelDoorKey");

IF
UseStarted((GUIDSTRING)_Var1, S_GOB_GoblinPriest_TempleDoor_30b9f282-d34f-4db5-85f2-f10252d00c9c, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
Unlock(S_GOB_GoblinPriest_SecludedRoomDoor_685bbe73-b643-4096-aa70-a06875598218);

IF
FlagSet(GOB_GoblinPriest_Event_CountPlayers_8773e88d-a53e-e51a-43d1-5fd334c9ceb0, (GUIDSTRING)_Var1, (INTEGER)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
ClearFlag(GOB_GoblinPriest_Event_CountPlayers_8773e88d-a53e-e51a-43d1-5fd334c9ceb0, _Var1, _Var2);
ClearFlag(GOB_GoblinPriest_State_PlayersAroundChapel_6fdb000d-b0c9-4295-b6df-a1b6171dab8d, _Var1, _Var2);

IF
FlagSet(GOB_GoblinPriest_Event_CountPlayers_8773e88d-a53e-e51a-43d1-5fd334c9ceb0, (GUIDSTRING)_Var1, (INTEGER)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
_Var3 != _Var1
AND
DB_InRegion(_Var3, GOB_GoblinPriest_ChapelTrigger_3dc95e64-7fb7-4944-b056-57f8199de53d, _Var1, _Var1, _Var1)
AND NOT
DB_HiddenCharacters(_Var3, _, _Var1, _Var1, _Var1)
THEN
SetFlag(GOB_GoblinPriest_State_PlayersAroundChapel_6fdb000d-b0c9-4295-b6df-a1b6171dab8d, _Var1);

IF
DialogEnded(GOB_GoblinPriest_Chapel_a5ab8ece-6d80-b110-4d8f-886420d0914d, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
GetFlag(GOB_GoblinPriest_Event_CastSleep_0202a489-2e8a-d3a6-164c-693b654cf59b, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, 1, _Var1, _Var1)
AND
DialogGetInvolvedPlayer(_Var1, 1, _Var2, _Var1, _Var1)
THEN
ClearFlag(GOB_GoblinPriest_Event_CastSleep_0202a489-2e8a-d3a6-164c-693b654cf59b, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);
PROC_GOB_GoblinPriest_FadeOut(_Var2);

IF
DialogEnded(GOB_GoblinPriest_Chapel_a5ab8ece-6d80-b110-4d8f-886420d0914d, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_DialogPlayers(_Var1, _Var2, _, _Var1, _Var1)
AND
GetFlag(GOB_GoblinPriest_Event_DrinkPotion_0d4b8077-d748-dcd8-12fc-0135c7f1a054, _Var2, 1, _Var1, _Var1)
THEN
SetOnStage(S_GOB_GoblinPriest_SleepPotion_ac533c0a-c664-40bb-9cd9-ed4b07a6deb6, 0);
PROC_GOB_GoblinPriest_FadeOut(_Var2);

PROC
PROC_GOB_GoblinPriest_FadeOut((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
DB_GOB_GoblinPriest_Chains_ChainedCharacter(_Var1);
ScreenFadeTo(_Var1, 0.5, 0, "GOB_GoblinPriest_Event_SleepingFadeOutBlackId");

IF
ScreenFadeDone(_, "GOB_GoblinPriest_Event_SleepingFadeOutBlackId", _, _, _)
AND
DB_GOB_GoblinPriest_Chains_ChainedCharacter(_Var2, _, _, _, _)
THEN
TeleportTo(_Var2, S_GOB_GoblinPriest_ChainedBox_000_d9f4a96e-5f45-462e-b2b5-8b7680135036, "GOB_GoblinPriest_Event_CharacterTeleported", 0, 0, 0, 1, 1);
PROC_GOB_GoblinPriest_TeleportPriest();

PROC
PROC_GOB_GoblinPriest_TeleportPriest()
THEN
ClearFlag(GOB_GoblinPriest_Event_StartMovingToChapel_919035a6-fb21-1145-77d5-e2c6dfae9651, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);
ClearFlag(GOB_GoblinPriest_Event_MovedToChapel_8ff66c21-e6cf-56fc-f9a4-ce15057697fa, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);
TeleportTo(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, S_GOB_GoblinPriest_ChainRoom_Point_71c4764c-fed3-467f-87d0-9493a07847fc, "GOB_GoblinPriest_Event_MovedToSecludedPlace", 0);
ToInventory(S_GOB_PriestDungeon_ChainsKey_62dda6b7-2992-488b-8ae7-07b82750e0cf, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);
ClearTag(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, AI_USESPELL_C_64d4bb52-dd35-4d61-a112-0bc9a5789597);
SetTag(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, AI_USESPELL_B_3297ed55-ccc1-473e-8475-ac4162a63fdd);
DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_GoblinPriestLowerLevel", ACT1_GOB_GoblinPriest_2d0b3c0e-279c-29c5-5e14-57de02a5dce9, PERMA_DEFEATED_867f3a1e-1e4b-48c2-869e-343415231727);
NOT DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_UpperLevel", ACT1_GOB_GoblinPriest_2d0b3c0e-279c-29c5-5e14-57de02a5dce9, PERMA_DEFEATED_867f3a1e-1e4b-48c2-869e-343415231727);

IF
EntityEvent((CHARACTER)_Var1, "GOB_GoblinPriest_Event_CharacterTeleported", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
SetFlag(GOB_GoblinPriest_Quest_WasChained_f3d570f7-deb2-d18c-1043-c2a49e7d8783, _Var1);
SetFlag(GOB_GoblinPriest_Event_ChainedCharacter_df8b22d8-803e-97c3-871d-5494e1fb84e2, _Var1);
SetFlag(GOB_GoblinPriest_Quest_CureIsHoax_9296acbd-c107-4fe4-ae63-7d5f89cd7099, NULL_00000000-0000-0000-0000-000000000000);
PROC_GOB_GoblinPriest_ApplyChainedStatus(_Var1);
PROC_GOB_GoblinPriest_FadeIn(_Var1);

PROC
PROC_GOB_GoblinPriest_FadeIn((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
ClearScreenFade(_Var1, 2, "GOB_GoblinPriest_Event_SleepingFadeOutBlackId");

PROC
PROC_GOB_GoblinPriest_FadeIn((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_StartDialog(GOB_GoblinPriest_ChainedCharacter_eecd9977-8ba4-b993-0c0a-066123f79b24, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
FlagSet(GOB_GoblinPriest_Event_BreakChains_871ecada-cdde-beff-3be5-5875529bdaab, (GUIDSTRING)_Var1, (INTEGER)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_GOB_GoblinPriest_BreakChains(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
DB_GOB_GoblinPriest_BreakChains(_Var1, _Var2);

IF
InstanceDialogChanged(_, GOB_GoblinPriest_ChainedCharacter_eecd9977-8ba4-b993-0c0a-066123f79b24, GOB_GoblinPriest_Chains_fbe594c5-21e7-c9b1-3350-dd7f8242aea3, 0, (INTEGER)_)
THEN
PROC_GOB_PriestessLeavesCell();

IF
DialogEnded(GOB_GoblinPriest_ChainedCharacter_eecd9977-8ba4-b993-0c0a-066123f79b24, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND NOT
DB_GOB_GoblinPriest_BreakChains(_, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GOB_PriestessLeavesCell();

PROC
PROC_GOB_PriestessLeavesCell()
AND
QRY_OnlyOnce("GOB_PriestessLeavesCell_OnlyOnce", _, _, _, _)
THEN
Proc_RemoveAllDialogEntriesForSpeaker(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);
DB_Dialogs(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, DIALOGRESOURCEGUID_GOB_GoblinPriest_Cellar_0b1cbf40-3e14-d0d7-42d7-2c9707144573);
PROC_CharacterMoveTo(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, TRIGGERGUID_GOB_GoblinPriest_PrayingPoint_fa423870-8805-4af9-ba58-670d1bcdc5dd, "Run", "GOB_GoblinPriest_Event_MovedToPrayingPoint");

IF
EntityEvent(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, "GOB_GoblinPriest_Event_MovedToPrayingPoint", _, _, _)
AND NOT
DB_GOB_WarlockProposal_WarlockEvent(_, _, _, _, _)
THEN
SetFlag(GOB_GoblinPriest_Quest_PlayersChainedAlone_93c5fc69-7c8e-4991-a44c-1b3dbf1880f9, NULL_00000000-0000-0000-0000-000000000000, 0);
LookFromTrigger(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, TRIGGERGUID_GOB_GoblinPriest_PrayingPoint_fa423870-8805-4af9-ba58-670d1bcdc5dd, 0);
DB_SpotPlayers(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, "GOB_GoblinPriest_SpotPlayerInDungeon", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers_TargetIgnoreCantTalk(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, "GOB_GoblinPriest_SpotPlayerInDungeon");
DB_SpotPlayers_IncludeWildshapedPlayers(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, "GOB_GoblinPriest_SpotPlayerInDungeon");
DB_SpotPlayers_IncludeFollowers(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, "GOB_GoblinPriest_SpotPlayerInDungeon");
DB_SpotPlayers_IncludeSummons(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, "GOB_GoblinPriest_SpotPlayerInDungeon");

PROC
PROC_SpotPlayers_Spotted(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, "GOB_GoblinPriest_SpotPlayerInDungeon", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_StartDialog(DIALOGRESOURCEGUID_GOB_GoblinPriest_Cellar_0b1cbf40-3e14-d0d7-42d7-2c9707144573, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
LeftCombat(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_SpotPlayers(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, "GOB_GoblinPriest_SpotPlayerInDungeon", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, _Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_Was_InCombat(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SpotPlayers_RestartSpotting(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, "GOB_GoblinPriest_SpotPlayerInDungeon");

PROC
PROC_FlagReactionAfterDialog((CHARACTER)_Var1, GOB_GoblinPriest_Event_BreakChains_871ecada-cdde-beff-3be5-5875529bdaab, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_GOB_GoblinPriest_FreeCharacter(_Var1);

IF
NestedDialogPlayed(GOB_GoblinPriest_Chains_fbe594c5-21e7-c9b1-3350-dd7f8242aea3, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DialogGetInvolvedPlayer(_Var1, 1, _Var2, _Var1, _Var1)
AND
GetFlag(GOB_GoblinPriest_Event_FreedFromChains_38ee56fc-1ee7-7ce7-a247-39913c3335ed, _Var2, 1, _Var1, _Var1)
AND
GetFlag(GOB_GoblinPriest_Event_ChainedCharacter_df8b22d8-803e-97c3-871d-5494e1fb84e2, _Var2, 1, _Var1, _Var1)
THEN
PROC_GOB_GoblinPriest_FreeCharacter(_Var2);

IF
NestedDialogPlayed(GOB_GoblinPriest_Chains_fbe594c5-21e7-c9b1-3350-dd7f8242aea3, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DialogGetInvolvedPlayer(_Var1, 1, _Var2, _Var1, _Var1)
AND
GetFlag(GOB_GoblinPriest_Event_FreedOtherFromChains_a760e678-6a62-9ba9-f822-4068eed9710b, _Var2, 1, _Var1, _Var1)
AND
DB_GOB_GoblinPriest_Chains_ChainedCharacter(_Var3, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GOB_GoblinPriest_FreeCharacter(_Var3);

IF
DB_GOB_GoblinPriest_Chains_ChainedCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_DangerZone(S_GOB_WarlockProposal_ChainRoom_DangerZone_b7a36d66-af5f-43a7-8f4d-6dc816a8bda4, "GOB_WarlockProposal_ChainRoom");

IF
DB_DangerZone(S_GOB_WarlockProposal_ChainRoom_DangerZone_b7a36d66-af5f-43a7-8f4d-6dc816a8bda4, "GOB_WarlockProposal_ChainRoom", _, _, _)
AND NOT
DB_GOB_GoblinPriest_Chains_ChainedCharacter(_, _, _, _, _)
AND
DB_Defeated(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _, _, _, _)
THEN
PROC_DangerZone_Safe("GOB_WarlockProposal_ChainRoom");

IF
DB_PermaDefeated(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _, _, _, _)
AND
DB_DangerZone(S_GOB_WarlockProposal_ChainRoom_DangerZone_b7a36d66-af5f-43a7-8f4d-6dc816a8bda4, "GOB_WarlockProposal_ChainRoom", _, _, _)
THEN
PROC_DangerZone_Safe("GOB_WarlockProposal_ChainRoom");

IF
LeftTrigger((CHARACTER)_Var1, S_GOB_WarlockProposal_ChainRoom_DangerZone_b7a36d66-af5f-43a7-8f4d-6dc816a8bda4, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_GOB_GoblinPriest_Chains_ChainedCharacter(_, _Var1, _Var1, _Var1, _Var1)
THEN
RealtimeObjectTimerLaunch(_Var1, "GOB_WarlockProposal_ChainRoom_RemoveDangerZone", 0);

IF
ObjectTimerFinished(_, "GOB_WarlockProposal_ChainRoom_RemoveDangerZone", (GUIDSTRING)_, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_DangerZone_Safe("GOB_WarlockProposal_ChainRoom");

PROC
PROC_GOB_GoblinPriest_ApplyChainedStatus((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_RemoveMutingStatusses(_Var1);
ApplyStatus(_Var1, "GOB_GOBLINPRIEST_CHAINS", -1, 1);
SetFlag(GOB_GoblinPriest_Event_ChainedCharacter_df8b22d8-803e-97c3-871d-5494e1fb84e2, _Var1);
Lock(S_GOB_GoblinPriest_Chain_000_0456483e-1158-4aa5-8876-3b9fd22f46e3, "GOB_PriestDungeon_ChainsLock");
SetOnStage(S_GOB_GoblinPriest_Chains_Spring_26ece288-8ff4-4c58-aa2b-2af55a0b7bef, 1);
AttachSpring(S_GOB_GoblinPriest_Chains_Spring_26ece288-8ff4-4c58-aa2b-2af55a0b7bef, "Dummy_Attach_01", _Var1, "Ankle_R");
AttachSpring(S_GOB_GoblinPriest_Chains_Spring_26ece288-8ff4-4c58-aa2b-2af55a0b7bef, "Dummy_Attach_02", S_GOB_GoblinPriest_Chain_000_0456483e-1158-4aa5-8876-3b9fd22f46e3, "Dummy_Pos_01");

PROC
PROC_GOB_GoblinPriest_FreeCharacter((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
NOT DB_GOB_GoblinPriest_Chains_ChainedCharacter(_Var1);
RemoveStatus(_Var1, "GOB_GOBLINPRIEST_CHAINS");
ClearFlag(GOB_GoblinPriest_Event_ChainedCharacter_df8b22d8-803e-97c3-871d-5494e1fb84e2, _Var1);
Unlock(S_GOB_GoblinPriest_Chain_000_0456483e-1158-4aa5-8876-3b9fd22f46e3);
DetachSpring(S_GOB_GoblinPriest_Chains_Spring_26ece288-8ff4-4c58-aa2b-2af55a0b7bef, "Dummy_Attach_01");
DetachSpring(S_GOB_GoblinPriest_Chains_Spring_26ece288-8ff4-4c58-aa2b-2af55a0b7bef, "Dummy_Attach_02");
SetOnStage(S_GOB_GoblinPriest_Chains_Spring_26ece288-8ff4-4c58-aa2b-2af55a0b7bef, 0);

IF
StatusRemoved((CHARACTER)_Var1, "GOB_GOBLINPRIEST_CHAINS", _, _, (CHARACTER)_Var1)
THEN
PROC_GOB_GoblinPriest_FreeCharacter(_Var1);

IF
Unlocked(S_GOB_GoblinPriest_Chain_000_0456483e-1158-4aa5-8876-3b9fd22f46e3, _, _, _, _)
AND
DB_GOB_GoblinPriest_Chains_ChainedCharacter(_Var3, _, _, _, _)
THEN
PROC_GOB_GoblinPriest_FreeCharacter(_Var3);

IF
DestroyedBy(S_GOB_GoblinPriest_Chain_000_0456483e-1158-4aa5-8876-3b9fd22f46e3, _, _, _, _)
AND
DB_GOB_GoblinPriest_Chains_ChainedCharacter(_Var4, _, _, _, _)
THEN
PROC_GOB_GoblinPriest_FreeCharacter(_Var4);

IF
LeftTrigger((CHARACTER)_Var1, S_GOB_GoblinPriest_ChainedBox_000_d9f4a96e-5f45-462e-b2b5-8b7680135036, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_GOB_GoblinPriest_Chains_ChainedCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GOB_GoblinPriest_FreeCharacter(_Var1);

IF
FlagSet(GOB_GoblinPriest_Event_DislocatedWrist_3c7849ac-1614-4a1b-9881-3cec92e87c35, (GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
ApplyDamage(_Var1, 3, "Piercing", _Var1);

PROC
PROC_LongRest()
AND NOT
DB_Defeated(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _, _, _, _)
AND
GetFlag(GOB_GoblinPriest_Event_AwaitCeremorphosis_cbf4c784-ca27-2ea8-6153-416bd3c48f97, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, 1, _, _)
AND
GetFlag(GOB_GoblinPriest_Quest_PlayerEscaped_97c3a596-e927-9cfb-b5a7-1c591e7382a2, NULL_00000000-0000-0000-0000-000000000000, 0, _, _)
THEN
SetFlag(GOB_GoblinPriest_Quest_PlayerEscaped_97c3a596-e927-9cfb-b5a7-1c591e7382a2, NULL_00000000-0000-0000-0000-000000000000, 0);

IF
FlagSet(GOB_GoblinPriest_Quest_PlayerEscaped_97c3a596-e927-9cfb-b5a7-1c591e7382a2, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
RemoveHarmfulStatuses(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);
PROC_CharacterMoveTo(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, TRIGGERGUID_S_GOB_GoblinPriest_HideScaredPoint_a72b2809-920a-4d4d-9e70-5c8477f47452, "Run", "GOB_GoblinPriest_MovedToScaredPoint");

IF
DB_Defeated(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _, _, _, _)
AND
IsTagged(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, AI_USESPELL_B_3297ed55-ccc1-473e-8475-ac4162a63fdd, 1, _, _)
THEN
SetTag(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, AI_USESPELL_B_3297ed55-ccc1-473e-8475-ac4162a63fdd);

PROC
PROC_GOB_GoblinPriest_TeleportPriest()
AND
GetCombatGroupID(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, _Var1, _Var1, _Var1, _Var1)
THEN
SetCombatGroupID(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _Var1);

IF
DB_GlobalFlag(GOB_GoblinPriest_Quest_PlayersChainedAlone_93c5fc69-7c8e-4991-a44c-1b3dbf1880f9, _, _, _, _)
THEN
PROC_RemoveDBTrespassTrigger(S_GOB_GoblinPriest_OgreTrespassTrigger_e8629a34-2111-4b7d-b50a-13044c445b4a, S_GOB_GoblinPriest_OutDungeonTrigger_58c346df-0c41-48df-9edb-cdba1b67dc4c);
DB_SpotPlayers(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, "GOB_GoblinPriestOgre_SpotEscapedCharacters", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers_TargetIgnoreCantTalk(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, "GOB_GoblinPriestOgre_SpotEscapedCharacters");
DB_SpotPlayers_IncludeWildshapedPlayers(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, "GOB_GoblinPriestOgre_SpotEscapedCharacters");
DB_SpotPlayers_IncludeFollowers(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, "GOB_GoblinPriestOgre_SpotEscapedCharacters");
DB_SpotPlayers_IncludeSummons(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, "GOB_GoblinPriestOgre_SpotEscapedCharacters");

PROC
PROC_SpotPlayers_Spotted(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, "GOB_GoblinPriestOgre_SpotEscapedCharacters", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_StartDialog(GOB_GoblinPriestOgre_4fe7a074-3c8a-884f-eec3-2a6ab7d02c19, S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
LeftCombat(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_SpotPlayers(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, "GOB_GoblinPriestOgre_SpotEscapedCharacters", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, _Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_Was_InCombat(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SpotPlayers_RestartSpotting(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, "GOB_GoblinPriestOgre_SpotEscapedCharacters");

IF
FlagSet(GOB_WarlockProposal_Event_PriestDeath_b9e8c596-55dc-4edc-8fbd-e52d601839d2, _, _, _, _)
AND NOT
QRY_GOB_WarlockProposal_FreePlayerPresent()
THEN
SetFlag(GOB_WarlockProposal_Event_OgreKilledByWarlock_cc5bc6ff-a73e-4358-b923-9bfc01abf982, NULL_00000000-0000-0000-0000-000000000000, 0);
Die(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, 0, S_GOB_Warlock_d432aafd-f728-4d9d-9707-732e1cdd8297, 0, 0);

QRY
QRY_GOB_WarlockProposal_FreePlayerPresent()
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GOB_GoblinPriest_Chains_ChainedCharacter(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
_Var2 != _Var1
AND
DB_InRegion(_Var1, S_GOB_PriestDungeon_SUB_d693268c-84c9-44c2-ac7d-11ebc5524764, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, S_GOB_OgreSpotTrigger_229f5142-3180-4518-9f23-a61f81b1c177, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
EnteredTrigger((CHARACTER)_Var1, S_GOB_OgreSpotTrigger_229f5142-3180-4518-9f23-a61f81b1c177, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(GOB_WarlockProposal_Event_OgreKilledByWarlock_cc5bc6ff-a73e-4358-b923-9bfc01abf982, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, S_GOB_OgreSpotTrigger_229f5142-3180-4518-9f23-a61f81b1c177, _Var1, _Var1, _Var1)
THEN
StartVoiceBark(GOB_WarlockProposal_VB_OgreBurned_5f62f90c-8697-d99a-b9fc-db480911cc86, _Var1);
PROC_TriggerUnregisterForPlayers(S_GOB_OgreSpotTrigger_229f5142-3180-4518-9f23-a61f81b1c177);

IF
CharacterLootedCharacter((CHARACTER)_Var1, S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetFlag(GOB_WarlockProposal_Event_PriestDeath_b9e8c596-55dc-4edc-8fbd-e52d601839d2, NULL_00000000-0000-0000-0000-000000000000, 1, _Var1, _Var1)
AND
DB_Dead(S_GOB_GoblinPriestOgre_658c5f80-33ea-4f8d-bded-8ef6ac2ed511, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("GOB_GoblinPriest_SaidPAD_DeadOgre", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(GOB_GoblinPriest_PAD_DeadOgre_f7cdcd7a-931e-0e07-2481-22515920743d, _Var1);

IF
DB_GOB_GoblinPriest_StatueInUse(_, _Var2, _, _, _)
THEN
TriggerRegisterForCharacter(_Var2, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);

IF
StatusApplied((ITEM)_Var1, "GOB_PRIESTESS_STATUE_DESTROY", _, _, (ITEM)_Var1)
AND
DB_GOB_GoblinPriest_StatueInUse(_Var1, _, _Var5, _Var6, _Var1)
THEN
Die(_Var1, 0, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, 0, 0);
RealtimeObjectTimerLaunch(_Var1, "GOB_GoblinPriest_FallingStatue_Timer", 1600);
DB_GOB_GoblinPriest_DestroyingStatues_Event(_Var1);

IF
DestroyedBy((ITEM)_Var1, _, _, _, (ITEM)_Var1)
AND
DB_GOB_GoblinPriest_StatueInUse(_Var1, _, _Var6, _, _Var1)
THEN
RealtimeObjectTimerLaunch(_Var1, "GOB_GoblinPriest_FallingStatue_Timer", 1800);
DB_GOB_GoblinPriest_DestroyingStatues_Event(_Var1);

IF
DB_GOB_GoblinPriest_DestroyingStatues_Event(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GOB_GoblinPriest_StatueInUse(_Var1, _Var2, _, _Var4, _Var1)
AND
DB_Players(_Var5, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var5, _Var6, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _Var6, _Var1, _Var1, _Var1)
THEN
SendArenaCameraEvent(_Var5, NULL_00000000-0000-0000-0000-000000000000, _Var4);
NOT DB_GOB_GoblinPriest_DestroyingStatues_Event(_Var1);

IF
ObjectTimerFinished((ITEM)_Var1, "GOB_GoblinPriest_FallingStatue_Timer", (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_GOB_GoblinPriest_StatueInUse(_Var1, _Var2, _Var3, _Var4, _Var1)
THEN
NOT DB_GOB_GoblinPriest_StatueInUse(_Var1, _Var2, _Var3, _Var4);
ClearTag(_Var1, ACT1_GOB_PRIESTESS_STATUE_UNSAFE_9ceba3bd-c44b-4b7b-a52c-ba6109c73b68);
AiRemoveInterestingItem(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _Var1);
CreateExplosion(_Var3, "Projectile_GOB_GoblinPriestess_StatueDebris", 3);
TriggerUnregisterForCharacter(_Var2, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);
PROC_TriggerUnregisterforPlayers(_Var2);

PROC
PROC_TriggerUnregisterForPlayers((TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1)
AND
DB_GOB_GoblinPriest_PlayersInDanger(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
NOT DB_GOB_GoblinPriest_PlayersInDanger(_Var1, _Var2);
ClearTag(_Var2, ACT1_GOB_PRIESTESS_PLAYER_DANGER_27a0ab52-9a5e-473f-aabd-573fa54d30eb);

IF
DB_GOB_GoblinPriest_StatueInUse(_, _Var2, _, _, _)
THEN
PROC_TriggerRegisterforPlayers(_Var2);

IF
EnteredTrigger((GUIDSTRING)_Var1, (GUIDSTRING)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GOB_GoblinPriest_StatueInUse(_Var3, _Var2, _, _, _Var1)
THEN
DB_GOB_GoblinPriest_PlayersInDanger(_Var2, _Var1);
SetTag(_Var3, ACT1_GOB_PRIESTESS_STATUE_f1fbea64-76c0-4ab0-9e3d-c5a748351b17);
SetTag(_Var1, ACT1_GOB_PRIESTESS_PLAYER_DANGER_27a0ab52-9a5e-473f-aabd-573fa54d30eb);
AiAddInterestingItem(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _Var3);

IF
LeftTrigger((GUIDSTRING)_Var1, (GUIDSTRING)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GOB_GoblinPriest_StatueInUse(_Var3, _Var2, _, _, _Var1)
AND NOT
QRY_TriggerEvents_AnyPlayerInTrigger(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
ClearTag(_Var3, ACT1_GOB_PRIESTESS_STATUE_f1fbea64-76c0-4ab0-9e3d-c5a748351b17);
AiRemoveInterestingItem(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _Var3);

IF
LeftTrigger((GUIDSTRING)_Var1, (GUIDSTRING)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GOB_GoblinPriest_PlayersInDanger(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_GOB_GoblinPriest_PlayersInDanger(_Var2, _Var1);
ClearTag(_Var1, ACT1_GOB_PRIESTESS_PLAYER_DANGER_27a0ab52-9a5e-473f-aabd-573fa54d30eb);

IF
EnteredTrigger(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GOB_GoblinPriest_StatueInUse(_Var2, _Var1, _, _, _Var1)
THEN
SetTag(_Var2, ACT1_GOB_PRIESTESS_STATUE_UNSAFE_9ceba3bd-c44b-4b7b-a52c-ba6109c73b68);

IF
LeftTrigger(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GOB_GoblinPriest_StatueInUse(_Var2, _Var1, _, _, _Var1)
THEN
ClearTag(_Var2, ACT1_GOB_PRIESTESS_STATUE_UNSAFE_9ceba3bd-c44b-4b7b-a52c-ba6109c73b68);

IF
FlagSet(GOB_DrowCommander_Event_RaidersSortie_26816b01-2d64-b50c-3bf6-bffd7dc5f0b9, NULL_00000000-0000-0000-0000-000000000000, _, _, _)
AND
DB_GOB_DrowCommander_RaidersInGoblinCamp(_Var2, _, _, _, _)
AND
DB_GOB_GoblinPriest_Minions(_Var2, _, _, _, _)
THEN
NOT DB_GOB_GoblinPriest_Minions(_Var2);

IF
UsingSpell(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, "Shout_GOB_GoblinPriest_CallForHelp", _, _, _)
THEN
PROC_TryStartAD(GOB_GoblinPriest_AD_CallingForHelp_405d703d-fd10-4a0d-e48b-b726f18f044a, S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9);

IF
CastedSpell(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, "Shout_GOB_GoblinPriest_CallForHelp", _, _, _)
AND
DB_GOB_GoblinPriest_Minions(_Var4, _, _, _, _)
THEN
PROC_CharacterMoveTo(_Var4, S_GOB_GoblinPriest_Minions_ToChapel_e48e6f7a-87aa-4777-9a12-7893112c4d4e, "Run", "GOB_GoblinMinion_ArrivedChapel");

IF
EntityEvent((CHARACTER)_Var1, "GOB_GoblinMinion_ArrivedChapel", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_GOB_GoblinPriest_Minions(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetCombatGroupID(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, _Var2, _Var1, _Var1, _Var1)
THEN
SetCombatGroupID(_Var1, _Var2);

IF
EntityEvent((CHARACTER)_Var1, "GOB_GoblinMinion_ArrivedChapel", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_GOB_GoblinPriest_Minions(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("GOB_GoblinPriest_MakeReinforcementsHostile", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SetRelationToPlayers(ACT1_GOB_GoblinPriest_Guards_6d266e80-f605-488d-a2e0-2c4e8ea19384, 0);

IF
EntityEvent((CHARACTER)_Var1, "GOB_GoblinMinion_ArrivedChapel", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_GOB_GoblinPriest_Minions(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetFaction(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_UpperLevel", _Var2, _Var3, _Var1)
THEN
DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_GoblinPriestLowerLevel", _Var2, _Var3);
NOT DB_CorpseLooting_ClearRedOutlineOnFactionGroupTagged("WLD_Main_A", "Act1_GOB_UpperLevel", _Var2, _Var3);

IF
CastedSpell(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, "Shout_GOB_GoblinPriest_CallForHelp", _, _, _)
AND
IsLocked(S_GOB_GoblinPriest_ChapelDoor_965b910b-f20f-4ea7-8756-4b2ff6b9a702, 1, _, _, _)
AND
IsDestroyed(S_GOB_GoblinPriest_ChapelDoor_965b910b-f20f-4ea7-8756-4b2ff6b9a702, 0, _, _, _)
AND
DB_GOB_GoblinPriest_Minions(_Var4, _, _, _, _)
THEN
AiAddInterestingItem(_Var4, S_GOB_GoblinPriest_ChapelDoor_965b910b-f20f-4ea7-8756-4b2ff6b9a702);
DB_GOB_GoblinPriest_Minion_AttackingDoor(_Var4);

IF
Unlocked(S_GOB_GoblinPriest_ChapelDoor_965b910b-f20f-4ea7-8756-4b2ff6b9a702, _, _, _, _)
AND
DB_GOB_GoblinPriest_Minion_AttackingDoor(_Var3, _, _, _, _)
THEN
AiRemoveInterestingItem(_Var3, S_GOB_GoblinPriest_ChapelDoor_965b910b-f20f-4ea7-8756-4b2ff6b9a702);
NOT DB_GOB_GoblinPriest_Minion_AttackingDoor(_Var3);

IF
DestroyedBy(S_GOB_GoblinPriest_ChapelDoor_965b910b-f20f-4ea7-8756-4b2ff6b9a702, _, _, _, _)
AND
DB_GOB_GoblinPriest_Minion_AttackingDoor(_Var4, _, _, _, _)
THEN
AiRemoveInterestingItem(_Var4, S_GOB_GoblinPriest_ChapelDoor_965b910b-f20f-4ea7-8756-4b2ff6b9a702);
NOT DB_GOB_GoblinPriest_Minion_AttackingDoor(_Var4);


EXITSECTION
ENDEXITSECTION

ParentTargetEdge "Act1"
