Version 1
SubGoalCombiner SGC_AND

INITSECTION
SetAmbushing(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, 1);
PROC_TriggerRegisterForParty(S_END_BrainBattleArea_b0cbe773-d02f-4074-8507-eab6033c3b27);
SetDoNotFaceFlag(S_GLO_Netherbrain_3858e896-d7dd-4699-b37d-d3919ff15ba7, 1);
DB_END_BrainBattle_DefaultThralls(S_END_SuperThrall_001_939b84fb-5ea5-43cf-b73c-c1315f60fe3f);
DB_END_BrainBattle_DefaultThralls(S_END_SuperThrall_002_8eeb8999-4c72-43a4-b7b3-7e6cdc824d36);
DB_END_BrainBattle_DefaultThralls(S_END_SuperThrall_003_0f9dd1ac-6545-4919-9f2f-5fe1958c3419);
DB_END_BrainBattle_DefaultThralls(S_END_SuperThrall_004_ba226fbd-7a38-4f9d-8403-8b593a698cd6);
DB_END_BrainBattle_PickedThrall(NULL_00000000-0000-0000-0000-000000000000);
NOT DB_END_BrainBattle_PickedThrall(NULL_00000000-0000-0000-0000-000000000000);
DB_END_BrainBattle_Thralls(BARBARIAN_02913f9a-f696-40cf-acdf-32032afab32c, QUEST_END_Thrall_Barbarian_0d14b483-983b-49d5-bc54-4cfab8897e37, "END_SUPERTHRALL_BARBARIAN", "EQP_END_Thrall_Barbarian");
DB_END_BrainBattle_Thralls(BARD_d93434bd-6b71-4789-b128-ee24156057cc, QUEST_END_Thrall_Bard_33d55bca-6c52-479c-b633-e2d10d3afa83, "END_SUPERTHRALL_BARD", "EQP_END_Thrall_Bard");
DB_END_BrainBattle_Thralls(CLERIC_1671b4bf-4f47-4bb7-9cb9-80bb1f6009d5, QUEST_END_Thrall_Cleric_98184393-7914-45ee-a89c-1c30f6ea1340, "END_SUPERTHRALL_CLERIC", "EQP_END_Thrall_Cleric");
DB_END_BrainBattle_Thralls(DRUID_44ac4317-4d38-4d28-80e2-94024c6e42f0, QUEST_END_Thrall_Druid_6c6b4487-cdca-45c8-b9b7-a90817a8249f, "END_SUPERTHRALL_DRUID", "EQP_END_Thrall_Druid");
DB_END_BrainBattle_Thralls(FIGHTER_1ae7017c-4884-4a43-bc4a-742fa0d201c0, QUEST_END_Thrall_Fighter_53a0d484-4647-44cb-9483-af52b72f991c, "END_SUPERTHRALL_FIGHTER", "EQP_END_Thrall_Fighter");
DB_END_BrainBattle_Thralls(MONK_e1e460bb-d0ae-4452-8529-c9e176558731, QUEST_END_Thrall_Monk_7ccc7bf1-c781-4c0c-ba9b-22948c593aea, "END_SUPERTHRALL_MONK", "EQP_END_Thrall_Monk");
DB_END_BrainBattle_Thralls(PALADIN_6d85ab2d-5c23-498c-a61e-98f05a00177a, QUEST_END_Thrall_Paladin_244b45f9-2fbd-4384-b822-71070da6f5f0, "END_SUPERTHRALL_PALADIN", "EQP_END_Thrall_Paladin");
DB_END_BrainBattle_Thralls(RANGER_37a733c1-a862-4157-b92a-9cff46232c6a, QUEST_END_Thrall_Ranger_e225fab6-36b8-4b35-b863-751b9d51ff34, "END_SUPERTHRALL_RANGER", "EQP_END_Thrall_Ranger");
DB_END_BrainBattle_Thralls(ROGUE_f8a0608b-666c-4be6-a49c-03b369c10bd2, QUEST_END_Thrall_Rogue_f710ea72-6c27-4a52-9919-4a00b2659c17, "END_SUPERTHRALL_ROGUE", "EQP_END_Thrall_Rogue");
DB_END_BrainBattle_Thralls(SORCERER_18266c0b-efbc-4c80-8784-ada4a37218d7, QUEST_END_Thrall_Sorcerer_a134466e-333b-4bf5-a65b-6a717fdaf044, "END_SUPERTHRALL_SORCERER", "EQP_END_Thrall_Sorcerer");
DB_END_BrainBattle_Thralls(WARLOCK_5804f55a-93f7-4281-9512-8d548a9e2a22, QUEST_END_Thrall_Warlock_6eab792d-c187-4a0d-86e7-39b0e2e41005, "END_SUPERTHRALL_WARLOCK", "EQP_END_Thrall_Warlock");
DB_END_BrainBattle_Thralls(WIZARD_6fe3ae27-dc6c-4fc9-9245-710c790c396c, QUEST_END_Thrall_Wizard_ca44eafa-4c35-4103-889d-fd4df47f2835, "END_SUPERTHRALL_WIZARD", "EQP_END_Thrall_Wizard");
DB_END_BrainBattle_PlayerAdversary(NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
NOT DB_END_BrainBattle_PlayerAdversary(NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_END_BrainBattle_AdversarySpawnPos(S_END_ThrallPos_001_ad5c383e-efd1-43fb-b567-a8a1fd786d73);
DB_END_BrainBattle_AdversarySpawnPos(S_END_ThrallPos_002_ea33627c-48e4-474a-a444-139da100dcf5);
DB_END_BrainBattle_AdversarySpawnPos(S_END_ThrallPos_003_a470a34e-cfa1-43e8-9f26-5c17aa4ab56d);
DB_END_BrainBattle_AdversarySpawnPos(S_END_ThrallPos_004_98912a06-b79e-445f-8d77-fb9c0e00c7e0);
DB_END_BrainBattle_BackupDaisies(END_BackupDaisy_001_d8e8b72e-4b21-4442-8e34-0ecab3f499ae);
DB_END_BrainBattle_BackupDaisies(END_BackupDaisy_002_7f8ba670-6749-457e-9aea-8169ab6d7a38);
DB_END_BrainBattle_BackupDaisies(END_BackupDaisy_003_41900801-ad80-4e79-881a-b0f58f14aff4);
DB_END_BrainBattle_BackupDaisies(END_BackupDaisy_004_e7bc792c-09ab-4a42-972e-6798cb5927b5);
DB_END_BrainBattle_NautiloidCannons(S_END_NautiloidCannon_007_7cd54f7c-21af-49f1-87cb-97e13f26bf27);
DB_END_BrainBattle_NautiloidCannons(S_END_NautiloidCannon_008_28db1262-a6b9-47cd-af6b-44cb694b17ba);
DB_END_BrainBattle_NautiloidCannons(S_END_NautiloidCannon_009_987dcf83-3ca5-4372-b2d9-fec950c2e5a6);
DB_END_BrainBattle_NautiloidCannons(S_END_NautiloidCannon_010_29edd32f-571c-4d6b-b5f4-3fd36cd8ad77);
DB_END_BrainBattle_NautiloidCannons(S_END_NautiloidCannon_011_ba70658b-84f2-4cc1-bd30-dadb3efd5402);
DB_END_BrainBattle_NautiloidCannons(S_END_NautiloidCannon_012_717fd538-8263-4a85-9d0f-15b5cf58e99d);
DB_END_BrainBattle_PodSpawnAreas(S_END_BrainIllithidPodArea_001_e10d68e8-78e1-4eec-9da2-aa7c213a8077);
DB_END_BrainBattle_PodSpawnAreas(S_END_BrainIllithidPodArea_004_1629e3f9-f3a9-4d65-8d75-9f3e09fcca7d);
DB_END_BrainBattle_PodSpawnAreas(S_END_BrainIllithidPodArea_003_db99f8be-025c-471d-be3d-560b93b514fa);
DB_END_BrainBattle_PodSpawnAreas(S_END_BrainIllithidPodArea_002_02ac5351-a37c-4b7d-aaec-4588ec54bc73);
DB_END_BrainBattle_PodSpawnAreas(S_END_BrainIllithidPodArea_005_c75a19cc-50d8-4709-b0a7-4302dadd24d0);
DB_END_BrainBattle_PodSpawnAreas(S_END_BrainIllithidPodArea_006_4731dedf-7f7e-4f99-86d1-aa4d67d05b36);
DB_END_BrainBattle_PodSpawnAreas(S_END_BrainIllithidPodArea_007_7c69737a-9082-4bf8-9796-c4270b67e709);
DB_END_BrainBattle_PodSpawnAreas(S_END_BrainIllithidPodArea_008_037c975c-d695-4da1-a26f-c7e12e45d28a);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_001_a7387630-f935-4c0b-80da-d21628d6e9c7, 0);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_002_8042c385-b8d0-42e5-ab0f-ea9d7bf6f941, 0);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_003_ed77f41a-054c-453d-8d3f-415ee5872f33, 0);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_004_772c253f-2b1d-4426-abd2-d64f5357f7fd, 0);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_005_c050677a-a5ec-4f81-87d1-39d8ab9cd13a, 0);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_006_6f87e6c7-601d-4ea5-a538-c629150baec6, 0);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_007_6697977c-7084-4c2d-be45-927b16aabc43, 0);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_008_fcd9edcf-8bc0-4543-b34e-cc161a5e2e55, 0);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_009_376274e3-7f5f-40ec-af37-cfc279a5c42d, 0);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_010_ad59d016-69e8-46d8-9e22-ab747f9dc10a, 0);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_011_39cc27b0-1352-4577-b33b-61a5df044f28, 1);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_012_8ac94e11-be6c-4e9a-996b-94a627f54a97, 1);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_013_6176cb82-2cac-4a03-83ae-efe2c596587c, 1);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_014_a05455d4-44ce-477f-a554-83e73f6f5d31, 1);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_015_9d75bccc-543c-429c-960c-b2699666a3e0, 1);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_016_37a583f6-9724-4457-8944-1b262b716d24, 1);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_017_a3170e52-a501-4cfc-a11c-f10f217934d9, 1);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_018_eb68c6ed-ad2d-4885-acae-e29d0807dd2c, 1);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_019_955b71b1-029a-422d-bada-c0da28dadaa9, 2);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_020_a1c64fb1-5d7b-40c1-871e-2872264b2212, 2);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_021_cd20691f-2599-47ea-a297-b99aefbcc32c, 2);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_022_115d6400-f70b-4f78-8027-b9bf5f22c397, 2);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_023_f5579e3f-cf2a-40b2-af80-84ee228e6fb5, 2);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_024_8ff5b92b-cfc7-43a4-92d6-ec188b5026d4, 2);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_025_3cdedc48-12d5-4c5c-a610-01f2b4877043, 2);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_026_7ca5c0fe-633c-4c86-a4a8-b2b36f8c0e9f, 2);
DB_END_BrainBattle_NautiloidStrikeSets(S_END_NautiloidStrikePos_027_a7dcc088-30ec-4883-8a45-29d0d4d76612, 2);
DB_END_BrainBattle_Enemies(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a);
DB_END_BrainBattle_Enemies(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e);
DB_END_BrainBattle_Enemies(S_END_BrainBattle_MindFlayer_001_70ef4f3f-c8bf-4b07-b473-8043699a6d5c);
DB_END_BrainBattle_Enemies(S_END_BrainBattle_MindFlayer_002_e5f0fcdf-8a9e-426a-96db-254f94898172);
DB_END_BrainBattle_Enemies(S_END_BrainBattle_MindFlayer_003_3868c215-f34f-4dfb-9c8a-1b06f2d5644d);
DB_END_BrainBattle_Enemies(S_END_BrainBattle_MindFlayer_004_c42ee756-319a-4ebd-b547-dceda6ef606d);
DB_END_BrainBattle_Enemies_MindFlayerArcanists(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e);
DB_END_BrainBattle_Enemies_MindFlayerArcanists(S_END_BrainBattle_MindFlayer_001_70ef4f3f-c8bf-4b07-b473-8043699a6d5c);
DB_END_BrainBattle_Enemies_MindFlayerArcanists(S_END_BrainBattle_MindFlayer_002_e5f0fcdf-8a9e-426a-96db-254f94898172);
DB_END_BrainBattle_Enemies_MindFlayerArcanists(S_END_BrainBattle_MindFlayer_003_3868c215-f34f-4dfb-9c8a-1b06f2d5644d);
DB_END_BrainBattle_Enemies_MindFlayerArcanists(S_END_BrainBattle_MindFlayer_004_c42ee756-319a-4ebd-b547-dceda6ef606d);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_001_6efe022f-8578-4710-a50d-fd1bd59904fc, S_END_BrainBattle_TentacleSpawnTrigger_001_3d70755e-035b-4f2a-bc60-df8ff4c5fff9);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_002_29294081-6990-453c-b667-7ed7f8ad2a27, S_END_BrainBattle_TentacleSpawnTrigger_002_b0df723e-1758-4621-b28f-b6af3d79007c);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_003_7e3e5fea-dd9f-432a-ab12-092e1e0f18c1, S_END_BrainBattle_TentacleSpawnTrigger_003_8d4db7f5-c5fd-405a-a05e-111ea2a6c8d2);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_004_1b121796-39dd-49b6-931d-a034d21b1963, S_END_BrainBattle_TentacleSpawnTrigger_004_d392ad42-d78d-4dcf-841d-466df13c8f4f);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_005_26139602-6b60-4844-9cad-f9188c1c9394, S_END_BrainBattle_TentacleSpawnTrigger_005_7189f249-d54e-4e1b-b1fe-da0a423c84b8);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_006_a84fb30e-c652-4c1b-9b43-2acf4b9d7e90, S_END_BrainBattle_TentacleSpawnTrigger_006_623324bf-f7ec-4325-b5b6-86a30907d533);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_007_977b8b8e-7541-4f27-949b-211f2417a45d, S_END_BrainBattle_TentacleSpawnTrigger_007_eae82dde-428a-41ff-84d6-4c12b1d4c2cd);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_008_7c5e5bcf-82ff-45e7-b3ae-6fee00e53457, S_END_BrainBattle_TentacleSpawnTrigger_008_f02eb8cf-3f1a-4e21-bd54-e4922b72184a);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_009_b7f6e355-50b5-444e-a11f-9ea0e672e6af, S_END_BrainBattle_TentacleSpawnTrigger_009_60e842f8-10ac-45ae-be74-6482b2c0f8db);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_010_b7df06f5-2c51-4b05-ad84-8737f7227d01, S_END_BrainBattle_TentacleSpawnTrigger_010_4b1948ec-5587-490e-85a9-efcd89ce17cf);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_011_6641a54c-176b-4c76-9a37-ad2dc1b4d02d, S_END_BrainBattle_TentacleSpawnTrigger_011_470db11e-6a0d-4ed2-8fff-4540e4d9381b);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_012_b685cbcf-c9c4-4f4c-9370-436f9b1ff4bd, S_END_BrainBattle_TentacleSpawnTrigger_012_a6683393-02e8-45d0-95d1-39c184c147bd);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_013_6edfc979-6257-43cc-8f46-326b95cfccc7, S_END_BrainBattle_TentacleSpawnTrigger_013_6102c4a6-0abf-4d3b-bca4-2e2381ddec16);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_014_6476da1f-9391-4260-9bbb-3df448cea360, S_END_BrainBattle_TentacleSpawnTrigger_014_3d6670fd-1731-49d3-94de-2095dc7866ec);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_015_6630a992-1e9a-4b70-b8b6-25043efe3753, S_END_BrainBattle_TentacleSpawnTrigger_015_fae393ab-4926-4833-a636-a40d9b5c126c);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_016_59c22551-acff-4426-8232-99cf7059758a, S_END_BrainBattle_TentacleSpawnTrigger_016_6571d0fb-78f8-42f7-b42b-f27833526aee);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_017_0e7e534f-5b19-481c-acc4-dd815e6de4d6, S_END_BrainBattle_TentacleSpawnTrigger_017_85dc8997-0133-4ba9-aeb6-097491c2572c);
DB_END_BrainBattle_BrainTentacles(S_END_BrainBattle_Tentacle_018_55916542-5572-4edf-b454-52da27c1a4be, S_END_BrainBattle_TentacleSpawnTrigger_018_387242b6-c101-4df5-8e48-46f73103750c);
DB_Combat_Dragon_ProxyOwner(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e, "END_RedDragon");
DB_Combat_Dragon_HitProxies(S_END_Dragon_Proxy_LegFrontLeft_0326bf71-261b-413b-a0ac-1ad457306e84, "END_RedDragon");
DB_Combat_Dragon_HitProxies(S_END_Dragon_Proxy_LegFrontRight_0ddd897c-6aa1-454b-936f-97681ff13382, "END_RedDragon");
DB_Combat_Dragon_HitProxies(S_END_Dragon_Proxy_LegBackLeft_748b540f-7ca8-4f69-a62d-efd8daf4115b, "END_RedDragon");
DB_Combat_Dragon_HitProxies(S_END_Dragon_Proxy_LegBackRight_b52f7339-4084-43c4-820f-4ee16ee06552, "END_RedDragon");
DB_Combat_Dragon_HitProxies(S_END_Dragon_Proxy_Tail_78a27d89-9867-481f-9e88-a1ff60af6f35, "END_RedDragon");
DB_Combat_Dragon_HitProxies(S_END_Dragon_Proxy_Head_e3bedcb1-b99d-42e7-9134-06614d7392ee, "END_RedDragon");
PROC_Combat_Dragon_ProxySetup("END_RedDragon");
SetForceUpdate(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e, 1);
AiAddInterestingItem(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e, S_END_DragonJumpPoint_001_fe54e1d3-1533-4f63-9411-d862f170d2c1);
AiAddInterestingItem(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e, S_END_DragonJumpPoint_002_de457ae1-3b79-4777-a095-462ae973e4bb);
AiAddInterestingItem(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e, S_END_DragonJumpPoint_003_a0343314-3ebc-4a17-8a1c-454a50ccb5f4);
AiAddInterestingItem(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e, S_END_DragonJumpPoint_004_04c5bb9a-f723-4505-a3b0-388510030cd3);
AiAddInterestingItem(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e, S_END_DragonJumpPoint_005_d1142771-b6a5-4899-825f-766f7f188cae);
AiAddInterestingItem(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e, S_END_DragonJumpPoint_006_ac57bb63-f294-4418-b3cf-982eb11877e8);
SetForceUpdate(S_END_Nautiloid_002_f50dc928-bb2d-48b6-a2dd-98fce0a47d28, 1);
SetForceUpdate(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a, 1);
SetForceUpdate(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, 1);
SetForceUpdate(S_END_Crown_704f1e91-8d56-4772-98d8-54c5d8a6af20, 1);
DB_END_BrainBattle_CrownTurn(0);
DB_END_BrainBattle_NautiloidTurn(0);
DB_END_BrainBattle_TeleportPositions(S_END_BrainBattlePartyPos_001_96fdb9c4-13c4-42b6-9e12-0644c8f2850d, 1);
DB_END_BrainBattle_TeleportPositions(S_END_BrainBattlePartyPos_002_5eb45058-b1d0-410d-aa16-f42aff1c7ffa, 2);
DB_END_BrainBattle_TeleportPositions(S_END_BrainBattlePartyPos_003_9454a614-281f-42f3-a14a-ef12c1b80e3c, 3);
DB_END_BrainBattle_TeleportPositions(S_END_BrainBattlePartyPos_004_54ec11ee-a6e5-4240-a524-1c94a77ac6b4, 4);
DB_END_BrainBattle_TeleportPositions(S_END_BrainBattlePartyPos_005_f8af2bc0-0ef8-4ed3-8c09-cf0d9aaa5571, 5);
DB_END_BrainBattle_TeleportPositions(S_END_BrainBattlePartyPos_006_af2e76fe-14de-4415-bf21-d12ac50395a7, 6);
DB_END_BrainBattle_TeleportPositions(S_END_BrainBattlePartyPos_007_6328c0bd-49d3-43fe-bcc8-360f3eef86fc, 7);
DB_END_BrainBattle_TeleportPositions(S_END_BrainBattlePartyPos_008_6cf3e324-81b0-404f-b1e6-d35ed0787fdd, 8);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_8f6b2b6a-3c4c-45e9-8069-d728ecca47f0, 398bc36d-2ced-8a8b-4912-2c9cbda4da37);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_002_986baa02-1776-4000-b122-077a8bd0aca8, 8e2f3234-191d-8e82-5165-42ac324dca32);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_003_c2cc1c7b-0427-45b2-802b-0bf8e81551dd, 2da5a0c4-62ca-88f2-3f60-20d38121806f);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_004_d3fbd6ac-ca83-4c95-b192-190288f1e876, 8bddcb2c-99a1-870b-30b0-2cca1722e3ef);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_005_1d646bd7-57a6-43a0-b660-6886f6bc02ef, 8b039516-e8c5-8b2b-3870-56825dc9c8d9);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_006_3654bde7-f4bc-41d5-8c6b-f608543823ef, 08d3956e-25cd-8c80-52a3-a468c4253b2f);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_007_5ce783db-f68b-4ef2-bd82-a0cdbe754813, b9296fb4-6be8-8f9b-1b2c-b028b13b2236);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_008_d122d9a9-0afd-4143-aec4-e9f1596f3fd8, cb8d4098-98ad-8054-2625-846d16835521);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_009_70b6cdc3-74ff-4c34-9f4b-b47f7371e065, b9296fb4-6be8-8f9b-1b2c-b028b13b2236);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_010_773048fe-8287-4603-9900-f98f7cc56d8f, b766d97e-bfa2-89c4-5df1-5c7280aad288);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_011_92e8d529-5821-423d-b150-7fa167dc906e, 2d4c079b-82c4-84a5-3747-a5e9c15cfeed);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_012_70cb6db5-850b-4bde-a7dc-e6a74908036f, 2d4c079b-82c4-84a5-3747-a5e9c15cfeed);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_013_a1996ecd-a174-40d0-810a-71b107491894, e9298a75-1d23-8e5b-2404-d6bbe3216776);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_014_bd6d7621-ebbf-40ff-8696-b531442d11a6, 203647d9-4dd0-87a4-4c7e-e380e3cfd12e);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_015_be42e122-5d83-4af4-b9e8-40d0ba48a2f1, 4a72420d-a1e8-40c9-b6d7-c5ea2b561a92);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_016_eae65893-b18e-461f-a445-3b306b500e64, e1860db2-d36d-4d2d-978d-f9fc8882fd48);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_017_54c6481d-2e60-42d5-b3f2-4759ce628a8f, a736e58a-b589-456e-83c0-8cd34eedf3bf);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_018_9e8d8851-de3e-4c46-9d56-f0231fd196df, 283c9461-40a3-4420-944f-635e83b9aa49);
DB_END_BrainBattle_MindSpawnPoints(S_END_MindPartyPos_019_c3d1e9b7-ddcc-4d11-9bd6-f1c399869c86, 6d2fac3b-266d-46e1-8136-a0edc6e61c99);
SetOnStage(S_END_MindPortal_06463ecc-d906-4c7c-b4e0-41e69abccc36, 0);
TriggerRegisterForItems(S_END_NetherbrainArena_001_SUB_a79f975d-d33a-455b-a444-9a0d08f59c57);
PROC_TriggerRegisterForPlayers(S_END_BrainCombatEndCheckArea_c2343d09-4446-416c-a3e6-fff64ca563ad);
SetImmortal(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, 1);
PROC_CharacterDisableAllCrimes(S_END_Netherbrain_HitboxProxy_001_49e7f225-6fa9-4f86-b03b-b8282a2bba20);
PROC_SelfHealing_Disable(S_END_Netherbrain_HitboxProxy_001_49e7f225-6fa9-4f86-b03b-b8282a2bba20);
PROC_CharacterDisableAllCrimes(S_END_Netherbrain_HitboxProxy_002_238679d4-f051-4b4f-bd50-5809c9e5893a);
PROC_SelfHealing_Disable(S_END_Netherbrain_HitboxProxy_002_238679d4-f051-4b4f-bd50-5809c9e5893a);
PROC_CharacterDisableAllCrimes(S_END_Netherbrain_HitboxProxy_003_37f2b1cc-992c-4298-aaf3-84e8b6c6fe0a);
PROC_SelfHealing_Disable(S_END_Netherbrain_HitboxProxy_003_37f2b1cc-992c-4298-aaf3-84e8b6c6fe0a);
PROC_CharacterDisableAllCrimes(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1);
PROC_CharacterDisableAllCrimes(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759);
DB_END_BrainBattle_DaisySpells("Target_END_Daisy_Command_Drop", END_BrainBattle_Event_DaisyDrop_69d918c4-36e6-f262-4ec6-20c650be8593);
DB_END_BrainBattle_DaisySpells("Target_END_Daisy_Command_Grovel", END_BrainBattle_Event_DaisyGrovel_2857a9b0-46d5-69fe-656e-e4ba70322d72);
DB_END_BrainBattle_DaisySpells("Target_END_Daisy_Command_Flee", END_BrainBattle_Event_DaisyFlee_1f46d45e-bfd8-62e4-32ed-16ae60b0c88b);
DB_END_BrainBattle_DaisySpells("Target_END_Daisy_Command_Halt", END_BrainBattle_Event_DaisyHalt_f97b003f-9382-9625-7ebc-cd260dfefcad);
DB_END_BrainBattle_DaisySpells("Target_END_Daisy_Command_Hush", END_BrainBattle_Event_DaisyHush_aa60650c-4f5f-5db3-4f07-3a3331b905bd);
DB_END_MindBattle_Platforms(2da5a0c4-62ca-88f2-3f60-20d38121806f);
DB_END_MindBattle_Platforms(398bc36d-2ced-8a8b-4912-2c9cbda4da37);
DB_END_MindBattle_Platforms(8bddcb2c-99a1-870b-30b0-2cca1722e3ef);
DB_END_MindBattle_Platforms(b9296fb4-6be8-8f9b-1b2c-b028b13b2236);
DB_END_MindBattle_Platforms(08d3956e-25cd-8c80-52a3-a468c4253b2f);
DB_END_MindBattle_Platforms(b766d97e-bfa2-89c4-5df1-5c7280aad288);
DB_END_MindBattle_Platforms(8e2f3234-191d-8e82-5165-42ac324dca32);
DB_END_MindBattle_Platforms(8b039516-e8c5-8b2b-3870-56825dc9c8d9);
DB_END_MindBattle_Platforms(2d4c079b-82c4-84a5-3747-a5e9c15cfeed);
DB_END_MindBattle_Platforms(203647d9-4dd0-87a4-4c7e-e380e3cfd12e);
DB_END_MindBattle_Platforms(e9298a75-1d23-8e5b-2404-d6bbe3216776);
DB_END_MindBattle_Platforms(cb8d4098-98ad-8054-2625-846d16835521);
DB_END_MindBattle_Platforms(4a72420d-a1e8-40c9-b6d7-c5ea2b561a92);
DB_END_MindBattle_Platforms(e1860db2-d36d-4d2d-978d-f9fc8882fd48);
DB_END_MindBattle_Platforms(a736e58a-b589-456e-83c0-8cd34eedf3bf);
DB_END_MindBattle_Platforms(283c9461-40a3-4420-944f-635e83b9aa49);
DB_END_MindBattle_Platforms(6d2fac3b-266d-46e1-8136-a0edc6e61c99);
DB_END_MindBattle_OrbHelpers(S_END_MindArena_OrbHelper_000_235d2cbe-9f87-4fea-b0de-7d1b49e79039);
DB_END_MindBattle_OrbHelpers(S_END_MindArena_OrbHelper_001_0c6b267f-1b78-411b-83cc-a04f49877bb0);
DB_END_MindBattle_OrbHelpers(S_END_MindArena_OrbHelper_002_9705e055-5666-46aa-afe0-7b8a37b959f3);
DB_END_MindBattle_OrbHelpers(S_END_MindArena_OrbHelper_003_1fe3dc3a-f4b3-49ac-96db-3c5d044e067d);
DB_END_MindBattle_OrbHelpers(S_END_MindArena_OrbHelper_004_40da66bd-2607-4ea8-a242-202e8cf2b623);
DB_END_MindBattle_OrbHelpers(S_END_MindArena_OrbHelper_005_7c843326-37b9-4e79-99a5-d80019cef9d1);
DB_END_MindBattle_OrbHelpers(S_END_MindArena_OrbHelper_006_3bcf0280-fcb4-4556-8a38-b3a90b2e345b);
DB_END_MindBattle_OrbHelpers(S_END_MindArena_OrbHelper_007_118525e0-1d8e-4e28-a927-43a6520a8934);
DB_END_MindBattle_OrbHelpers(S_END_MindArena_OrbHelper_008_537f81be-48bb-49ab-9ae2-bd50738db812);
DB_END_MindBattle_OrbHelpers(S_END_MindArena_OrbHelper_009_1649e4cd-3e8e-4b8f-ae8f-86781e4f007d);
DB_END_MindBattle_OrbHelpers(S_END_MindArena_OrbHelper_010_4b2e814c-3e3b-4645-a552-19c59d0bf89e);
DB_END_MindBattle_OrbHelpers(S_END_MindArena_OrbHelper_011_cceb2de3-4bef-4c23-aa56-de45c3beb388);
DB_END_MindBattle_OrbHelpers(S_END_MindArena_OrbHelper_012_dee05715-0d67-4ce9-90a0-e6d496a0c827);
DB_END_MindBattle_OrbHelpers(S_END_MindArena_OrbHelper_013_240f27d5-bd31-4499-95df-6ed38943f0fa);
DB_END_MindBattle_OrbHelpers(S_END_MindArena_OrbHelper_014_00c0bb6a-aaed-4a0f-8825-42c5a227e581);
DB_END_MindBattle_Ladders(S_END_MindLadder_001_38cb1dba-cd25-4b44-b421-84f0e9d5bb8a, e9298a75-1d23-8e5b-2404-d6bbe3216776);
DB_END_MindBattle_Ladders(S_END_MindLadder_001_38cb1dba-cd25-4b44-b421-84f0e9d5bb8a, 0723ac48-1021-8448-2d37-17ecf6424f3d);
DB_END_MindBattle_Ladders(S_END_MindLadder_002_f69bbfe2-f4bf-4eba-8977-96d514c0bf13, 2d4c079b-82c4-84a5-3747-a5e9c15cfeed);
DB_END_MindBattle_Ladders(S_END_MindLadder_002_f69bbfe2-f4bf-4eba-8977-96d514c0bf13, 7bbbbc39-9ef4-85db-5de4-490ba2eaf0ec);
DB_END_MindBattle_Ladders(S_END_MindLadder_003_4cfd0bd9-a5ba-4535-bffa-54ea32534737, 2d4c079b-82c4-84a5-3747-a5e9c15cfeed);
DB_END_MindBattle_Ladders(S_END_MindLadder_003_4cfd0bd9-a5ba-4535-bffa-54ea32534737, 8b039516-e8c5-8b2b-3870-56825dc9c8d9);
DB_END_MindBattle_Ladders(S_END_MindLadder_005_4809f0b5-ba1d-4204-9db9-967640840cad, e9298a75-1d23-8e5b-2404-d6bbe3216776);
DB_END_MindBattle_Ladders(S_END_MindLadder_005_4809f0b5-ba1d-4204-9db9-967640840cad, b9296fb4-6be8-8f9b-1b2c-b028b13b2236);
DB_END_MindBattle_Ladders(S_END_MindLadder_006_919c4241-b896-4c5e-9432-039f1c60f8ee, 08d3956e-25cd-8c80-52a3-a468c4253b2f);
DB_END_MindBattle_Ladders(S_END_MindLadder_006_919c4241-b896-4c5e-9432-039f1c60f8ee, 398bc36d-2ced-8a8b-4912-2c9cbda4da37);
DB_END_MindBattle_Chains("END_CHAINSOFKARSUS_CHAINS_VFX_2", 2);
DB_END_MindBattle_Chains("END_CHAINSOFKARSUS_CHAINS_VFX_4", 3);
DB_END_MindBattle_Chains("END_CHAINSOFKARSUS_CHAINS_VFX_1", 4);
DB_END_MindBattle_Chains("END_CHAINSOFKARSUS_CHAINS_VFX_3", 5);
PROC_DeclareCounter("END_BrainBattle_ChainCounter");
DB_END_BrainBattle_QueuedRestoreCharacters(NULL_00000000-0000-0000-0000-000000000000);
NOT DB_END_BrainBattle_QueuedRestoreCharacters(NULL_00000000-0000-0000-0000-000000000000);
DB_DialogDeath(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759);

KBSECTION
IF
TextEvent("startmindtimer", _, _, _, _)
THEN
TurnBasedTimerLaunch(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, "END_MindCountdown", "END_MindCountdown_Timer", 24000);

IF
TextEvent("mindbraindies", _, _, _, _)
THEN
Die(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1);

IF
TextEvent("mindbattle", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
ApplyStatus(_Var1, "MIND_FLAYER_FORM", -1, 1, NULL_00000000-0000-0000-0000-000000000000);
PROC_GlobalSetFlagAndCache(END_IllithidOptions_Event_EmperorBetrayal_411c2575-bfbc-449c-9762-edad4285aafd);
PROC_TeleportPartiesTo(S_END_MindPortal_06463ecc-d906-4c7c-b4e0-41e69abccc36, "");
PROC_END_BrainBattle_DominationUsed(_Var1);
PROC_SetRelationToPlayers(ACT3_END_Netherbrain_04928f91-6658-431e-b652-65aea6403879, 0);
DB_END_DEBUG_BrainBattle_MindBattleCombatJoin(1);

IF
TextEvent("testbraindeath", _, _, _, _)
THEN
PlayEffect(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, VFX_Combat_Death_Mind_Lifetime_01_071ec218-0a26-3f5a-a5b4-975eb11a82d8, "Dummy_BodyFX", 1);

IF
TextEvent("testcrownburst", _, _, _, _)
THEN
PROC_LoopEffect(VFX_Script_Brainquake_NoOffset_01_0d5c292e-0eca-5117-bdc5-75a56b1e5eb7, S_END_Crown_704f1e91-8d56-4772-98d8-54c5d8a6af20, "END_BrainBattle_DominationReaction", "END_Main", "", 0.2);
ObjectTimerLaunch(S_END_Crown_704f1e91-8d56-4772-98d8-54c5d8a6af20, "END_BrainBattle_DominationReaction", 5000);

IF
TextEvent("END_BrainBattle_CINE_NautiloidFires", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SendArenaCameraEvent(S_END_Nautiloid_002_f50dc928-bb2d-48b6-a2dd-98fce0a47d28, _Var1, "END_BrainBattle_CINE_NautiloidFires");

PROC
PROC_END_BrainBattle_EnterMind((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_DEBUG_BrainBattle_MindBattleCombatJoin(1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_Start(1, _Var1, _Var1, _Var1, _Var1)
THEN
SetCombatGroupID(_Var1, "END_BrainBattle");
DB_END_BrainBattle_Start(1);

IF
DB_END_DEBUG_BrainBattle_MindBattleCombatJoin(1, _, _, _, _)
AND
DB_END_BrainBattle_Start(1, _, _, _, _)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetCombatGroupID(_Var1, "END_BrainBattle");
PROC_END_BrainBattle_TryEnterCombat(_Var1);

IF
TextEvent("brainbattle", _, _, _, _)
THEN
PROC_END_BrainBattle_DebugAddEmperor();

PROC
PROC_END_BrainBattle_DebugAddEmperor()
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_DEBUG_BrainBattle_EmperorJoiningParty(1);
SetFlag(END_IllithidOptions_State_GaveStones_18e3be1a-c1c0-437e-ad0a-a1426d8830f4);
SetFlag(END_IllithidOptions_State_AssimilatedOrpheus_5562cc3f-c168-48c9-87c1-1598a5c58961);
PROC_DEBUG_END_IllithidOptionsFollower_Follow(_Var1, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);

IF
CharacterJoinedParty(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _, _, _, _)
AND
DB_END_DEBUG_BrainBattle_EmperorJoiningParty(1, _, _, _, _)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_DEBUG_BrainBattle_EmperorJoiningParty(1);
DebugText(_Var1, "Possiblity of breaking Illithid Options Situations!");
PROC_END_BrainBattle_TeleportParty(1);
DB_END_HighHallInterior_ToRoofReadyCheckPlayer(_Var1);
PROC_END_BrainBattle_PreSetup();

IF
TextEvent("brainbattlenoemperor", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
ApplyStatus(_Var1, "MIND_FLAYER_FORM", -1, 1, NULL_00000000-0000-0000-0000-000000000000);
PROC_GlobalSetFlagAndCache(END_IllithidOptions_Event_EmperorBetrayal_411c2575-bfbc-449c-9762-edad4285aafd);
DB_END_HighHallInterior_ToRoofReadyCheckPlayer(_Var1);
PROC_END_BrainBattle_PreSetup();

IF
TextEvent("nautiloidon", _, _, _, _)
THEN
ApplyStatus(S_END_Nautiloid_002_f50dc928-bb2d-48b6-a2dd-98fce0a47d28, "END_NAUTILOID_SPAWN_VFX", -1, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
TextEvent("nautiloidoff", _, _, _, _)
THEN
TeleportTo(S_END_Nautiloid_002_f50dc928-bb2d-48b6-a2dd-98fce0a47d28, S_END_DebugTentacle_998e2725-5022-43fd-87f7-2f64be3718f4, "");
RemoveStatus(S_END_Nautiloid_002_f50dc928-bb2d-48b6-a2dd-98fce0a47d28, "END_NAUTILOID_SPAWN_VFX", NULL_00000000-0000-0000-0000-000000000000);
SetForceUpdate(S_END_Nautiloid_002_f50dc928-bb2d-48b6-a2dd-98fce0a47d28, 0);

IF
DB_END_BrainBattle_NautiloidCannons(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetOnStage(_Var1, 0);

IF
DB_END_BrainBattle_DefaultThralls(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_END_BrainBattle_Setup()
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
LeaveCombat(_Var1);

PROC
PROC_END_BrainBattle_Setup()
THEN
DB_END_BrainBattle_RapidMindMeld(1);
DB_END_MorphicPool_RapidMindMeldADHelper(S_END_RapidMindMeldHelper_007_47c212eb-1cfb-4e2b-803f-03aa65e0a178, END_BrainBattle_AD_RapidMindMeld_001_dc1a70c8-dcd2-94ba-835e-90b27b9de561);
DB_END_MorphicPool_RapidMindMeldADHelper(S_END_RapidMindMeldHelper_008_fc7f9f4a-8216-4ef7-b9b4-4e4e214cefe5, END_BrainBattle_AD_RapidMindMeld_002_d6be2dde-cea3-31ad-ca47-408f470cc94c);
DB_END_MorphicPool_RapidMindMeldADHelper(S_END_RapidMindMeldHelper_009_1a6afb45-5adc-43ce-961b-93d0a8e3475e, END_BrainBattle_AD_RapidMindMeld_003_ba5b84be-4290-009b-cd6f-a8d0337a129e);
DB_END_MorphicPool_RapidMindMeldADHelper(S_END_RapidMindMeldHelper_010_d0169cf1-1aa2-40a2-81e9-ab6d0ea133ca, END_BrainBattle_AD_RapidMindMeld_004_fe055f67-495a-37a1-2f6f-783c4317197f);
DB_END_MorphicPool_RapidMindMeldADHelper(S_END_RapidMindMeldHelper_011_c6d06422-0376-4f3a-ba67-58b36f91468d, END_BrainBattle_AD_RapidMindMeld_005_b31c34f4-706a-ebc9-c203-e426d402870e);
DB_END_MorphicPool_RapidMindMeldADHelper(S_END_RapidMindMeldHelper_012_82242af5-2273-4804-9d97-975eeb1d9ec4, END_BrainBattle_AD_RapidMindMeld_006_513e4249-d926-2199-6f55-3ec78a07a9b9);
DB_END_MorphicPool_RapidMindMeldADHelper(S_END_RapidMindMeldHelper_013_3cb8ce5c-1fac-4426-bf23-a7889d020cc8, END_BrainBattle_AD_RapidMindMeld_007_9197e648-79ee-6908-fadd-641848586566);
DB_END_MorphicPool_RapidMindMeldADHelper(S_END_RapidMindMeldHelper_014_7d620a11-1fd8-4a02-b0fb-524da0658f36, END_BrainBattle_AD_RapidMindMeld_008_63b6d9ea-37f2-3886-f704-5a5f4df826b0);

PROC
PROC_END_BrainBattle_PreSetup()
AND NOT
DB_GlobalFlag(END_IllithidOptions_Event_EmperorBetrayal_411c2575-bfbc-449c-9762-edad4285aafd, _, _, _, _)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_ClassTags(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
IsTagged(_Var1, _Var2, 1, _Var1, _Var1)
THEN
DB_END_BrainBattle_PlayerClasses(_Var1, _Var2);

PROC
PROC_END_BrainBattle_PreSetup()
AND NOT
DB_GlobalFlag(END_IllithidOptions_Event_EmperorBetrayal_411c2575-bfbc-449c-9762-edad4285aafd, _, _, _, _)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_BrainBattle_PlayerClasses(_, _, _Var1, _Var1, _Var1)
AND
QRY_GetRandom("DB_END_BrainBattle_PlayerClasses", 2, "DB_END_BrainBattle_RandomPlayerSelectedClass", _Var1, _Var1)
AND
DB_END_BrainBattle_RandomPlayerSelectedClass(_Var4, _Var5, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_PlayerSelectedClass(_Var4, _, _Var1, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_RandomPlayerSelectedClass(_Var4, _Var5);
DB_END_BrainBattle_PlayerSelectedClass(_Var4, _Var5);
PROC_END_BrainBattle_PlayerSelectedClass_ClearOtherClasses(_Var4);

PROC
PROC_END_BrainBattle_PlayerSelectedClass_ClearOtherClasses((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_PlayerClasses(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_PlayerClasses(_Var1, _Var2);

PROC
PROC_END_BrainBattle_PreSetup()
AND NOT
DB_GlobalFlag(END_IllithidOptions_Event_EmperorBetrayal_411c2575-bfbc-449c-9762-edad4285aafd, _, _, _, _)
AND
DB_END_BrainBattle_PlayerSelectedClass(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_END_BrainBattle_Thralls(_Var2, _Var3, _Var4, _Var5, _Var1)
AND
DB_END_BrainBattle_AdversarySpawnPos(_Var6, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_PlayerAdversary(_Var1, _, _Var1, _Var1, _Var1)
AND
SysFactAtIndex("DB_END_BrainBattle_DefaultThralls", 1, 1, "DB_END_BrainBattle_PickedThrall", _Var1)
AND
DB_END_BrainBattle_PickedThrall(_Var8, _Var1, _Var1, _Var1, _Var1)
AND
CreateAtObject(_Var3, _Var6, 0, 0, "END_BrainBattle_Setup_ThrallSpawned", 1, _Var9, _Var1, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_PickedThrall(_Var8);
NOT DB_END_BrainBattle_DefaultThralls(_Var8);
Transform(_Var9, _Var8, Disguise_ceccc4eb-d774-4cd5-9147-12322b81b763);
DB_END_BrainBattle_Enemies(_Var9);
NOT DB_END_BrainBattle_AdversarySpawnPos(_Var6);
DB_END_BrainBattle_PlayerAdversary(_Var1, _Var9);
AddPreferredAiTargetTag(_Var9, _Var2);
DB_END_BrainBattle_ExtraSpeakerThrall(_Var9);
DB_END_BrainBattle_QueuedThrallSpawn(_Var9);
DB_END_BrainBattle_Setup_ThrallSpawned_Status(_Var9, _Var4);
DB_END_BrainBattle_DelaySetup(1);

IF
EnteredLevel((CHARACTER)_Var1, _, "END_Main", (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_QueuedThrallSpawn(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_QueuedThrallSpawn(_Var1);

IF
EntityEvent((CHARACTER)_Var1, "END_BrainBattle_Setup_ThrallSpawned", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_Setup_ThrallSpawned_Status(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
ApplyStatus(_Var1, _Var2, -1, 1, _Var1);
NOT DB_END_BrainBattle_Setup_ThrallSpawned_Status(_Var1, _Var2);

PROC
PROC_END_BrainBattle_PreSetup()
AND NOT
DB_END_BrainBattle_DelaySetup(1, _, _, _, _)
THEN
PROC_END_BrainBattle_Setup();

IF
DB_END_BrainBattle_DelaySetup(1, _, _, _, _)
AND NOT
DB_END_BrainBattle_QueuedThrallSpawn(_, _, _, _, _)
THEN
PROC_END_BrainBattle_Setup();

PROC
PROC_END_BrainBattle_Setup()
AND
DB_GlobalFlag(END_IllithidOptions_Event_EmperorBetrayal_411c2575-bfbc-449c-9762-edad4285aafd, _, _, _, _)
THEN
SetOnStage(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, 1);
NOT DB_OffStage(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);
TeleportTo(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, S_END_EmperorBrainPos_80c1ecca-63bf-4ea5-a536-e72f1b72c3a4, "");
SetFaction(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, ACT3_END_Netherbrain_04928f91-6658-431e-b652-65aea6403879);
UseSpell(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, "Target_TAD_ShieldOfThralls", S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);
ApplyStatus(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, "END_INITIATIVE_DEBUFF", -1, 1, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);
SetAiHint(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, AI_HINT_UNIQUE_1902723d-dd16-4e7a-87d6-7b07f63add79);
DB_END_BrainBattle_Enemies(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);

PROC
PROC_END_BrainBattle_Setup()
AND
DB_GlobalFlag(END_IllithidOptions_Event_EmperorBetrayal_411c2575-bfbc-449c-9762-edad4285aafd, _, _, _, _)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GLO_DaisyDreams_Relationships(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_END_BrainBattle_AdversarySpawnPos(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_BrainBattle_BackupDaisies(_Var4, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_PlayerAdversary(_Var1, _, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var4, _Var3, "");
Transform(_Var4, _Var2, DisguiseKeepName_c7c3381e-b901-416e-a0c4-bc745e1ff54a);
DB_END_BrainBattle_CombatDaisy(_Var4);
NOT DB_END_BrainBattle_BackupDaisies(_Var4);
DB_END_BrainBattle_Enemies(_Var4);
NOT DB_END_BrainBattle_AdversarySpawnPos(_Var3);
DB_END_BrainBattle_PlayerAdversary(_Var1, _Var4);
DB_END_BrainBattle_IntroExtraSpeakers(_Var4);

PROC
PROC_END_BrainBattle_Setup()
AND
DB_GlobalFlag(END_IllithidOptions_Event_EmperorBetrayal_411c2575-bfbc-449c-9762-edad4285aafd, _, _, _, _)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GLO_DaisyDreams_Relationships(_Var1, _, _Var1, _Var1, _Var1)
AND
DB_END_BrainBattle_AdversarySpawnPos(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_BrainBattle_BackupDaisies(_Var4, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_PlayerAdversary(_Var1, _, _Var1, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_BackupDaisies(_Var4);
DB_END_BrainBattle_CombatDaisy(_Var4);
DB_END_BrainBattle_Enemies(_Var4);
TeleportTo(_Var4, _Var3, "");
NOT DB_END_BrainBattle_AdversarySpawnPos(_Var3);
DB_END_BrainBattle_PlayerAdversary(_Var1, _Var4);
DB_END_BrainBattle_IntroExtraSpeakers(_Var4);

PROC
PROC_END_BrainBattle_Setup()
AND
DB_Avatars(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, _, _, _, _)
AND NOT
DB_END_BrainBattle_IntroScene(1, _, _, _, _)
AND
QRY_StartDialogCustom(END_BrainBattle_Intro_4565e114-0153-0449-ea83-de3b972c7679, S_GLO_Netherbrain_3858e896-d7dd-4699-b37d-d3919ff15ba7, S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, 0, 0, 0, 0, _, _)
THEN
DB_END_BrainBattle_IntroScene(1);

PROC
PROC_END_BrainBattle_Setup()
AND
DB_END_General_MainDialogAnchor(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_IntroScene(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_BrainBattle_Intro_4565e114-0153-0449-ea83-de3b972c7679, S_GLO_Netherbrain_3858e896-d7dd-4699-b37d-d3919ff15ba7, _Var1, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, 0, 0, 0, 0, _Var1, _Var1)
THEN
DB_END_BrainBattle_IntroScene(1);

PROC
PROC_END_BrainBattle_Setup()
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_General_MainDialogAnchor(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_IntroScene(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_BrainBattle_Intro_4565e114-0153-0449-ea83-de3b972c7679, S_GLO_Netherbrain_3858e896-d7dd-4699-b37d-d3919ff15ba7, _Var1, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, 0, 0, 0, 0, _Var1, _Var1)
THEN
DB_END_BrainBattle_IntroScene(1);

PROC
PROC_END_BrainBattle_Setup()
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_IntroScene(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_BrainBattle_Intro_4565e114-0153-0449-ea83-de3b972c7679, S_GLO_Netherbrain_3858e896-d7dd-4699-b37d-d3919ff15ba7, _Var1, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, 0, 0, 0, 0, _Var1, _Var1)
THEN
DB_END_BrainBattle_IntroScene(1);

PROC
PROC_END_BrainBattle_Setup()
AND
DB_END_HighHallInterior_ToRoofReadyCheckPlayer(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_HighHallInterior_ToRoofReadyCheckPlayer(_Var1);

PROC
PROC_END_BrainBattle_Setup()
THEN
SetFlag(END_General_State_CurrentlyInBrainBattle_0d7205b2-0d55-4540-8737-543253873cd6);
PROC_SetRelationToPlayers(ACT3_END_Netherbrain_04928f91-6658-431e-b652-65aea6403879, 50);

PROC
PROC_END_BrainBattle_Setup()
AND NOT
DB_END_BrainBattle_IntroScene(1, _, _, _, _)
THEN
SetFlag(END_BrainBattle_Event_PlayersMovedToBrain_87f477a2-6ca7-4ada-be46-3f2680fa0f4c);
DB_END_BrainBattle_Start(1);
PROC_SetRelationToPlayers(ACT3_END_Netherbrain_04928f91-6658-431e-b652-65aea6403879, 0);

IF
DialogEnded(END_BrainBattle_Intro_4565e114-0153-0449-ea83-de3b972c7679, _, _, _, _)
AND NOT
DB_GlobalFlag(END_BrainBattle_Event_PlayersMovedToBrain_87f477a2-6ca7-4ada-be46-3f2680fa0f4c, _, _, _, _)
THEN
SetFlag(END_BrainBattle_Event_PlayersMovedToBrain_87f477a2-6ca7-4ada-be46-3f2680fa0f4c, NULL_00000000-0000-0000-0000-000000000000, 0);

IF
FlagSet(END_BrainBattle_Event_PlayersMovedToBrain_87f477a2-6ca7-4ada-be46-3f2680fa0f4c, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_END_BrainBattle_TeleportParty(1);

PROC
PROC_END_BrainBattle_TeleportParty(1, _, _, _, _)
AND
DB_PartyMembers(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _, _, _, _)
THEN
DB_END_BrainBattle_Teleported(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);
TeleportTo(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, S_END_BrainBattlePartyPos_009_3c60b4fd-1440-40da-889d-d8d0030215b1, "", 0, 0, 0, 1, 1);
LookFromTrigger(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, S_END_BrainBattlePartyPos_009_3c60b4fd-1440-40da-889d-d8d0030215b1, 1);

PROC
PROC_END_BrainBattle_TeleportParty(1, _, _, _, _)
AND
DB_PartyMembers(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _, _, _, _)
THEN
DB_END_BrainBattle_Teleported(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);
TeleportTo(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, S_END_BrainBattlePartyPos_009_3c60b4fd-1440-40da-889d-d8d0030215b1, "", 0, 0, 0, 1, 1);
LookFromTrigger(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, S_END_BrainBattlePartyPos_009_3c60b4fd-1440-40da-889d-d8d0030215b1, 1);

PROC
PROC_END_BrainBattle_TeleportParty((INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
SysCount("DB_END_BrainBattle_TeleportPositions", 2, _Var2, _Var1, _Var1)
AND
_Var1 > _Var2
THEN
PROC_END_BrainBattle_TeleportParty(1);

PROC
PROC_END_BrainBattle_TeleportParty((INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_PartyMembers(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
_Var2 != S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b
AND
_Var2 != S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e
AND NOT
DB_END_BrainBattle_Teleported(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
IntegerSum(_Var1, 1, _Var3, _Var1, _Var1)
AND
DB_END_BrainBattle_TeleportPositions(_Var4, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_Teleported(_Var2);
TeleportTo(_Var2, _Var4, "", 0, 0, 0, 1, 1);
LookFromTrigger(_Var2, _Var4, 1);
PROC_END_BrainBattle_TeleportParty(_Var3);

PROC
PROC_END_BrainBattle_TryEnterCombat((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
HasSpell(_Var1, "Target_END_Mindflayer_CrownDomination", 1, _Var1, _Var1)
THEN
ApplyStatus(_Var1, "END_KARSUSCOMPULSION_SPELLGLOW", -1, 1);

PROC
PROC_StartDialog_AddExtraSpeakers(END_BrainBattle_Intro_4565e114-0153-0449-ea83-de3b972c7679, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_END_BrainBattle_IntroExtraSpeakers(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_BrainBattle_CombatDaisy(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, _Var2, 0, 1);

PROC
PROC_StartDialog_AddExtraSpeakers(END_BrainBattle_Intro_4565e114-0153-0449-ea83-de3b972c7679, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_END_BrainBattle_ExtraSpeakerThrall(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, _Var2, 0, 1);

PROC
PROC_StartDialog_AddExtraSpeakers(END_BrainBattle_Intro_4565e114-0153-0449-ea83-de3b972c7679, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_PartyMembers(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

IF
FlagSet(END_BrainBattle_Event_GaleAscendsTheStalkAlone_217731da-1297-09b6-52b0-e9ee8580e70c, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_END_General_AssignMainAvatar(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604);

IF
DialogEnded(END_BrainBattle_Intro_4565e114-0153-0449-ea83-de3b972c7679, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
SetFlag(END_BrainBattle_Event_Started_3cd63c2e-7343-45dd-9137-4cabca2179a6, NULL_00000000-0000-0000-0000-000000000000, 0);
DB_END_BrainBattle_Start(1);
PROC_SetRelationToPlayers(ACT3_END_Netherbrain_04928f91-6658-431e-b652-65aea6403879, 0);

IF
DialogEnded(END_BrainBattle_Intro_4565e114-0153-0449-ea83-de3b972c7679, _, _, _, _)
AND NOT
DB_GlobalFlag(END_BrainBattle_Event_GaleAscendsTheStalkAlone_217731da-1297-09b6-52b0-e9ee8580e70c, _, _, _, _)
AND
DB_Players(_Var2, _, _, _, _)
THEN
PROC_ClearScreenFadeTimeline(_Var2, 0.5);

IF
CastSpell(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, "Shout_END_Gale_ActivateNethereseOrb", _, _, _)
THEN
PROC_END_General_AssignMainAvatar(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604);

IF
DB_END_BrainBattle_Enemies(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsCharacter(_Var1, 1, _Var1, _Var1, _Var1)
THEN
PROC_CharacterDisableAllCrimes(_Var1);

IF
DB_PartyMembers(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _, _, _, _)
THEN
TriggerRegisterForCharacter(S_END_BrainCombatEndCheckArea_c2343d09-4446-416c-a3e6-fff64ca563ad, S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

IF
DB_PartyMembers(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _, _, _, _)
THEN
TriggerRegisterForCharacter(S_END_BrainCombatEndCheckArea_c2343d09-4446-416c-a3e6-fff64ca563ad, S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

IF
RelationChanged(ACT3_END_Netherbrain_04928f91-6658-431e-b652-65aea6403879, Hero_a1542c81-6895-929e-4522-10ce218bb360, 0, _, _)
AND
DB_END_BrainBattle_Start(1, _, _, _, _)
AND
DB_PartyMembers(_Var2, _, _, _, _)
THEN
SetCombatGroupID(_Var2, "END_BrainBattle");
PROC_END_BrainBattle_TryEnterCombat(_Var2);

IF
EnteredTrigger((CHARACTER)_Var1, S_END_BrainBattleArea_b0cbe773-d02f-4074-8507-eab6033c3b27, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_Start(1, _Var1, _Var1, _Var1, _Var1)
AND
GetCombatGroupID(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
_Var2 != "END_BrainBattle"
THEN
SetCombatGroupID(_Var1, "END_BrainBattle");
PROC_END_BrainBattle_TryEnterCombat(_Var1);

PROC
PROC_END_BrainBattle_TryEnterCombat((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_Enemies(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Is_InCombat(_Var1, _, _Var1, _Var1, _Var1)
THEN
PROC_EnterCombat(_Var1, _Var2);

IF
DB_END_BrainBattle_Enemies(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetForceUpdate(_Var1, 1);
SetCombatGroupID(_Var1, "END_BrainBattle");

IF
DB_Is_InCombat(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Defeated(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_ActivePlayers(_Var2);

IF
DB_END_BrainBattle_ActivePlayers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Defeated(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_ActivePlayers(_Var1);

PROC
PROC_END_BrainBattle_TryJoinCombat((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_END_BrainBattle_ActivePlayers(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_EnterCombatRequested(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_EnterCombat(_Var1, _Var2);

PROC
PROC_StateSet_Defeated((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_END_BrainBattle_Enemies(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetForceUpdate(_Var1, 0);
NOT DB_END_BrainBattle_Enemies(_Var1);

IF
DB_END_BrainBattle_Start(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_KnockedOut(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TriggerUnregisterForCharacter(S_END_BrainCombatEndCheckArea_c2343d09-4446-416c-a3e6-fff64ca563ad, _Var1);
DB_END_BrainBattle_PermaDefeated(_Var1);

IF
DB_END_BrainBattle_Start(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Dead(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TriggerUnregisterForCharacter(S_END_BrainCombatEndCheckArea_c2343d09-4446-416c-a3e6-fff64ca563ad, _Var1);
DB_END_BrainBattle_PermaDefeated(_Var1);

IF
DB_END_BrainBattle_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Dead(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_KnockedOut(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TriggerRegisterForCharacter(S_END_BrainCombatEndCheckArea_c2343d09-4446-416c-a3e6-fff64ca563ad, _Var1);
NOT DB_END_BrainBattle_PermaDefeated(_Var1);

IF
DB_PartyMembers(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _, _, _, _)
THEN
TriggerRegisterForCharacter(S_END_BrainCombatEndCheckArea_c2343d09-4446-416c-a3e6-fff64ca563ad, S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

IF
DB_PartyMembers(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _, _, _, _)
THEN
TriggerRegisterForCharacter(S_END_BrainCombatEndCheckArea_c2343d09-4446-416c-a3e6-fff64ca563ad, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);

IF
DB_END_BrainBattle_Start(1, _, _, _, _)
AND NOT
DB_InRegion(_, S_END_BrainCombatEndCheckArea_c2343d09-4446-416c-a3e6-fff64ca563ad, _, _, _)
AND NOT
DB_END_BrainBattle_PausedCombat(_, _, _, _, _)
AND
QRY_OnlyOnce("END_BrainBattle_Cleared", _, _, _, _)
THEN
PROC_END_BrainBattle_ClearBrainBattle();

PROC
PROC_END_BrainBattle_ClearBrainBattle()
AND
DB_Is_InCombat(_Var1, _, _Var1, _Var1, _Var1)
AND
IsInTrigger(_Var1, S_END_BrainCombatEndCheckArea_c2343d09-4446-416c-a3e6-fff64ca563ad, 1, _Var1, _Var1)
THEN
SetForceUpdate(_Var1, 0);
SetCombatGroupID(_Var1, "");
LeaveCombat(_Var1);
SetCanJoinCombat(_Var1, 0);
SetCanFight(_Var1, 0);

PROC
PROC_END_BrainBattle_ClearBrainBattle()
AND
DB_END_BrainBattle_NautiloidCannons(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetForceUpdate(_Var1, 0);

PROC
PROC_END_BrainBattle_ClearBrainBattle()
AND
DB_END_BrainBattle_Enemies(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsInTrigger(_Var1, S_END_BrainCombatEndCheckArea_c2343d09-4446-416c-a3e6-fff64ca563ad, 1, _Var1, _Var1)
THEN
SetForceUpdate(_Var1, 0);
SetCombatGroupID(_Var1, "");
LeaveCombat(_Var1);
SetCanJoinCombat(_Var1, 0);
SetCanFight(_Var1, 0);

IF
EnteredCombat(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, _, (GUIDSTRING)_, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
TurnBasedTimerLaunch(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, "END_NautiloidCountdown", "END_NautiloidCountdown_Timer", 24000);

IF
TurnStarted(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, _, _, _, _)
THEN
PROC_END_BrainBattle_IncrementCrownTurn();

PROC
PROC_END_BrainBattle_IncrementCrownTurn()
AND
DB_END_BrainBattle_CrownTurn(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IntegerSum(_Var1, 1, _Var2, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_CrownTurn(_Var1);
DB_END_BrainBattle_CrownTurn(_Var2);

PROC
PROC_END_BrainBattle_IncrementCrownTurn()
AND
DB_END_BrainBattle_CrownTurn(4, _, _, _, _)
THEN
SetFlag(END_BrainBattle_Event_SummoningNautiloid_4941b0cc-c3f0-1aa4-36ab-0c0768090b07);

IF
EntityEvent(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, "END_BrainBattle_CameraTarget", _, _, _)
AND
DB_END_BrainBattle_CrownTurn(4, _, _, _, _)
THEN
TeleportTo(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, S_END_NautiloidCameraPos_b18891fe-a5b0-4c11-b3d5-f6f6391a6b39, "", 0, 0, 0, 0, 0);

IF
EntityEvent(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, "END_BrainBattle_CastSpell", _, _, _)
AND
DB_END_BrainBattle_CrownTurn(4, _, _, _, _)
THEN
PROC_END_BrainBattle_CrownSpell(S_END_NautiloidCameraPos_b18891fe-a5b0-4c11-b3d5-f6f6391a6b39, "Shout_END_Netherbrain_HellFromAbove");

PROC
PROC_END_BrainBattle_CrownSpell((GUIDSTRING)_Var1, "Shout_END_Netherbrain_HellFromAbove", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
UseSpell(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, "Shout_END_Netherbrain_HellFromAbove", S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a);

PROC
PROC_END_BrainBattle_CrownSpell((GUIDSTRING)_Var1, "Shout_END_Netherbrain_DraconicDomination", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
UseSpell(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, "Shout_END_Netherbrain_DraconicDomination", S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a);

PROC
PROC_END_BrainBattle_CrownSpell((GUIDSTRING)_Var1, "Target_END_Netherbrain_GraspFromBelow", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
UseSpell(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, "Target_END_Netherbrain_GraspFromBelow", _Var1);

IF
EntityEvent(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, "END_BrainBattle_CameraTarget", _, _, _)
AND
DB_END_BrainBattle_CrownTurn(2, _, _, _, _)
THEN
TeleportTo(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, S_END_DragonCameraPos_792709ca-d97a-4ad0-858f-6bf0bd377687, "", 0, 0, 0, 0, 0);

IF
EntityEvent(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, "END_BrainBattle_CastSpell", _, _, _)
AND
DB_END_BrainBattle_CrownTurn(2, _, _, _, _)
THEN
PROC_END_BrainBattle_CrownSpell(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, "Shout_END_Netherbrain_DraconicDomination");

IF
AutomatedDialogEnded(END_BrainBattle_AD_CrownTurn_52b8a6be-38bc-4da6-5d4c-42fe19783a4c, _, _, _, _)
AND
DB_END_BrainBattle_CrownTurn(4, _, _, _, _)
THEN
ApplyStatus(S_END_Crown_704f1e91-8d56-4772-98d8-54c5d8a6af20, "END_CROWN_CASTING_VFX", -1, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
TurnEnded(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, _, _, _, _)
THEN
RemoveStatus(S_END_Crown_704f1e91-8d56-4772-98d8-54c5d8a6af20, "END_CROWN_CASTING_VFX", NULL_00000000-0000-0000-0000-000000000000);
TeleportTo(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, S_END_Crown_704f1e91-8d56-4772-98d8-54c5d8a6af20, "", 0, 0, 0, 0, 0);

IF
DB_END_BrainBattle_BrainTentacles(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var1, 0);
PROC_TriggerRegisterForParty(_Var2);

IF
EnteredTrigger((CHARACTER)_Var1, (TRIGGER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_BrainTentacles(_Var3, _Var2, _Var1, _Var1, _Var1)
AND
IsOnStage(_Var3, 0, _Var1, _Var1, _Var1)
AND
GetUUID(_Var3, _Var4, _Var1, _Var1, _Var1)
AND
Concatenate("END_BrainBattle_SpawnTentacle_", _Var4, _Var5, _Var1, _Var1)
AND
QRY_OnlyOnce(_Var5, _Var1, _Var1, _Var1, _Var1)
THEN
AppearAt(_Var3, _Var3, 1, NULL_00000000-0000-0000-0000-000000000000, "", 0);
DB_END_BrainBattle_Enemies(_Var3);
PROC_TriggerUnregisterForParty(_Var2);

IF
DB_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_BrainBattle_BrainTentacles(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_BrainTentacles(_Var1, _Var2);

IF
CastedSpell((CHARACTER)_Var1, "Target_Fly_Dragon", _, _, _)
AND
DB_END_BrainBattle_BrainTentacles(_Var5, _, _Var1, _Var1, _Var1)
AND
IsOnStage(_Var5, 1, _Var1, _Var1, _Var1)
AND
GetDistanceTo(_Var1, _Var5, _Var7, _Var1, _Var1)
AND
_Var7 < 6
THEN
Die(_Var5, 0, _Var1, 1, 0);

IF
DB_END_BrainBattle_PodSpawnAreas(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TriggerRegisterForCharacter(_Var1, S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e);

IF
TextEvent("END_SpawnDragon", _, _, _, _)
THEN
PROC_END_BrainBattle_SpawnDragon();

PROC
PROC_END_BrainBattle_SpawnDragon()
THEN
DB_END_BrainBattle_QueuedSpawn(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e);
SetOnStage(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e, 1);
SetForceUpdate(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e, 1);
SetEntityEvent(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, "END_BrainBattle_SpawnedDragon");

IF
WentOnStage(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e, 1, _, _, _)
THEN
PlayAnimation(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e, CUST_Landing_01_72f2b73f-ab59-4ea7-99fa-ac1c8b298e80, "");

IF
StatusRemoved(S_END_Dragon_823861a5-0132-4d15-b9f1-9bac2fa2e85e, "END_NETHERBRAIN_DRAGONDOMINATION", _, _, (GUIDSTRING)_)
THEN
PROC_SetRelationMutual(ACT3_END_Dragon_c43260b4-b04a-44df-814d-662bf64ff602, ACT3_END_Netherbrain_04928f91-6658-431e-b652-65aea6403879, 0);
PROC_SetRelationToPlayers(ACT3_END_Dragon_c43260b4-b04a-44df-814d-662bf64ff602, 100);

PROC
PROC_END_BrainBattle_CrownSpell((GUIDSTRING)_Var1, "Shout_END_Netherbrain_HellFromAbove", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
PROC_END_BrainBattle_SpawnNautiloid();

PROC
PROC_END_HellFromAbove_DecideStrike((TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1)
AND NOT
DB_END_HellFromAbove_QueuedPod(_, _, _, _Var1, _Var1)
AND
GetPosition(_Var1, _Var5, _Var6, _Var7, _Var1)
THEN
DB_END_HellFromAbove_SetTarget(_Var1);
DB_END_HellFromAbove_QueuedPod(_Var5, _Var6, _Var7);
PROC_END_NautiloidStrike_SetTarget(_Var5, _Var7, 1);

PROC
PROC_END_HellFromAbove_DecideStrike((TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1)
AND NOT
DB_END_HellFromAbove_SetTarget(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetPosition(_Var1, _Var2, _Var3, _Var4, _Var1)
THEN
DB_END_HellFromAbove_SetTarget(_Var1);
PROC_END_NautiloidStrike_SetTarget(_Var2, _Var4);

PROC
PROC_END_BrainBattle_SpawnNautiloid()
THEN
ApplyStatus(S_END_Nautiloid_002_f50dc928-bb2d-48b6-a2dd-98fce0a47d28, "END_NAUTILOID_SPAWN_VFX", -1, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
StatusApplied(S_END_Nautiloid_002_f50dc928-bb2d-48b6-a2dd-98fce0a47d28, "END_NAUTILOID_SPAWN_VFX", _, _, (GUIDSTRING)_)
THEN
TeleportTo(S_END_Nautiloid_002_f50dc928-bb2d-48b6-a2dd-98fce0a47d28, S_END_BrainNautiloidPos_d7fb3435-99f8-4e54-b428-5a03c15aee89, "");
SetForceUpdate(S_END_Nautiloid_002_f50dc928-bb2d-48b6-a2dd-98fce0a47d28, 1);
DB_END_BrainBattle_Enemies(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a);
PROC_END_BrainBattle_TryJoinCombat(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a);

PROC
PROC_END_BrainBattle_TryJoinCombat(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_NautiloidCannons(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetOnStage(_Var1, 1);
SetForceUpdate(_Var1, 1);

IF
EnteredCombat(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a, _, _, _, _)
AND
DB_END_BrainBattle_NautiloidTurn(_Var2, _, _, _, _)
THEN
PROC_END_HellFromAbove_SeekTargets(_Var2);

IF
EntityEvent(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a, "END_BrainBattle_Turn", _, _, _)
THEN
PROC_END_BrainBattle_IncrementNautiloidTurn();

PROC
PROC_END_BrainBattle_IncrementNautiloidTurn()
AND
DB_END_BrainBattle_NautiloidTurn(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IntegerSum(_Var1, 1, _Var2, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_NautiloidTurn(_Var1);
DB_END_BrainBattle_NautiloidTurn(_Var2);

IF
EntityEvent(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a, "END_BrainBattle_CameraTarget", _, _, _)
THEN
TeleportTo(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a, S_END_NautiloidStrikeCameraPos_4d4689c2-ab9a-47e2-810f-468c6ba3a066, "", 0, 0, 0, 0, 0);

IF
EntityEvent(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a, "END_BrainBattle_CastSpell2", (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_END_BrainBattle_NautiloidTurn(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_HellFromAbove_SeekTargets(_Var1);

PROC
PROC_END_HellFromAbove_SeekTargets((INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
IntegerModulo(_Var1, 3, _Var2, _Var1, _Var1)
AND
DB_END_BrainBattle_NautiloidStrikeSets(_Var3, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_END_HellFromAbove_DecideStrike(_Var3);

IF
EntityEvent(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a, "END_BrainBattle_FireCannons", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SendArenaCameraEvent(S_END_Nautiloid_002_f50dc928-bb2d-48b6-a2dd-98fce0a47d28, _Var1, "END_BrainBattle_CINE_NautiloidFires");

IF
EntityEvent(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a, "END_BrainBattle_CastSpell", (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_END_BrainBattle_NautiloidTurn(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IntegerModulo(_Var1, 2, _Var2, _Var1, _Var1)
THEN
TeleportTo(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a, S_END_NautiloidStrikeCameraPos_4d4689c2-ab9a-47e2-810f-468c6ba3a066, "", 0, 0, 0, 0, 0);
PROC_END_NautiloidStrike_FireAll();
PROC_END_HellFromAbove_FirePod(_Var2);

PROC
PROC_END_HellFromAbove_FirePod(0, _, _, _, _)
THEN
PROC_END_NautiloidStrike_FireDropPods(0);

PROC
PROC_END_HellFromAbove_FirePod(1, _, _, _, _)
THEN
PROC_END_NautiloidStrike_FireDropPods(1);

PROC
PROC_END_HellFromAbove_FirePod((INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_END_HellFromAbove_QueuedPod(_Var2, _Var3, _Var4, _Var1, _Var1)
THEN
NOT DB_END_HellFromAbove_QueuedPod(_Var2, _Var3, _Var4);

PROC
PROC_END_NautiloidStrike_FireAll()
AND
DB_END_HellFromAbove_SetTarget(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_HellFromAbove_SetTarget(_Var1);

IF
TurnEnded(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a, _, _, _, _)
THEN
TeleportTo(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a, S_END_FireCannonsCameraPos_49c42cb5-1550-4b6f-ba2d-7e09d59b2cba, "", 0, 0, 0, 0, 0);

IF
EnteredCombat(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a, _, (GUIDSTRING)_, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
TeleportTo(S_END_NautiloidHelper_f61c2ece-f92e-4707-b6e4-eae37437990a, S_END_FireCannonsCameraPos_49c42cb5-1550-4b6f-ba2d-7e09d59b2cba, "", 0, 0, 0, 0, 0);

PROC
PROC_END_NautiloidStrike_DropPodCharSet((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
IsInTrigger(_Var1, S_END_BrainBattleArea_b0cbe773-d02f-4074-8507-eab6033c3b27, 1, _Var1, _Var1)
THEN
DB_END_BrainBattle_Enemies(_Var1);

PROC
PROC_END_NautiloidStrike_IntDevPodCharSet((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
IsInTrigger(_Var1, S_END_BrainBattleArea_b0cbe773-d02f-4074-8507-eab6033c3b27, 1, _Var1, _Var1)
THEN
RequestSetSwarmGroup(_Var1, "END_BrainBattle_IntDevs");
SetFaction(_Var1, ACT3_END_Netherbrain_04928f91-6658-431e-b652-65aea6403879);

IF
WentOnStage((GUIDSTRING)_Var1, 1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_END_BrainBattle_QueuedSpawn(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_QueuedSpawn(_Var1);
PROC_END_BrainBattle_Spawned(_Var1);

PROC
PROC_END_BrainBattle_Spawned((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
DB_END_BrainBattle_Enemies(_Var1);

IF
CastedSpell(_, "Target_END_Mindflayer_CrownDomination", _, _, _)
AND NOT
DB_GlobalFlag(END_BrainBattle_Event_CompulsionAttempt_91f9cf79-2ba8-ce1c-9380-4282464328be, _, _, _, _)
THEN
SetFlag(END_BrainBattle_Event_CompulsionAttempt_91f9cf79-2ba8-ce1c-9380-4282464328be, NULL_00000000-0000-0000-0000-000000000000, 0);

IF
FlagSet(END_BrainBattle_Event_CompulsionAttempt_91f9cf79-2ba8-ce1c-9380-4282464328be, _, _, _, _)
AND
DB_END_BrainBattle_Enemies_MindFlayerArcanists(_Var3, _, _, _, _)
THEN
SetStayInAiHints(_Var3, 0);
SetAiHint(_Var3, NULL_00000000-0000-0000-0000-000000000000);

IF
TurnStarted((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
HasActiveStatus(_Var1, "END_KARSUSCOMPULSION_CHANNEL", 1, _Var1, _Var1)
THEN
DB_END_BrainBattle_DominationDone(1);

IF
GainedControl((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
HasActiveStatus(_Var1, "END_KARSUSCOMPULSION_CHANNEL", 1, _Var1, _Var1)
AND
DB_END_BrainBattle_DominationDone(1, _Var1, _Var1, _Var1, _Var1)
THEN
RemoveStatus(_Var1, "END_KARSUSCOMPULSION_CHANNEL");
ApplyStatus(S_END_Crown_704f1e91-8d56-4772-98d8-54c5d8a6af20, "END_KARSUSCOMPULSION_CHANNEL_TARGET_END", 1, 1);
PROC_END_BrainBattle_DominationUsed(_Var1);

IF
StatusRemoved((GUIDSTRING)_Var1, "END_KARSUSCOMPULSION_CHANNEL", _, _, (GUIDSTRING)_Var1)
THEN
RemoveStatus(S_END_Crown_704f1e91-8d56-4772-98d8-54c5d8a6af20, "END_KARSUSCOMPULSION_CHANNEL_TARGET");

PROC
PROC_END_BrainBattle_DominationUsed((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_END_General_AssignMainAvatar(_Var1);
DB_END_BrainBattle_DominationCharacter(_Var1);

PROC
PROC_END_BrainBattle_DominationUsed((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Is_InCombat(S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a, _Var2, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_PausedCombat(_Var2);
PauseCombat(_Var2);

PROC
PROC_END_BrainBattle_DominationUsed((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
SetFlag(END_BrainBattle_State_PortalOpen_d55bc4d7-eabb-1c01-88e4-28e3456bd1c7, NULL_00000000-0000-0000-0000-000000000000, 0);
SetOnStage(S_END_MindPortal_06463ecc-d906-4c7c-b4e0-41e69abccc36, 1);
SetForceUpdate(S_END_MindPortal_06463ecc-d906-4c7c-b4e0-41e69abccc36, 1);

IF
WentOnStage(S_END_MindPortal_06463ecc-d906-4c7c-b4e0-41e69abccc36, 1, _, _, _)
THEN
TimerLaunch("END_BrainBattle_StartMindFade", 2000);

IF
TimerFinished("END_BrainBattle_StartMindFade", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
ScreenFadeTo(_Var1, 1.5, 1, "END_BrainBattle_EnterMindFade");

IF
ScreenFadeDone(_, "END_BrainBattle_EnterMindFade", _, _, _)
AND
QRY_OnlyOnce("END_BrainBattle_ClearFade", _, _, _, _)
THEN
PROC_END_BrainBattle_FadeFinished();

IF
DialogStarted(END_BrainBattle_EnterMind_714b6fff-814f-ae03-f959-c15596aef2dd, _, _, _, _)
AND
DB_Players(_Var2, _, _, _, _)
THEN
ClearScreenFade(_Var2, 0.8, "END_BrainBattle_EnterMindFade");

IF
DialogStarted(END_BrainBattle_EnterMind_714b6fff-814f-ae03-f959-c15596aef2dd, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_END_BrainBattle_TeleportDominationCharacter();

PROC
PROC_END_BrainBattle_TeleportDominationCharacter()
AND
QRY_OnlyOnce("END_BrainBattle_TeleportDominationCharacter", _, _, _, _)
AND
DB_END_BrainBattle_DominationCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_EnterPortalAD(1);
DB_END_BrainBattle_PortalOpened(1);
DB_END_BrainBattle_QueueMindAD(_Var1);
TeleportTo(_Var1, S_END_MindPartyPos_8f6b2b6a-3c4c-45e9-8069-d728ecca47f0, "", 0, 0, 0, 0, 1);

IF
StatusApplied(_, "END_KARSUSCOMPULSION_CHANNEL", _, _, (GUIDSTRING)_)
THEN
DB_END_BrainBattle_OngoingDomination(1);

IF
StatusRemoved(_, "END_KARSUSCOMPULSION_CHANNEL", _, _, (GUIDSTRING)_)
THEN
NOT DB_END_BrainBattle_OngoingDomination(1);

PROC
PROC_END_BrainBattle_FadeFinished()
AND
QRY_OnlyOnce("END_BrainBattle_EnterMind", _, _, _, _)
AND
DB_END_BrainBattle_DominationCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_BrainBattle_EnterMindDialog(_Var1);

PROC
PROC_END_BrainBattle_EnterMindDialog(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
CharacterGetOwner(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_BrainBattle_EnterMind_714b6fff-814f-ae03-f959-c15596aef2dd, S_GLO_Netherbrain_3858e896-d7dd-4699-b37d-d3919ff15ba7, NULL_00000000-0000-0000-0000-000000000000, S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _Var1, 0, 0, 0, 0, _Var1)
THEN
DB_END_BrainBattle_EnterMindScene(1);

PROC
PROC_END_BrainBattle_EnterMindDialog(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
CharacterGetOwner(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_BrainBattle_EnterMind_714b6fff-814f-ae03-f959-c15596aef2dd, S_GLO_Netherbrain_3858e896-d7dd-4699-b37d-d3919ff15ba7, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, NULL_00000000-0000-0000-0000-000000000000, _Var1, 0, 0, 0, 0, _Var1)
THEN
DB_END_BrainBattle_EnterMindScene(1);

PROC
PROC_END_BrainBattle_EnterMindDialog((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_StartDialogCustom(END_BrainBattle_EnterMind_714b6fff-814f-ae03-f959-c15596aef2dd, S_GLO_Netherbrain_3858e896-d7dd-4699-b37d-d3919ff15ba7, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, _Var1, 0, 0, 0, 0, _Var1)
THEN
DB_END_BrainBattle_EnterMindScene(1);

PROC
PROC_END_BrainBattle_EnterMindDialog((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_END_BrainBattle_EnterMindScene(1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_BrainBattle_EnterMind(_Var1);

IF
DialogEnded(END_BrainBattle_EnterMind_714b6fff-814f-ae03-f959-c15596aef2dd, _, _, _, _)
AND
DB_END_BrainBattle_DominationCharacter(_Var2, _, _, _, _)
THEN
PROC_END_BrainBattle_EnterMind(_Var2);
MusicPlayGeneral("Netherbrain_combat_Part_2");

PROC
PROC_END_BrainBattle_EnterMind((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_PausedCombat(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_PausedCombat(_Var2);
ResumeCombat(_Var2);
RemoveStatus(_Var1, "END_KARSUSCOMPULSION_SPELLGLOW");

PROC
PROC_END_BrainBattle_EnterMind((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
SetForceUpdate(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, 1);
SetForceUpdate(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, 1);
SetCombatGroupID(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, "END_BrainBattle");
EnterCombat(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, _Var1);
RemoveSpell(_Var1, "Shout_END_AllyAbilities_MultipleSummon", 1);

IF
EnteredCombat(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, _, (GUIDSTRING)_, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
TurnBasedTimerCancel(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, "END_NautiloidCountdown");
TimerLaunch("END_Mindcountdown_Delay", 1000);

IF
TimerFinished("END_Mindcountdown_Delay", _, _, _, _)
THEN
TurnBasedTimerLaunch(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, "END_MindCountdown", "END_MindCountdown_Timer", 30000);

IF
UseStarted((CHARACTER)_Var1, S_END_MindPortal_06463ecc-d906-4c7c-b4e0-41e69abccc36, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_END_BrainBattle_UsedMindTeleporter(_Var1);

PROC
PROC_END_BrainBattle_UsedMindTeleporter((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
DB_END_BrainBattle_QueuedTeleportToMind(_Var1);

PROC
PROC_END_BrainBattle_UsedMindTeleporter((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_MindSpawnPoints(_Var2, _Var3, _Var1, _Var1, _Var1)
AND
DB_END_BrainBattle_QueuedTeleportToMind(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
HasActiveStatus(_Var3, "OBLITERATIONORB", 0, _Var1, _Var1)
AND NOT
QRY_END_BrainBattle_IsMindTargetInvalid(_Var2, _Var1, _Var3, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_QueuedTeleportToMind(_Var1);
RemoveSpell(_Var1, "Shout_END_AllyAbilities_MultipleSummon", 1);
PlayEffect(_Var1, VFX_Script_END_MindArena_TeleportIn_01_99f45f51-1c30-84ee-003f-d44be42e71c0, "Dummy_Root");
TeleportTo(_Var1, _Var2, "END_MindBattle_TeleportedTo", 0, 0, 0, 0, 1);

PROC
PROC_END_BrainBattle_UsedMindTeleporter((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_MindSpawnPoints(_Var2, _Var3, _Var1, _Var1, _Var1)
AND
DB_END_BrainBattle_QueuedTeleportToMind(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
HasActiveStatus(_Var3, "OBLITERATIONORB", 1, _Var1, _Var1)
AND NOT
QRY_END_BrainBattle_IsMindTargetInvalid(_Var2, _Var1, _Var3, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_QueuedTeleportToMind(_Var1);
PlayEffect(_Var1, VFX_Script_END_MindArena_TeleportIn_01_99f45f51-1c30-84ee-003f-d44be42e71c0, "Dummy_Root");
TeleportTo(_Var1, _Var2, "END_MindBattle_TeleportedTo", 0, 0, 0, 0, 1);

IF
EntityEvent((CHARACTER)_Var1, "END_MindBattle_TeleportedTo", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyFollowers(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
CharacterGetOwner(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_AllyAbilities_Summons(_, _, _Var2, _, _Var1)
THEN
RemovePartyFollower(_Var2, _Var1);

QRY
QRY_END_BrainBattle_IsMindTargetInvalid((TRIGGER)_Var1, (GUIDSTRING)_Var2, (ITEM)_Var3, (TRIGGER)_Var1, (TRIGGER)_Var1)
AND
GetPosition(_Var1, _Var4, _Var5, _Var6, _Var1)
AND NOT
FindValidPosition(_Var4, _Var5, _Var6, 1, _Var2, 0, _, _, _, _Var1)
THEN
NOT DB_END_BrainBattle_MindSpawnPoints(_Var1, _Var3);

IF
DestroyedBy((ITEM)_Var1, _, _, _, (ITEM)_Var1)
AND
DB_END_BrainBattle_MindSpawnPoints(_Var5, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_MindSpawnPoints(_Var5, _Var1);

IF
DestroyedBy((ITEM)_Var1, _, _, _, (ITEM)_Var1)
AND
DB_END_MindBattle_Ladders(_Var5, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_MindBattle_DestroyLadder(_Var5);

PROC
PROC_END_MindBattle_DestroyLadder((ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
THEN
Die(_Var1);

PROC
PROC_END_MindBattle_DestroyLadder((ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_END_MindBattle_Ladders(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
NOT DB_END_MindBattle_Ladders(_Var1, _Var2);

IF
DestroyedBy((ITEM)_Var1, _, _, _, (ITEM)_Var1)
AND
DB_END_MindBattle_Platforms(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_MindBattle_Platforms(_Var1);
PROC_END_MindBattle_CheckRemainingPlatforms();

PROC
PROC_END_MindBattle_CheckRemainingPlatforms()
AND
SysCount("DB_END_MindBattle_Platforms", 1, _Var1, _Var1, _Var1)
AND
IntegerToString(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
Concatenate(_Var2, " remaining platforms!", _Var3, _Var1, _Var1)
THEN
DebugBreak(_Var3);

IF
DB_END_MindBattle_OrbHelpers(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
AiAddInterestingItem(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, _Var1);

PROC
PROC_END_BrainBattle_CheckMindGameOver(5, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_MainDialogAnchor(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_BlockChainGameOver(1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(GLO_ThrallOfTheAbsolute_Event_EndingLost_56da89f9-916b-076f-d6c1-035a9ac39cb8, _Var1, 0);

PROC
PROC_END_BrainBattle_TryPauseCombatForGameOver()
AND
DB_Is_InCombat(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, _Var1, _Var1, _Var1, _Var1)
THEN
PauseCombat(_Var1);

IF
HitProxy(S_END_Netherbrain_HitboxProxy_003_37f2b1cc-992c-4298-aaf3-84e8b6c6fe0a, _, _, _, _)
AND NOT
DB_END_MindBrain_IsPlayingHitAnimation(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, _, _, _, _)
THEN
DB_END_MindBrain_IsPlayingHitAnimation(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1);
PlayAnimation(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, REAC_Magic_External_Combat_01_5f127742-79d4-4590-839f-6eb5ae45930d, "END_Netherbrain_FinishedPlayingHitAnimation");
PROC_END_Netherbrain_PlayHitAnimation();

IF
HitProxy(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, _, _, _, _)
AND NOT
DB_END_MindBrain_IsPlayingHitAnimation(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, _, _, _, _)
THEN
DB_END_MindBrain_IsPlayingHitAnimation(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1);
PlayAnimation(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, REAC_Magic_External_Combat_01_5f127742-79d4-4590-839f-6eb5ae45930d, "END_Netherbrain_FinishedPlayingHitAnimation");
PROC_END_Netherbrain_PlayHitAnimation();

IF
HitProxy(S_END_Netherbrain_HitboxProxy_001_49e7f225-6fa9-4f86-b03b-b8282a2bba20, _, _, _, _)
AND NOT
DB_END_MindBrain_IsPlayingHitAnimation(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, _, _, _, _)
THEN
DB_END_MindBrain_IsPlayingHitAnimation(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1);
PlayAnimation(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, REAC_Hit_R_Combat_01_96577b02-b66b-425f-9aaf-308d45864de9, "END_Netherbrain_FinishedPlayingHitAnimation");
PROC_END_Netherbrain_PlayHitAnimation();

IF
HitProxy(S_END_Netherbrain_HitboxProxy_002_238679d4-f051-4b4f-bd50-5809c9e5893a, _, _, _, _)
AND NOT
DB_END_MindBrain_IsPlayingHitAnimation(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, _, _, _, _)
THEN
DB_END_MindBrain_IsPlayingHitAnimation(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1);
PlayAnimation(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, REAC_Hit_L_Combat_01_50980969-7e1c-490e-ab33-0f00d383bafa, "END_Netherbrain_FinishedPlayingHitAnimation");
PROC_END_Netherbrain_PlayHitAnimation();

PROC
PROC_END_Netherbrain_PlayHitAnimation()
AND
GetHitpointsPercentage(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 > 0
THEN
DB_END_MindBrain_IsPlayingHitAnimation(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759);
PlayAnimation(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, REAC_Hit_F_Combat_01_Head_b568aa07-de7e-4737-90b4-0f252613bdef, "END_Netherbrain_FinishedPlayingHitAnimation");

IF
EntityEvent((CHARACTER)_Var1, "END_Netherbrain_FinishedPlayingHitAnimation", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_MindBrain_IsPlayingHitAnimation(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_MindBrain_IsPlayingHitAnimation(_Var1);

IF
UsingSpellOnTarget((GUIDSTRING)_Var1, (GUIDSTRING)_Var2, "Target_PsionicRebuke_Netherbrain", _, _, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
PROC_LoopEffect(VFX_Script_Brainquake_NoOffset_01_0d5c292e-0eca-5117-bdc5-75a56b1e5eb7, _Var1, "END_BrainBattle_PsionicRebuke", "END_Main", "", 0.010);
RealtimeObjectTimerLaunch(_Var1, "END_BrainBattle_PsionicRebuke_Timer", 5000);

IF
ObjectTimerFinished((GUIDSTRING)_Var1, "END_BrainBattle_PsionicRebuke_Timer", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
PROC_StopLoopEffect(_Var1, "END_BrainBattle_PsionicRebuke");

IF
CastSpell(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, "Target_ObliterationOrb_Netherbrain", _, _, _)
THEN
SetEntityEventReal(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, "GLO_CombatWait", 1.6);

IF
FlagSet(END_MorphicPool_Event_99RollSuccess_dfd232ba-165f-4472-ab46-ae45778642f7, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
ApplyStatus(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, "END_NETHERBRAIN_MORPHICPOOLWOUND", -1, 1);
PROC_SetHitpointsPercentage_BlockSelfHealing(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, 80);

IF
HitpointsChanged(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, (REAL)_Var1, (REAL)_Var1, (REAL)_Var1, (REAL)_Var1)
THEN
SetHitpointsPercentage(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, _Var1);

IF
Dying(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Is_InCombat(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_BlockChainGameOver(1);
PROC_END_MindBattle_MindDeathSetup(_Var1);

PROC
PROC_END_MindBattle_MindDeathSetup((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
TurnBasedTimerCancel(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, "END_MindCountdown");
PlayAnimation(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, DIE_Generic_KO_01_8145f891-e1f3-4510-b166-d974ef1c3896, "");
SetFlag(END_BrainBattle_Event_DeathCry_827e3129-d67e-ff16-c27a-952e9cf96f2b, NULL_00000000-0000-0000-0000-000000000000, 0);
PROC_TryStartAD(END_BrainBattle_AD_MindBrainTurn_fbc23a61-dd88-ca19-81ed-9578236a9b27, S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1);
DB_END_BrainBattle_PausedMindCombat(_Var1);
PauseCombat(_Var1);
TimerLaunch("END_MindBattle_Over", 7000);
MusicPlayGeneral("Netherbrain_combat_Victory");

IF
TimerFinished("END_MindBattle_Over", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_END_BrainBattle_PausedMindCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_BrainBattle_ClearBrainBattle();
EndCombat(_Var1);
PROC_SetRelationToPlayers(ACT3_END_Netherbrain_04928f91-6658-431e-b652-65aea6403879, 50);
SetImmortal(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, 0);
Die(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759);

IF
Died(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, _, _, _, _)
AND
QRY_OnlyOnce("END_MindBattle_Over", _, _, _, _)
AND
DB_END_BrainBattle_DominationCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_BrainBattle_QueueFullRestore(_Var1);
DB_END_BrainBattle_DominationCompletedReady(1);

IF
Died(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, _, _, _, _)
AND
QRY_OnlyOnce("END_MindBattle_Over", _, _, _, _)
AND
DB_END_BrainBattle_DominationCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_BrainBattle_QueueFullRestore(_Var1);
DB_END_BrainBattle_DominationCompletedReady(1);

IF
Dying(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Is_InCombat(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
IsItem(_Var2, 1, _Var1, _Var1, _Var1)
AND
HasActiveStatus(_Var2, "OBLITERATIONORB_AURA", 1, _Var1, _Var1)
THEN
SetOnStage(_Var2, 0);

IF
Dying(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Is_InCombat(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
IsItem(_Var2, 1, _Var1, _Var1, _Var1)
AND
HasActiveStatus(_Var2, "OBLITERATIONORB_AURA", 1, _Var1, _Var1)
THEN
SetOnStage(_Var2, 0);

IF
DB_END_BrainBattle_QueuedRestoreCharacters(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetCanJoinCombat(_Var1, 0);
SetCanFight(_Var1, 0);
PROC_CharacterFullRestore(_Var1);

IF
DB_END_BrainBattle_QueuedRestoreCharacters(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_CantAct(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Defeated(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_QueuedRestoreCharacters(_Var1);

PROC
PROC_END_BrainBattle_QueueFullRestore((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_QueuedRestoreCharacters(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);

PROC
PROC_END_BrainBattle_QueueFullRestore((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_QueuedRestoreCharacters(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

PROC
PROC_END_BrainBattle_QueueFullRestore((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_QueuedRestoreCharacters(_Var2);

IF
DB_END_BrainBattle_DominationCompletedReady(1, _, _, _, _)
AND NOT
DB_END_BrainBattle_QueuedRestoreCharacters(_, _, _, _, _)
AND
DB_END_BrainBattle_DominationCharacter(_Var2, _, _, _, _)
THEN
PROC_END_General_AssignMainAvatar(_Var2);
PROC_END_BrainBattle_DominationCompleted(_Var2);

PROC
PROC_END_BrainBattle_DominationCompleted((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_RemoveMutingStatusses(_Var2);

PROC
PROC_END_BrainBattle_DominationCompleted((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_MainDialogAnchor(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_BrainBattle_FinalDecision_e5feae67-c6f1-1827-e9d6-a6b34647c8ea, S_GLO_Netherbrain_3858e896-d7dd-4699-b37d-d3919ff15ba7, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, _Var2, 0, 0, 0, 0, _Var1)
THEN
DB_END_BrainBattle_FinalDecisionScene(1);

PROC
PROC_END_BrainBattle_DominationCompleted((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Avatars(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_General_MainDialogAnchor(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_FinalDecisionScene(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_BrainBattle_FinalDecision_e5feae67-c6f1-1827-e9d6-a6b34647c8ea, S_GLO_Netherbrain_3858e896-d7dd-4699-b37d-d3919ff15ba7, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, _Var2, 0, 0, 0, 0, _Var1)
THEN
DB_END_BrainBattle_FinalDecisionScene(1);

PROC
PROC_END_BrainBattle_DominationCompleted((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Avatars(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_FinalDecisionScene(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_BrainBattle_FinalDecision_e5feae67-c6f1-1827-e9d6-a6b34647c8ea, S_GLO_Netherbrain_3858e896-d7dd-4699-b37d-d3919ff15ba7, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, _Var2, 0, 0, 0, 0, _Var1)
THEN
DB_END_BrainBattle_FinalDecisionScene(1);

IF
DialogStarted(END_BrainBattle_FinalDecision_e5feae67-c6f1-1827-e9d6-a6b34647c8ea, _, _, _, _)
AND
DB_END_BrainBattle_Enemies(_Var2, _, _, _, _)
THEN
SetOnStage(_Var2, 0);

PROC
PROC_END_BrainBattle_DominationCompleted((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
RemoveAllPartyFollowers(_Var2);

PROC
PROC_END_BrainBattle_DominationCompleted((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_DominationCharacter(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_FinalDecisionScene(1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_BrainBattle_BrainDestructionScene();

IF
DialogEnded(END_BrainBattle_FinalDecision_e5feae67-c6f1-1827-e9d6-a6b34647c8ea, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_END_BrainBattle_ProcessFinalDecision();

PROC
PROC_END_BrainBattle_ProcessFinalDecision()
AND
DB_GlobalFlag(END_BrainBattle_Event_EvilFinalDecision_71617aed-6f56-ad38-5657-189de2628cc8, _, _, _, _)
AND
DB_END_General_MainDialogAnchor(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_ORI_DarkUrge(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GlobalSetFlagAndCache(ORI_DarkUrge_State_FinalDecisionForBhaal_a7683d15-4bca-4c96-a158-225acb497a8e);

PROC
PROC_END_BrainBattle_ProcessFinalDecision()
AND
DB_GlobalFlag(END_BrainBattle_Event_EvilFinalDecision_71617aed-6f56-ad38-5657-189de2628cc8, _, _, _, _)
AND
DB_END_General_MainDialogAnchor(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_GodsAndMonsters_RollCredits("END_GodsAndMonsters_GameFinished");

PROC
PROC_END_BrainBattle_ProcessFinalDecision()
AND NOT
DB_GlobalFlag(END_BrainBattle_Event_EvilFinalDecision_71617aed-6f56-ad38-5657-189de2628cc8, _, _, _, _)
THEN
PROC_END_BrainBattle_BrainDestructionScene();

PROC
PROC_END_BrainBattle_BrainDestructionScene()
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var1, S_END_DestructionOfBrainPos_46fc7d18-5357-449f-bb04-1df7948e0bfd, "");

PROC
PROC_END_BrainBattle_BrainDestructionScene()
AND
DB_END_General_MainDialogAnchor(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_BrainBattle_DestructionOfBrain_5180d955-3d53-ee59-ce74-5866c5be8cd2, S_GLO_Netherbrain_3858e896-d7dd-4699-b37d-d3919ff15ba7, _Var1, 0, 0, 0, 0, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_BrainDestructionScene(1);

PROC
PROC_END_BrainBattle_BrainDestructionScene()
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_BrainDestructionScene(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_BrainBattle_DestructionOfBrain_5180d955-3d53-ee59-ce74-5866c5be8cd2, S_GLO_Netherbrain_3858e896-d7dd-4699-b37d-d3919ff15ba7, _Var1, 0, 0, 0, 0, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_BrainDestructionScene(1);

PROC
PROC_END_BrainBattle_BrainDestructionScene()
AND NOT
DB_END_BrainBattle_BrainDestructionScene(1, _, _, _, _)
THEN
PROC_END_BrainBattle_RevelryScene();

PROC
PROC_StartDialog_AddExtraSpeakers(END_BrainBattle_DestructionOfBrain_5180d955-3d53-ee59-ce74-5866c5be8cd2, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_END_RealPartOfTheTeam(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);

PROC
PROC_StartDialog_AddExtraSpeakers(END_BrainBattle_DestructionOfBrain_5180d955-3d53-ee59-ce74-5866c5be8cd2, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_END_RealPartOfTheTeam(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

IF
DialogEnded(END_BrainBattle_DestructionOfBrain_5180d955-3d53-ee59-ce74-5866c5be8cd2, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_END_BrainBattle_RevelryScene();

PROC
PROC_END_BrainBattle_RevelryScene()
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
RemoveStatus(_Var1, "TAD_PARTIAL_CEREMORPH", _Var1);

PROC
PROC_END_BrainBattle_RevelryScene()
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
RemoveSplatters(_Var1);

PROC
PROC_END_BrainBattle_RevelryScene()
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var1, S_END_CombatOverPos_8546debd-36b5-461e-971a-9cf6c2e67bbb, "");

PROC
PROC_END_BrainBattle_RevelryScene()
AND
DB_END_RealPartOfTheTeam(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var1, S_END_CombatOverPos_8546debd-36b5-461e-971a-9cf6c2e67bbb, "");

PROC
PROC_END_BrainBattle_RevelryScene()
AND
DB_END_General_MainDialogAnchor(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_GameFinale_TheHerosRevelry_ecd7cb66-d650-d92a-118f-6be977c4b0b2, _Var1, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_RevelryScene(1);

PROC
PROC_END_BrainBattle_RevelryScene()
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_RevelryScene(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_GameFinale_TheHerosRevelry_ecd7cb66-d650-d92a-118f-6be977c4b0b2, _Var1, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_RevelryScene(1);

PROC
PROC_END_BrainBattle_RevelryScene()
AND NOT
DB_END_BrainBattle_RevelryScene(1, _, _, _, _)
THEN
PROC_END_BrainBattle_CombatOverScene();

PROC
PROC_StartDialog_AddExtraSpeakers(END_GameFinale_TheHerosRevelry_ecd7cb66-d650-d92a-118f-6be977c4b0b2, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_END_RealPartOfTheTeam(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);

PROC
PROC_StartDialog_AddExtraSpeakers(END_GameFinale_TheHerosRevelry_ecd7cb66-d650-d92a-118f-6be977c4b0b2, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_END_RealPartOfTheTeam(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

IF
DialogEnded(END_GameFinale_TheHerosRevelry_ecd7cb66-d650-d92a-118f-6be977c4b0b2, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_END_BrainBattle_CombatOverScene();

PROC
PROC_END_BrainBattle_CombatOverScene()
AND
DB_END_General_MainDialogAnchor(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_BrainBattle_CombatOver_8cb159d3-3390-4e58-a0ae-8414628bb813, _Var1, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_CombatOverScene(1);

PROC
PROC_END_BrainBattle_CombatOverScene()
AND
DB_END_General_MainDialogAnchor(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Avatars(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
_Var2 != _Var1
AND NOT
DB_END_General_ForcedListener(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_CombatOverScene(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_BrainBattle_CombatOver_8cb159d3-3390-4e58-a0ae-8414628bb813, _Var2, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_CombatOverScene(1);

PROC
PROC_END_BrainBattle_CombatOverScene()
AND NOT
DB_END_BrainBattle_CombatOverScene(1, _, _, _, _)
THEN
PROC_END_BrainBattle_Over();

IF
DialogEnded(END_BrainBattle_CombatOver_8cb159d3-3390-4e58-a0ae-8414628bb813, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_END_BrainBattle_ClearEmperorOrpheus();
PROC_END_BrainBattle_Over();

PROC
PROC_END_BrainBattle_ClearEmperorOrpheus()
AND
DB_PartOfTheTeam(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _, _, _, _)
THEN
NOT DB_PartOfTheTeam(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);
NOT DB_PartyMembers(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);
NOT DB_END_RealPartOfTheTeam(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);

PROC
PROC_END_BrainBattle_ClearEmperorOrpheus()
AND
DB_PartOfTheTeam(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _, _, _, _)
THEN
NOT DB_PartOfTheTeam(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);
NOT DB_PartyMembers(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);
NOT DB_END_RealPartOfTheTeam(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

IF
DialogActorJoined(END_BrainBattle_CombatOver_8cb159d3-3390-4e58-a0ae-8414628bb813, _, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, (INTEGER)_)
THEN
SetFlag(END_CombatOver_State_LaezelInDialog_0108f646-e2c5-02f6-96ca-675c542114cc, NULL_00000000-0000-0000-0000-000000000000, 0);

IF
DialogActorJoined(END_BrainBattle_CombatOver_8cb159d3-3390-4e58-a0ae-8414628bb813, _, S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, _, _)
AND NOT
DB_Avatars(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, _, _, _, _)
THEN
SetFlag(END_BrainBattle_State_KarlachIsTheOnlyCompanion_9d788bc3-4bf5-b0a3-8a83-647622aaab67, NULL_00000000-0000-0000-0000-000000000000, 0);

IF
DB_GlobalFlag(END_BrainBattle_State_KarlachIsTheOnlyCompanion_9d788bc3-4bf5-b0a3-8a83-647622aaab67, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_General_PotentialInterjectionCandidate(_Var1, _, END_BrainBattle_CombatOver_8cb159d3-3390-4e58-a0ae-8414628bb813, _Var1, _Var1)
AND
_Var1 != S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c
THEN
ClearFlag(END_BrainBattle_State_KarlachIsTheOnlyCompanion_9d788bc3-4bf5-b0a3-8a83-647622aaab67, NULL_00000000-0000-0000-0000-000000000000, 0);

IF
DB_END_BrainBattle_Start(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_ADCandidates(_Var1);

IF
DB_END_BrainBattle_Start(1, _, _, _, _)
AND
DB_PartyMembers(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _, _, _, _)
THEN
DB_END_BrainBattle_ADCandidates(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);

IF
DB_END_BrainBattle_Start(1, _, _, _, _)
AND
DB_PartyMembers(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _, _, _, _)
THEN
DB_END_BrainBattle_ADCandidates(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

IF
DB_END_BrainBattle_Start(1, _, _, _, _)
THEN
DB_END_BrainBattle_FirstTurnAD(1);

IF
TurnStarted((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_ADCandidates(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_BrainBattle_ProcessTurnAD(_Var1);

PROC
PROC_END_BrainBattle_ProcessTurnAD((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_END_BrainBattle_ADOnTurn(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_BrainBattle_FirstTurnAD(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_END_BrainBattleArea_b0cbe773-d02f-4074-8507-eab6033c3b27, _Var1, _Var1, _Var1)
AND NOT
DB_CantTalk_IgnoreCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_FirstTurnAD(1);
PROC_END_BrainBattle_TryPlayerAD(END_BrainBattle_AD_FirstTurn_6786e4ca-d4ff-0351-6931-682118235705, _Var1);
DB_END_BrainBattle_ADOnTurn(_Var1);

PROC
PROC_END_BrainBattle_ProcessTurnAD((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_ADCandidates(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_BrainBattle_EnterPortalAD(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_END_BrainBattleArea_b0cbe773-d02f-4074-8507-eab6033c3b27, _Var1, _Var1, _Var1)
AND NOT
DB_CantTalk_IgnoreCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_ADOnTurn(_Var1);
NOT DB_END_BrainBattle_EnterPortalAD(1);
PROC_END_BrainBattle_TryPlayerAD(END_BrainBattle_AD_EnterPortal_e32b047f-9bfe-e30e-441c-cd964a4b2cd9, _Var1);

IF
CombatRoundStarted(_, (INTEGER)_Var2, _, _, _)
AND
DB_END_BrainBattle_Start(1, _, _, _, _)
AND
DB_END_BrainBattle_CrownTurn(2, _, _, _, _)
AND NOT
DB_END_BrainBattle_OngoingDomination(1, _, _, _, _)
AND NOT
DB_END_BrainBattle_PortalOpened(1, _, _, _, _)
AND NOT
DB_END_BrainBattle_QueuedHurryUpAD(_, _, _, _, _)
AND
_Var2 > 1
THEN
PROC_END_BrainBattle_FindHurryUpCharacter();

PROC
PROC_END_BrainBattle_FindHurryUpCharacter()
AND
DB_END_BrainBattle_HurryUpCandidate(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_HurryUpCandidate(_Var1);

PROC
PROC_END_BrainBattle_FindHurryUpCharacter()
AND
DB_END_BrainBattle_ADCandidates(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_CantTalk_IgnoreCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsTagged(_Var1, FULL_CEREMORPH_3797bfc4-8004-4a19-9578-61ce0714cc0b, 0, _Var1, _Var1)
THEN
DB_END_BrainBattle_HurryUpCandidate(_Var1);

PROC
PROC_END_BrainBattle_FindHurryUpCharacter()
AND
QRY_GetRandom("DB_END_BrainBattle_HurryUpCandidate", 1, "DB_END_BrainBattle_QueuedHurryUpAD", _, _)
THEN
DB_NOOP(1);

PROC
PROC_END_BrainBattle_FindHurryUpCharacter()
AND
DB_END_BrainBattle_ADCandidates(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_QueuedHurryUpAD(_, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_CantTalk_IgnoreCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsTagged(_Var1, FULL_CEREMORPH_3797bfc4-8004-4a19-9578-61ce0714cc0b, 1, _Var1, _Var1)
THEN
DB_END_BrainBattle_QueuedHurryUpAD(_Var1);

PROC
PROC_END_BrainBattle_ProcessTurnAD((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_QueuedHurryUpAD(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_ADOnTurn(_Var1);
NOT DB_END_BrainBattle_QueuedHurryUpAD(_Var1);
PROC_END_BrainBattle_TryPlayerAD(END_BrainBattle_AD_HurryUp_082ec0c4-51ab-5ab7-1282-9b38419b116d, _Var1);

PROC
PROC_END_BrainBattle_ProcessTurnAD((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_ADCandidates(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_BrainBattle_OngoingDomination(1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_CantTalk_IgnoreCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
HasActiveStatus(_Var1, "END_KARSUSCOMPULSION_CHANNEL", 0, _Var1, _Var1)
AND
QRY_OnlyOnce("END_BrainBattle_ProtectCasterAD", _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_ADOnTurn(_Var1);
PROC_END_BrainBattle_TryPlayerAD(END_BrainBattle_AD_ProtectCaster_ead8ed48-1bcb-8007-7346-75cfcde2faa0, _Var1);

IF
GainedControl((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_RapidMindMeld(1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_ADOnTurn(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsInTrigger(_Var1, S_END_BrainBattleArea_b0cbe773-d02f-4074-8507-eab6033c3b27, 1, _Var1, _Var1)
AND
Random(2500, _Var2, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_ADOnTurn(_Var1);
DB_END_BrainBattle_RapidMindMeldCount(_Var1, 2);
RealtimeObjectTimerLaunch(_Var1, "END_BrainBattle_RapidMindMeld", _Var2);

IF
ObjectTimerFinished((CHARACTER)_Var1, "END_BrainBattle_RapidMindMeld", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_END_MorphicPool_RapidMindMeldADCleanup();
PROC_END_MorphicPool_TryRapidMindMeldAD(_Var1, S_END_BrainBattleArea_b0cbe773-d02f-4074-8507-eab6033c3b27);

IF
ObjectTimerFinished((CHARACTER)_Var1, "END_MorphicPool_RapidMindMeldAD", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_RapidMindMeldCount(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
_Var2 > 0
AND
QRY_END_BrainBattle_RapidMindMeldCountAdjust(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_END_MorphicPool_RapidMindMeldADCleanup();
PROC_END_MorphicPool_TryRapidMindMeldAD(_Var1, S_END_BrainBattleArea_b0cbe773-d02f-4074-8507-eab6033c3b27);

QRY
QRY_END_BrainBattle_RapidMindMeldCountAdjust((CHARACTER)_Var1, (INTEGER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_RapidMindMeldCount(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
IntegerSubtract(_Var2, 1, _Var3, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_RapidMindMeldCount(_Var1, _Var2);
DB_END_BrainBattle_RapidMindMeldCount(_Var1, _Var3);

QRY
QRY_END_BrainBattle_RapidMindMeldCountAdjust((CHARACTER)_Var1, (INTEGER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_RapidMindMeldCount(_Var1, 0, _Var1, _Var1, _Var1)
THEN
NOT DB_END_BrainBattle_RapidMindMeldCount(_Var1, 0);

IF
DialogEnded(END_BrainBattle_EnterMind_714b6fff-814f-ae03-f959-c15596aef2dd, _, _, _, _)
AND
DB_END_BrainBattle_QueueMindAD(_Var2, _, _, _, _)
THEN
PROC_END_BrainBattle_TryPlayerAD(END_BrainBattle_AD_FirstMindTurn_df46df82-8d06-1e74-59bb-766c7c37d1ea, _Var2);

IF
TurnStarted(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, (REAL)_Var1, (REAL)_Var1, (REAL)_Var1, (REAL)_Var1)
AND
GetHitpointsPercentage(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 < 50
AND
QRY_OnlyOnce("END_MindBattle_LowHealthAD", _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(END_BrainBattle_Event_LowHealthBrain_10cc92be-132c-00ff-185b-78313f2a0e35, NULL_00000000-0000-0000-0000-000000000000, 0);

IF
EntityEvent((CHARACTER)_Var1, "END_MindBattle_TeleportedTo", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_END_BrainBattle_QueueMindAD(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_BrainBattle_TryPlayerAD(END_BrainBattle_AD_FirstMindTurn_df46df82-8d06-1e74-59bb-766c7c37d1ea, _Var1);

PROC
PROC_END_BrainBattle_TryPlayerAD((DIALOGRESOURCE)_Var1, (CHARACTER)_Var2, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(_Var1, _Var2);

PROC
PROC_END_BrainBattle_TryPlayerAD((DIALOGRESOURCE)_Var1, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
THEN
PROC_TryStartAD(_Var1, NULL_00000000-0000-0000-0000-000000000000, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);

PROC
PROC_END_BrainBattle_TryPlayerAD((DIALOGRESOURCE)_Var1, S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
THEN
PROC_TryStartAD(_Var1, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

IF
KilledBy(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, (CHARACTER)_Var1, _, _, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(END_BrainBattle_AD_KilledEmperor_e4c85c87-41e6-a9bd-aced-bb0223fecfc4, _Var1);

IF
KilledBy(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, (CHARACTER)_Var1, _, _, (CHARACTER)_Var1)
AND NOT
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsCharacter(_Var1, 1, _Var1, _Var1, _Var1)
AND
CharacterGetOwner(_Var1, _Var4, _Var1, _Var1, _Var1)
AND
DB_Players(_Var4, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(END_BrainBattle_AD_KilledEmperor_e4c85c87-41e6-a9bd-aced-bb0223fecfc4, _Var4);

IF
KilledBy(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, (ITEM)_Var1, _, _, (ITEM)_Var1)
AND
IsItem(_Var1, 1, _Var1, _Var1, _Var1)
AND
GetOwner(_Var1, _Var4, _Var1, _Var1, _Var1)
AND
DB_Players(_Var4, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(END_BrainBattle_AD_KilledEmperor_e4c85c87-41e6-a9bd-aced-bb0223fecfc4, _Var4);

IF
TurnEnded((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_BrainBattle_ADOnTurn(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
RealtimeObjectTimerCancel(_Var1, "END_BrainBattle_RapidMindMeld");
NOT DB_END_BrainBattle_ADOnTurn(_Var1);

IF
UsingSpell((GUIDSTRING)_Var1, (STRING)_Var2, _, _, _)
AND
DB_END_BrainBattle_CombatDaisy(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_BrainBattle_DaisySpells(_Var2, _Var6, _Var1, _Var1, _Var1)
AND NOT
DB_END_BrainBattle_DaisyADBlocked(1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_BrainBattle_DaisyADBlocked(1);
SetFlag(_Var6, _Var1, 0);
PROC_TryStartAD(END_BrainBattle_AD_DaisySpell_95def1af-6d80-5b5e-fa46-77dd2ab2b81f, _Var1);

IF
CombatRoundStarted(_, _, _, _, _)
AND
DB_END_BrainBattle_Start(1, _, _, _, _)
THEN
NOT DB_END_BrainBattle_DaisyADBlocked(1);

IF
TurnStarted(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _, _, _, _)
AND NOT
DB_PartyMembers(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _, _, _, _)
AND
DB_END_BrainBattle_Start(1, _, _, _, _)
THEN
PROC_TryStartAD(END_BrainBattle_AD_EnemyEmperor_bb2a48cc-8c22-0f9e-42a9-0038713a9c96, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);

IF
UsingSpellOnTarget(_, S_END_Crown_704f1e91-8d56-4772-98d8-54c5d8a6af20, "Target_END_Mindflayer_CrownDomination", _, _, _, _, _, _, _)
AND
QRY_OnlyOnce("END_BrainBattle_DominationReaction", _, _, _, _)
THEN
PROC_LoopEffect(VFX_Script_Brainquake_NoOffset_01_0d5c292e-0eca-5117-bdc5-75a56b1e5eb7, S_END_Crown_704f1e91-8d56-4772-98d8-54c5d8a6af20, "END_BrainBattle_DominationReaction", "END_Main", "", 1);
ObjectTimerLaunch(S_END_Crown_704f1e91-8d56-4772-98d8-54c5d8a6af20, "END_BrainBattle_DominationReaction", 5000);
SetFlag(END_BrainBattle_Event_DominatedCrown_f1fa578a-0b5d-9f1a-033b-e0e9e7c9293b, NULL_00000000-0000-0000-0000-000000000000, 0);
PROC_TryStartAD(END_BrainBattle_AD_CrownBeingDominated_2cfbe30d-a1c8-ccfc-b528-b3c2a54cd257, S_END_CrownProxy_b06e8326-a034-4480-8652-6a66b3bd7d0a);

IF
TurnEnded(S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759, _, _, _, _)
THEN
PROC_END_BrainBattle_ProcessEndOfMindBrainTurn();

PROC
PROC_END_BrainBattle_ProcessEndOfMindBrainTurn()
AND NOT
DB_END_BrainBattle_BrainBrokeChainThisTurn(1, _, _, _, _)
THEN
PROC_END_BrainBattle_ForceChainRemovalAtTurnEnd();

PROC
PROC_END_BrainBattle_ForceChainRemovalAtTurnEnd()
THEN
PROC_IncreaseCounter("END_BrainBattle_ChainCounter");

PROC
PROC_END_BrainBattle_ForceChainRemovalAtTurnEnd()
AND
DB_GlobalCounter("END_BrainBattle_ChainCounter", _Var1, _Var1, _Var1, _Var1)
AND
DB_END_MindBattle_Chains(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
RemoveStatus(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, _Var2, NULL_00000000-0000-0000-0000-000000000000);
PROC_END_BrainBattle_CheckMindGameOver(_Var1);

PROC
PROC_END_BrainBattle_ProcessEndOfMindBrainTurn()
AND
DB_END_BrainBattle_BrainBrokeChainThisTurn(1, _, _, _, _)
THEN
NOT DB_END_BrainBattle_BrainBrokeChainThisTurn(1);

IF
AutomatedDialogStarted(END_BrainBattle_AD_MindBrainTurn_fbc23a61-dd88-ca19-81ed-9578236a9b27, _, _, _, _)
AND NOT
DB_END_BrainBattle_BrainBrokeChainThisTurn(1, _, _, _, _)
THEN
DB_END_BrainBattle_BrainBrokeChainThisTurn(1);
PROC_IncreaseCounter("END_BrainBattle_ChainCounter");
PROC_END_MindBattle_BreakChain();

PROC
PROC_END_MindBattle_BreakChain()
AND
DB_GlobalCounter("END_BrainBattle_ChainCounter", _Var1, _Var1, _Var1, _Var1)
AND
_Var1 > 1
THEN
PlayAnimation(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, CUST_BreakingOutOfChains_01_047c1521-ffa3-43b1-89ed-db0c5445cfc5, "");
RealtimeObjectTimerLaunch(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, "END_MindBattle_BreakChainTimer", 2000);

IF
ObjectTimerFinished(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, "END_MindBattle_BreakChainTimer", (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_GlobalCounter("END_BrainBattle_ChainCounter", _Var1, _Var1, _Var1, _Var1)
AND
DB_END_MindBattle_Chains(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
RemoveStatus(S_END_MindBrain_f8bb04a3-22e5-41b0-aed7-5dcf852343d1, _Var2, NULL_00000000-0000-0000-0000-000000000000);
PROC_END_BrainBattle_CheckMindGameOver(_Var1);

IF
ObjectTimerFinished(S_END_Crown_704f1e91-8d56-4772-98d8-54c5d8a6af20, "END_BrainBattle_DominationReaction", _, _, _)
THEN
PROC_StopLoopEffect(S_END_Crown_704f1e91-8d56-4772-98d8-54c5d8a6af20, "END_BrainBattle_DominationReaction");

PROC
PROC_END_BrainBattle_Over()
THEN
GoalCompleted;


EXITSECTION
ENDEXITSECTION

ParentTargetEdge "Act3c"
