Version 1
SubGoalCombiner SGC_AND

INITSECTION
DB_HasItemEvent(S_END_CrownController_Complete_5424460f-8a64-45d6-863e-55e5425e271e, END_General_State_HasCrownController_de78970a-95c8-4e54-bdf7-28f1da9ca83b);
DB_HasItemEvent(S_END_SupremeTadpole_02a7596f-5dcb-4d2a-93c8-611de53096b5, END_General_State_HasSupremeTadpole_a0d1a230-79f8-4af6-a425-f9d8a771bd24);
DB_END_General_TadpoleAndStoneTracking(S_END_SupremeTadpole_02a7596f-5dcb-4d2a-93c8-611de53096b5, END_General_State_HasSupremeTadpole_a0d1a230-79f8-4af6-a425-f9d8a771bd24, END_General_State_PartyHasSupremeTadpole_a0ee98a9-7272-415a-95f6-f11c86048593, GLO_Tadpole_PAD_DroppedSupremeTadpole_914b8ffb-71f9-a479-5f46-e515ba0d542a, "GLO_SupremeTadpole");
DB_END_General_TadpoleAndStoneTracking(S_END_CrownController_Complete_5424460f-8a64-45d6-863e-55e5425e271e, END_General_State_HasCrownController_de78970a-95c8-4e54-bdf7-28f1da9ca83b, END_General_State_PartyHasCrownController_d526db7f-8ded-4755-84cd-498fd629b11d, END_General_PAD_DroppedCrownController_720b87f5-6516-f7f5-81f6-538cc8515051, "END_CompleteCrownController");
DB_END_General_InterjectionCharacter(NULL_00000000-0000-0000-0000-000000000000);
NOT DB_END_General_InterjectionCharacter(NULL_00000000-0000-0000-0000-000000000000);
DB_END_General_ActualInterjectionCandidate(NULL_00000000-0000-0000-0000-000000000000);
NOT DB_END_General_ActualInterjectionCandidate(NULL_00000000-0000-0000-0000-000000000000);
DB_Inclusion_CombatInclusionDialog(GLO_Tadpole_UseSupremeTadpole_474dd7db-074b-08cf-fd96-9b63fea16985);
NOT DB_END_General_PartyMindFlayer(NULL_00000000-0000-0000-0000-000000000000);
DB_END_Debug_AvatarPresetFlags(END_General_Debug_GaleStartAvatar_dc52ad2e-99e1-47f2-0ebf-38d90927ecf2);
DB_END_Debug_AvatarPresetFlags(END_General_Debug_WyllStartAvatar_cac9789e-f050-cc65-b346-6bbba4ac0dd2);
DB_END_Debug_AvatarPresetFlags(END_General_Debug_AstarionStartAvatar_d97013d1-405f-c07a-d324-73da945412b1);
DB_END_Debug_AvatarPresetFlags(END_General_Debug_SHStartAvatar_e35b5da6-1d34-024a-ac21-f8302b622d22);
DB_END_Debug_AvatarPresetFlags(END_General_Debug_KarlachStartAvatar_9db0205a-737f-2709-36b9-944ef3571e44);
DB_END_Debug_AvatarPresetFlags(END_General_Debug_LaezelStartAvatar_5b7d278e-abc5-a329-95a6-d6c6e216fa72);
DB_END_Debug_AvatarPresetFlags(END_General_Debug_DarkUrgeStartAvatar_6f90eca0-38c1-b45e-977b-3ff27857ee0e);
DB_END_General_InPartyDialogs(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, Astarion_InPartyEND_7f58ff67-227b-bfc0-d90f-0e70369b3c81);
DB_END_General_InPartyDialogs(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, Gale_InPartyEND_53af5b51-2d5d-c820-02db-2d5242ba6c0d);
DB_END_General_InPartyDialogs(S_GLO_Halsin_7628bc0e-52b8-42a7-856a-13a6fd413323, Halsin_InPartyEND_abd22cab-248f-9554-3621-50d99996eca2);
DB_END_General_InPartyDialogs(S_Player_Jaheira_91b6b200-7d00-4d62-8dc9-99e8339dfa1a, Jaheira_InPartyEND_57293e55-3d7c-e464-00ee-e199161622bc);
DB_END_General_InPartyDialogs(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, Karlach_InPartyEND_84af8609-030b-252c-2335-65d7f410b0e7);
DB_END_General_InPartyDialogs(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, Laezel_InPartyEND_10e8ff26-dea4-7ef3-ff8e-274ecb3e2868);
DB_END_General_InPartyDialogs(S_Player_Minsc_0de603c5-42e2-4811-9dad-f652de080eba, Minsc_InPartyEND_5f5091d1-3514-6f4e-e542-5e49a6a07bea);
DB_END_General_InPartyDialogs(S_GOB_DrowCommander_25721313-0c15-4935-8176-9f134385451b, Minthara_InPartyEND_2f19b684-e44f-704c-f272-18d535064060);
DB_END_General_InPartyDialogs(S_Player_ShadowHeart_3ed74f06-3c60-42dc-83f6-f034cb47c679, ShadowHeart_InPartyEND_de869b93-4a43-1813-b166-b1c0aa52cd6e);
DB_END_General_InPartyDialogs(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, Wyll_InPartyEND_0d572da8-0783-4adc-6a30-f3a25d94f033);
DB_END_General_ExtractBrainCastID(NULL_00000000-0000-0000-0000-000000000000, -1);
DB_GLO_ExclusiveFlag("END_General_PartyInRegion_States", END_General_State_CurrentlyInMorphicPool_06208edf-4c61-44a2-932b-b158d9ddd2f0);
DB_GLO_ExclusiveFlag("END_General_PartyInRegion_States", END_General_State_CurrentlyInAstralPlane_b3cf6c91-4d1c-4dcf-bc57-262f7d0f02b9);
DB_GLO_ExclusiveFlag("END_General_PartyInRegion_States", END_General_State_CurrentlyInHighHall_118b3dc5-dab8-4872-92da-ab01c15fa55e);
DB_GLO_ExclusiveFlag("END_General_PartyInRegion_States", END_General_State_CurrentlyInBrainBattle_0d7205b2-0d55-4540-8737-543253873cd6);
DB_END_General_FullPartyDialog(NULL_00000000-0000-0000-0000-000000000000, 0, 0, 0, 0, 0, 0, 0);
NOT DB_END_General_FullPartyDialog(NULL_00000000-0000-0000-0000-000000000000, 0, 0, 0, 0, 0, 0, 0);
DB_END_General_FullPartyDialog(END_BrainBattle_Intro_4565e114-0153-0449-ea83-de3b972c7679, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_BrainBattle_DestructionOfBrain_5180d955-3d53-ee59-ce74-5866c5be8cd2, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_BrainBattle_CombatOver_8cb159d3-3390-4e58-a0ae-8414628bb813, 1, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_BrainBattle_FinalDecision_e5feae67-c6f1-1827-e9d6-a6b34647c8ea, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_BrainBattle_EnterMind_714b6fff-814f-ae03-f959-c15596aef2dd, 0, 1, 1, 1, 1, 1, 1);
DB_END_General_FullPartyDialog(END_BrainBattle_GaleExplosion_3b9653f5-17c7-6716-2919-3ad3a9c137fc, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_DeathofKarlach_e419b950-b6ba-64bc-f041-1d07a602dfc4, 1, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_ROM_RomanceFates_Astarion_73fb7151-e772-cae7-8d7a-bb5eb8e8860a, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_RomanceFates_Gale_81fc2269-0613-259c-b950-c0dcebbb7934, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_RomanceFates_Laezel_523b1bb2-0443-79bf-cf3e-8f435ff5f2e9, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_RomanceFates_Shadowheart_b9ebb9af-ad65-4e64-6015-105e831d49c0, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_RomanceFates_Wyll_32de9167-3489-9257-e3c1-e430f2f455ab, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_RomanceFates_Minthara_699ad056-06a4-db4f-53c4-6706dbb7c544, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_RomanceFates_Halsin_a853d059-2572-04c4-88db-d737e4a264f7, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_RomanceFates_Karlach_091af35d-0d30-a4bf-b056-9eda505138b5, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_SoloFates_Astarion_9a09777b-c0ac-d3d3-c2f4-5e6794fa2ca0, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_SoloFates_CustomAvatar_f346a423-c718-45ca-3a0d-cc228b92abe6, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_SoloFates_Gale_7674e0c3-ca25-e924-9c17-3058796f87c3, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_SoloFates_Laezel_fbee59b9-cb3a-c1f2-66b4-b0fb82cf24fa, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_SoloFates_Shadowheart_bdc19865-8e61-2db2-f135-4a611b15cae1, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_SoloFates_Wyll_1667181c-2c0a-5255-ecfd-bd0752b4639c, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_SoloFates_Karlach_0181cc77-4b25-dd9a-025b-b08e85387645, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_MystraGaleConfrontation_06f1e7cd-25bf-492a-be6d-5fe608de4bbb, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_TheHerosRevelry_ecd7cb66-d650-d92a-118f-6be977c4b0b2, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GameFinale_SequeToElfsong_7633bf1a-a3e5-d33c-8986-a5fe85f680f3, 0, 1, 1, 1, 1, 1, 2);
DB_END_General_FullPartyDialog(END_GodsAndMonsters_WithersMeeting_037b2c4f-d8cd-b3bb-1471-a9dee232217d, 0, 1, 1, 1, 1, 1, 1);
DB_END_General_FullPartyDialog(END_GameFinale_RaphaelCrownUpdate_b7ee667d-d550-7115-37f3-ce900ca80cbd, 0, 1, 1, 1, 1, 1, 1);
DB_END_General_FullPartyDialog(END_GodsAndMonsters_WithersMeeting_037b2c4f-d8cd-b3bb-1471-a9dee232217d, 0, 1, 1, 1, 1, 1, 1);
DB_END_General_FullPartyDialog(END_GameFinale_RaphaelCrownUpdate_b7ee667d-d550-7115-37f3-ce900ca80cbd, 0, 1, 1, 1, 1, 1, 1);
DB_END_General_InterjectionDialog(END_BrainBattle_FinalDecision_e5feae67-c6f1-1827-e9d6-a6b34647c8ea, END_FinalDecision_State_HasCompanions_71509891-35c2-4e80-a107-e7c21a0028db, 4, 13);
DB_END_General_InterjectionDialog(END_BrainBattle_CombatOver_8cb159d3-3390-4e58-a0ae-8414628bb813, END_CombatOver_State_HasCompanions_d4e1d74a-ac07-7d10-07dc-3dbd24d3d260, 3, 12);
DB_END_General_InterjectionDialog(END_BrainBattle_CombatOver_Nested_AfterGithLeave_a7c18482-0cc0-7b5a-420b-28974c3e1dc8, END_CombatOver_State_HasCompanions_d4e1d74a-ac07-7d10-07dc-3dbd24d3d260, 3, 12);
DB_END_General_InterjectionDialog(END_BrainBattle_CombatOver_Nested_Conclusion_6a5c5975-8e27-c58f-1a26-64e8685464c0, END_CombatOver_State_HasCompanions_d4e1d74a-ac07-7d10-07dc-3dbd24d3d260, 3, 12);
DB_END_General_InterjectionDialog(END_BrainBattle_CombatOver_Nested_EmperorSolo_113aa7cc-d0cd-5c19-eb5d-b9f6e77136b5, END_CombatOver_State_HasCompanions_d4e1d74a-ac07-7d10-07dc-3dbd24d3d260, 3, 12);
DB_END_General_InterjectionDialog(END_BrainBattle_CombatOver_Nested_GaleExplodedIntro_32b59231-2f78-df56-f3b8-4bf3674641ad, END_CombatOver_State_HasCompanions_d4e1d74a-ac07-7d10-07dc-3dbd24d3d260, 3, 12);
DB_END_General_InterjectionDialog(END_BrainBattle_CombatOver_Nested_GithAreLeaving_b7f3c52d-364c-e740-404f-fb84d34763be, END_CombatOver_State_HasCompanions_d4e1d74a-ac07-7d10-07dc-3dbd24d3d260, 3, 12);
DB_END_General_InterjectionDialog(END_BrainBattle_CombatOver_Nested_StandardIntro_48d64086-0da8-289a-c2a1-cdaa4f7349b2, END_CombatOver_State_HasCompanions_d4e1d74a-ac07-7d10-07dc-3dbd24d3d260, 3, 12);
DB_END_General_InterjectionDialog(END_BrainBattle_CombatOver_Nested_VlaakithLaezel_5b64b0bb-70f3-0873-2982-aedee8a4582b, END_CombatOver_State_HasCompanions_d4e1d74a-ac07-7d10-07dc-3dbd24d3d260, 3, 12);
DB_END_General_InterjectionDialog(END_BrainBattle_CombatOver_Nested_WhatNext_9187b124-548b-3da3-ca48-4ad22d613207, END_CombatOver_State_HasCompanions_d4e1d74a-ac07-7d10-07dc-3dbd24d3d260, 3, 12);
DB_END_General_InterjectionDialog(END_GameFinale_DeathofKarlach_e419b950-b6ba-64bc-f041-1d07a602dfc4, END_DeathOfKarlach_State_HasCompanions_c60948cb-3c9b-491b-bccf-618a7c5bdc26, 1, 10);
DB_END_General_ExcludedInterjectionCharacters(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);
DB_END_General_ExcludedInterjectionCharacters(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);
DB_END_General_ExcludedInterjectionCandidate(NULL_00000000-0000-0000-0000-000000000000);
NOT DB_END_General_ExcludedInterjectionCandidate(NULL_00000000-0000-0000-0000-000000000000);
DB_END_General_ForcedListener(NULL_00000000-0000-0000-0000-000000000000);
NOT DB_END_General_ForcedListener(NULL_00000000-0000-0000-0000-000000000000);
PROC_END_General_FindMainAvatar();
DB_END_General_MakeUnavailableFlag(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, END_GameFinale_State_LaezelLeavesFaerun_896fb62a-4f56-41d8-a173-7d06c4cb9209);
DB_END_General_MakeUnavailableFlag(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, END_BrainBattle_Event_KillKarlach_796fc0c1-607e-fc25-2eca-845c453f9afc);
DB_END_General_MakeUnavailableFlag(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, END_GameFinale_State_GaleInElysium_d6c53ee8-ce94-4016-73ee-74d44d309837);
DB_END_General_MakeUnavailableFlag(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, END_GameFinale_state_GaleChallengedMystra_d6dfa722-f85e-e191-a7e0-776d19c9f18a);
DB_END_General_MakeUnavailableFlag(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, END_CombatOver_State_PlayerKilledLaezel_dc67028e-f26e-a092-ae9a-809234a6bc6d);
DB_END_General_MakeUnavailableFlag(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, END_GameFinale_Event_GaleBecameGod_e85955a3-58d0-17ea-2d31-ed3713121d9b);
DB_END_General_MakeUnavailableFlag(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, GLO_END_GameFinale_DeathofKarlach_KarlachWentWithNonRomanceWyll_a552e386-af26-eb98-d198-a84221e467b0);
DB_END_General_MakeUnavailableFlag(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, GLO_END_GameFinale_DeathOfKarlach_WentToAvernusWithAvatar_35150cbf-2c72-1049-37ed-14dbc3736135);
DB_END_General_MakeUnavailableFlag(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, GLO_END_GameFinale_DeathofKarlach_KarlachWentWithNonRomanceWyll_a552e386-af26-eb98-d198-a84221e467b0);
DB_END_General_MakeUnavailableCharacterFlag(END_BrainBattle_Event_Suicide_ad1258fa-27eb-537c-a113-91db07cb6590);
DB_END_General_MakeUnavailableCharacterFlag(END_BrainBattle_Event_GoToJail_4a021214-a319-a17b-13f6-c3427c794684);
DB_END_WorldTimelineHelper(WRLD_END_DragonNuatiloidFight_20abace3-8ed7-c55c-7e17-0f32bcf27a25, TimelineSceneTrigger_WRLD_END_DragonNautiloidFight_Var1_57c7437a-44f5-43a8-b243-203d7e0db8ad, "InitialDialog");
DB_END_WorldTimelineHelper(WRLD_END_DragonNuatiloidFight_20abace3-8ed7-c55c-7e17-0f32bcf27a25, TimelineSceneTrigger_WRLD_END_DragonNautiloidFight_Var1_001_8689c065-90e9-4028-bc03-15fd6d8404d8, "InitialDialog");
DB_END_WorldTimelineHelper(WRLD_END_DragonNautiloidFight_Var2_8fa8580d-24da-35e5-2cc4-e77ec2180192, TimelineSceneTrigger_WRLD_END_DragonNautiloidFight_Var2_14c45ed0-a332-4f7a-96d8-3141117166be, "InitialDialog");
DB_END_WorldTimelineHelper(WRLD_END_DragonNautiloidFight_Var2_8fa8580d-24da-35e5-2cc4-e77ec2180192, TimelineSceneTrigger_WRLD_END_DragonNautiloidFight_Var2_001_644825fb-58eb-4111-8b63-b96c22736653, "InitialDialog");
DB_END_WorldTimelineHelper(WRLD_END_DragonNautiloidFight_Var3_65dbe627-a6ef-1d51-5d9e-1db9c11f1903, TimelineSceneTrigger_WRLD_END_DragonNautiloidFight_Var3_af3a3db6-53fe-42b2-8ca9-07d6241f4edf, "InitialDialog");
DB_END_WorldTimelineHelper(WRLD_END_DragonNautiloidFight_Var3_65dbe627-a6ef-1d51-5d9e-1db9c11f1903, TimelineSceneTrigger_WRLD_END_DragonNautiloidFight_Var3_001_ca55bdaa-8a13-4d98-83fa-73abf51ef7a1, "InitialDialog");
DB_END_WorldTimelineHelper(WRLD_END_DragonNautiloidFight_Var2_8fa8580d-24da-35e5-2cc4-e77ec2180192, TimelineSceneTrigger_WRLD_END_DragonNautiloidFight_Var2_000_4acf2db8-4d00-4851-a7e9-5f3bf994446a, "Brain");
DB_END_WorldTimelineHelper(WRLD_END_DragonNuatiloidFight_20abace3-8ed7-c55c-7e17-0f32bcf27a25, TimelineSceneTrigger_WRLD_END_DragonNautiloidFight_Var1_000_ff62948d-55e4-4466-a92e-9cc167ae8f7e, "Brain");
DB_END_WorldTimelineHelper(WRLD_END_DragonNautiloidFight_Var3_65dbe627-a6ef-1d51-5d9e-1db9c11f1903, TimelineSceneTrigger_WRLD_END_DragonNautiloidFight_Var3_000_b506739d-63f4-4f24-b2ec-427c6530c4ec, "Brain");
DB_END_WorldTimelineHelper(WRLD_END_DragonNuatiloidFight_20abace3-8ed7-c55c-7e17-0f32bcf27a25, TimelineSceneTrigger_WRLD_END_DragonNautiloidFight_Var1_002_cb500dd4-947d-4a49-8e75-a6a153b36bc8, "Brain");
DB_END_WorldTimelineHelper(WRLD_END_DragonNautiloidFight_Var2_8fa8580d-24da-35e5-2cc4-e77ec2180192, TimelineSceneTrigger_WRLD_END_DragonNautiloidFight_Var2_002_a08d5ff0-3c03-4caa-991c-5311b75abac8, "Brain");
DB_END_WorldTimelineHelper(WRLD_END_DragonNautiloidFight_Var3_65dbe627-a6ef-1d51-5d9e-1db9c11f1903, TimelineSceneTrigger_WRLD_END_DragonNautiloidFight_Var3_002_309d95af-7101-4ac3-9865-e219ef7f5991, "Brain");
DB_END_HideMindBrainDialogs(END_BrainBattle_FinalDecision_e5feae67-c6f1-1827-e9d6-a6b34647c8ea);
DB_END_HideMindBrainDialogs(END_BrainBattle_EnterMind_714b6fff-814f-ae03-f959-c15596aef2dd);
PROC_END_General_TEMP_RemoveAstralTadpole();
SetHitpointsPercentage(S_END_SewerGratesOutside_af613949-8da2-46e9-a3c4-3e157512ac9c, 55);
PROC_END_Misc_Init();
PROC_END_Misc_ChangeToInPartyEND();

KBSECTION
IF
TextEvent("destroyparty", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsTagged(_Var1, AVATAR_306b9b05-1057-4770-aa17-01af21acd650, 0, _Var1, _Var1)
THEN
PROC_GLO_PartyMembers_Remove(_Var1, 1);

IF
TextEvent("hh_arrival", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_HighHall_Arrival_be92c5db-c9bf-4130-25f1-bdde183f7a46, _Var1, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
UseStarted((CHARACTER)_Var1, S_END_DEBUG_ToUpperHighHallDoorCube_85bac0f7-5511-44e6-b409-324d4f645420, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var1, S_END_DEBUG_ToHighHallUpperDoorPoint_7d44ebe5-d74f-4a47-a60e-8b2875998406);

IF
FlagSet(Debug_END_IllithidOptions_GetSupremeTadpole_50731772-e893-4a45-9691-5e0fe21f8fd9, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
ClearFlag(Debug_END_IllithidOptions_GetSupremeTadpole_50731772-e893-4a45-9691-5e0fe21f8fd9, _Var1);
PROC_END_DEBUG_GiveSupremeTadpole(_Var1);

IF
TextEvent("end_supremetadpole", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_DEBUG_GiveSupremeTadpole(_Var1);

PROC
PROC_END_DEBUG_GiveSupremeTadpole((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
ClearFlag(END_IllithidOptions_Event_GiveSupremeTadpole_a8128df9-dea6-4a4d-961d-9dbdc49ebb38, _Var1);
ClearFlag(END_General_Event_DialogFullCeremorph_d968607c-405b-4a57-9956-477e9708b5b5, _Var1);
RemoveStatus(_Var1, "MIND_FLAYER_FORM", NULL_00000000-0000-0000-0000-000000000000);
ClearTag(_Var1, FULL_CEREMORPH_3797bfc4-8004-4a19-9578-61ce0714cc0b);
NOT DB_OnlyOnce("END_AppliedMindFlayerForm");
SetFlag(END_IllithidOptions_Event_GiveSupremeTadpole_a8128df9-dea6-4a4d-961d-9dbdc49ebb38, _Var1);

IF
TextEvent("end_completecrowncontroller", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
ToInventory(S_END_CrownController_Complete_5424460f-8a64-45d6-863e-55e5425e271e, _Var1, 1, 1, 1);

IF
TextEvent("end_testbrainextract", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_PartyMindFlayer(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_IllithidOptionsFollower_Follower(_Var2, _Var3, _, _, _Var1)
THEN
Die(_Var2, 0, _Var1, 0, 1);
DB_END_General_BrainExtractor(_Var1);
ClearFlag(_Var3, _Var1);
PROC_END_General_BrainExtract(_Var2);

IF
TextEvent("end_changeinpartydialog", _, _, _, _)
THEN
PROC_END_Misc_ChangeToInPartyEND();

IF
TextEvent("end_starthhworldtimelines", _, _, _, _)
THEN
PROC_END_General_ReadyDragonAndNautiloidWorldTimelines();

IF
LevelLoaded("END_Main", _, _, _, _)
THEN
SetFlag(CURRENTREGION_END_Main_140b4d3e-6cc7-48cb-b66f-dbc4eba710e1, NULL_00000000-0000-0000-0000-000000000000, 0);

IF
LevelUnloading("END_Main", _, _, _, _)
THEN
ClearFlag(CURRENTREGION_END_Main_140b4d3e-6cc7-48cb-b66f-dbc4eba710e1, NULL_00000000-0000-0000-0000-000000000000, 0);

IF
PartyPresetLoaded(_, _, _, _, _)
AND
DB_END_Debug_QueuedPartyPresetChange(1, _, _, _, _)
AND
GetHostCharacter(_Var3, _, _, _, _)
AND
QRY_StartDialog_Fixed(DebugBook_3af7dec4-4c08-9e44-9064-ec038ebad0ea, _Var3, _, _, _)
THEN
PROC_END_Debug_CheckNewAvatar(_Var3);

PROC
PROC_END_Debug_CheckNewAvatar(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _, _)
AND
DB_GlobalFlag(END_Debug_Event_LaezelOrpheusPath_bc1addec-13d4-147c-3a97-84cdd1cb1b02, _, _, _, _)
THEN
SetFlag(ORI_Laezel_State_IsOnOrpheusPath_97244ccc-a6b5-403e-9cfe-a3502eb4af56, NULL_00000000-0000-0000-0000-000000000000, 0);
SetTag(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, LAEZEL_ORPHEUSPATH_616688cd-b203-4f14-8c33-086bb83062a3);

IF
DialogEnded(DebugBook_3af7dec4-4c08-9e44-9064-ec038ebad0ea, _, _, _, _)
AND
DB_END_Debug_QueuedPartyChangeFlag(END_General_Debug_GaleStartAvatar_dc52ad2e-99e1-47f2-0ebf-38d90927ecf2, _Var2, _, _, _)
THEN
NOT DB_END_Debug_QueuedPartyChangeFlag(END_General_Debug_GaleStartAvatar_dc52ad2e-99e1-47f2-0ebf-38d90927ecf2, _Var2);
DB_END_Debug_QueuedPartyPresetChange(1);
TeleportTo(S_END_DebugLoadPartyPresetPos_bdbdde1b-51e5-43bb-b0d5-64732ed9e2f7, _Var2, "");
LoadPartyPreset("Level12_Gale", S_END_DebugLoadPartyPresetPos_bdbdde1b-51e5-43bb-b0d5-64732ed9e2f7);

IF
DialogEnded(DebugBook_3af7dec4-4c08-9e44-9064-ec038ebad0ea, _, _, _, _)
AND
DB_END_Debug_QueuedPartyChangeFlag(END_General_Debug_WyllStartAvatar_cac9789e-f050-cc65-b346-6bbba4ac0dd2, _Var2, _, _, _)
THEN
NOT DB_END_Debug_QueuedPartyChangeFlag(END_General_Debug_WyllStartAvatar_cac9789e-f050-cc65-b346-6bbba4ac0dd2, _Var2);
DB_END_Debug_QueuedPartyPresetChange(1);
TeleportTo(S_END_DebugLoadPartyPresetPos_bdbdde1b-51e5-43bb-b0d5-64732ed9e2f7, _Var2, "");
LoadPartyPreset("Level12_Wyll", S_END_DebugLoadPartyPresetPos_bdbdde1b-51e5-43bb-b0d5-64732ed9e2f7);

IF
DialogEnded(DebugBook_3af7dec4-4c08-9e44-9064-ec038ebad0ea, _, _, _, _)
AND
DB_END_Debug_QueuedPartyChangeFlag(END_General_Debug_LaezelStartAvatar_5b7d278e-abc5-a329-95a6-d6c6e216fa72, _Var2, _, _, _)
THEN
NOT DB_END_Debug_QueuedPartyChangeFlag(END_General_Debug_LaezelStartAvatar_5b7d278e-abc5-a329-95a6-d6c6e216fa72, _Var2);
DB_END_Debug_QueuedPartyPresetChange(1);
TeleportTo(S_END_DebugLoadPartyPresetPos_bdbdde1b-51e5-43bb-b0d5-64732ed9e2f7, _Var2, "");
LoadPartyPreset("Level12_Laezel", S_END_DebugLoadPartyPresetPos_bdbdde1b-51e5-43bb-b0d5-64732ed9e2f7);

IF
DialogEnded(DebugBook_3af7dec4-4c08-9e44-9064-ec038ebad0ea, _, _, _, _)
AND
DB_END_Debug_QueuedPartyChangeFlag(END_General_Debug_AstarionStartAvatar_d97013d1-405f-c07a-d324-73da945412b1, _Var2, _, _, _)
THEN
NOT DB_END_Debug_QueuedPartyChangeFlag(END_General_Debug_AstarionStartAvatar_d97013d1-405f-c07a-d324-73da945412b1, _Var2);
DB_END_Debug_QueuedPartyPresetChange(1);
TeleportTo(S_END_DebugLoadPartyPresetPos_bdbdde1b-51e5-43bb-b0d5-64732ed9e2f7, _Var2, "");
LoadPartyPreset("Level12_Astarion", S_END_DebugLoadPartyPresetPos_bdbdde1b-51e5-43bb-b0d5-64732ed9e2f7);

IF
DialogEnded(DebugBook_3af7dec4-4c08-9e44-9064-ec038ebad0ea, _, _, _, _)
AND
DB_END_Debug_QueuedPartyChangeFlag(END_General_Debug_SHStartAvatar_e35b5da6-1d34-024a-ac21-f8302b622d22, _Var2, _, _, _)
THEN
NOT DB_END_Debug_QueuedPartyChangeFlag(END_General_Debug_SHStartAvatar_e35b5da6-1d34-024a-ac21-f8302b622d22, _Var2);
DB_END_Debug_QueuedPartyPresetChange(1);
TeleportTo(S_END_DebugLoadPartyPresetPos_bdbdde1b-51e5-43bb-b0d5-64732ed9e2f7, _Var2, "");
LoadPartyPreset("Level12_Shadowheart", S_END_DebugLoadPartyPresetPos_bdbdde1b-51e5-43bb-b0d5-64732ed9e2f7);

IF
DialogEnded(DebugBook_3af7dec4-4c08-9e44-9064-ec038ebad0ea, _, _, _, _)
AND
DB_END_Debug_QueuedPartyChangeFlag(END_General_Debug_KarlachStartAvatar_9db0205a-737f-2709-36b9-944ef3571e44, _Var2, _, _, _)
THEN
NOT DB_END_Debug_QueuedPartyChangeFlag(END_General_Debug_KarlachStartAvatar_9db0205a-737f-2709-36b9-944ef3571e44, _Var2);
DB_END_Debug_QueuedPartyPresetChange(1);
TeleportTo(S_END_DebugLoadPartyPresetPos_bdbdde1b-51e5-43bb-b0d5-64732ed9e2f7, _Var2, "");
LoadPartyPreset("Level12_Karlach", S_END_DebugLoadPartyPresetPos_bdbdde1b-51e5-43bb-b0d5-64732ed9e2f7);

IF
DialogEnded(DebugBook_3af7dec4-4c08-9e44-9064-ec038ebad0ea, _, _, _, _)
AND
DB_END_Debug_QueuedPartyChangeFlag(END_General_Debug_DarkUrgeStartAvatar_6f90eca0-38c1-b45e-977b-3ff27857ee0e, _Var2, _, _, _)
THEN
NOT DB_END_Debug_QueuedPartyChangeFlag(END_General_Debug_DarkUrgeStartAvatar_6f90eca0-38c1-b45e-977b-3ff27857ee0e, _Var2);
DB_END_Debug_QueuedPartyPresetChange(1);
TeleportTo(S_END_DebugLoadPartyPresetPos_bdbdde1b-51e5-43bb-b0d5-64732ed9e2f7, _Var2, "");
LoadPartyPreset("Level12_DarkUrge", S_END_DebugLoadPartyPresetPos_bdbdde1b-51e5-43bb-b0d5-64732ed9e2f7);

IF
FlagSet((FLAG)_Var1, (GUIDSTRING)_Var2, _, (FLAG)_Var1, (FLAG)_Var1)
AND
DB_END_Debug_AvatarPresetFlags(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_Debug_QueuedPartyChangeFlag(_Var1, _Var2);

IF
FlagSet(END_Debug_Event_KillRavengard_580dde3f-31fa-6e1b-d25a-1dbd622d7fb6, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
Die(S_GLO_Ravengard_f6620372-ebd0-4511-a39d-8c2d4ad03f03, 0, 1);

IF
DialogEnded(DebugBook_3af7dec4-4c08-9e44-9064-ec038ebad0ea, _, _, _, _)
AND
DB_GlobalFlag(ORI_Wyll_State_IsDevil_f83eee79-271b-4044-947a-d8eb699d734a, _, _, _, _)
AND
DB_PartOfTheTeam(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, _, _, _, _)
THEN
SetTag(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, WYLL_DEVIL_5e844f0e-d822-4210-a28e-6af149a7bd4b);

IF
FlagSet(END_General_Debug_GoodAllies_ee71917a-2c8d-cc3c-b50e-b981bf204b75, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_GlobalSetFlagAndCache(GLO_Volo_State_AtCamp_de1cadca-2eca-4cee-a3dc-e262bbb92277);
PROC_GlobalSetFlagAndCache(LOW_SorcerousSundries_State_ProdigyHasStayedAtRamazith_524ab56a-8169-4926-9105-8bcaf8c87499);
PROC_GlobalSetFlagAndCache(LOW_SorcerousSundries_State_PlayersSideWithNightsong_992ec758-9536-40ce-9a45-72193c81ec1b);
PROC_GlobalSetFlagAndCache(CAMP_OwlbearCub_State_Friend_3b963a1c-ca06-db60-75c3-063592e84dc4);
PROC_GlobalSetFlagAndCache(GLO_Origin_PartOfTheTeam_Jaheira_d7d29efe-70bb-47c2-9db3-bc8a10347bc6);
PROC_GlobalSetFlagAndCache(COL_TadpolingCentre_Event_ReleasePods_3e81dc65-eb2d-86aa-5163-28450894f868);
PROC_GlobalSetFlagAndCache(GLO_LiftingTheCurse_State_BreathHasBeenRestored_2113b54e-a140-4aa0-97ac-219fa7b7d038);
PROC_GlobalSetFlagAndCache(LOW_MurderTribunal_Event_ValeriaLeavesTribunal_57a75bf2-2648-c9f8-e75e-8366c582225e);
PROC_GlobalSetFlagAndCache(LOW_SteelWatchFoundry_State_GainedGondianENDSupport_1bb09a8b-001d-4b43-9f39-ba89eb3aece9);
PROC_GlobalSetFlagAndCache(LOW_SteelWatchFoundry_BarcusIsLeader_2feaf431-1f1d-d951-7b4f-daa744985a46);
PROC_GlobalSetFlagAndCache(ORI_Astarion_State_StayedVampireSpawn_2724b881-6be1-49a7-8375-a49e9acb4546);
PROC_GlobalSetFlagAndCache(CAMP_ArabellaPowers_State_JergalToldToLeave_3d22614e-8762-8aec-4537-9d50abb97b23);
PROC_GlobalSetFlagAndCache(WYR_WyrmRockPrison_State_FlorrickEscaped_a84a5b16-ca29-43c3-91bf-17def670ba07);
PROC_GlobalSetFlagAndCache(LOW_Guildhall_State_SidedWithNineFingers_9a6c3448-67c8-e23a-ed28-7b3cfba65bf5);
PROC_GlobalSetFlagAndCache(CAMP_Ravengard_State_RavengardInCamp_37309008-04cf-493c-8ca6-43034d331a8a);
PROC_GlobalSetFlagAndCache(LOW_Guildhall_State_MolHelpsPlayerInEND_5c4d5b0f-a9bb-4fe0-8003-2af9213a64b0);

IF
FlagSet(END_General_Debug_BadAllies_566210a1-27ef-a883-cb74-7001f7a0ea92, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_GlobalSetFlagAndCache(GLO_Volo_State_AtCamp_de1cadca-2eca-4cee-a3dc-e262bbb92277);
PROC_GlobalSetFlagAndCache(END_GatherYourAllies_State_WulbrenGaveIronhandSupport_dd929cfa-685e-41d6-8e04-be2f1a14da98);
PROC_GlobalSetFlagAndCache(LOW_Guildhall_State_PostCoup_ZhentControlled_bd914804-54c7-4de2-b51e-988919c2e644);
PROC_GlobalSetFlagAndCache(LOW_SorcerousSundries_State_PlayersSideWithLorroakan_24c45d86-9027-48cc-afdd-3e6bac7d5425);
PROC_GlobalSetFlagAndCache(LOW_Orthon_State_PromisedENDSupport_b412f8bc-1cc6-2ac9-058e-8a5d06e77c5a);
PROC_GlobalSetFlagAndCache(LOW_SharGrotto_Event_SurrenderShadowheart_bfc7f3b7-4e58-44e1-bb58-131ee77fc0ad);
PROC_GlobalSetFlagAndCache(ORI_Astarion_State_BecameVampireLord_c446ce94-efd8-45d5-b407-284177b6b57e);
PROC_GlobalSetFlagAndCache(CAMP_MizorasPact_State_WyllEternalPact_8da8b1fb-5aa9-8cf5-8b45-6f8ca31a1227);
PROC_GlobalSetFlagAndCache(LOW_DevilishOx_State_HelpedPhasmToCity_d1498063-a466-4f43-8cb5-103baa46c753);
PROC_GlobalSetFlagAndCache(LOW_BlushingMermaid_State_HagIsAllyInEND_3bb65bd3-a72f-4a43-a497-10b1501cd6a5);
PROC_GlobalSetFlagAndCache(ORI_Shadowheart_State_Shar_KilledParents_3a3b0ecf-a1ed-4733-8548-0348befc6bac);

IF
FlagSet(END_General_Debug_SetupAllies_56c77d49-4963-4a38-b0ea-52a0e3911ca8, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_END_GatherYourAllies_DebugSetup();

IF
FlagSet(END_General_Debug_SideEmperor_4e4fa4b8-d870-d677-db2f-be9f1ecad210, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
SetFlag(END_IllithidOptions_State_AssimilatedOrpheus_5562cc3f-c168-48c9-87c1-1598a5c58961);
PROC_DEBUG_END_IllithidOptionsFollower_Follow(_Var1, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);

IF
FlagSet(END_General_Debug_SideOrpheus_a1c60b25-a466-9dd3-5234-330d2bc001cb, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
SetFlag(END_IllithidOptions_Event_EmperorBetrayal_411c2575-bfbc-449c-9762-edad4285aafd);
PROC_DEBUG_END_IllithidOptionsFollower_Follow(_Var1, S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);
PROC_END_IllithidOptionsFollower_DebugFreeOrpheus();

IF
FlagSet(END_General_Debug_SideNone_d528077d-4da8-19b5-45ff-d92e4a3f3254, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
SetFlag(END_IllithidOptions_State_AssimilatedOrpheus_5562cc3f-c168-48c9-87c1-1598a5c58961);
SetFlag(END_IllithidOptions_Event_EmperorBetrayal_411c2575-bfbc-449c-9762-edad4285aafd);

IF
FlagSet(END_General_Debug_EmperorMF_b027bc20-79fd-a08d-c483-78fadd3a8765, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
SetFlag(END_IllithidOptions_State_GaveStones_18e3be1a-c1c0-437e-ad0a-a1426d8830f4);

IF
FlagSet(END_General_Debug_OrpheusMF_f5e1bff5-a71f-13d5-70d2-44a16b060025, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
ApplyStatus(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, "MIND_FLAYER_ORPHEUS", -1, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
FlagSet(END_General_Debug_PlayerMF_e2c308d9-4ecf-88b7-ea51-a557d94845de, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
ApplyStatus(_Var1, "MIND_FLAYER_FORM", -1, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
FlagSet(END_General_Debug_KarlachMF_ce0e00d5-3c22-b15e-900d-b3f089d47f42, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
ApplyStatus(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, "MIND_FLAYER_FORM", -1, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
FlagSet(END_General_Debug_GaleMF_cbf5eb48-3d73-e1fb-f78d-bf81e3bcb8ea, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
ApplyStatus(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, "MIND_FLAYER_FORM", -1, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
FlagSet(END_General_Debug_StartAtGather_09162d84-03ea-4e28-27e6-91d12dc574d4, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
ClearFlag(END_General_Debug_StartAtGather_09162d84-03ea-4e28-27e6-91d12dc574d4, _Var1);
DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtGather_09162d84-03ea-4e28-27e6-91d12dc574d4, _Var1);

IF
DialogEnded(DebugBook_3af7dec4-4c08-9e44-9064-ec038ebad0ea, _, _, _, _)
AND
DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtGather_09162d84-03ea-4e28-27e6-91d12dc574d4, _Var2, _, _, _)
THEN
NOT DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtGather_09162d84-03ea-4e28-27e6-91d12dc574d4, _Var2);
PROC_TeleportPartiesTo(S_END_VossAmbushPoint_000_4f34b0e2-c6fb-4fc7-b552-30566581ab56, "");

IF
FlagSet(END_General_Debug_StartAtBrainStalk_3b6b7268-6c97-9bf6-3c2b-8180cc9ae6f9, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
ClearFlag(END_General_Debug_StartAtBrainStalk_3b6b7268-6c97-9bf6-3c2b-8180cc9ae6f9, _Var1);
DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtBrainStalk_3b6b7268-6c97-9bf6-3c2b-8180cc9ae6f9, _Var1);

IF
DialogEnded(DebugBook_3af7dec4-4c08-9e44-9064-ec038ebad0ea, _, _, _, _)
AND
DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtBrainStalk_3b6b7268-6c97-9bf6-3c2b-8180cc9ae6f9, _Var2, _, _, _)
THEN
NOT DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtBrainStalk_3b6b7268-6c97-9bf6-3c2b-8180cc9ae6f9, _Var2);
PROC_TeleportPartiesTo(S_END_DEBUG_ToHighHallUpperDoorPoint_7d44ebe5-d74f-4a47-a60e-8b2875998406, "");

IF
FlagSet(END_General_Debug_StartAtBrainBattle_80306787-bf3c-2278-e78c-706229a70b84, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
ClearFlag(END_General_Debug_StartAtBrainBattle_80306787-bf3c-2278-e78c-706229a70b84, _Var1);
DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtBrainBattle_80306787-bf3c-2278-e78c-706229a70b84, _Var1);

IF
DialogEnded(DebugBook_3af7dec4-4c08-9e44-9064-ec038ebad0ea, _, _, _, _)
AND
DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtBrainBattle_80306787-bf3c-2278-e78c-706229a70b84, _Var2, _, _, _)
THEN
NOT DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtBrainBattle_80306787-bf3c-2278-e78c-706229a70b84, _Var2);
DB_END_HighHallInterior_ToRoofReadyCheckPlayer(_Var2);
DB_END_BrainBattle_IntroScene(1);
PROC_END_BrainBattle_PreSetup();
SetFlag(END_BrainBattle_Event_PlayersMovedToBrain_87f477a2-6ca7-4ada-be46-3f2680fa0f4c);
SetFlag(END_BrainBattle_Event_Started_3cd63c2e-7343-45dd-9137-4cabca2179a6, NULL_00000000-0000-0000-0000-000000000000, 0);
DB_END_BrainBattle_Start(1);
PROC_SetRelationToPlayers(ACT3_END_Netherbrain_04928f91-6658-431e-b652-65aea6403879, 0);

IF
FlagSet(END_General_Debug_StartAtMindBattle_0989383f-83fb-f6dc-2fa1-c4ddb0b008f8, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
ClearFlag(END_General_Debug_StartAtMindBattle_0989383f-83fb-f6dc-2fa1-c4ddb0b008f8, _Var1);
DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtMindBattle_0989383f-83fb-f6dc-2fa1-c4ddb0b008f8, _Var1);

IF
DialogEnded(DebugBook_3af7dec4-4c08-9e44-9064-ec038ebad0ea, _, _, _, _)
AND
DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtMindBattle_0989383f-83fb-f6dc-2fa1-c4ddb0b008f8, _Var2, _, _, _)
AND
DB_END_General_PartyMindFlayer(_Var3, _, _, _, _)
THEN
NOT DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtMindBattle_0989383f-83fb-f6dc-2fa1-c4ddb0b008f8, _Var2);
DB_END_BrainBattle_Start(1);
PROC_TeleportPartiesTo(S_END_MindPartyPos_8f6b2b6a-3c4c-45e9-8069-d728ecca47f0, "");
DB_END_DEBUG_BrainBattle_MindBattleCombatJoin(1);
PROC_END_BrainBattle_DominationUsed(_Var3);
PROC_SetRelationToPlayers(ACT3_END_Netherbrain_04928f91-6658-431e-b652-65aea6403879, 0);

IF
FlagSet(END_General_Debug_StartAtCombatOver_b46e68a0-a987-cb5c-45be-ddfaa1b6ba5a, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
ClearFlag(END_General_Debug_StartAtCombatOver_b46e68a0-a987-cb5c-45be-ddfaa1b6ba5a, _Var1);
DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtCombatOver_b46e68a0-a987-cb5c-45be-ddfaa1b6ba5a, _Var1);

IF
DialogEnded(DebugBook_3af7dec4-4c08-9e44-9064-ec038ebad0ea, _, _, _, _)
AND
DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtCombatOver_b46e68a0-a987-cb5c-45be-ddfaa1b6ba5a, _Var2, _, _, _)
THEN
PROC_TeleportPartiesTo(S_END_MindPartyPos_8f6b2b6a-3c4c-45e9-8069-d728ecca47f0, "END_Debug_CombatOverTP");

IF
EntityEvent(_, "END_Debug_CombatOverTP", _, _, _)
AND
DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtCombatOver_b46e68a0-a987-cb5c-45be-ddfaa1b6ba5a, _Var2, _, _, _)
AND
DB_END_General_PartyMindFlayer(_Var3, _, _, _, _)
THEN
NOT DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtCombatOver_b46e68a0-a987-cb5c-45be-ddfaa1b6ba5a, _Var2);
DB_END_BrainBattle_DominationCharacter(_Var3);
DB_END_BrainBattle_DominationCompletedReady(1);

IF
FlagSet(END_General_Debug_StartAtFates_7a7e4405-09a9-a8e3-165c-016f5625b2b3, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
ClearFlag(END_General_Debug_StartAtFates_7a7e4405-09a9-a8e3-165c-016f5625b2b3, _Var1);
DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtFates_7a7e4405-09a9-a8e3-165c-016f5625b2b3, _Var1);

IF
DialogEnded(DebugBook_3af7dec4-4c08-9e44-9064-ec038ebad0ea, _, _, _, _)
AND
DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtFates_7a7e4405-09a9-a8e3-165c-016f5625b2b3, _Var2, _, _, _)
THEN
NOT DB_END_General_QueuedDebugSetup(END_General_Debug_StartAtFates_7a7e4405-09a9-a8e3-165c-016f5625b2b3, _Var2);
PROC_END_BrainBattle_Over();

IF
FlagSet(END_General_Debug_GaleWantsCrown_4580ddff-923e-2088-0381-99d8a73316c4, _, _, _, _)
AND
DB_ORI_Gale_GoalScore(_Var3, _Var4, _, _, _)
THEN
NOT DB_ORI_Gale_GoalScore(_Var3, _Var4);
DB_ORI_Gale_GoalScore(1, 6);

PROC
PROC_END_General_TEMP_RemoveAstralTadpole()
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetItemByTemplateInInventory(LOOT_MF_Tadpole_Astral_A_4a82e6f2-839f-434e-addf-b07dd1578194, _Var1, _Var2, _Var1, _Var1)
THEN
MagicPocketsDrop(_Var1, _Var2);
SetOnStage(_Var2, 0);

QRY
QRY_GLO_DaisyDreams_BlockInclusion((DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND
DB_ActiveLevel("END_Main", _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_General_EmperorADs(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_END_Misc_ChangeToInPartyEND()
AND
DB_END_General_InPartyDialogs(_Var1, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_OriginInPartyDialog(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
DB_OriginInPartyDialog(_Var1, _Var2);

IF
EntityEvent((CHARACTER)_Var1, "END_ArrivedInHighHall", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
SetFlag(END_General_State_CurrentlyInHighHall_118b3dc5-dab8-4872-92da-ab01c15fa55e);
RemoveStatus(_Var1, "CRE_ASTRALPRISON_GRAVITY", NULL_00000000-0000-0000-0000-000000000000);
PROC_END_HighHall_TryStartArrivalDialog(_Var1);

PROC
PROC_END_HighHall_TryStartArrivalDialog((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_MainDialogAnchor(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_HighHall_ArrivalStarted(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_HighHall_Arrival_be92c5db-c9bf-4130-25f1-bdde183f7a46, _Var1, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_HighHall_ArrivalStarted(1);
PROC_NotifyWhenReadyToMoveOn(_Var1, "END_HighHall_ArrivalReaction");

PROC
PROC_END_HighHall_TryStartArrivalDialog((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_HighHall_ArrivalUser(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_HighHall_ArrivalStarted(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_HighHall_Arrival_be92c5db-c9bf-4130-25f1-bdde183f7a46, _Var1, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_HighHall_ArrivalStarted(1);
PROC_NotifyWhenReadyToMoveOn(_Var1, "END_HighHall_ArrivalReaction");

PROC
PROC_END_HighHall_TryStartArrivalDialog((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_HighHall_ArrivalStarted(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(END_HighHall_Arrival_be92c5db-c9bf-4130-25f1-bdde183f7a46, _Var1, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_HighHall_ArrivalStarted(1);
PROC_NotifyWhenReadyToMoveOn(_Var1, "END_HighHall_ArrivalReaction");

PROC
PROC_END_HighHall_TryStartArrivalDialog((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_END_HighHall_ArrivalStarted(1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_General_ReadyDragonAndNautiloidWorldTimelines();
PROC_NotifyWhenReadyToMoveOn(_Var1, "END_HighHall_ArrivalReaction");

PROC
PROC_StartDialog_AddExtraSpeakers(END_HighHall_Arrival_be92c5db-c9bf-4130-25f1-bdde183f7a46, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_PartyMembers(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

PROC
PROC_StartDialog_AddExtraSpeakers(END_HighHall_Arrival_be92c5db-c9bf-4130-25f1-bdde183f7a46, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_PartyMembers(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);

PROC
PROC_ReadyToMoveOn((CHARACTER)_Var1, "END_HighHall_ArrivalReaction", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
StartVoiceBark(END_HighHall_VB_ArrivalReaction_2f18a24d-5347-1124-2575-c288056f4993, _Var1);

IF
DialogEnded(END_HighHall_Arrival_be92c5db-c9bf-4130-25f1-bdde183f7a46, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_END_General_ReadyDragonAndNautiloidWorldTimelines();

PROC
PROC_END_General_ReadyDragonAndNautiloidWorldTimelines()
AND
QRY_OnlyOnce("END_ReadyDragonAndNautiloidWorldTimelineOnce", _, _, _, _)
AND
DB_END_WorldTimelineHelper(_Var1, _Var2, "InitialDialog", _Var1, _Var1)
AND
StartWorldTimeline(_Var1, _Var2, _, _Var4, _Var1)
THEN
DB_END_ActiveWorldTimelines(_Var4);

PROC
PROC_END_BrainBattle_Setup()
AND
QRY_OnlyOnce("END_ReadyDragonAndNautiloidWorldTimelinesBrainBattle", _, _, _, _)
AND
DB_END_WorldTimelineHelper(_Var1, _Var2, "Brain", _Var1, _Var1)
AND
StartWorldTimeline(_Var1, _Var2, _, _Var4, _Var1)
THEN
DB_END_ActiveWorldTimelines(_Var4);

PROC
PROC_END_BrainBattle_RevelryScene()
AND
QRY_OnlyOnce("END_DisableDragonAndNautiloidWorldTimelinesBrainBattle", _, _, _, _)
AND
DB_END_ActiveWorldTimelines(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
StopWorldTimeline(_Var1);
NOT DB_END_ActiveWorldTimelines(_Var1);

IF
FlagSet(END_IllithidOptions_Event_GiveSupremeTadpole_a8128df9-dea6-4a4d-961d-9dbdc49ebb38, (GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
SetFlag(END_General_State_SupremeTadpoleAvailable_0177c452-90cc-4c29-83b8-4acaa2902b27);
ToInventory(S_END_SupremeTadpole_02a7596f-5dcb-4d2a-93c8-611de53096b5, _Var1, 1, 1, 1);
ClearFlag(END_IllithidOptions_Event_GiveSupremeTadpole_a8128df9-dea6-4a4d-961d-9dbdc49ebb38, _Var1);

IF
UseStarted((CHARACTER)_Var1, S_END_SupremeTadpole_02a7596f-5dcb-4d2a-93c8-611de53096b5, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_END_General_UseSupremeTadpole(_Var1);

PROC
PROC_END_General_UseSupremeTadpole((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_GetClosestAvailableCharacterTo(_Var1, 0, _Var1, _Var1, _Var1)
AND
DB_ClosestAvailableCharacterTo_PreferAvatar(_Var2, _Var1, _Var3, 1, _Var1)
AND
_Var3 <= 10
THEN
DB_END_General_CompanionHandingTadpoleToAvatar(_Var1);
PROC_GlobalSetFlagAndCache(END_SupremeTadpole_State_CompanionUsedNearAvatar_e83666c4-63db-4002-963b-53123c284c8c);
PROC_END_General_TryStartSupremeTadpoleDialog(_Var2);

PROC
PROC_END_General_UseSupremeTadpole((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_General_CompanionHandingTadpoleToAvatar(_, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(GLO_Tadpole_PAD_RefuseSupremeTadpole_e0a3c10b-6a7a-d6d1-7951-567889caabf2, _Var1);

PROC
PROC_END_General_UseSupremeTadpole((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_General_TryStartSupremeTadpoleDialog(_Var1);

PROC
PROC_END_General_TryStartSupremeTadpoleDialog((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_GlobalFlag(END_BrainBattle_Event_Started_3cd63c2e-7343-45dd-9137-4cabca2179a6, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(GLO_Tadpole_UseSupremeTadpole_474dd7db-074b-08cf-fd96-9b63fea16985, NULL_00000000-0000-0000-0000-000000000000, _Var1, 0, 0, 0, 0, _Var1, _Var1, _Var1)
THEN
PROC_END_General_RemoveSupremeTadpole();
DB_END_General_SupremeTadpoleHolder(_Var1);

PROC
PROC_END_General_RemoveSupremeTadpole()
AND
GetOwner(S_END_SupremeTadpole_02a7596f-5dcb-4d2a-93c8-611de53096b5, _Var1, _Var1, _Var1, _Var1)
THEN
MagicPocketsDrop(_Var1, S_END_SupremeTadpole_02a7596f-5dcb-4d2a-93c8-611de53096b5);
SetOnStage(S_END_SupremeTadpole_02a7596f-5dcb-4d2a-93c8-611de53096b5, 0);

PROC
PROC_END_General_GiveSupremeTadpole((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
SetOnStage(S_END_SupremeTadpole_02a7596f-5dcb-4d2a-93c8-611de53096b5, 1);
ToInventory(S_END_SupremeTadpole_02a7596f-5dcb-4d2a-93c8-611de53096b5, _Var1, 1, 0, 1);

PROC
PROC_END_General_TryStartSupremeTadpoleDialog((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_GlobalFlag(END_BrainBattle_Event_Started_3cd63c2e-7343-45dd-9137-4cabca2179a6, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(GLO_Tadpole_UseSupremeTadpole_474dd7db-074b-08cf-fd96-9b63fea16985, S_GLO_Netherbrain_3858e896-d7dd-4699-b37d-d3919ff15ba7, _Var1, 0, 0, 0, 0, _Var1, _Var1, _Var1)
THEN
PROC_END_General_RemoveSupremeTadpole();
DB_END_General_SupremeTadpoleHolder(_Var1);

PROC
PROC_DialogFlagSetup(GLO_Tadpole_UseSupremeTadpole_474dd7db-074b-08cf-fd96-9b63fea16985, _, (GUIDSTRING)_Var2, _, _)
AND
DB_Is_InCombat(_Var2, _, _, _, _)
THEN
SetFlag(END_SupremeTadpole_State_UserInCombat_c83894e1-646b-c2b5-faac-82d0927f5d0a, _Var2);

PROC
PROC_StartDialog_AddExtraSpeakers(GLO_Tadpole_UseSupremeTadpole_474dd7db-074b-08cf-fd96-9b63fea16985, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_END_General_CompanionHandingTadpoleToAvatar(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c);

PROC
PROC_StartDialog_AddExtraSpeakers(GLO_Tadpole_UseSupremeTadpole_474dd7db-074b-08cf-fd96-9b63fea16985, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND NOT
DB_GlobalFlag(END_IllithidOptions_Event_EmperorBetrayal_411c2575-bfbc-449c-9762-edad4285aafd, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, 0, 1);

PROC
PROC_StartDialog_AddExtraSpeakers(GLO_Tadpole_UseSupremeTadpole_474dd7db-074b-08cf-fd96-9b63fea16985, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_GlobalFlag(END_IllithidOptions_State_OrpheusIsFree_3b747050-1be0-432e-9de6-e48faa4b74bb, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(END_General_State_OrpheusDefeated_f502054a-3668-4e54-b742-6266d00c4ec1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

IF
DialogEnded(GLO_Tadpole_UseSupremeTadpole_474dd7db-074b-08cf-fd96-9b63fea16985, _, _, _, _)
AND
DB_Players(_Var2, _, _, _, _)
AND
GetFlag(END_SupremeTadpole_State_UserInCombat_c83894e1-646b-c2b5-faac-82d0927f5d0a, _Var2, 1, _, _)
THEN
ClearFlag(END_SupremeTadpole_State_UserInCombat_c83894e1-646b-c2b5-faac-82d0927f5d0a, _Var2);

IF
DialogEnded(GLO_Tadpole_UseSupremeTadpole_474dd7db-074b-08cf-fd96-9b63fea16985, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_END_General_SupremeTadpoleDialogEnded();

PROC
PROC_END_General_SupremeTadpoleDialogEnded()
AND
DB_GlobalFlag(END_General_State_SupremeTadpoleAvailable_0177c452-90cc-4c29-83b8-4acaa2902b27, _, _, _, _)
AND
DB_END_General_SupremeTadpoleHolder(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_General_GiveSupremeTadpole(_Var1);
NOT DB_END_General_SupremeTadpoleHolder(_Var1);
ClearFlag(END_SupremeTadpole_State_CompanionUsedNearAvatar_e83666c4-63db-4002-963b-53123c284c8c);

PROC
PROC_END_General_SupremeTadpoleDialogEnded()
AND
DB_END_General_CompanionHandingTadpoleToAvatar(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_General_CompanionHandingTadpoleToAvatar(_Var1);

PROC
PROC_END_General_SupremeTadpoleDialogEnded()
AND NOT
DB_GlobalFlag(END_General_State_SupremeTadpoleAvailable_0177c452-90cc-4c29-83b8-4acaa2902b27, _, _, _, _)
AND
DB_END_General_SupremeTadpoleHolder(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_General_SupremeTadpoleHolder(_Var1);

IF
FlagSet(END_General_Event_DialogFullCeremorph_d968607c-405b-4a57-9956-477e9708b5b5, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_END_General_RemoveSupremeTadpole();
PROC_END_General_ApplyMindFlayerForm(_Var1);

PROC
PROC_END_General_ApplyMindFlayerForm((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_END_General_ValidPlayerMindFlayerCandidate(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
HasActiveStatus(_Var1, "MIND_FLAYER_FORM", 0, _Var1, _Var1)
AND
QRY_OnlyOnce("END_AppliedMindFlayerForm", _Var1, _Var1, _Var1, _Var1)
THEN
ApplyStatus(_Var1, "MIND_FLAYER_FORM", -1, 1, NULL_00000000-0000-0000-0000-000000000000);

QRY
QRY_END_General_ValidPlayerMindFlayerCandidate((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_END_General_ValidPlayerMindFlayerCandidate(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, _, _, _, _)
AND NOT
DB_Avatars(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_END_General_ValidPlayerMindFlayerCandidate(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, _, _, _, _)
AND NOT
DB_Avatars(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, _, _, _, _)
THEN
DB_NOOP(1);

IF
StatusApplied((CHARACTER)_Var1, "MIND_FLAYER_FORM", (GUIDSTRING)_Var2, _, (CHARACTER)_Var1)
AND
_Var2 != S_GLO_ThrallOfTheAbsolute_AbsoluteHelper_15d4bd12-855b-4483-a2e5-661bfeb96d1f
THEN
PROC_END_General_ApplyFullCeremorphAndReactions(_Var1);

PROC
PROC_END_General_ApplyMindFlayerForm(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _, _, _, _)
AND
HasActiveStatus(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, "MIND_FLAYER_ORPHEUS", 0, _, _)
AND
QRY_OnlyOnce("END_AppliedMindFlayerForm", _, _, _, _)
THEN
ApplyStatus(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, "MIND_FLAYER_ORPHEUS", -1, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
StatusApplied(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, "MIND_FLAYER_ORPHEUS", _, _, (GUIDSTRING)_)
THEN
PROC_END_General_ApplyFullCeremorphAndReactions(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

PROC
PROC_END_General_ApplyFullCeremorphAndReactions((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_General_ReadyTransformVBReaction(_Var1);
DB_END_General_ReadyFollowerADTransformReaction(_Var1);

IF
FlagSet(END_IllithidOptions_State_AssimilatedOrpheus_5562cc3f-c168-48c9-87c1-1598a5c58961, _, _, _, _)
AND
DB_END_General_ReadyTransformVBReaction(_Var3, _, _, _, _)
THEN
NOT DB_END_General_ReadyTransformVBReaction(_Var3);

IF
FlagSet(END_IllithidOptions_State_AssimilatedOrpheus_5562cc3f-c168-48c9-87c1-1598a5c58961, _, (INTEGER)_Var2, _, _)
AND
DB_DialogPlayers(_Var2, _Var3, 1, _, _)
THEN
DB_END_General_ReadyAssimilationVBReaction(_Var3);

IF
DB_END_General_ReadyAssimilationVBReaction(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_DialogPlayers(_, _Var1, _, _Var1, _Var1)
THEN
NOT DB_END_General_ReadyAssimilationVBReaction(_Var1);
StartVoiceBark(END_IllithidOptions_VB_OrpheusAssimilationReaction_186992b2-95ed-c212-7bca-847f5a7b16a7, _Var1);

PROC
PROC_END_General_ApplyFullCeremorphAndReactions((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
ClearFlag(END_General_State_SupremeTadpoleAvailable_0177c452-90cc-4c29-83b8-4acaa2902b27);
SetOnStage(S_END_SupremeTadpole_02a7596f-5dcb-4d2a-93c8-611de53096b5, 0);
SetTag(_Var1, FULL_CEREMORPH_3797bfc4-8004-4a19-9578-61ce0714cc0b);

IF
FlagSet(END_IllithidOptions_State_GaveStones_18e3be1a-c1c0-437e-ad0a-a1426d8830f4, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
SetTag(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, FULL_CEREMORPH_3797bfc4-8004-4a19-9578-61ce0714cc0b);

IF
DB_END_General_ReadyTransformVBReaction(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_DialogPlayers(_, _Var1, _, _Var1, _Var1)
THEN
StartVoiceBark(END_IllithidOptions_VB_TransformationReaction_983619db-fbfd-239f-c7ef-3dcfa1fd6779, _Var1);

IF
AutomatedDialogStarted(END_IllithidOptions_PAD_TransformationReaction_6c3b1a42-5f59-cfb5-5bb8-4e52b2c963bb, _, _, _, _)
AND
DB_END_General_ReadyTransformVBReaction(_Var2, _, _, _, _)
THEN
NOT DB_END_General_ReadyTransformVBReaction(_Var2);

IF
AutomatedDialogEnded(END_IllithidOptions_PAD_TransformationReaction_6c3b1a42-5f59-cfb5-5bb8-4e52b2c963bb, _, _, _, _)
AND
DB_END_General_ReadyTransformVBReaction(_Var2, _, _, _, _)
THEN
NOT DB_END_General_ReadyTransformVBReaction(_Var2);

IF
DB_END_General_ReadyFollowerADTransformReaction(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_General_ReadyTransformVBReaction(_, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_DialogName(END_IllithidOptions_PAD_TransformationReaction_6c3b1a42-5f59-cfb5-5bb8-4e52b2c963bb, _, _Var1, _Var1, _Var1)
AND NOT
DB_DialogPlayers(_, _Var1, _, _Var1, _Var1)
THEN
NOT DB_END_General_ReadyFollowerADTransformReaction(_Var1);
PROC_END_General_TryFollowerTransformReactionAD();

PROC
PROC_END_General_TryFollowerTransformReactionAD()
AND
QRY_END_General_FollowerAvailableForAD(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _, _, _, _)
AND
DB_GlobalFlag(END_IllithidOptions_State_OrpheusIsFree_3b747050-1be0-432e-9de6-e48faa4b74bb, _, _, _, _)
AND
DB_GlobalFlag(END_IllithidOptions_State_ExitPortalAvailable_b97872a1-59cc-40cd-8963-e06be614adc0, _, _, _, _)
THEN
PROC_TryStartAD(END_General_AD_OrpheusTadpoleReact_c201a21f-baea-173b-6d87-77a30b11dddb, S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

QRY
QRY_END_General_FollowerAvailableForAD((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_IllithidOptionsFollower_Follower(_Var1, _, _, _, _Var1)
AND NOT
DB_CantTalk(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
TagSet((CHARACTER)_Var1, FULL_CEREMORPH_3797bfc4-8004-4a19-9578-61ce0714cc0b, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_END_General_PartyMindFlayer(_, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_General_PartyMindFlayer(_Var1);
ToInventory(S_END_CrownController_Complete_5424460f-8a64-45d6-863e-55e5425e271e, _Var1, 1, 1, 1);
ApplyStatus(S_END_CrownController_Complete_5424460f-8a64-45d6-863e-55e5425e271e, "END_CROWNCONTROLLER_BOUNDEDTO", -1, 1, NULL_00000000-0000-0000-0000-000000000000);
PROC_END_General_KarsusStatusSafetyCheck();
PROC_END_General_UpdateMindFlayerFlags(_Var1);

PROC
PROC_END_General_UpdateMindFlayerFlags((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(END_General_State_PlayerIsMindFlayer_d138f537-2268-49a6-8dc4-256bd9cf5633);
SetFlag(END_General_State_PartyMemberIsMindFlayer_3c42b03b-c51c-4f06-a5a3-a5ee416d9d8b);

PROC
PROC_END_General_UpdateMindFlayerFlags(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, _, _, _, _)
AND NOT
DB_Avatars(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, _, _, _, _)
THEN
SetFlag(END_General_State_CompKarlachIsMindFlayer_4f403cb8-c9d8-4e50-ff3a-e56a90c8f1d0);

PROC
PROC_END_General_UpdateMindFlayerFlags(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _, _, _, _)
THEN
SetFlag(END_General_State_OrpheusIsMindFlayer_2b638127-f30a-424e-9d4a-a9f8f100a307);
SetFlag(END_General_State_PartyMemberIsMindFlayer_3c42b03b-c51c-4f06-a5a3-a5ee416d9d8b);

PROC
PROC_END_General_UpdateMindFlayerFlags(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _, _, _, _)
THEN
SetFlag(END_General_State_EmperorIsPartyMindFlayer_4e9c31b2-f298-48f6-853c-e74dd88591e9);
SetFlag(END_General_State_PartyMemberIsMindFlayer_3c42b03b-c51c-4f06-a5a3-a5ee416d9d8b);

PROC
PROC_END_General_UpdateMindFlayerFlags(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, _, _, _, _)
AND
DB_Avatars(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, _, _, _, _)
AND
IsTagged(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c, FULL_CEREMORPH_3797bfc4-8004-4a19-9578-61ce0714cc0b, 1, _, _)
THEN
SetFlag(END_GameFinale_State_AvatarKarlachIllithid_5caf1522-7698-4b37-b6f0-863bfdff21ce);

PROC
PROC_END_General_UpdateMindFlayerFlags(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, _, _, _, _)
AND
DB_Avatars(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, _, _, _, _)
AND
IsTagged(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, FULL_CEREMORPH_3797bfc4-8004-4a19-9578-61ce0714cc0b, 1, _, _)
THEN
SetFlag(END_GameFinale_State_AvatarGaleIllitihid_fe5bd233-b4ac-4b6b-91ce-e588398bec75);

IF
UsingSpellOnTarget((CHARACTER)_Var1, S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, "Target_ExtractBrain_Mindflayer", _, _, (INTEGER)_Var4, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_PartyMindFlayer(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_General_UpdateBrainCastID(_Var1, _Var4);

IF
UsingSpellOnTarget(_, S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, (STRING)_Var2, _, _, _, _, _, _, _)
AND
_Var2 != "Target_ExtractBrain_Mindflayer"
AND
DB_END_General_ExtractBrainCastID(_Var6, _Var7, _, _, _)
THEN
NOT DB_END_General_ExtractBrainCastID(_Var6, _Var7);

PROC
PROC_END_General_UpdateBrainCastID(_, _, _, _, _)
AND
DB_END_General_ExtractBrainCastID(_Var3, _Var4, _, _, _)
THEN
NOT DB_END_General_ExtractBrainCastID(_Var3, _Var4);

PROC
PROC_END_General_UpdateBrainCastID((CHARACTER)_Var1, (INTEGER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
DB_END_General_ExtractBrainCastID(_Var1, _Var2);

IF
KilledBy(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, (CHARACTER)_Var1, _, (INTEGER)_Var3, (CHARACTER)_Var1)
AND
DB_END_General_ExtractBrainCastID(_Var1, _Var3, _Var1, _Var1, _Var1)
AND
DB_Players(_Var4, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_IllithidOptionsFollower_Follower(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _Var5, _Var6, _Var7, _Var1)
AND
GetFlag(_Var5, _Var4, 1, _Var1, _Var1)
THEN
NOT DB_END_General_ExtractBrainCastID(_Var1, _Var3);
DB_END_General_BrainExtractor(_Var1);
ClearFlag(_Var5, _Var4);
PROC_END_General_BrainExtract(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

PROC
PROC_END_General_BrainExtract(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_BrainExtractor(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GlobalSetFlagAndCache(END_IllithidOptions_State_AssimilatedOrpheus_5562cc3f-c168-48c9-87c1-1598a5c58961);
SetFlag(END_IllithidOptions_State_AssimilatorOfOrpheus_56989e8b-cca9-4f3b-aece-26a389e3b6ee, _Var1);
PROC_END_General_CheckBetrayedLaezel(_Var1);

PROC
PROC_END_General_CheckBetrayedLaezel((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_Avatars(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1, _Var1)
AND
GetFlag(ORI_State_PartneredWithLaezel_d169a786-6e56-4f0d-a2eb-33c48d8d1160, _Var1, 1, _Var1, _Var1)
THEN
SetFlag(END_General_State_OrpheusBrainExtractByLaezelPartner_8bef4e13-3c97-4210-970d-d83ff71de33d);

PROC
PROC_END_General_CheckBetrayedLaezel((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_GlobalFlag(ORI_Laezel_State_IsOnOrpheusPath_97244ccc-a6b5-403e-9cfe-a3502eb4af56, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Avatars(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(END_IllithidOptions_Event_OrpheusPathLaezelBetrayed_2be665c6-da32-4e78-bae2-a83fb1b72368);
PROC_END_General_SpellAssimilationOrpheus();
PROC_Origins_CompanionLeavePermanently(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "CompanionHostile");
PROC_SetRelationToPlayers(Origin_Laezel_bee8449b-d682-93c8-e7da-9e4bad369476, 0);
DB_CombatReact_AD_OnDeath(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, END_General_AD_LaezelBetrayedDeath_e8064996-c2f9-9c53-7540-f6f23dc66c19);

PROC
PROC_END_General_SpellAssimilationOrpheus()
THEN
DB_NOOP(1);

PROC
PROC_GLO_PartyMembers_MakeNPCHook(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_BrainExtractor(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_CharacterMoveTo(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, "Sprint", "");

IF
DB_Sees(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(END_IllithidOptions_Event_OrpheusPathLaezelBetrayed_2be665c6-da32-4e78-bae2-a83fb1b72368, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_General_BrainExtractor(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("END_BetrayedLaezel_TurnStartAD", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(END_General_AD_LaezelBetrayed_b7acf440-715b-9b3b-1b2c-a7644d678fd5, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);

IF
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_General_FindMainAvatar();

PROC
PROC_END_General_FindMainAvatar()
AND
DB_END_General_MainDialogAnchor(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_General_MainDialogAnchor(_Var1);

PROC
PROC_END_General_FindMainAvatar()
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsTagged(_Var1, FULL_CEREMORPH_3797bfc4-8004-4a19-9578-61ce0714cc0b, 1, _Var1, _Var1)
AND NOT
DB_END_General_UnavailableAvatar(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_General_MainDialogAnchor(_, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_General_MainDialogAnchor(_Var1);

PROC
PROC_END_General_FindMainAvatar()
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsTagged(_Var1, FULL_CEREMORPH_3797bfc4-8004-4a19-9578-61ce0714cc0b, 1, _Var1, _Var1)
AND NOT
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
CharacterGetOwner(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_Avatars(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_General_UnavailableAvatar(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_General_MainDialogAnchor(_, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_General_MainDialogAnchor(_Var2);

PROC
PROC_END_General_FindMainAvatar()
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_General_UnavailableAvatar(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_General_MainDialogAnchor(_, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_General_MainDialogAnchor(_Var1);

PROC
PROC_END_General_AssignMainAvatar((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_GetBestAvatarForCompanion(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_QRYRTN_GetBestAvatarForCompanion(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_END_General_AssignMainAvatar(_Var2);

PROC
PROC_END_General_AssignMainAvatar((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
CharacterGetOwner(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_END_General_AssignMainAvatar(_Var2);

PROC
PROC_END_General_AssignMainAvatar((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_General_UnavailableAvatar(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_General_MainDialogAnchor(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != _Var2
THEN
NOT DB_END_General_MainDialogAnchor(_Var2);
DB_END_General_MainDialogAnchor(_Var1);

PROC
PROC_END_General_AssignMainAvatar((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_General_MainDialogAnchor(_, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_General_MainDialogAnchor(_Var1);

PROC
PROC_END_General_MakeAvatarUnavailable((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
DB_END_General_ForcedListener(_Var1);

PROC
PROC_END_General_MakeAvatarUnavailable((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_General_UnavailableAvatar(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_General_UnavailableAvatar(_Var1);

PROC
PROC_END_General_MakeAvatarUnavailable((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_MainDialogAnchor(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_General_FindMainAvatar();

PROC
PROC_END_Misc_Init()
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PartOfTheTeam(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_RealPartOfTheTeam(_Var1);

PROC
PROC_END_Misc_Init()
AND
DB_PartOfTheTeam(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _, _, _, _)
THEN
DB_END_RealPartOfTheTeam(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);

PROC
PROC_END_Misc_Init()
AND
DB_PartOfTheTeam(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _, _, _, _)
THEN
DB_END_RealPartOfTheTeam(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

PROC
PROC_END_Misc_Init()
AND
DB_Origins(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PartOfTheTeam(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_RealPartOfTheTeam(_Var1);

PROC
PROC_END_Misc_Init()
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PartOfTheTeam(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_RealPartOfTheTeam(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_RealPartOfTheTeam(_Var1);

PROC
PROC_END_Misc_Init()
AND
DB_END_RealPartOfTheTeam(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PartOfTheTeam(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_RealPartOfTheTeam(_Var1);

IF
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PartOfTheTeam(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_RealPartOfTheTeam(_Var1);

IF
DB_PartOfTheTeam(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b, _, _, _, _)
THEN
DB_END_RealPartOfTheTeam(S_GLO_Emperor_73d49dc5-8b8b-45dc-a98c-927bb4e3169b);

IF
DB_PartOfTheTeam(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e, _, _, _, _)
THEN
DB_END_RealPartOfTheTeam(S_GLO_Orpheus_47c90728-af68-4cbc-baaa-6497eebd8d7e);

IF
DB_Origins(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PartOfTheTeam(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_RealPartOfTheTeam(_Var1);

IF
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PartOfTheTeam(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_RealPartOfTheTeam(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_RealPartOfTheTeam(_Var1);

IF
DB_END_RealPartOfTheTeam(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PartOfTheTeam(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_RealPartOfTheTeam(_Var1);

IF
DB_END_General_FullPartyDialog(_Var1, _Var2, _Var3, 1, _Var4, _Var5, _Var6, _Var7, _Var1, _Var1)
THEN
DB_DialogBlockAttackButton(_Var1);

IF
DB_END_General_FullPartyDialog(_Var1, _Var2, _Var3, _Var4, 1, _Var5, _Var6, _Var7, _Var1, _Var1)
THEN
DB_DialogBlockTradeButton(_Var1);

IF
DB_END_General_FullPartyDialog(_Var1, _Var2, _Var3, _Var4, _Var5, _Var6, _Var7, 1, _Var1, _Var1)
THEN
DB_IgnoreMutingStatussesDialog(_Var1);

IF
DB_END_General_FullPartyDialog(_Var1, _Var2, _Var3, _Var4, _Var5, _Var6, _Var7, 2, _Var1, _Var1)
THEN
DB_DropMutingStatussesDialog(_Var1);

PROC
PROC_StartDialog_AddExtraSpeakers((DIALOGRESOURCE)_Var1, (INTEGER)_Var2, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND
DB_END_General_FullPartyDialog(_Var1, 1, _Var3, _Var4, _Var5, _Var6, _Var7, _Var8, _Var1, _Var1)
AND
_Var8 != 0
AND
DB_END_RealPartOfTheTeam(_Var9, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_END_General_ShouldNotAddToFullPartyDialog(_Var9, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailable(_Var9, _Var6, 1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var2, _Var9, 1, 1);

PROC
PROC_StartDialog_AddExtraSpeakers((DIALOGRESOURCE)_Var1, (INTEGER)_Var2, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND
DB_END_General_FullPartyDialog(_Var1, 1, _Var3, _Var4, _Var5, _Var6, _Var7, _Var8, _Var1, _Var1)
AND
_Var8 == 0
AND
DB_END_RealPartOfTheTeam(_Var9, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_END_General_ShouldNotAddToFullPartyDialog(_Var9, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailable(_Var9, _Var6, 0, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var2, _Var9, 1, 1);

IF
DB_DialogName(_Var1, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_DialogEnding(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_END_General_FullPartyDialog(_Var1, 1, _Var3, _Var4, _Var5, _Var6, _Var7, _Var8, _Var1, _Var1)
AND
DB_END_RealPartOfTheTeam(_Var9, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_DialogPlayers(_Var2, _Var9, _, _Var1, _Var1)
AND NOT
DB_DialogNPCs(_Var2, _Var9, _, _Var1, _Var1)
AND NOT
QRY_END_General_ShouldNotAddToFullPartyDialog(_Var9, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddListeningActor(_Var2, _Var9);

PROC
PROC_StartDialog_AddExtraSpeakers((DIALOGRESOURCE)_Var1, (INTEGER)_Var2, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND
DB_END_General_FullPartyDialog(_Var1, 0, _Var3, _Var4, _Var5, _Var6, _Var7, _Var8, _Var1, _Var1)
AND
_Var8 != 0
AND
DB_PartyMembers(_Var9, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_RealPartOfTheTeam(_Var9, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_END_General_ShouldNotAddToFullPartyDialog(_Var9, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailable(_Var9, _Var6, 1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var2, _Var9, 1, 1);

PROC
PROC_StartDialog_AddExtraSpeakers((DIALOGRESOURCE)_Var1, (INTEGER)_Var2, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND
DB_END_General_FullPartyDialog(_Var1, 0, _Var3, _Var4, _Var5, _Var6, _Var7, _Var8, _Var1, _Var1)
AND
_Var8 == 0
AND
DB_PartyMembers(_Var9, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_RealPartOfTheTeam(_Var9, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_END_General_ShouldNotAddToFullPartyDialog(_Var9, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailable(_Var9, _Var6, 0, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var2, _Var9, 1, 1);

IF
DB_DialogName(_Var1, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_DialogEnding(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_END_General_FullPartyDialog(_Var1, 0, _Var3, _Var4, _Var5, _Var6, _Var7, _Var8, _Var1, _Var1)
AND
DB_PartyMembers(_Var9, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_RealPartOfTheTeam(_Var9, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_DialogPlayers(_Var2, _Var9, _, _Var1, _Var1)
AND NOT
DB_DialogNPCs(_Var2, _Var9, _, _Var1, _Var1)
AND NOT
QRY_END_General_ShouldNotAddToFullPartyDialog(_Var9, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddListeningActor(_Var2, _Var9);

QRY
QRY_END_General_ShouldNotAddToFullPartyDialog((CHARACTER)_Var1, (DIALOGRESOURCE)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Defeated(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_END_General_ShouldNotAddToFullPartyDialog((CHARACTER)_Var1, (DIALOGRESOURCE)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_FullPartyDialog(_Var2, _, _, _, _, 0, _, 0, _Var1, _Var1)
AND
DB_CantTalk(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_END_General_ShouldNotAddToFullPartyDialog((CHARACTER)_Var1, (DIALOGRESOURCE)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_FullPartyDialog(_Var2, _, _, _, _, 1, _, 0, _Var1, _Var1)
AND
DB_CantTalk_IgnoreCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_END_General_ShouldNotAddToFullPartyDialog((CHARACTER)_Var1, (DIALOGRESOURCE)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_FullPartyDialog(_Var2, _, _, _, _, 0, _, _Var8, _Var1, _Var1)
AND
_Var8 != 0
AND
DB_CantTalk_IgnoreStatuses(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_END_General_ShouldNotAddToFullPartyDialog((CHARACTER)_Var1, (DIALOGRESOURCE)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_FullPartyDialog(_Var2, _, _, _, _, 1, _, _Var8, _Var1, _Var1)
AND
_Var8 != 0
AND
DB_CantTalk_IgnoreStatusesCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
FlagSet(END_General_State_InclusionExcluded_98c42fdb-7511-72c1-3861-a9232a4c40f7, (GUIDSTRING)_Var1, (INTEGER)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_DialogName(_Var3, _Var2, _Var1, _Var1, _Var1)
THEN
DB_END_General_ExcludedInterjectionCandidate(_Var1);
PROC_END_General_CheckAvailableInterjection(_Var3);

IF
FlagCleared(END_General_State_InclusionExcluded_98c42fdb-7511-72c1-3861-a9232a4c40f7, (GUIDSTRING)_Var1, (INTEGER)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_DialogName(_Var3, _Var2, _Var1, _Var1, _Var1)
THEN
NOT DB_END_General_ExcludedInterjectionCandidate(_Var1);
PROC_END_General_CheckAvailableInterjection(_Var3);

PROC
PROC_END_General_CheckAvailableInterjection((DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND NOT
QRY_END_General_AnyInterjectionAvailable()
AND
DB_END_General_InterjectionDialog(_Var1, _Var2, _, _, _Var1)
THEN
ClearFlag(_Var2, NULL_00000000-0000-0000-0000-000000000000, 0);

PROC
PROC_END_General_CheckAvailableInterjection((DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND
QRY_END_General_AnyInterjectionAvailable()
AND
DB_END_General_InterjectionDialog(_Var1, _Var2, _, _, _Var1)
THEN
SetFlag(_Var2, NULL_00000000-0000-0000-0000-000000000000, 0);

QRY
QRY_END_General_AnyInterjectionAvailable()
AND
DB_END_General_PotentialInterjectionCandidate(_Var1, _Var2, _Var3, _Var1, _Var1)
AND NOT
DB_END_General_ExcludedInterjectionCandidate(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
DialogActorLeft((DIALOGRESOURCE)_Var1, _, (GUIDSTRING)_Var3, _, (DIALOGRESOURCE)_Var1)
AND
DB_END_General_ExcludedInterjectionCandidate(_Var3, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_General_ExcludedInterjectionCandidate(_Var3);
ClearFlag(END_General_State_InclusionExcluded_98c42fdb-7511-72c1-3861-a9232a4c40f7, _Var3);

IF
DialogActorJoined((DIALOGRESOURCE)_Var1, (INTEGER)_Var2, (CHARACTER)_Var3, (INTEGER)_Var4, (DIALOGRESOURCE)_Var1)
AND
DB_END_General_InterjectionDialog(_Var1, _Var5, _Var6, _Var7, _Var1)
AND
_Var4 >= _Var6
AND
_Var4 <= _Var7
AND NOT
DB_Avatars(_Var3, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_General_PotentialInterjectionCandidate(_Var3, _Var2, _Var1);

PROC
PROC_DialogAddSpeakingActor((INTEGER)_Var1, (CHARACTER)_Var2, _, _, (INTEGER)_Var1)
AND
DB_DialogRequestCache_DialogInstance(_Var5, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_General_InterjectionDialog(_Var5, _Var6, _Var7, _Var8, _Var1)
AND NOT
DB_GlobalFlag(_Var6, _Var1, _Var1, _Var1, _Var1)
AND
DB_END_RealPartOfTheTeam(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_General_ExcludedInterjectionCharacters(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
IsTagged(_Var2, AVATAR_306b9b05-1057-4770-aa17-01af21acd650, 0, _Var1, _Var1)
THEN
SetFlag(_Var6, NULL_00000000-0000-0000-0000-000000000000, 0);

IF
FlagSet(END_RandomCompanion_Find_b80c6715-9cc9-5106-015e-433cd682eb7a, (CHARACTER)_Var1, (INTEGER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
ClearFlag(END_RandomCompanion_Find_b80c6715-9cc9-5106-015e-433cd682eb7a, _Var1, _Var2);
PROC_END_General_AssignInterjection(_Var1, _Var2, END_RandomCompanion_Find_b80c6715-9cc9-5106-015e-433cd682eb7a);

IF
FlagSet(END_RandomPartyMember_Find_418e721f-1710-450b-b73d-1378bcaa2bbd, (CHARACTER)_Var1, (INTEGER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
ClearFlag(END_RandomPartyMember_Find_418e721f-1710-450b-b73d-1378bcaa2bbd, _Var1, _Var2);
PROC_END_General_AssignInterjection(_Var1, _Var2, END_RandomPartyMember_Find_418e721f-1710-450b-b73d-1378bcaa2bbd);

PROC
PROC_END_General_AssignInterjection((CHARACTER)_Var1, (INTEGER)_Var2, (FLAG)_Var3, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_InterjectionCharacter(_Var4, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_General_InterjectionCharacter(_Var4);
ClearFlag(END_RandomCompanion_Picked_d39d2a4e-2efb-c14c-ba23-f5c03fac5038, _Var4, 0);

PROC
PROC_END_General_AssignInterjection((CHARACTER)_Var1, (INTEGER)_Var2, (FLAG)_Var3, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_ActualInterjectionCandidate(_Var4, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_END_General_ActualInterjectionCandidate(_Var4);

PROC
PROC_END_General_AssignInterjection((CHARACTER)_Var1, (INTEGER)_Var2, END_RandomCompanion_Find_b80c6715-9cc9-5106-015e-433cd682eb7a, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_PotentialInterjectionCandidate(_Var3, _Var2, _Var4, _Var1, _Var1)
AND NOT
DB_END_General_ExcludedInterjectionCandidate(_Var3, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_General_ActualInterjectionCandidate(_Var3);

PROC
PROC_END_General_AssignInterjection((CHARACTER)_Var1, (INTEGER)_Var2, END_RandomPartyMember_Find_418e721f-1710-450b-b73d-1378bcaa2bbd, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_General_PotentialInterjectionCandidate(_Var3, _Var2, _Var4, _Var1, _Var1)
AND
DB_PartyMembers(_Var3, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_END_General_ExcludedInterjectionCandidate(_Var3, _Var1, _Var1, _Var1, _Var1)
THEN
DB_END_General_ActualInterjectionCandidate(_Var3);

PROC
PROC_END_General_AssignInterjection((CHARACTER)_Var1, (INTEGER)_Var2, (FLAG)_Var3, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_GetRandom("DB_END_General_ActualInterjectionCandidate", 1, "DB_END_General_InterjectionCharacter", _Var1, _Var1)
AND
DB_END_General_InterjectionCharacter(_Var4, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(END_RandomCompanion_Picked_d39d2a4e-2efb-c14c-ba23-f5c03fac5038, _Var4, 0);

IF
DialogEnded((DIALOGRESOURCE)_Var1, _, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND
DB_END_General_InterjectionDialog(_Var1, _Var3, _, _, _Var1)
AND
DB_GlobalFlag(_Var3, _Var1, _Var1, _Var1, _Var1)
THEN
ClearFlag(_Var3, NULL_00000000-0000-0000-0000-000000000000, 0);

PROC
PROC_END_General_CombineStones(_, _, _, _, _)
AND
DB_GLO_EmperorPrelude_NetherStoneTrackers(_Var2, _, _, _, _, _, _, _, _, _)
AND
GetOwner(_Var2, _Var8, _, _, _)
THEN
MagicPocketsDrop(_Var8, _Var2);

PROC
PROC_END_General_CombineStones(_, _, _, _, _)
AND
DB_GLO_EmperorPrelude_NetherStoneTrackers(_Var2, _, _, _, _, _, _, _, _, _)
THEN
SetOnStage(_Var2, 0);

PROC
PROC_END_General_CombineStones((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("END_General_StonesCombined", _Var1, _Var1, _Var1, _Var1)
THEN
ToInventory(S_END_CrownController_Complete_5424460f-8a64-45d6-863e-55e5425e271e, _Var1, 1, 1, 1);

PROC
PROC_END_General_KarsusStatusSafetyCheck()
AND
DB_END_General_PartyMindFlayer(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
HasSpell(_Var1, "Target_END_Mindflayer_CrownDomination", 0, _Var1, _Var1)
THEN
AddSpell(_Var1, "Target_END_Mindflayer_CrownDomination", 0, 0);

PROC
PROC_END_Misc_Init()
THEN
PROC_TriggerRegisterForPlayers(S_END_MindFlayerOutburstTrigger_01_03e6520d-58ae-4fce-bc25-a3dce2977810);
DB_END_MindflayerOutburst_TurnedCivilians(S_END_MindFlayerOutburstCivilian_01_74e72b8f-f071-4778-9114-0281f43a7c36, "Shout_END_MindFlayerFormCivilian", 0);
DB_END_MindflayerOutburst_TurnedCivilians(S_END_MindFlayerOutburstCivilian_02_71294a40-be3e-4543-b01e-f5332cf086d5, "Shout_END_MindFlayerFormCivilian", 400);

IF
DB_END_MindflayerOutburst_TurnedCivilians(_Var1, _, _, _Var1, _Var1)
THEN
PROC_CharacterDisableAllCrimes(_Var1);

IF
AttackedBy((CHARACTER)_Var1, _, _, _, _, _, _, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_MindflayerOutburst_TurnedCivilians(_Var1, _, _, _Var1, _Var1)
THEN
PROC_END_MindflayerOutburst_TurnToMindflayer();

IF
EnteredTrigger((CHARACTER)_Var1, S_END_MindFlayerOutburstTrigger_01_03e6520d-58ae-4fce-bc25-a3dce2977810, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_END_MindflayerOutburst_TurnToMindflayer();

PROC
PROC_END_MindflayerOutburst_TurnToMindflayer()
AND
QRY_OnlyOnce("END_MindflayerOutburst_TurnToMindflayer_OnlyOnce", _, _, _, _)
AND
DB_END_MindflayerOutburst_TurnedCivilians(_Var1, _, _Var3, _Var1, _Var1)
THEN
RealtimeObjectTimerLaunch(_Var1, "END_MindflayerOutburst_TurnToMindflayer_Delay", _Var3);

IF
ObjectTimerFinished((CHARACTER)_Var1, "END_MindflayerOutburst_TurnToMindflayer_Delay", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_END_MindflayerOutburst_TurnedCivilians(_Var1, _Var2, _Var3, _Var1, _Var1)
AND NOT
DB_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
UseSpell(_Var1, _Var2, _Var1);
RemoveStatus(_Var1, "ANIM_COWER");
NOT DB_END_MindflayerOutburst_TurnedCivilians(_Var1, _Var2, _Var3);

PROC
PROC_END_MindflayerOutburst_TurnToMindflayer()
THEN
PROC_TriggerUnregisterForPlayers(S_END_MindFlayerOutburstTrigger_01_03e6520d-58ae-4fce-bc25-a3dce2977810);

IF
FlagSet((FLAG)_Var1, (CHARACTER)_Var2, _, (FLAG)_Var1, (FLAG)_Var1)
AND
DB_END_General_TadpoleAndStoneTracking(_, _Var1, _Var5, _, _Var7)
THEN
ShowMapMarker(_Var2, _Var7, 0);
SetFlag(_Var5);
PROC_END_General_ResetLeaveAttemptFlag();

IF
FlagCleared(END_General_State_HasSupremeTadpole_a0d1a230-79f8-4af6-a425-f9d8a771bd24, (GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
QRY_END_General_PartyHasSupremeTadpole()
THEN
ClearFlag(END_General_State_PartyHasSupremeTadpole_a0ee98a9-7272-415a-95f6-f11c86048593);

IF
FlagCleared(END_General_State_HasCrownController_de78970a-95c8-4e54-bdf7-28f1da9ca83b, (GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
QRY_END_General_PartyHasCompleteCrownController()
THEN
ClearFlag(END_General_State_PartyHasCrownController_d526db7f-8ded-4755-84cd-498fd629b11d);

QRY
QRY_END_General_PartyHasSupremeTadpole()
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetFlag(END_General_State_HasSupremeTadpole_a0d1a230-79f8-4af6-a425-f9d8a771bd24, _Var1, 1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_END_General_PartyHasCompleteCrownController()
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetFlag(END_General_State_HasCrownController_de78970a-95c8-4e54-bdf7-28f1da9ca83b, _Var1, 1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_END_General_CanProceedTowardsFinale()
AND
DB_GlobalFlag(END_General_State_PartyMemberIsMindFlayer_3c42b03b-c51c-4f06-a5a3-a5ee416d9d8b, _, _, _, _)
AND
QRY_END_General_PartyHasCompleteCrownController()
THEN
DB_NOOP(1);

QRY
QRY_END_General_CanProceedTowardsFinale()
AND
QRY_END_General_PartyHasSupremeTadpole()
AND
QRY_END_General_PartyHasCompleteCrownController()
THEN
DB_NOOP(1);

QRY
QRY_END_General_CanProceedTowardsFinale()
AND
DB_GlobalFlag(END_IllithidOptions_State_GaveStones_18e3be1a-c1c0-437e-ad0a-a1426d8830f4, _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_END_General_CanProceedTowardsFinale()
AND
DB_GlobalFlag(END_General_State_OrpheusIsMindFlayer_2b638127-f30a-424e-9d4a-a9f8f100a307, _, _, _, _)
THEN
DB_NOOP(1);

PROC
PROC_END_General_ThrallOfTheAbsoluteWarning((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_StartDialogCustom(END_General_TadpoleOrNetherstoneAbsent_24763045-86d0-69a7-83f2-5f531a3e589f, _Var1, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_END_General_ResetLeaveAttemptFlag()
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
ClearFlag(END_General_State_LeaveWithoutStoryItemsAttempt_d8a2a19f-662a-1df2-cee2-782d32c2d344, _Var1);

IF
FlagCleared((FLAG)_Var1, (CHARACTER)_Var2, _, (FLAG)_Var1, (FLAG)_Var1)
AND
DB_END_General_TadpoleAndStoneTracking(_Var4, _Var1, _, _, _Var7)
AND NOT
QRY_ItemInMagicPockets(_Var2, _Var4, _Var1, _Var1, _Var1)
THEN
ShowMapMarker(_Var2, _Var7, 1);

IF
DroppedBy((ITEM)_Var1, (CHARACTER)_Var2, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_END_General_TadpoleAndStoneTracking(_Var1, _, _, _Var5, _)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(_Var5, _Var2);

PROC
PROC_END_Misc_Init()
THEN
DB_GLO_RestorationStation(S_END_HighHallExterior_ResotrationPod_424a5497-b958-4360-b826-f93eb9f88690);
DB_GLO_RestorationStation_OneTimeUse(S_END_HighHallExterior_ResotrationPod_424a5497-b958-4360-b826-f93eb9f88690);
DB_GLO_RestorationStation(S_END_HighHallInterior_ResotrationPod_1933944a-7724-4091-9c88-1e501516b890);
DB_GLO_RestorationStation_OneTimeUse(S_END_HighHallInterior_ResotrationPod_1933944a-7724-4091-9c88-1e501516b890);

PROC
PROC_Hardcore_Disable("END_Main", _, _, _, _)
THEN
SetOnStage(S_END_HighHallExterior_ResotrationPod_424a5497-b958-4360-b826-f93eb9f88690, 1);
SetOnStage(S_END_HighHallInterior_ResotrationPod_1933944a-7724-4091-9c88-1e501516b890, 1);

PROC
PROC_Hardcore_Enable("END_Main", _, _, _, _)
THEN
SetOnStage(S_END_HighHallExterior_ResotrationPod_424a5497-b958-4360-b826-f93eb9f88690, 0);
SetOnStage(S_END_HighHallInterior_ResotrationPod_1933944a-7724-4091-9c88-1e501516b890, 0);

PROC
PROC_StartDialog_AddExtraSpeakers((DIALOGRESOURCE)_Var1, (INTEGER)_Var2, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND
DB_END_HideMindBrainDialogs(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var2, S_END_MindBattleHelper_be50f7cd-c14a-4131-82d3-29337f3a4759);

IF
FlagSet((FLAG)_Var1, (CHARACTER)_Var2, (INTEGER)_Var3, (FLAG)_Var1, (FLAG)_Var1)
AND
DB_END_General_MakeUnavailableCharacterFlag(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_General_MakeAvatarUnavailable(_Var2);

IF
FlagSet((FLAG)_Var1, _, _, (FLAG)_Var1, (FLAG)_Var1)
AND
DB_END_General_MakeUnavailableFlag(_Var4, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_END_General_MakeAvatarUnavailable(_Var4);

IF
FlagSet(END_GameFinale_State_PlayerLaezelOrpheus_9bbf4067-fcb1-0c74-088d-ff887ca2abe5, _, (INTEGER)_Var2, _, _)
AND
DB_DialogSpeakers(_Var2, _Var3, 2, _, _)
THEN
PROC_END_General_MakeAvatarUnavailable(_Var3);

IF
FlagSet(END_GameFinale_State_PlayerLaezelVlaakith_bf95c085-fe78-9cda-7aac-2d8e5b94a9cf, _, (INTEGER)_Var2, _, _)
AND
DB_DialogSpeakers(_Var2, _Var3, 2, _, _)
THEN
PROC_END_General_MakeAvatarUnavailable(_Var3);

IF
DialogEnded(END_GameFinale_DeathofKarlach_e419b950-b6ba-64bc-f041-1d07a602dfc4, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_END_General_MakeAvatarUnavailable(S_Player_Karlach_2c76687d-93a2-477b-8b18-8a14b549304c);

IF
FlagSet(END_FinalDecisions_Event_GaleExploded_a32e3cb5-9536-3c3e-a4d2-1837ee3b6190, _, _, _, _)
AND
DB_GlobalFlag(END_BrainBattle_Event_GaleAscendsTheStalkAlone_217731da-1297-09b6-52b0-e9ee8580e70c, _, _, _, _)
THEN
PROC_END_General_MakeAvatarUnavailable(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604);

IF
FlagSet(END_FinalDecisions_Event_GaleExploded_a32e3cb5-9536-3c3e-a4d2-1837ee3b6190, _, _, _, _)
AND NOT
DB_GlobalFlag(END_BrainBattle_Event_GaleAscendsTheStalkAlone_217731da-1297-09b6-52b0-e9ee8580e70c, _, _, _, _)
AND
DB_Players(_Var3, _, _, _, _)
THEN
PROC_END_General_MakeAvatarUnavailable(_Var3);


EXITSECTION
ENDEXITSECTION

ParentTargetEdge "Act3c"
