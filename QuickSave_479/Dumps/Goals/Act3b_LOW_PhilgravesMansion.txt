Version 1
SubGoalCombiner SGC_AND

INITSECTION
Open(S_LOW_AncientLairEntranceDoor_13b8694c-dd66-486d-8487-3e7561e0ba21);
DB_LOW_PhilgravesMansion_AllowedUndeadTagsInLair(UNDEAD_33c625aa-6982-4c27-904f-e47029a9b140);
DB_LOW_PhilgravesMansion_AllowedUndeadTagsInLair(UNDEAD_BEAST_1d156657-b014-48fa-b34c-327763480627);
DB_LOW_PhilgravesMansion_AllowedUndeadTagsInLair(VAMPIRE_f6662b6e-b3bf-468e-82cb-402247176a1b);
DB_LOW_PhilgravesMansion_AllowedUndeadTagsInLair(GHOST_3def9d73-7c73-487b-8111-d1df1dce076e);
DB_LOW_PhilgravesMansion_AllowedUndeadTagsInLair(SKELETON_146a89e7-802f-4926-bc21-4a41c2478502);
DB_LOW_PhilgravesMansion_AllowedUndeadTagsInLair(REALLY_ASTARION_ffd08582-7396-4cac-bcd4-8f9cd0fd8ef3);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLairMummy_001_65b33bdc-3126-4962-a712-4175007d9e54);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLairMummy_002_6f71be30-7cab-43a7-999d-12b9adde5a0e);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLairMummy_003_6d04276b-aefd-43a2-a2f0-eb586bcfc881);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLairMummy_004_d526d72a-599c-464e-b7fe-84128d496b3c);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLairMummy_005_331ffe6e-00c9-4f79-94d4-c6d65b4a9093);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLair_GreaterZombie_000_bd8ab705-e59e-44b1-89fa-df0dc41cd563);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLair_GreaterZombie_001_64b89b9c-657a-40d3-8232-3931e6c72aaf);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLair_GreaterZombie_002_ba701b3d-20ec-4225-8a69-3a8be31b4c4f);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLair_CrawlingClaw_002_8aa6c119-d8f2-4c47-877b-425645df061c);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLair_CrawlingClaw_000_7f5d8047-66dd-4cec-a992-98d7fe7d9263);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLair_CrawlingClaw_001_b174f4f8-7a3e-49d9-90c4-a254bbee9c41);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLair_CrawlingClaw_003_dfb5ea37-aebf-45c5-a658-d69534414132);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLair_CrawlingClaw_004_461234ed-2457-417b-b850-7dffb9d57498);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLair_CrawlingClaw_005_387ea8f7-eed3-46b0-81bc-a2ecc280550c);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLair_CrawlingClaw_006_2928d81e-4ceb-466f-95a4-a774b35a4c83);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLair_CrawlingClaw_007_fdc82f15-f593-4f03-a9da-26505e66e8e1);
DB_LOW_PhilgravesMansion_LairEnemies(S_LOW_AncientLair_CrawlingClaw_008_bfaacde1-8b90-4846-b474-5d8f8f81c4f6);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_001_963cf82e-1255-4da6-9c16-f1c8b98a33a4);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_002_f721addc-feed-494e-b2d2-94da197daf3c);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_003_130229a5-5da4-45f2-892e-1034f199b519);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_004_b89866e4-b57a-4346-96d9-317a94920ceb);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_005_5e0ac38e-7fa8-482f-a0e5-829b700d1bfc);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_006_d15370a7-43c8-4a99-90bc-0a0d8a7dadfe);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_007_04a7b7ce-6d9d-4f9d-8629-ff268255be8a);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_008_01a006b8-9a61-46dd-aa2f-00113ef46b73);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_009_6901c2fc-554a-44c6-8e49-2c847fe70a94);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_010_262ab1a6-2e77-47d3-8ef6-db44c289eda4);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_011_a9f10a6d-50bc-47fb-9731-43223ec4b6ac);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_012_aacb0126-6490-4df5-9e64-5f020e9a5a08);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_013_5debe83a-93a8-416b-83ba-aac9bc8873dd);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_014_97e9b580-2b7e-458c-a2a6-06537f1afd2b);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_015_7d5685a7-e475-4ab2-b557-c8eb0e424574);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_016_08da9e05-e528-47dd-b360-20ac59c27551);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_017_f3ddfb1f-5ac2-495d-8c46-e6208b3b2f96);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_018_43f0d8cb-b202-40d6-ba66-449c7f1b4aad);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_019_4fb5ae5b-8780-4e36-8bda-c33f4698ac56);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_LairWorkshopDoor_89f3dd4f-850f-44a5-8441-42e35330a5dc);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_020_f1cff6a8-0e7f-4750-b398-0d05a1214ff1);
DB_LOW_PhilgravesMansion_LairItems(S_LOW_PhilgravesMansion_AncientLairObject_021_73fdd8fe-7f19-4ee5-b6af-61bf42ae065c);
ToInventory(S_UNI_LOW_TorchOfRevocation_a042774f-ae71-4d19-9554-ba90cf34d046, S_LOW_PhilgravesMansion_ClientChest_ee7e8c08-5359-4cc2-932a-42edd01c4de6, 1, 0, 0);
SetFlag(LOW_PhilgravesMansion_TorchIsInChest_177f5f22-0fd8-4e31-8949-cb8cf45f0dfa);
PROC_SetOnStage(S_LOW_NoteFromThrumbo_c1fb827d-eb8c-4898-8d3b-32281695a682, 0);
PROC_SetOnStage(S_LOW_CarrionThreat_2ae36508-b040-4292-843d-b5939285435e, 0);
PROC_SetOnStage(S_LOW_PhilgravesBasementHatch_b65ea489-3d05-450e-b19f-1e0265ed1ba5, 1);
PROC_SetOnStage(S_LOW_ThrumboRing_15edfd0b-ae2a-4ce5-8369-748070746713, 0);
DB_SpotPlayers(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, "LOW_PhilgravesMansion_CarrionSpotted", NULL_00000000-0000-0000-0000-000000000000, LOW_PhilgravesMansion_State_CarrionNotSpotting_223ba810-bd5e-4a07-801b-2a84c8eedd04);
DB_SpotPlayers_SpotTrigger(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, "LOW_PhilgravesMansion_CarrionSpotted", LOW_PhilgravesMansion_MainHallTrigger_97b50e48-fc3e-435c-a3ba-2745eb733f2e);
Open(S_LOW_AncientLairEntranceDoor_13b8694c-dd66-486d-8487-3e7561e0ba21);
DB_IgnoreMutingStatussesDialog(LOW_PhilgravesMansion_AngryFatherCarrion_f1c37076-434c-a441-d6ec-0f0827f97ed2);
DB_PreventPermaDefeated(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e);
DB_Dialogs(S_LOW_FatherCarrion_CoffinMummy_000_d03067ac-43a7-435b-be97-558065b1f7d1, LOW_PhilgravesMansion_CoffinMummy_000_5aadf206-e35a-4a08-3fec-9d1c0bfef808);
DB_Dialogs(S_LOW_FatherCarrion_CoffinMummy_001_f7e60433-053d-4735-b542-658397785f7a, LOW_PhilgravesMansion_CoffinMummy_001_1f905333-6dbe-170e-058e-48803196ca32);
DB_Dialogs(S_LOW_FatherCarrion_CoffinMummy_002_2bb0196b-9bd6-4eb3-989f-29d14a8cd2d8, LOW_PhilgravesMansion_CoffinMummy_002_7dd9b447-3245-f1d2-32b5-604891e23409);
DB_Dialogs(S_LOW_FatherCarrion_CoffinMummy_003_1ada20fe-49b1-4663-a832-0e2c7126907d, LOW_PhilgravesMansion_CoffinMummy_003_1eb7ebed-5659-10ea-d9e8-cabdf6a09c08);
DB_Dialogs(S_LOW_FatherCarrion_CoffinMummy_004_ca673f78-bf5a-4170-9a3d-86956fd7320b, LOW_PhilgravesMansion_CoffinMummy_004_46d3bf88-3980-126f-7ace-e70ae3658aed);
DB_Dialogs(S_LOW_FatherCarrion_CoffinMummy_005_9ede4829-ec97-40b6-ac1c-ef14b9c6d14a, LOW_PhilgravesMansion_CoffinMummy_005_de579c75-7fd7-5c4f-7832-f36c24e9168b);
DB_Dialogs(S_LOW_FatherCarrion_CoffinMummy_006_e6bd5cec-2691-4dc4-99ae-2461c87bb6ba, LOW_PhilgravesMansion_CoffinMummy_006_3c872b31-e6fb-891a-1566-6c75cac67ba5);
DB_Dialogs(S_LOW_FatherCarrion_Ghoul_000_d8141d00-5f80-4245-9a48-fe3651be6954, LOW_PhilgravesMansion_CarrionGhoul_000_874a2940-42d6-0557-a06d-4e3a3aee1f6b);
DB_Dialogs(S_LOW_FatherCarrion_Ghoul_001_ea1e4956-140f-4dda-a0eb-211744ec3fd0, LOW_PhilgravesMansion_CarrionGhoul_001_2985a732-1084-d784-f850-7d2872c6dd6b);
DB_Dialogs(S_LOW_FatherCarrion_Ghoul_002_f0f2dbe1-d72b-48b0-9e9f-8a47ab189cfa, LOW_PhilgravesMansion_CarrionGhoul_002_d3f42ced-8f2f-ac11-11fd-d984bd613ea7);
DB_Dialogs(S_LOW_FatherCarrion_Ghoul_003_08bfd546-b2c2-461d-83e5-fc86160b3bfc, LOW_PhilgravesMansion_CarrionGhoul_003_412aa655-c826-4ed9-019f-c09378776d59);
DB_Dialogs(S_LOW_FatherCarrion_Ghoul_004_bbc46971-3203-44b2-8582-b8822b1d5d70, LOW_PhilgravesMansion_CarrionGhoul_004_9ace1117-027d-891c-7982-bc9d6df5657a);
DB_GLO_CharacterCorpseDialog(S_LOW_DeadAdventurer_001_98f5af07-74fb-49ae-be05-3834e0a23464, LOW_PhilgravesMansion_DeadAdventurer_Dead_219fa9ed-e842-ecf0-b64b-15097fb0db7b);
DB_HasItemEvent(S_LOW_UNI_CarrionJar_Lungs_cc6570db-e584-4ba1-a162-7a5419c887f8, LOW_PhilgravesMansion_State_HasLungs_2e069f6f-27cb-4646-a3b5-ab559216b18e);
DB_HasItemEvent(S_LOW_UNI_CarrionJar_Liver_add49a50-6200-4430-9f28-e4fe79e45a48, LOW_PhilgravesMansion_State_HasLiver_ed2cbee5-58d3-40ed-b81c-48b3689327c9);
DB_HasItemEvent(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492, LOW_PhilgravesMansion_State_HasHeart_22154967-9777-4149-bbae-216409fea025);
DB_HasItemEvent(S_LOW_UNI_CarrionJar_Brain_d4c6be37-524a-43cd-ad45-4fc9b68cf531, LOW_PhilgravesMansion_State_HasBrain_2de27cfc-fc18-4db0-abe6-b7f6f6d6b2a2);
DB_HasItemEvent(S_LOW_ThrumboRing_15edfd0b-ae2a-4ce5-8369-748070746713, LOW_PhilgravesMansion_State_HasThrumboRing_38b11f4b-ac6c-4861-8648-0d40f8c83cd0);
DB_LOW_PhilgravesMansion_CarrionBuffs("LOW_PHILGRAVESMANSION_CANOPICAURA_HEART", S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492);
DB_LOW_PhilgravesMansion_CarrionBuffs("LOW_PHILGRAVESMANSION_CANOPICAURA_LIVER", S_LOW_UNI_CarrionJar_Liver_add49a50-6200-4430-9f28-e4fe79e45a48);
DB_LOW_PhilgravesMansion_CarrionBuffs("LOW_PHILGRAVESMANSION_CANOPICAURA_BRAIN", S_LOW_UNI_CarrionJar_Brain_d4c6be37-524a-43cd-ad45-4fc9b68cf531);
DB_LOW_PhilgravesMansion_CarrionBuffs("LOW_PHILGRAVESMANSION_CANOPICAURA_LUNGS", S_LOW_UNI_CarrionJar_Lungs_cc6570db-e584-4ba1-a162-7a5419c887f8);
DB_Dialogs(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, LOW_PhilgravesMansion_FatherCarrion_b141f677-21c0-cba8-331e-21e157dba36b);
DB_Dialogs(S_LOW_Ghast_48d8e43e-e5d1-4ae4-bd14-8208bdacb21b, LOW_PhilgravesMansion_Ghast_c6d694f1-0da7-d86c-819d-4ebc8feddb54);
DB_Dialogs(S_LOW_ZombieBeggar_001_3bca7480-e42d-4c3f-aa12-2b03a03064aa, LOW_PhilgravesMansion_ZombieBeggar_Morbus_f975f719-21d3-fea9-4147-c58f3b313473);
DB_Dialogs(S_LOW_ZombieBeggar_002_d4ff4e8c-7788-408b-a9ee-ee5e6a27b460, LOW_PhilgravesMansion_ZombieBeggar_Sacrum_020e39c8-6fb2-9d3d-4432-5b5d23366339);
DB_Dialogs(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, LOW_PhilgravesMansion_Thrumbo_eaa15ff1-12c2-a8fe-657e-b0e83d779339);
DB_Dialogs(S_LOW_ChildTalkingToMorbus_1218e27d-368b-4a97-8a53-623b53848c4f, LOW_PhilgravesMansion_MorbusGirl_3ac05ccf-b963-f9b2-1941-134fda9b8f4b);
DB_Dialogs(S_LOW_LumbarAttacker_1f9a18a4-a5a1-4204-8857-7c9977e96bff, LOW_PhilgravesMansion_LumbarAttacker_13ebe2ec-2700-226b-7b12-f7c0e35a4241);
DB_Dialogs(S_LOW_SacrumVignetteCivilian_c2fdc5ab-ddc4-446a-9151-fee891eff6d0, LOW_PhilgravesMansion_SacrumVignetteCivilian_f907866b-d8b7-de2c-7caf-bab15656c2f4);
DB_Dialogs(S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4, LOW_PhilgravesMansion_Lumbar_5b26d0e7-ee4f-efd7-4c1b-6f9b90293d5e);
DB_LOW_PhilgravesMansion_LeavingTriggers(S_LOW_ZombieBeggar_001_3bca7480-e42d-4c3f-aa12-2b03a03064aa, S_LOW_DissapearToTrigger_Morbus_707c94ad-30ca-4f4c-8a82-52420eb7b215);
DB_LOW_PhilgravesMansion_LeavingTriggers(S_LOW_ZombieBeggar_002_d4ff4e8c-7788-408b-a9ee-ee5e6a27b460, S_LOW_DissapearToTrigger_Sacrum_1300acc5-f6c2-4f8b-a83c-1ab27f9ef659);
DB_LOW_PhilgravesMansion_LeavingTriggers(S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4, S_LOW_DissapearToTrigger_Lumbar_ec9c25e9-b7f3-461a-a41d-471a00d9bbfd);
DB_LOW_PhilgravesMansion_LeavingTriggers(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, S_LOW_DissapearToTrigger_Thrumbo_139a1c6f-1b14-47e1-9a4e-276f56cb96d2);
DB_PermaDefeatedEvent(S_LOW_ZombieBeggar_001_3bca7480-e42d-4c3f-aa12-2b03a03064aa, LOW_Morbus_State_IsPermaDefeated_8adaebc8-e85c-4d20-88a0-38b39eae8d5a);
DB_PermaDefeatedEvent(S_LOW_ZombieBeggar_002_d4ff4e8c-7788-408b-a9ee-ee5e6a27b460, LOW_Sacrum_State_IsPermaDefeated_f7be2a58-3487-4933-a9b1-f5eaeb0a0f8b);
DB_PermaDefeatedEvent(S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4, LOW_Lumbar_State_IsPermaDefeated_ba898ac2-6eb5-4462-a314-e941bf005848);
DB_PermaDefeatedEvent(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, LOW_Thrumbo_State_IsPermaDefeated_21e2f143-abef-45fa-a29c-6eb91491b9ec);
DB_DialogMoneyTransfer(1, LOW_PhilgravesMansion_ZombieBeggar_Morbus_f975f719-21d3-fea9-4147-c58f3b313473, 50);
DB_DialogMoneyTransfer(2, LOW_PhilgravesMansion_ZombieBeggar_Morbus_f975f719-21d3-fea9-4147-c58f3b313473, 100);
DB_DialogMoneyTransfer(1, LOW_PhilgravesMansion_ZombieBeggar_Sacrum_020e39c8-6fb2-9d3d-4432-5b5d23366339, 50);
DB_DialogMoneyTransfer(2, LOW_PhilgravesMansion_ZombieBeggar_Sacrum_020e39c8-6fb2-9d3d-4432-5b5d23366339, 100);
DB_DialogMoneyTransfer(1, LOW_BaldursMouth_SkaraiBervos_5b26d0e7-ee4f-efd7-4c1b-6f9b90293d5e, 50);
DB_DialogMoneyTransfer(2, LOW_BaldursMouth_SkaraiBervos_5b26d0e7-ee4f-efd7-4c1b-6f9b90293d5e, 100);
DB_DialogMoneyTransfer(1, LOW_PhilgravesMansion_ThrumboInsideHouse_149b5744-5f7a-154b-87d0-ac1f54a02b6c, 20);
DB_DialogMoneyTransfer(2, LOW_PhilgravesMansion_ThrumboInsideHouse_149b5744-5f7a-154b-87d0-ac1f54a02b6c, 40);
DB_DialogMoneyTransfer(1, LOW_PhilgravesMansion_FatherCarrion_b141f677-21c0-cba8-331e-21e157dba36b, 1500, 2, 1);
DB_DialogMoneyTransfer(2, LOW_PhilgravesMansion_FatherCarrion_b141f677-21c0-cba8-331e-21e157dba36b, 1000, 2, 1);
DB_DialogMoneyTransfer(3, LOW_PhilgravesMansion_FatherCarrion_b141f677-21c0-cba8-331e-21e157dba36b, 500, 1);
DB_DialogMoneyTransfer(4, LOW_PhilgravesMansion_FatherCarrion_b141f677-21c0-cba8-331e-21e157dba36b, 3000, 2, 1);
DB_DialogMoneyTransfer(1, LOW_PhilgravesMansion_ZombieBeggar_Sacrum_020e39c8-6fb2-9d3d-4432-5b5d23366339, 5, 2, 1);
DB_DialogMoneyTransfer(2, LOW_PhilgravesMansion_ZombieBeggar_Sacrum_020e39c8-6fb2-9d3d-4432-5b5d23366339, 100, 2, 1);
DB_DialogMoneyTransfer(1, LOW_PhilgravesMansion_Lumbar_5b26d0e7-ee4f-efd7-4c1b-6f9b90293d5e, 15, 2, 1);
DB_HasItemEvent(S_FOR_DangerousBook_Tome_73ea8888-ed82-4ca5-b9f9-0c9119873507, LOW_PhilgravesMansion_State_PlayerHasNecromancyOfThay_32fe3265-f672-4846-9b56-7400f66c899f);
DB_HasItemEvent(S_LOW_LetterFatherCarrion_c4aae84c-c9b5-4941-a94f-c5c8ead07205, LOW_PhilgravesMansion_State_PlayerHasLetter_6e10c2c4-0d6d-4709-8b02-a92fc277a15f);
DB_GiveItemToEvent(S_UNI_LOW_TorchOfRevocation_a042774f-ae71-4d19-9554-ba90cf34d046, LOW_FatherCarrion_Event_GiveTorch_93398704-3e10-4515-9996-5b42cb917f53);
DB_GiveItemToEvent(S_LOW_LetterFatherCarrion_c4aae84c-c9b5-4941-a94f-c5c8ead07205, Debug_LOW_PhilgravesMansion_GetLetterFatherCarrion_63062d16-ac9f-48f9-8687-be13b90ae13c);
DB_GiveItemToEvent(S_FOR_DangerousBook_Tome_73ea8888-ed82-4ca5-b9f9-0c9119873507, Debug_LOW_PhilgravesMansion_GiveNecromancyOfThay_84bd0fe3-0fb6-4269-9c1b-67551756831f);
DB_GiveItemToEvent(S_LOW_ThrumboRing_15edfd0b-ae2a-4ce5-8369-748070746713, LOW_Thrumbo_Event_GiveRing_8cd84b82-c06b-4dce-a551-8674bf30f7ea);
PROC_TriggerRegisterForPlayers(LOW_PhilgravesMansion_MainHallTrigger_97b50e48-fc3e-435c-a3ba-2745eb733f2e);
PROC_TriggerRegisterForPlayers(LOW_PhilgravesMansion_LigusTrigger_5f95560a-4d59-469e-978b-26b59bebff05);
PROC_TriggerRegisterForPlayers(S_LOW_TriggerEntranceDoor_3ecec798-f164-47c7-9e1a-8f1c4eeba7ba);
PROC_TriggerRegisterForPlayers(S_LOW_PhilgravesMansion_BasementRegionTrigger_17a71a2b-98b2-470d-bb7b-f8cfeda2d4dc);
PROC_TriggerRegisterForPlayers(S_LOW_PhilgravesMansion_AncientLairRegion_ec10580c-2e07-4eb1-8465-a648183ccaea);
DB_ItemDialog_NarratorAD(S_LOW_TabletAncientLair_001_a1285a32-8b20-45a1-bf26-1807242e91c3, LOW_PhilgravesMansion_PAD_AncientLairTablet_001_85b9f0ed-c647-2b65-7a63-225cb3f02111);
DB_LOW_PhilgravesMansion_ZombieBeggars(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb);
DB_LOW_PhilgravesMansion_ZombieBeggars(S_LOW_ZombieBeggar_001_3bca7480-e42d-4c3f-aa12-2b03a03064aa);
DB_LOW_PhilgravesMansion_ZombieBeggars(S_LOW_ZombieBeggar_002_d4ff4e8c-7788-408b-a9ee-ee5e6a27b460);
DB_LOW_PhilgravesMansion_ZombieBeggars(S_LOW_BaldursMouth_SkaraiBervos_cc4b66fb-a789-472d-8d23-ad3380215ca4);
DB_LOW_PhilgravesMansion_BasementDropZombies(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, S_LOW_BasementZombieDropPosition_000_8acce947-e8bb-401e-94e9-4a068326be2d);
DB_LOW_PhilgravesMansion_BasementDropZombies(S_LOW_ZombieBeggar_001_3bca7480-e42d-4c3f-aa12-2b03a03064aa, S_LOW_BasementZombieDropPosition_001_c52260ff-1ed3-4e25-b88d-06f967f8b391);
DB_LOW_PhilgravesMansion_BasementDropZombies(S_LOW_ZombieBeggar_002_d4ff4e8c-7788-408b-a9ee-ee5e6a27b460, S_LOW_BasementZombieDropPosition_002_4ba44985-ee72-4b43-a4db-afd855268001);
DB_LOW_PhilgravesMansion_BasementDropZombies(S_LOW_BaldursMouth_SkaraiBervos_cc4b66fb-a789-472d-8d23-ad3380215ca4, S_LOW_BasementZombieDropPosition_003_8351fc4f-8288-4eef-b97a-be40bc9986a4);
DB_LOW_PhilgravesMansion_Jars(S_LOW_UNI_CarrionJar_Brain_d4c6be37-524a-43cd-ad45-4fc9b68cf531);
DB_LOW_PhilgravesMansion_Jars(S_LOW_UNI_CarrionJar_Liver_add49a50-6200-4430-9f28-e4fe79e45a48);
DB_LOW_PhilgravesMansion_Jars(S_LOW_UNI_CarrionJar_Lungs_cc6570db-e584-4ba1-a162-7a5419c887f8);
DB_LOW_PhilgravesMansion_Jars(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492);
DB_PhilgravesMansion_JarBasementLocation(S_LOW_UNI_CarrionJar_Liver_add49a50-6200-4430-9f28-e4fe79e45a48, S_LOW_JarBasementLocation_Liver_239dc974-d8d6-4c1f-8e7b-8412cfef4c89);
DB_PhilgravesMansion_JarBasementLocation(S_LOW_UNI_CarrionJar_Lungs_cc6570db-e584-4ba1-a162-7a5419c887f8, S_LOW_JarBasementLocation_Lungs_6604044d-3c7b-4de3-8d69-3ced43c290ae);
DB_PhilgravesMansion_JarBasementLocation(S_LOW_UNI_CarrionJar_Brain_d4c6be37-524a-43cd-ad45-4fc9b68cf531, S_LOW_JarBasementLocation_Brain_34b7fa14-ed4e-4ed7-8477-077c91c4bd28);
DB_PhilgravesMansion_JarBasementLocation(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492, S_LOW_JarBasementLocation_Heart_68eec807-9a0b-412e-b30e-0e75dbc551f5);
PROC_SetOnStage(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, 0);
SetFlag(LOW_PhilgravesMansion_State_ZombieInOriginalLocation_0c1ac3f8-ce83-40b2-bcff-9ea7572bd983, S_LOW_ZombieBeggar_001_3bca7480-e42d-4c3f-aa12-2b03a03064aa);
SetFlag(LOW_PhilgravesMansion_State_ZombieInOriginalLocation_0c1ac3f8-ce83-40b2-bcff-9ea7572bd983, S_LOW_ZombieBeggar_002_d4ff4e8c-7788-408b-a9ee-ee5e6a27b460);
SetFlag(LOW_PhilgravesMansion_State_ZombieInOriginalLocation_0c1ac3f8-ce83-40b2-bcff-9ea7572bd983, S_LOW_BaldursMouth_SkaraiBervos_cc4b66fb-a789-472d-8d23-ad3380215ca4);
DB_LOW_PhilgravesMansion_CarrionCoffins(LOW_ZombieCoffin_000_df6939ee-d2e9-4aff-81d4-6c46b6aedaef, S_LOW_FatherCarrion_CoffinMummy_000_d03067ac-43a7-435b-be97-558065b1f7d1, LOW_PhilgravesMansion_AD_MummyAwakened_000_9dd5a3e1-1720-c624-a55d-58155ccbc990);
DB_LOW_PhilgravesMansion_CarrionCoffins(LOW_ZombieCoffin_001_77849166-fdb7-4439-b424-ea6369d13a97, S_LOW_FatherCarrion_CoffinMummy_001_f7e60433-053d-4735-b542-658397785f7a, LOW_PhilgravesMansion_AD_MummyAwakened_001_19ae2276-7a65-130a-e012-666946daa068);
DB_LOW_PhilgravesMansion_CarrionCoffins(LOW_ZombieCoffin_002_c66e2e13-41b6-40fc-9fe6-c97246b020bd, S_LOW_FatherCarrion_CoffinMummy_002_2bb0196b-9bd6-4eb3-989f-29d14a8cd2d8, LOW_PhilgravesMansion_AD_MummyAwakened_002_da25b5b4-6351-72a3-b2ba-06a510b1017e);
DB_LOW_PhilgravesMansion_CarrionCoffins(LOW_ZombieCoffin_003_3056e5d8-5166-4263-bf83-5e630bd4bcaa, S_LOW_FatherCarrion_CoffinMummy_003_1ada20fe-49b1-4663-a832-0e2c7126907d, LOW_PhilgravesMansion_AD_MummyAwakened_003_fd0c81f3-1c97-2c43-2bc2-e239b5d3d877);
DB_LOW_PhilgravesMansion_CarrionCoffins(LOW_ZombieCoffin_004_33a119e2-2d37-4606-91e0-2b8181544b25, S_LOW_FatherCarrion_CoffinMummy_004_ca673f78-bf5a-4170-9a3d-86956fd7320b, LOW_PhilgravesMansion_AD_MummyAwakened_004_8f07a175-3605-c102-dd7f-0910df2accee);
DB_LOW_PhilgravesMansion_CarrionCoffins(LOW_ZombieCoffin_005_6770bb1b-b7a6-40f8-adce-d6b5d739bf57, S_LOW_FatherCarrion_CoffinMummy_005_9ede4829-ec97-40b6-ac1c-ef14b9c6d14a, LOW_PhilgravesMansion_AD_MummyAwakened_005_bcf9d823-3ab5-8d11-9ea3-96e11e1b46c1);
DB_LOW_PhilgravesMansion_CarrionCoffins(LOW_ZombieCoffin_006_1ad93cb6-1d93-4083-9934-aefbd87a0181, S_LOW_FatherCarrion_CoffinMummy_006_e6bd5cec-2691-4dc4-99ae-2461c87bb6ba, LOW_PhilgravesMansion_AD_MummyAwakened_006_1eba4de1-cf8d-b92c-cad9-42752e23eea5);
DB_LOW_PhilgravesMansion_BeggarOneShotTriggers(S_LOW_MorbusAndGirlTrigger_d896a41f-394f-479e-9e12-db24959d86e8, S_LOW_ZombieBeggar_001_3bca7480-e42d-4c3f-aa12-2b03a03064aa, S_LOW_ChildTalkingToMorbus_1218e27d-368b-4a97-8a53-623b53848c4f, LOW_PhilgravesMansion_AD_MorbusAndGirl_6dfbfa58-54dd-b254-2533-aca632376860);
DB_LOW_PhilgravesMansion_BeggarOneShotTriggers(S_LOW_LumbarBeatingTrigger_aac37b70-327c-4097-8f9c-97d762002e85, S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4, S_LOW_LumbarAttacker_1f9a18a4-a5a1-4204-8857-7c9977e96bff, LOW_PhildravesMansion_AD_LumbarPreBeating_19676a7d-bae5-f015-8a87-09ebd10bbcf6);
DB_LOW_PhilgravesMansion_BeggarOneShotTriggers(S_LOW_SacrumVignetteTrigger_116787bd-ad1e-4071-bacf-7a3cc718200e, S_LOW_ZombieBeggar_002_d4ff4e8c-7788-408b-a9ee-ee5e6a27b460, S_LOW_SacrumVignetteCivilian_c2fdc5ab-ddc4-446a-9151-fee891eff6d0, LOW_PhilgravesMansion_AD_SacrumVignette_c62a26e1-d66d-f289-cd20-f94b7bbab8b8);
DB_OneShotPlayerTrigger(S_LOW_VignetteThrumboTrigger_5887ae6b-fcde-4bd8-a99d-4ec4883f605f);
DB_OneShotPlayerTrigger(S_LOW_PhilgravesLarderTrigger_362d5da1-7b69-485e-a7a6-65e5277dc9dd);
DB_NoLowAttitudeDialog(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e);
PROC_LOW_PhilgravesMansion_SetOneShots();
DB_LOW_PhilgravesMansion_CarrionMinions(S_LOW_FatherCarrion_CoffinMummy_000_d03067ac-43a7-435b-be97-558065b1f7d1);
DB_LOW_PhilgravesMansion_CarrionMinions(S_LOW_FatherCarrion_CoffinMummy_001_f7e60433-053d-4735-b542-658397785f7a);
DB_LOW_PhilgravesMansion_CarrionMinions(S_LOW_FatherCarrion_CoffinMummy_002_2bb0196b-9bd6-4eb3-989f-29d14a8cd2d8);
DB_LOW_PhilgravesMansion_CarrionMinions(S_LOW_FatherCarrion_CoffinMummy_003_1ada20fe-49b1-4663-a832-0e2c7126907d);
DB_LOW_PhilgravesMansion_CarrionMinions(S_LOW_FatherCarrion_CoffinMummy_004_ca673f78-bf5a-4170-9a3d-86956fd7320b);
DB_LOW_PhilgravesMansion_CarrionMinions(S_LOW_FatherCarrion_CoffinMummy_005_9ede4829-ec97-40b6-ac1c-ef14b9c6d14a);
DB_LOW_PhilgravesMansion_CarrionMinions(S_LOW_FatherCarrion_CoffinMummy_006_e6bd5cec-2691-4dc4-99ae-2461c87bb6ba);
DB_LOW_PhilgravesMansion_CarrionMinions(S_LOW_FatherCarrion_Ghoul_000_d8141d00-5f80-4245-9a48-fe3651be6954);
DB_LOW_PhilgravesMansion_CarrionMinions(S_LOW_FatherCarrion_Ghoul_001_ea1e4956-140f-4dda-a0eb-211744ec3fd0);
DB_LOW_PhilgravesMansion_CarrionMinions(S_LOW_Ghast_48d8e43e-e5d1-4ae4-bd14-8208bdacb21b);
DB_LOW_PhilgravesMansion_CarrionMinions(S_LOW_FatherCarrion_Ghoul_002_f0f2dbe1-d72b-48b0-9e9f-8a47ab189cfa);
DB_LOW_PhilgravesMansion_CarrionMinions(S_LOW_FatherCarrion_Ghoul_003_08bfd546-b2c2-461d-83e5-fc86160b3bfc);
DB_LOW_PhilgravesMansion_CarrionMinions(S_LOW_FatherCarrion_Ghoul_004_bbc46971-3203-44b2-8582-b8822b1d5d70);
DB_LOW_PhilgravesMansion_CheckpointGuards(S_LOW_FatherCarrion_Ghast_48d8e43e-e5d1-4ae4-bd14-8208bdacb21b);
DB_LOW_PhilgravesMansion_CheckpointGuards(S_LOW_FatherCarrion_Ghoul_001_ea1e4956-140f-4dda-a0eb-211744ec3fd0);
DB_LOW_PhilgravesMansion_CheckpointGuards(S_LOW_FatherCarrion_Ghoul_002_f0f2dbe1-d72b-48b0-9e9f-8a47ab189cfa);
DB_LOW_PhilgravesMansion_CheckpointGuards(S_LOW_FatherCarrion_Ghoul_003_08bfd546-b2c2-461d-83e5-fc86160b3bfc);
DB_LOW_PhilgravesMansion_CheckpointGuards(S_LOW_FatherCarrion_Ghoul_004_bbc46971-3203-44b2-8582-b8822b1d5d70);
PROC_LOW_PhilgravesMansion_InitCoffinMinions();
PROC_LOW_PhilgravesMansion_InitJars();
DB_GLO_DefeatCounter_AllPermaDefeatedGlobalFlag("LOW_PhilgravesMansion_Jars", LOW_FatherCarrion_State_AllJarsDestroyed_a915bde9-1c3b-469c-8a75-ce761f8f30e4);
DB_LOW_PhilgravesMansion_ZombieBeggarsMeetingLocations(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, S_LOW_ThrumboLocation_a1f7a6d1-d3af-4fcd-a69c-7d6812ba2c50, Debug_Teleport_LOW_ZombieBeggarPosition1_c8637295-a337-42d8-a057-856c567dbfc3);
DB_LOW_PhilgravesMansion_ZombieBeggarsMeetingLocations(S_LOW_ZombieBeggar_001_3bca7480-e42d-4c3f-aa12-2b03a03064aa, S_LOW_ZombieFinalLocation_001_92862dbd-f6cb-45bc-a386-7e8a8695febf, Debug_Teleport_LOW_ZombieBeggarPosition2_33d4df0d-3fc0-450d-ab22-83b7452d807e);
DB_LOW_PhilgravesMansion_ZombieBeggarsMeetingLocations(S_LOW_ZombieBeggar_002_d4ff4e8c-7788-408b-a9ee-ee5e6a27b460, S_LOW_ZombieFinalLocation_002_dd688b62-cdb3-4cd0-8068-0342fe302045, Debug_Teleport_LOW_ZombieBeggarPosition3_bfaa0136-0852-4981-8bbe-42ea550ddd74);
DB_LOW_PhilgravesMansion_ZombieBeggarsMeetingLocations(S_LOW_BaldursMouth_SkaraiBervos_cc4b66fb-a789-472d-8d23-ad3380215ca4, S_LOW_ZombieFinalLocation_003_86e27bec-b55f-4f17-9066-2d431163b156, Debug_Teleport_LOW_ZombieBeggarPosition4_58f819a5-0cc6-44c0-af71-e4a32f73fcc0);
DB_LOW_PhilgravesMansion_ZombieBeggarsInsideHouseLocations(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, S_LOW_InsideHouse_Thrumbo_a605f958-a726-431c-b90a-30dc8ac6a8c9);
DB_LOW_PhilgravesMansion_ZombieBeggarsInsideHouseLocations(S_LOW_ZombieBeggar_001_3bca7480-e42d-4c3f-aa12-2b03a03064aa, S_LOW_InsideHouse_Morbus_55b9d90b-8274-42fd-9447-cef8f81c8c71);
DB_LOW_PhilgravesMansion_ZombieBeggarsInsideHouseLocations(S_LOW_ZombieBeggar_002_d4ff4e8c-7788-408b-a9ee-ee5e6a27b460, S_LOW_InsideHouse_Sacrum_40b59685-951a-4409-9406-1fd3c1597f66);
DB_LOW_PhilgravesMansion_ZombieBeggarsInsideHouseLocations(S_LOW_BaldursMouth_SkaraiBervos_cc4b66fb-a789-472d-8d23-ad3380215ca4, S_LOW_InsideHouse_Skarai_a4b07289-2d59-4e52-88b0-22d1aa65c873);
DB_GLO_DefeatCounter(S_LOW_ZombieBeggar_001_3bca7480-e42d-4c3f-aa12-2b03a03064aa, "LOW_PhilgravesMansion_AllBeggarsButThrumbo");
DB_GLO_DefeatCounter(S_LOW_ZombieBeggar_002_d4ff4e8c-7788-408b-a9ee-ee5e6a27b460, "LOW_PhilgravesMansion_AllBeggarsButThrumbo");
DB_GLO_DefeatCounter(S_LOW_BaldursMouth_SkaraiBervos_cc4b66fb-a789-472d-8d23-ad3380215ca4, "LOW_PhilgravesMansion_AllBeggarsButThrumbo");
DB_GLO_DefeatCounter_AllPermaDefeatedGlobalFlag("LOW_PhilgravesMansion_AllBeggarsButThrumbo", LOW_PhilgravesMansion_State_AllZombiesDead_e938c802-ee1b-4e15-87b1-d44ae67ec589);
DB_GLO_DefeatCounter(S_LOW_Ghast_48d8e43e-e5d1-4ae4-bd14-8208bdacb21b, "LOW_PhilgravesMansion_UpperFloorEnemies");
DB_GLO_DefeatCounter(S_LOW_FatherCarrion_Ghoul_001_ea1e4956-140f-4dda-a0eb-211744ec3fd0, "LOW_PhilgravesMansion_UpperFloorEnemies");
DB_GLO_DefeatCounter(S_LOW_FatherCarrion_Ghoul_002_f0f2dbe1-d72b-48b0-9e9f-8a47ab189cfa, "LOW_PhilgravesMansion_UpperFloorEnemies");
DB_GLO_DefeatCounter_AllPermaDefeatedGlobalFlag("LOW_PhilgravesMansion_UpperFloorEnemies", LOW_PhilgravesMansion_State_AllUpperFloorEnemiesPermaDefeated_04f8421c-896e-4fc0-8da2-358abf2cb2b3);
DB_CheckPoint(S_LOW_Ghast_48d8e43e-e5d1-4ae4-bd14-8208bdacb21b, S_LOW_FatherCarrion_Ghoul_002_f0f2dbe1-d72b-48b0-9e9f-8a47ab189cfa, S_LOW_CheckpointPhilgravesPrimary_979cabfa-019e-4cef-88b8-7ce8f94f7dbb, S_LOW_CheckpointPhilgravesWarning_1e1e5fd6-c745-42f4-a334-a631592e4e15, S_LOW_CheckpointPhilgravesTrespass_eaf77afe-232f-4b01-8b7b-e28f09ef01d4, "S_LOW_PhilgravesMansionCheckpoint", LOW_PhilgravesMansion_State_CheckpointGivenAccess_0cd65e38-ca07-44c3-a225-19365ff5c483, "LOW_PhilgravesMansion_Trespassing", S_LOW_CheckpointPhilgravesOutTrigger_5e7d879d-0ee7-47ff-858d-5410e902a799);
DB_PerceptionSkillCustomAD(S_LOW_BeggarsPortrait_9e5d743a-f00e-4d5c-93ff-272b9a895c15, LOW_PhilgravesMansion_PAD_SucceededPerceptionPortrait_41852fb3-a558-5995-16cc-9ac05c1047f2);
DB_PerceptionSkillCustomAD(S_LOW_PhilgravesBasementGuardedDoor_717a919a-e1e0-4ca3-b2da-eac784afae00, LOW_PhilgravesMansion_PAD_AlarmDoorRevealed_4e0c6bf8-d336-2c20-7842-a47319e8b33c);
DB_PermaDefeatedEvent(S_LOW_FatherCarrion_Ghast_48d8e43e-e5d1-4ae4-bd14-8208bdacb21b, LOW_PhilgravesMansion_State_GhastIsPermadefeated_925e603a-9238-4cbb-a931-bc9938fd9227);
DB_GlobalFlagReactionAfterDialog(LOW_Thrumbo_Event_ThrowUp_6e4e32f8-312b-4bfc-bd46-15af3831a1b5, LOW_PhilgravesMansion_Thrumbo_eaa15ff1-12c2-a8fe-657e-b0e83d779339);
DB_GlobalFlagReactionAfterDialog(LOW_Thrumbo_Event_ThrowUpNearMansion_b122a9c2-002e-4d89-ae81-0a6c7094540e, LOW_PhilgravesMansion_ThrumboHouse_f6455bc1-4c42-e798-8730-61b6433fca65);
DB_GlobalFlagReactionAfterDialog(LOW_PhilgravesMansion_Event_OpenMagicDoor_020ec7ce-3094-4f4d-bebe-51d298a10128, LOW_PhilgravesMansion_DoorInteraction_fee7f153-a59f-5734-1745-4e131fb862e9);
DB_GlobalFlagReactionAfterDialog(LOW_PhilgravesMansion_State_CheckpointGivenAccess_0cd65e38-ca07-44c3-a225-19365ff5c483, LOW_PhilgravesMansion_Ghast_c6d694f1-0da7-d86c-819d-4ebc8feddb54);
DB_QuestDef_State(LOW_FatherCarrion_State_ExplainedTask_f77ed6af-3076-43da-9a68-1d83edf9068d, "LOW_PhilgravesMansion", "Carrion_ExplainedTask");
DB_QuestDef_State(LOW_FatherCarrion_State_PlayersAcceptedTask_318caac3-8dba-4f13-b1ad-02f847715231, "LOW_PhilgravesMansion", "Carrion_AcceptedTask");
DB_QuestDef_State(LOW_PhilgravesMansion_State_ReadThrumboNote_2e0a5f21-a80c-4e6b-852b-dad97ac47f19, "LOW_PhilgravesMansion", "BeggarNoteRead");
DB_QuestDef_State(LOW_PhilgravesMansion_Event_SendThrumboTorsoToChest_d3ff1c4d-8ed9-494b-bcaa-6bcb9bfc3c61, "LOW_PhilgravesMansion", "Carrion_GaveCorpse");
DB_QuestDef_State(LOW_PhilgravesMansion_Event_SetJarsToChest_98b9ea3e-835d-4cfe-8dca-def8b48affcb, "LOW_PhilgravesMansion", "Carrion_GaveJar");
DB_QuestDef_State(LOW_FatherCarrion_State_IsFullyDead_683c08ad-358d-400f-8dc8-c1a93f31dcac, "LOW_PhilgravesMansion", "CarrionFullyKilled");
DB_QuestDef_State(LOW_PhilgravesMansion_State_ReadBasementLetter_9bbb0551-5ec6-44a1-b826-67a14bbd5409, "LOW_PhilgravesMansion", "ReadBasementBook");
DB_QuestDef_State(LOW_PhilgravesMansion_State_HeartIsDestroyed_fcf8164a-742d-4ef4-af61-3773d8891a44, "LOW_PhilgravesMansion", "HeartDestroyed");
DB_QuestDef_State(LOW_PhilgravesMansion_Event_SetJarsToChest_98b9ea3e-835d-4cfe-8dca-def8b48affcb, "LOW_PhilgravesMansion", "HeartGiven");
DB_QuestDef_State(LOW_PhilgravesMansion_State_DestroyedNonHeartJar_0b8a48a7-b093-4ac2-a4b1-502e9b5dad31, "LOW_PhilgravesMansion", "NonHeartJarDestroyed");
DB_QuestDef_State(LOW_PhilgravesMansion_State_GrabbedFirstJarOtherThanHeart_6e4cb103-051d-4164-8c0a-84af4b2a3bff, "LOW_PhilgravesMansion", "LootedNonHeartJar");
DB_QuestDef_State(LOW_PhilgravesMansion_State_FoundThrumbo_14d2ebc7-b98f-456a-b7f0-cb73ec788826, "LOW_PhilgravesMansion", "FoundThrumbo");
DB_QuestDef_State_ConditionalFlag(LOW_PhilgravesMansion_Quest_ReadJarDiagrams_9d307fd4-e5e3-430c-b617-2d208d5e1053, "LOW_PhilgravesMansion", "AncientLair_ReadBook_ThrumboDead", 1, LOW_Thrumbo_State_IsDead_21e2f143-abef-45fa-a29c-6eb91491b9ec);
DB_QuestDef_State_ConditionalFlag(LOW_PhilgravesMansion_Quest_ReadJarDiagrams_9d307fd4-e5e3-430c-b617-2d208d5e1053, "LOW_PhilgravesMansion", "AncientLair_ReadBook_ThrumboAlive", 0, LOW_Thrumbo_State_IsDead_21e2f143-abef-45fa-a29c-6eb91491b9ec);
DB_QuestDef_BookReadState("LOW_PhilgravesMansion", "Carrion_StoleHeartFromPlayers", S_LOW_CarrionThreat_2ae36508-b040-4292-843d-b5939285435e);
PROC_TriggerRegisterForPlayers(LOW_PhilgravesMansion_BasementTrigger_d7c59739-fc8b-40e6-81a8-9113920ad11b);
PROC_SetOnStage(S_LOW_ThrumboDeadWarningCleaver_6e254dae-1454-4885-acd9-26bd917a9cc0, 0);
PROC_SetOnStage(S_LOW_ThrumboDeadWarning_113c6cee-50d1-41f0-bedb-ebd759f2828c, 0);
DB_DeadEvent(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, LOW_Thrumbo_State_IsDead_21e2f143-abef-45fa-a29c-6eb91491b9ec);
DB_OneShotPlayerTrigger(S_LOW_PhilgravesMansion_BasementRegionTrigger_17a71a2b-98b2-470d-bb7b-f8cfeda2d4dc);
DB_OneShotPlayerTrigger(S_LOW_PhilgravesMansion_AncientLairRegion_ec10580c-2e07-4eb1-8465-a648183ccaea);
DB_OneShot_VoiceBarkTrigger(LOW_PhilgravesMansion_BadPlaceVB_Trigger_99aa70ee-ac39-480b-a686-6ab513f57483, LOW_PhilgravesMansion_VB_BadPlace_5db97567-ccb6-5043-ac82-0d915e96748a);
DB_ItemOwnerShipTriggers("CTY_Main_A", S_LOW_PhilgravesMansion_Ownership_1c101e16-3568-4a76-b2ae-be54d9e807d0, S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e);

KBSECTION
IF
TextEvent("LOW_Philgraves_SendJarsToBasement", _, _, _, _)
THEN
PROC_LOW_PhilgravesMansion_SendAllJarsToBasement();

IF
TextEvent("LOW_Philgraves_SendGemToBasement", _, _, _, _)
THEN
SetGravity(S_FOR_DangerousBook_Key_000_123c268d-ad0c-4df5-905b-a78dacbed80b, 0);
TeleportTo(S_FOR_DangerousBook_Key_000_123c268d-ad0c-4df5-905b-a78dacbed80b, S_LOW_PhilgravesMansion_PlaceForGem_5e6f51c1-a861-493f-91e8-806c8498fa64, "", 0, 0, 0, 0, 0);

IF
TextEvent("LOW_PhilgravesMansion_ResetBeggarPositions", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_PhilgravesMansion_ZombieBeggarsMeetingLocations(_Var1, _Var2, _, _Var1, _Var1)
THEN
TeleportTo(_Var1, _Var2);

IF
TextEvent("LOW_PhilgravesMansion_HaveNecromancyBookNotUnlocked", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
ToInventory(S_FOR_DangerousBook_Tome_73ea8888-ed82-4ca5-b9f9-0c9119873507, _Var1, 1, 1, 1);

IF
TextEvent("LOW_PhilgravesMansion_HaveNecromancyBookReady", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
ToInventory(S_FOR_DangerousBook_Tome_73ea8888-ed82-4ca5-b9f9-0c9119873507, _Var1, 1, 1, 1);
SetFlag(FOR_DangerousBook_State_BookUnlocked_fd215551-a14c-8cfa-ba34-7ac32d1ada28);
SetFlag(FOR_DangerousBook_State_BookOwner_06022678-24ed-35af-de93-bd91abc02452, _Var1);
SetFlag(FOR_DangerousBook_State_Bound_5e16d6fc-ae5c-cb6f-3a0f-4237593ee05e);
SetFlag(FOR_DangerousBook_State_BookFinished_489a23a0-758a-97bd-bd0c-d6b417c20af3);

IF
TextEvent("LOW_PhilgravesMansion_GetLetterFatherCarrion", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
ToInventory(S_LOW_LetterFatherCarrion_c4aae84c-c9b5-4941-a94f-c5c8ead07205, _Var1, 1, 1, 1);

IF
TextEvent("LOW_PhilgravesMansion_GetCandles", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
ToInventory(S_UNI_LOW_TorchOfRevocation_a042774f-ae71-4d19-9554-ba90cf34d046, _Var1, 1, 1, 1);

IF
TextEvent("LOW_PhilgravesMansion_ZombiesGoToHouse", _, _, _, _)
THEN
PROC_SetOnStage(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, 1);
Die(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, 0, 0);
SetFlag(LOW_FatherCarrion_State_IsFullyDead_683c08ad-358d-400f-8dc8-c1a93f31dcac);
PROC_LOW_PhilgravesMansion_ZombiesGoToHouse();

IF
TextEvent("LOW_PhilgravesMansion_ThrumboThrowUp", _, _, _, _)
THEN
ClearOwnership(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492);
ObjectTimerLaunch(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, "LOW_PhilgravesMansion_ThrowingUp", 500);
PlayAnimation(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, CUST_Throw_Up_01_cf51f24c-b405-4c55-a4e9-bbaf5e210954, "LOW_PhilgravesMansion_ThrowUpAnimationDone");

IF
DB_GlobalFlag(Debug_LOW_PhilgravesMansion_DestroyJars_de5a8e4a-8602-4ce1-82c7-bc83329412ff, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_Jars(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
Die(_Var1);

IF
DB_GlobalFlag(Debug_LOW_PhilgravesMansion_GoToMansion_22d23237-a519-4c3a-8f3c-44e4d6066985, _, _, _, _)
THEN
PROC_LOW_PhilgravesMansion_ZombiesGoToHouse();

IF
FlagSet(Debug_LOW_PhilgravesMansion_GetTorches_38a628a7-f686-40fd-a144-2ea23db42d29, (GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
ToInventory(S_UNI_LOW_TorchOfRevocation_a042774f-ae71-4d19-9554-ba90cf34d046, _Var1, 1, 1, 1);

IF
FlagSet(Debug_LOW_PhilgravesMansion_GetJars_b9d66897-b7f4-4dc7-8f45-38320bbac9fb, (GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_PhilgravesMansion_Jars(_Var3, _Var1, _Var1, _Var1, _Var1)
THEN
ToInventory(_Var3, _Var1, 1, 1, 1);

IF
FlagSet(Debug_LOW_PhilgravesMansion_GetFatherCarrionLetter_b8b04a6a-2c2b-4039-8e79-766db57bc1c4, (GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
PROC_SetOnStage(S_LOW_LetterFatherCarrion_c4aae84c-c9b5-4941-a94f-c5c8ead07205, 1);
ToInventory(S_LOW_LetterFatherCarrion_c4aae84c-c9b5-4941-a94f-c5c8ead07205, _Var1, 1, 1, 1);

IF
Saw((CHARACTER)_Var1, S_LOW_DeadAdventurer_001_98f5af07-74fb-49ae-be05-3834e0a23464, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailable(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_PlayersSawLairDeadBody", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(LOW_PhilgravesMansion_PAD_EnteredLabAncientLair_dd0e55db-932b-37c3-1d2f-a46d88ab19e1, _Var1);

QRY
QRY_SelectCustomDialog_AfterGenerics(S_LOW_DeadAdventurer_001_98f5af07-74fb-49ae-be05-3834e0a23464, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Dead(S_LOW_DeadAdventurer_001_98f5af07-74fb-49ae-be05-3834e0a23464, _Var1, _Var1, _Var1, _Var1)
THEN
DB_SelectedDialog(LOW_PhilgravesMansion_DeadAdventurer_Dead_219fa9ed-e842-ecf0-b64b-15097fb0db7b, S_LOW_DeadAdventurer_001_98f5af07-74fb-49ae-be05-3834e0a23464, _Var1);

IF
UseFinished((CHARACTER)_Var1, S_LOW_BasementBookPhilgraves_f4180de1-823c-44f1-8995-a62de3e5f5af, 1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_ReadBasementBook", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(LOW_PhilgravesMansion_PAD_BasementBookFound_55183485-d424-c7ac-2332-22299d722094, _Var1);
SetFlag(LOW_PhilgravesMansion_State_ReadBasementLetter_9bbb0551-5ec6-44a1-b826-67a14bbd5409);

IF
DB_LOW_PhilgravesMansion_LairItems(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_LOW_PhilgravesMansion_LairEntities(_Var1);

IF
UseStarted((CHARACTER)_Var1, (ITEM)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_LairItems(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_PhilgravesMansion_ProcessLairDisturbance(_Var1);

IF
AttackedBy((GUIDSTRING)_Var1, _, _, _, _, _, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_LOW_PhilgravesMansion_AlarmSet(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_LairEntities(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_PhilgravesMansion_SetAlarm();

IF
MovedBy((GUIDSTRING)_Var1, (CHARACTER)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_LOW_PhilgravesMansion_AlarmSet(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_LairEntities(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_PhilgravesMansion_ProcessLairDisturbance(_Var2);

IF
RequestCanLoot((CHARACTER)_Var1, (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_LOW_PhilgravesMansion_AlarmSet(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_LairEntities(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_PhilgravesMansion_ProcessLairDisturbance(_Var1);

IF
UsingSpellOnTarget((CHARACTER)_Var1, (GUIDSTRING)_Var2, _, _, _, (INTEGER)_Var6, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_LOW_PhilgravesMansion_AlarmSet(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_LairEntities(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
DB_LOW_PhilgravesMansion_SpellOnLairTrigger(_Var1, _Var6);

IF
UsingSpellOnZoneWithTarget((CHARACTER)_Var1, (GUIDSTRING)_Var2, _, _, _, (INTEGER)_Var6, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_LOW_PhilgravesMansion_AlarmSet(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_LairEntities(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
DB_LOW_PhilgravesMansion_SpellOnLairTrigger(_Var1, _Var6);

IF
CastSpellFailed(_, _, _, _, (INTEGER)_Var5)
AND
DB_LOW_PhilgravesMansion_SpellOnLairTrigger(_Var6, _Var5, _, _, _)
THEN
NOT DB_LOW_PhilgravesMansion_SpellOnLairTrigger(_Var6, _Var5);

IF
CastedSpell(_, _, _, _, (INTEGER)_Var5)
AND
DB_LOW_PhilgravesMansion_SpellOnLairTrigger(_Var6, _Var5, _, _, _)
AND NOT
DB_LOW_PhilgravesMansion_AlarmSet(1, _, _, _, _)
THEN
PROC_LOW_PhilgravesMansion_SetAlarm();

IF
AddedTo((GUIDSTRING)_Var1, (CHARACTER)_Var2, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_LOW_PhilgravesMansion_AlarmSet(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_LairEntities(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_PhilgravesMansion_ProcessLairDisturbance(_Var2);

PROC
PROC_LOW_PhilgravesMansion_ProcessLairDisturbance((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
QRY_LOW_PhilgravesMansion_CheckTagsInLair(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_PhilgravesMansion_SetAlarm();

PROC
PROC_LOW_PhilgravesMansion_ProcessLairDisturbance((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_LOW_PhilgravesMansion_ProcessingLairRoll(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_LOW_PhilgravesMansion_CheckTagsInLair(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_LOW_PhilgravesMansion_ProcessingLairRoll(_Var1);
RequestPassiveRoll(_Var1, _Var1, "SavingThrow", "Wisdom", Act3_Hard_6298329e-255c-4826-9209-e911873b64e7, 0, "LOW_PhilgravesMansion_LairAvoidDetect");

PROC
PROC_RollResult("LOW_PhilgravesMansion_LairAvoidDetect", _, _, 0, (CHARACTER)_)
THEN
PROC_LOW_PhilgravesMansion_SetAlarm();

PROC
PROC_RollResult("LOW_PhilgravesMansion_LairAvoidDetect", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_PhilgravesMansion_ProcessingLairRoll(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_PhilgravesMansion_ProcessingLairRoll(_Var1);

QRY
QRY_LOW_PhilgravesMansion_CheckTagsInLair((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_PhilgravesMansion_AllowedUndeadTagsInLair(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
IsTagged(_Var1, _Var2, 1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_LOW_PhilgravesMansion_SetAlarm()
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_SetAncientLairAlarm", _, _, _, _)
THEN
DB_LOW_PhilgravesMansion_AlarmSet(1);
PROC_TriggerRegisterForParty(S_LOW_PhilgravesMansion_LairCurseArea_33383141-aa85-4b8d-9b71-86a2bb6b5f70);
PROC_ItemCloseAndLock(S_LOW_AncientLairEntranceDoor_13b8694c-dd66-486d-8487-3e7561e0ba21, "LOW_PhilgravesMansion_LairKey");
PROC_SetRelationToPlayers(ACT3_PhilgravesMansion_LairMummies_92f0e992-3a6b-40db-adba-eaa78f01ac17, 0);
PROC_LOW_PhilgravesMansion_WakeUpLairMinions();

IF
DB_LOW_PhilgravesMansion_LairEnemies(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_LOW_PhilgravesMansion_LairEntities(_Var1);
TriggerRegisterForCharacter(S_LOW_PhilgravesMansion_LairCurseArea_33383141-aa85-4b8d-9b71-86a2bb6b5f70, _Var1);

PROC
PROC_LOW_PhilgravesMansion_WakeUpLairMinions()
AND
DB_LOW_PhilgravesMansion_LairEnemies(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
Random(2000, _Var2, _Var1, _Var1, _Var1)
THEN
ObjectTimerLaunch(_Var1, "LOW_PhilgravesMansion_WakeUpLairMinion", _Var2);

IF
ObjectTimerFinished((CHARACTER)_Var1, "LOW_PhilgravesMansion_WakeUpLairMinion", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_InRegion(_Var1, S_LOW_PhilgravesMansion_LairCurseArea_33383141-aa85-4b8d-9b71-86a2bb6b5f70, _Var1, _Var1, _Var1)
THEN
Resurrect(_Var1);

IF
EnteredTrigger((GUIDSTRING)_Var1, S_LOW_PhilgravesMansion_LairCurseArea_33383141-aa85-4b8d-9b71-86a2bb6b5f70, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
PROC_LOW_PhilgravesMansion_ApplyCurseCheckImmunity(_Var1);

IF
StatusRemoved((CHARACTER)_Var1, "LOW_ANCIENTLAIR_CURSE", (CHARACTER)_Var2, (INTEGER)_Var3, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_LOW_PhilgravesMansion_LairCurseArea_33383141-aa85-4b8d-9b71-86a2bb6b5f70, _Var1, _Var1, _Var1)
AND
GetHitpoints(_Var1, _Var4, _Var1, _Var1, _Var1)
AND
_Var4 > 0
THEN
ApplyStatus(_Var1, "LOW_ANCIENTLAIR_CURSE_IMMUNITY", 18);

IF
Resurrected((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_InRegion(_Var1, S_LOW_PhilgravesMansion_LairCurseArea_33383141-aa85-4b8d-9b71-86a2bb6b5f70, _Var1, _Var1, _Var1)
THEN
ApplyStatus(_Var1, "LOW_ANCIENTLAIR_CURSE", -1);

IF
StatusRemoved((CHARACTER)_Var1, "LOW_ANCIENTLAIR_CURSE_IMMUNITY", _, (INTEGER)_Var3, (CHARACTER)_Var1)
AND
DB_InRegion(_Var1, S_LOW_PhilgravesMansion_LairCurseArea_33383141-aa85-4b8d-9b71-86a2bb6b5f70, _Var1, _Var1, _Var1)
THEN
PROC_LOW_PhilgravesMansion_ApplyCurseCheckImmunity(_Var1);

IF
LeftTrigger((CHARACTER)_Var1, S_LOW_PhilgravesMansion_LairCurseArea_33383141-aa85-4b8d-9b71-86a2bb6b5f70, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
HasActiveStatus(_Var1, "LOW_ANCIENTLAIR_CURSE", 1, _Var1, _Var1)
THEN
RemoveStatus(_Var1, "LOW_ANCIENTLAIR_CURSE");

PROC
PROC_LOW_PhilgravesMansion_ApplyCurseCheckImmunity((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
HasActiveStatus(_Var1, "LOW_ANCIENTLAIR_CURSE_IMMUNITY", 0, _Var1, _Var1)
AND
HasActiveStatus(_Var1, "LOW_ANCIENTLAIR_CURSE", 0, _Var1, _Var1)
AND NOT
QRY_LOW_PhilgravesMansion_CheckTagsInLair(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
ApplyStatus(_Var1, "LOW_ANCIENTLAIR_CURSE", -1);

IF
StatusApplied((CHARACTER)_Var1, "LOW_ANCIENTLAIR_CURSE", _, _, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailable(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_AncientLairCurseReaction", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(LOW_PhilgravesMansion_PAD_AncientLairCurseReaction_ed8a580a-ee6b-df0c-f1cc-42c1d40b7f11, _Var1);

IF
EnteredTrigger((CHARACTER)_Var1, LOW_PhilgravesMansion_LigusTrigger_5f95560a-4d59-469e-978b-26b59bebff05, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_CheckpointGivenAccess_0cd65e38-ca07-44c3-a225-19365ff5c483, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailable(S_LOW_FatherCarrion_Ghoul_003_08bfd546-b2c2-461d-83e5-fc86160b3bfc, _Var1, _Var1, _Var1, _Var1)
AND
CanSee(S_LOW_FatherCarrion_Ghoul_003_08bfd546-b2c2-461d-83e5-fc86160b3bfc, _Var1, 1, _Var1, _Var1)
AND
QRY_StartDialog(LOW_PhilgravesMansion_CarrionGhoul_003_412aa655-c826-4ed9-019f-c09378776d59, S_LOW_FatherCarrion_Ghoul_003_08bfd546-b2c2-461d-83e5-fc86160b3bfc, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
FlagSet(LOW_PhilgravesMansion_Event_TeleportOutsideCheckpoint_b1e385fd-9e3e-4323-a908-bd651d5f9fe2, (GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
TeleportTo(_Var1, S_LOW_CheckpointPhilgravesOutTrigger_5e7d879d-0ee7-47ff-858d-5410e902a799, "", 1, 1, 1, 0, 1);

IF
Opened(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, _, _, _, _)
THEN
SetFlag(LOW_PhilgravesMansion_State_StreetDoorOpenedOrDestroyed_92ff7268-c049-43f7-9731-89200c439afb);

IF
DestroyedBy(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, _, _, _, (CHARACTER)_)
THEN
SetFlag(LOW_PhilgravesMansion_State_StreetDoorOpenedOrDestroyed_92ff7268-c049-43f7-9731-89200c439afb);

IF
Closed(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, _, _, _, _)
THEN
ClearFlag(LOW_PhilgravesMansion_State_StreetDoorOpenedOrDestroyed_92ff7268-c049-43f7-9731-89200c439afb);

PROC
PROC_CheckPointDialogue((CHARACTER)_Var1, S_LOW_FatherCarrion_Ghoul_002_f0f2dbe1-d72b-48b0-9e9f-8a47ab189cfa, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_StartCheckpointWarningDialog("S_LOW_PhilgravesMansionCheckpoint", LOW_PhilgravesMansion_GhoulWarning_43b3341c-cb5c-fb39-f7dd-5465c38c37cb, S_LOW_FatherCarrion_Ghoul_002_f0f2dbe1-d72b-48b0-9e9f-8a47ab189cfa, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_CheckPointDialogue((CHARACTER)_Var1, S_LOW_FatherCarrion_Ghast_48d8e43e-e5d1-4ae4-bd14-8208bdacb21b, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_StartCheckpointWarningDialog("S_LOW_PhilgravesMansionCheckpoint", LOW_PhilgravesMansion_Ghast_c6d694f1-0da7-d86c-819d-4ebc8feddb54, S_LOW_FatherCarrion_Ghast_48d8e43e-e5d1-4ae4-bd14-8208bdacb21b, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_GlobalFlagReactionAfterDialog(LOW_PhilgravesMansion_State_CheckpointGivenAccess_0cd65e38-ca07-44c3-a225-19365ff5c483, _, _, _, _)
THEN
ClearOwnership(S_Lever_FirstFloorPhilgraveDoor_A_0c176205-625d-4c4d-8eb9-7a1c98a356a9);
ClearOwnership(S_LOW_FirstFloorPhilgravesDoor_0c989650-9ac2-4737-ac95-2f9f573d133a);

PROC
PROC_GlobalFlagReactionAfterDialog(LOW_PhilgravesMansion_State_CheckpointGivenAccess_0cd65e38-ca07-44c3-a225-19365ff5c483, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_PhilgravesMansion_CheckpointGuards(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PeacefulResolve(_Var1);

IF
DB_PlayerTrespassing(_Var1, _, S_LOW_CheckpointPhilgravesTrespass_8c7d5e5c-398e-47f5-8f1f-7a5d74ccc65b, _Var1, _Var1)
THEN
PROC_SetRelationToPlayers(ACT3_LOW_PhilgravesMansion_FatherCarrionUpperFloor_1d746532-eee0-4ea7-a7fa-09fbddb84f94, 0);

IF
DB_GlobalFlag(LOW_PhilgravesMansion_State_AllUpperFloorEnemiesPermaDefeated_04f8421c-896e-4fc0-8da2-358abf2cb2b3, _, _, _, _)
THEN
SetFlag(LOW_PhilgravesMansion_State_CheckpointGivenAccess_0cd65e38-ca07-44c3-a225-19365ff5c483);

PROC
PROC_LOW_PhilgravesMansion_InitCoffinMinions()
AND
DB_LOW_PhilgravesMansion_CarrionCoffins(_Var1, _Var2, _, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var2, 0);
PROC_SetOnStage(_Var1, 1);

IF
UseStarted(_, (ITEM)_Var2, _, _, _)
AND
DB_LOW_PhilgravesMansion_CarrionCoffins(_Var2, _, _, _, _)
THEN
Die(_Var2);

IF
DestroyedBy((ITEM)_Var1, _, _, _, (ITEM)_Var1)
AND
DB_LOW_PhilgravesMansion_CarrionCoffins(_Var1, _Var5, _Var6, _Var1, _Var1)
AND
IsOnStage(_Var5, 0, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var5, _Var1);
PROC_Foop(_Var5);
PROC_TryStartAD(_Var6, _Var5);

PROC
PROC_LOW_PhilgravesMansion_ExplodeCoffins()
AND
DB_LOW_PhilgravesMansion_CarrionCoffins(_Var1, _Var2, _, _Var1, _Var1)
AND
IsOnStage(_Var2, 0, _Var1, _Var1, _Var1)
THEN
Die(_Var1);
TeleportTo(_Var2, _Var1, "", 0, 0, 0, 0, 1);
PROC_Foop(_Var2);

IF
UseFinished((CHARACTER)_Var1, S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, 0, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsLocked(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, 1, _Var1, _Var1, _Var1)
AND
QRY_StartDialog(LOW_PhilgravesMansion_DoorInteraction_fee7f153-a59f-5734-1745-4e131fb862e9, S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
EnteredTrigger((CHARACTER)_Var1, S_LOW_TriggerEntranceDoor_3ecec798-f164-47c7-9e1a-8f1c4eeba7ba, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetCanInteract(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, 0, _Var1, _Var1, _Var1)
AND
GetFlag(LOW_PhilgravesMansion_PlayerHasLetter_6e10c2c4-0d6d-4709-8b02-a92fc277a15f, _Var1, 1, _Var1, _Var1)
THEN
SetCanInteract(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, 1);
PROC_PlayPerceptionRevealEffect(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, "", 6000);

IF
EnteredTrigger((CHARACTER)_Var1, S_LOW_TriggerEntranceDoor_3ecec798-f164-47c7-9e1a-8f1c4eeba7ba, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_LOW_PhilgravesMansion_AttemptedPerceptionStreetDoor(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetCanInteract(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, 0, _Var1, _Var1, _Var1)
AND NOT
GetFlag(LOW_PhilgravesMansion_PlayerHasLetter_6e10c2c4-0d6d-4709-8b02-a92fc277a15f, _Var1, 1, _Var1, _Var1)
THEN
DB_LOW_PhilgravesMansion_AttemptedPerceptionStreetDoor(_Var1);
RequestPassiveRoll(_Var1, S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, "SkillCheck", "Perception", DC_Legacy_15_625be976-7a67-4394-97c8-14c69715ae4b, 0, "LOW_PhilgravesMansion_PerceptionStreetDoor");

PROC
PROC_RollResult("LOW_PhilgravesMansion_PerceptionStreetDoor", (CHARACTER)_Var1, (ITEM)_Var2, 1, (CHARACTER)_Var1)
THEN
SetCanInteract(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, 1);
PROC_PlayPerceptionRevealEffect(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, "LOW_PhilgravesMansion_PerceptionStreetDoor");

PROC
PROC_GlobalFlagReactionAfterDialog(LOW_PhilgravesMansion_Event_OpenMagicDoor_020ec7ce-3094-4f4d-bebe-51d298a10128, _, _, _, _)
THEN
SetCanInteract(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, 1);
PROC_TryStartAD(LOW_PhilgravesMansion_MagicDoor_AD_2d8a4178-1fb7-b062-4f5d-5a9a8f2afdf0, S_LOW_PhilgraesMansion_MagicDoorHelper_26c8f01f-eeda-45ad-8485-ddf9bce08209);
PROC_ItemUnlockAndOpen(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab);

IF
UseStarted((CHARACTER)_Var1, S_LOW_DoorLever_e1b2ef3a-ad17-48ad-a643-f1c10474fd68, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
IsLocked(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, 1, _Var1, _Var1, _Var1)
THEN
PROC_ItemUnlockAndOpen(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab);

PROC
PROC_LOW_Philgraves_OpenOrCloseDoor((ITEM)_Var1, (ITEM)_Var2, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
IsClosed(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, 1, _Var1, _Var1, _Var1)
THEN
PlayAnimation(_Var2, OBJ_Open_Unused_01_1c8ad609-f780-418e-9fdf-c52f6d749c9f, "");
Open(_Var1);

PROC
PROC_LOW_Philgraves_OpenOrCloseDoor((ITEM)_Var1, (ITEM)_Var2, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
IsOpened(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, 1, _Var1, _Var1, _Var1)
THEN
PlayAnimation(_Var2, OBJ_Close_Unused_01_a7078367-8eed-4ba7-a436-196774f68a60, "");
Close(_Var1);

IF
UseStarted((CHARACTER)_Var1, S_LOW_DoorLever_e1b2ef3a-ad17-48ad-a643-f1c10474fd68, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_LOW_Philgraves_OpenOrCloseDoor(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, S_LOW_DoorLever_e1b2ef3a-ad17-48ad-a643-f1c10474fd68);

IF
DestroyedBy(S_LOW_ThrumboWardrobe_360023df-ad20-483d-a6ad-5543db21d902, (CHARACTER)_Var1, (CHARACTER)_Var2, _, (CHARACTER)_Var1)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_ThrumboLeaveSpot", _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(LOW_PhilgravesMansion_Quest_FoundThrumbo_14d2ebc7-b98f-456a-b7f0-cb73ec788826);
PROC_SetOnStage(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, 1);
PROC_NotifyWhenReadyToMoveOn(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, "LOW_PhilgravesMansion_ThrumboReadyToLeaveCloset");

IF
UseStarted((CHARACTER)_Var1, S_LOW_ThrumboWardrobe_360023df-ad20-483d-a6ad-5543db21d902, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_ThrumboLeaveSpot", _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(LOW_PhilgravesMansion_Quest_FoundThrumbo_14d2ebc7-b98f-456a-b7f0-cb73ec788826);
PROC_SetOnStage(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, 1);
PROC_NotifyWhenReadyToMoveOn(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, "LOW_PhilgravesMansion_ThrumboReadyToLeaveCloset");

PROC
PROC_ReadyToMoveOn((CHARACTER)_Var1, "LOW_PhilgravesMansion_ThrumboReadyToLeaveCloset", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_TryStartAD(LOW_PhilgravesMansion_AD_ThrumboLeftCloset_909f9840-ca35-bcd7-3df0-82ab0f83b747, S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb);
PROC_CharacterMoveTo(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, S_LOW_ThrumboJump_59becc5d-09b5-4df0-9667-190fd8b9f32c, "Run", "LOW_PhilgravesMansion_ThrumboLeftCloset");
SetEntityEvent(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, "LOW_PhilgravesMansion_StopHiding");

IF
EntityEvent((GUIDSTRING)_Var1, "LOW_PhilgravesMansion_ThrumboLeftCloset", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
QRY_SpeakerIsAvailable(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_LOW_PhilgravesMansion_FindSpeakerForThrumbo()
AND
DB_QRYRTN_LOW_PhilgravesMansion_FindSpeakerForThrumbo(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialog(LOW_PhilgravesMansion_Thrumbo_eaa15ff1-12c2-a8fe-657e-b0e83d779339, _Var1, _Var2, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_LOW_PhilgravesMansion_FindSpeakerForThrumbo()
AND NOT
DB_QRYRTN_LOW_PhilgravesMansion_FindSpeakerForThrumbo(_, _, _, _, _)
AND
DB_Players(_Var2, _, _, _, _)
AND
QRY_SpeakerIsAvailableAndInDialogRange(_Var2, S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, _, _, _)
THEN
DB_QRYRTN_LOW_PhilgravesMansion_FindSpeakerForThrumbo(_Var2);

IF
DialogEnded(LOW_PhilgravesMansion_Thrumbo_eaa15ff1-12c2-a8fe-657e-b0e83d779339, _, _, _, _)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_ThrumboDialogEnded", _, _, _, _)
THEN
SetFlag(LOW_Thrumbo_Event_StopHiding_9f4d1064-e5b9-41b1-969a-8ee9886eb07c);

QRY
QRY_StartDialogFailed(LOW_PhilgravesMansion_Thrumbo_eaa15ff1-12c2-a8fe-657e-b0e83d779339, _, _, _, _, _, _, _, _, _)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_ThrumboDialogEnded", _, _, _, _)
THEN
SetFlag(LOW_Thrumbo_Event_StopHiding_9f4d1064-e5b9-41b1-969a-8ee9886eb07c);

PROC
PROC_LOW_PhilgravesMansion_SetOneShots()
AND
DB_LOW_PhilgravesMansion_BeggarOneShotTriggers(_Var1, _, _, _, _Var1)
THEN
DB_OneShotPlayerTrigger(_Var1);

PROC
PROC_OneShotTriggerEntered((GUIDSTRING)_Var1, (GUIDSTRING)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_PhilgravesMansion_BeggarOneShotTriggers(_Var2, _Var3, _Var4, _Var5, _Var1)
AND NOT
DB_PermaDefeated(_Var3, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_DialogNPCs(_, _Var3, _, _Var1, _Var1)
AND NOT
DB_PermaDefeated(_Var4, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_DialogNPCs(_, _Var4, _, _Var1, _Var1)
THEN
PROC_TryStartAD(_Var5, _Var3, _Var4);

IF
AutomatedDialogRequestFailed((DIALOGRESOURCE)_Var1, _, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND
DB_LOW_PhilgravesMansion_BeggarOneShotTriggers(_, _Var4, _, _Var1, _Var1)
THEN
SetEntityEvent(_Var4, "LOW_PhilgravesMansion_EndedInitialScene");

IF
AutomatedDialogEnded((GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_PhilgravesMansion_BeggarOneShotTriggers(_, _Var4, _, _Var1, _Var1)
AND
_Var4 != S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4
THEN
SetEntityEvent(_Var4, "LOW_PhilgravesMansion_EndedInitialScene");

IF
DialogEnded(LOW_PhilgravesMansion_LumbarAttacker_13ebe2ec-2700-226b-7b12-f7c0e35a4241, _, _, _, _)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_StartBeating", _, _, _, _)
THEN
PROC_LOW_PhilgravesMansion_StartBeating();

IF
AutomatedDialogEnded(LOW_PhilgravesMansion_AD_LumbarPreBeating_19676a7d-bae5-f015-8a87-09ebd10bbcf6, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_LOW_PhilgravesMansion_StartBeating();

PROC
PROC_LOW_PhilgravesMansion_StartBeating()
THEN
PROC_SelfHealing_Disable(S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4);
DB_LOW_PhilgravesMansion_BeatingActive(1);
DB_LOW_PhilgravesMansion_LumbarPunchesLeft(4);
PROC_LOW_PhilgravesMansion_PunchLumbar();

QRY
QRY_LOW_PhilgravesMansion_CheckDoBeating()
AND NOT
DB_Is_InCombat(S_LOW_LumbarAttacker_1f9a18a4-a5a1-4204-8857-7c9977e96bff, _, _, _, _)
AND NOT
DB_Is_InCombat(S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4, _, _, _, _)
AND NOT
DB_Defeated(S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4, _, _, _, _)
AND NOT
DB_Defeated(S_LOW_LumbarAttacker_1f9a18a4-a5a1-4204-8857-7c9977e96bff, _, _, _, _)
THEN
DB_NOOP(1);

PROC
PROC_LOW_PhilgravesMansion_PunchLumbar()
AND NOT
QRY_LOW_PhilgravesMansion_CheckDoBeating()
THEN
PROC_PhilgravesMansion_StopBeatingLumbar();

PROC
PROC_LOW_PhilgravesMansion_PunchLumbar()
AND NOT
DB_LOW_PhilgravesMansion_WaitingToLeaveBeating(_, _, _, _, _)
AND
QRY_LOW_PhilgravesMansion_CheckDoBeating()
AND
DB_LOW_PhilgravesMansion_LumbarPunchesLeft(_Var2, _, _, _, _)
AND
DB_LOW_PhilgravesMansion_BeatingActive(1, _, _, _, _)
AND
IntegerSubtract(_Var2, 1, _Var3, _, _)
AND
_Var3 > 0
THEN
NOT DB_LOW_PhilgravesMansion_LumbarPunchesLeft(_Var2);
DB_LOW_PhilgravesMansion_LumbarPunchesLeft(_Var3);
UseSpell(S_LOW_LumbarAttacker_1f9a18a4-a5a1-4204-8857-7c9977e96bff, "Target_UnarmedAttack", S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4);

PROC
PROC_LOW_PhilgravesMansion_PunchLumbar()
AND
DB_LOW_PhilgravesMansion_LumbarPunchesLeft(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_BeatingActive(1, _Var1, _Var1, _Var1, _Var1)
AND
IntegerSubtract(_Var1, 1, _Var2, _Var1, _Var1)
AND
_Var2 <= 0
THEN
PROC_PhilgravesMansion_StopBeatingLumbar();

PROC
PROC_PhilgravesMansion_StopBeatingLumbar()
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_StopBeating", _, _, _, _)
THEN
NOT DB_LOW_PhilgravesMansion_BeatingActive(1);
PROC_TryStartAD(LOW_PhildravesMansion_AD_PostLumbarBeating_7994d3ba-9de9-ce11-274d-a6ce2e70562d, S_LOW_LumbarAttacker_1f9a18a4-a5a1-4204-8857-7c9977e96bff, S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4);
PROC_SelfHealing_Enable(S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4);

IF
AutomatedDialogEnded(LOW_PhildravesMansion_AD_PostLumbarBeating_7994d3ba-9de9-ce11-274d-a6ce2e70562d, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_LOW_PhilgravesMansion_EndLumbarVignette();

IF
AutomatedDialogRequestFailed(LOW_PhildravesMansion_AD_PostLumbarBeating_7994d3ba-9de9-ce11-274d-a6ce2e70562d, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_LOW_PhilgravesMansion_EndLumbarVignette();

PROC
PROC_LOW_PhilgravesMansion_EndLumbarVignette()
THEN
SetFlag(LOW_PhilgravesMansion_LumbarBeatingDone_6aa92ecb-8f64-4b85-899a-039518d60c07);
SetEntityEvent(S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4, "LOW_PhilgravesMansion_EndedInitialScene");
PROC_DisappearOutOfSightTo(S_LOW_LumbarAttacker_1f9a18a4-a5a1-4204-8857-7c9977e96bff, S_LOW_LumbarAttackerLeaveTrigger_03750117-a17e-45e4-a0d8-6773761d1d4c, "Walk", 0, "");

IF
DialogStarted(LOW_PhilgravesMansion_Lumbar_5b26d0e7-ee4f-efd7-4c1b-6f9b90293d5e, _, _, _, _)
AND
DB_LOW_PhilgravesMansion_BeatingActive(1, _, _, _, _)
THEN
PROC_PhilgravesMansion_StopBeatingLumbar();

IF
DialogStarted(LOW_PhilgravesMansion_LumbarAttacker_13ebe2ec-2700-226b-7b12-f7c0e35a4241, _, _, _, _)
AND NOT
DB_LOW_PhilgravesMansion_WaitingToLeaveBeating(1, _, _, _, _)
THEN
DB_LOW_PhilgravesMansion_WaitingToLeaveBeating(1);

IF
DialogEnded(LOW_PhilgravesMansion_LumbarAttacker_13ebe2ec-2700-226b-7b12-f7c0e35a4241, _, _, _, _)
AND
DB_LOW_PhilgravesMansion_WaitingToLeaveBeating(1, _, _, _, _)
THEN
NOT DB_LOW_PhilgravesMansion_WaitingToLeaveBeating(1);
PROC_SelfHealing_Enable(S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4);
NOT DB_LOW_PhilgravesMansion_BeatingActive(1);
PROC_LOW_PhilgravesMansion_EndLumbarVignette();

IF
UsingSpellOnTarget(S_LOW_LumbarAttacker_1f9a18a4-a5a1-4204-8857-7c9977e96bff, S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4, "Target_UnarmedAttack", _, _, (INTEGER)_Var3, (STRING)_, (STRING)_, (STRING)_, (STRING)_)
THEN
DB_LOW_PhilgravesMansion_LumbarPunch(_Var3);

IF
CastedSpell(S_LOW_LumbarAttacker_1f9a18a4-a5a1-4204-8857-7c9977e96bff, "Target_UnarmedAttack", _, _, (INTEGER)_Var3)
AND
DB_LOW_PhilgravesMansion_LumbarPunch(_Var3, _, _, _, _)
THEN
NOT DB_LOW_PhilgravesMansion_LumbarPunch(_Var3);
TimerLaunch("LOW_PhilgravesMansion_WaitForNextLumbarPunch", 3000);

IF
CastSpellFailed(S_LOW_LumbarAttacker_1f9a18a4-a5a1-4204-8857-7c9977e96bff, "Target_UnarmedAttack", _, _, (INTEGER)_Var3)
AND
DB_LOW_PhilgravesMansion_LumbarPunch(_Var3, _, _, _, _)
THEN
NOT DB_LOW_PhilgravesMansion_LumbarPunch(_Var3);

IF
TimerFinished("LOW_PhilgravesMansion_WaitForNextLumbarPunch", _, _, _, _)
THEN
PROC_LOW_PhilgravesMansion_PunchLumbar();

IF
UsingSpellOnTarget((CHARACTER)_Var1, S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4, "Target_UnarmedAttack", _, _, (INTEGER)_Var4, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_LOW_PhilgravesMansion_LumbarPunch_Player(_Var4);

IF
DB_LOW_PhilgravesMansion_LumbarPunch_Player(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_LumbarBeatingDone_6aa92ecb-8f64-4b85-899a-039518d60c07, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_PhilgravesMansion_BeatingActive(1);
PROC_DisappearOutOfSightTo(S_LOW_LumbarAttacker_1f9a18a4-a5a1-4204-8857-7c9977e96bff, S_LOW_LumbarAttackerLeaveTrigger_03750117-a17e-45e4-a0d8-6773761d1d4c, "Run", 0, "");
SetFlag(LOW_PhilgravesMansion_LumbarBeatingDone_6aa92ecb-8f64-4b85-899a-039518d60c07);

QRY
QRY_CRIME_BlockRegisterCrime((CHARACTER)_Var1, (STRING)_Var2, (INTEGER)_Var3, (GUIDSTRING)_Var4, S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4, (INTEGER)_Var5, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_CRIME_IsCrimeFamilyMember(_Var2, "Assault", _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_PhilgravesMansion_LumbarPunch_Player(_Var3);
SetFlag(LOW_Lumbar_State_PunchedByPlayer_e015603e-28d1-1efd-4cc7-3702638d6963, _Var1);
PROC_LOW_PhilgravesMansion_LumbarReactToPlayerPunch(_Var1);

PROC
PROC_LOW_PhilgravesMansion_LumbarReactToPlayerPunch((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
GetFlag(LOW_PhilgravesMansion_PaidLumbar_9599f39c-7ed3-8976-4932-a2348b55784c, _Var1, 0, _Var1, _Var1)
AND
GetFlag(LOW_Lumbar_NextPunchWillBeHostile_01fee4d2-74ab-4d00-a8b8-d447c02f2a95, _Var1, 0, _Var1, _Var1)
THEN
PROC_ForceStopDialog(S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4);
PROC_TryStartAD(LOW_PhilgravesMansion_AD_LumbarReactionAfterPunch_NoPay_fad9ed9c-f59b-74d3-bd5e-00393305cca1, S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4, _Var1);

PROC
PROC_LOW_PhilgravesMansion_LumbarReactToPlayerPunch((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
GetFlag(LOW_PhilgravesMansion_PaidLumbar_9599f39c-7ed3-8976-4932-a2348b55784c, _Var1, 0, _Var1, _Var1)
AND
GetFlag(LOW_Lumbar_NextPunchWillBeHostile_01fee4d2-74ab-4d00-a8b8-d447c02f2a95, _Var1, 1, _Var1, _Var1)
THEN
PROC_SetRelationToPlayers(ACT3_LOW_PhilgravesMansion_Lumbar_036304f6-bbd9-46fb-879c-fc4408eed63d, 0);

PROC
PROC_LOW_PhilgravesMansion_LumbarReactToPlayerPunch((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
GetFlag(LOW_PhilgravesMansion_PaidLumbar_9599f39c-7ed3-8976-4932-a2348b55784c, _Var1, 1, _Var1, _Var1)
THEN
ClearFlag(LOW_PhilgravesMansion_PaidLumbar_9599f39c-7ed3-8976-4932-a2348b55784c, _Var1);
PROC_TryStartAD(LOW_PhilgravesMansion_AD_LumbarReactionAfterPunch_d0889c69-aa30-18d2-560c-5fcdb364be3a, S_LOW_Lumbar_cc4b66fb-a789-472d-8d23-ad3380215ca4, _Var1);

IF
FlagSet(LOW_PhilgravesMansion_State_HasHeart_22154967-9777-4149-bbae-216409fea025, S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, _, (INTEGER)_, (INTEGER)_)
THEN
SetFlag(LOW_PhilgravesMansion_State_HeartInThrumbosInventory_46beba15-84e7-47ac-bc46-922cf0345b1a);

IF
FlagCleared(LOW_PhilgravesMansion_State_HasHeart_22154967-9777-4149-bbae-216409fea025, S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, _, (INTEGER)_, (INTEGER)_)
THEN
ClearFlag(LOW_PhilgravesMansion_State_HeartInThrumbosInventory_46beba15-84e7-47ac-bc46-922cf0345b1a);

IF
AddedTo(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, (GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
SetFlag(LOW_PhilgravesMansion_State_HasBody_1_b4d1f8c5-a85a-47e4-9ce3-2105a73987c9, _Var1);

IF
RemovedFrom(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
ClearFlag(LOW_PhilgravesMansion_State_HasBody_1_b4d1f8c5-a85a-47e4-9ce3-2105a73987c9, _Var1);

IF
MovedFromTo(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492, S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, _, _, _)
AND
IsDead(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, 0, _, _, _)
THEN
Die(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, 0, 0);

PROC
PROC_GlobalFlagReactionAfterDialog(LOW_Thrumbo_Event_ThrowUp_6e4e32f8-312b-4bfc-bd46-15af3831a1b5, _, _, _, _)
AND NOT
DB_PermaDefeated(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, _, _, _, _)
THEN
ClearOwnership(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492);
ObjectTimerLaunch(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, "LOW_PhilgravesMansion_ThrowingUp", 500);
PlayAnimation(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, CUST_Throw_Up_01_cf51f24c-b405-4c55-a4e9-bbaf5e210954, "LOW_PhilgravesMansion_ThrowUpAnimationDone");

IF
ObjectTimerFinished(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, "LOW_PhilgravesMansion_ThrowingUp", _, _, _)
THEN
DB_LOW_PhilgravesMansion_ReadyToTeleport(1);
SetFlag(LOW_Thrumbo_Event_TeleportJarFromThrumbo_504e5385-96bd-4215-85de-22b81374382c);

IF
ItemTeleported(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492, _, _, _, _, _, _, _, _, _)
AND
DB_LOW_PhilgravesMansion_ReadyToTeleport(1, _, _, _, _)
AND
GetPosition(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492, _Var7, _Var8, _Var9, _)
THEN
NOT DB_LOW_PhilgravesMansion_ReadyToTeleport(1);
PROC_TryStartAD(LOW_PhilgravesMansion_ZombieBeggarsVomit_AD_0eb35eb5-79ce-3343-076c-f731ee4fc36e, S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb);
PlayEffectAtPosition(VFX_Script_LOW_HAG_BlushingMermaid_Vomit_01_44647e59-07b5-9678-6989-a08aa59c4ba2, _Var7, _Var8, _Var9, 1);
QuestUpdate("LOW_PhilgravesMansion", "Thrumbo_ThrowUp");

IF
AttackedBy(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492, _, _, _, _, _, _, _, _, _)
AND
CanSee(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492, 1, _, _)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_ThrumboReactToAttackedJar", _, _, _, _)
THEN
PROC_TryStartAD(LOW_PhilgravesMansion_ThrumboJarAttack_AD_2890a536-064b-1186-f2d6-e1f557f763e5, S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb);

PROC
PROC_LOW_PhilgravesMansion_ChangeFactionUndeads()
AND
DB_LOW_PhilgravesMansion_CarrionMinions(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFaction(_Var1, ACT3_LOW_PhilgravesMansion_Beggars_ccd1d57e-f358-4608-94e0-114dd2b552bb);

PROC
PROC_LOW_PhilgravesMansion_ChangeFactionUndeads()
THEN
SetFlag(LOW_PhilgravesMansion_State_CheckpointGivenAccess_0cd65e38-ca07-44c3-a225-19365ff5c483);

PROC
PROC_ReadyToMoveOn((CHARACTER)_Var1, "LOW_PhilgravesMansion_ZombieGoingToHouse", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_PhilgravesMansion_ZombieBeggarsInsideHouseLocations(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
ClearFlag(LOW_PhilgravesMansion_State_ZombieOutsideHouse_c8999882-566e-40b5-9e44-eff82249850b, _Var1);
PROC_CharacterMoveTo(_Var1, _Var2, "Run", "LOW_PhilgravesMansion_ZombieInstalledInHouse");

IF
DialogEnded(LOW_PhilgravesMansion_ThrumboHouse_f6455bc1-4c42-e798-8730-61b6433fca65, _, _, _, _)
AND
DB_GlobalFlag(LOW_PhilgravesMansion_Event_ZombiesGoInsideHouse_2a946158-679c-498b-bfbf-6a3e3f6b087e, _, _, _, _)
AND
DB_LOW_PhilgravesMansion_ZombieBeggarsInsideHouseLocations(_Var2, _Var3, _, _, _)
AND NOT
DB_PermaDefeated(_Var2, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_StreetDoorOpenedOrDestroyed_92ff7268-c049-43f7-9731-89200c439afb, _, _, _, _)
THEN
DB_LOW_PhilgravesMansion_GoingInsideHouse(_Var2);

IF
Opened(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_PhilgravesMansion_GoingInsideHouse(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_NotifyWhenReadyToMoveOn(_Var1, "LOW_PhilgravesMansion_ZombieGoingToHouse");

IF
DestroyedBy(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, _, _, _, _)
AND
DB_LOW_PhilgravesMansion_GoingInsideHouse(_Var4, _, _, _, _)
THEN
PROC_NotifyWhenReadyToMoveOn(_Var4, "LOW_PhilgravesMansion_ZombieGoingToHouse");

IF
DB_InRegion(_Var1, S_LOW_PhilgravesMansion_MainHallTrigger_97b50e48-fc3e-435c-a3ba-2745eb733f2e, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_GoingInsideHouse(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TriggerUnregisterForCharacter(S_LOW_PhilgravesMansion_MainHallTrigger_97b50e48-fc3e-435c-a3ba-2745eb733f2e, _Var1);
NOT DB_LOW_PhilgravesMansion_GoingInsideHouse(_Var1);
SetFlag(LOW_PhilgravesMansion_State_ZombieInHouse_1b0c0656-5d5a-4d4a-89cd-83949b09dd98, _Var1);

PROC
PROC_SpotPlayers_Spotted((CHARACTER)_Var1, "LOW_PhilgravesMansion_ThrumboWantsToThank", (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_StartDialog(LOW_PhilgravesMansion_ThrumboInsideHouse_149b5744-5f7a-154b-87d0-ac1f54a02b6c, S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, _Var2, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
DialogStarted(LOW_PhilgravesMansion_ThrumboInsideHouse_149b5744-5f7a-154b-87d0-ac1f54a02b6c, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_SpotPlayers_StopSpotting("LOW_PhilgravesMansion_ThrumboWantsToThank");

PROC
PROC_StartDialog_AddExtraSpeakers(LOW_PhilgravesMansion_AD_BeggarsConversationEndState_3be8f5f2-3c49-facf-2e1e-727e2510e794, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_LOW_PhilgravesMansion_ZombieBeggars(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
_Var2 != S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb
AND
QRY_SpeakerIsAvailable(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, _Var2);

IF
DB_LOW_PhilgravesMansion_ZombieBeggars(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NoLowAttitudeDialog(_Var1);

IF
DB_Is_InCombat(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_ZombieBeggars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var3, _Var2, _Var1, _Var1, _Var1)
AND
DB_Players(_Var3, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_BeggarAngryAtPlayers_6c6c3e32-8f04-4cb7-a2a6-9b6881391834, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GlobalSetFlagAndCache(LOW_PhilgravesMansion_BeggarAngryAtPlayers_6c6c3e32-8f04-4cb7-a2a6-9b6881391834);

PROC
PROC_LongRest()
AND
DB_GlobalFlag(LOW_PhilgravesMansion_Event_PreparingToLeave_38aee7b4-961d-4a42-a792-1f5916d8ed85, _, _, _, _)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_RemoveShip", _, _, _, _)
THEN
PROC_SetOnStage(S_LOW_ThrumboShip_48d28610-6e33-4b52-879d-eb86299b9cf3, 0);
PROC_SetOnStage(S_LOW_ThrumboPaddle_001_b5911672-4a67-45e4-ad59-3f9a1b2a9515, 0);
PROC_SetOnStage(S_LOW_ThrumboPaddle_002_ec5cd601-b005-425b-8ab3-e3f996ed40ad, 0);

PROC
PROC_LongRest()
AND
DB_GlobalFlag(LOW_PhilgravesMansion_Event_PreparingToLeave_38aee7b4-961d-4a42-a792-1f5916d8ed85, _, _, _, _)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_ZombiesLeaving", _, _, _, _)
AND
DB_LOW_PhilgravesMansion_ZombieBeggars(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var1, 0);

PROC
PROC_LOW_PhilgravesMansion_ZombiesGoToHouse()
AND
DB_LOW_PhilgravesMansion_ZombieBeggars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetFaction(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
GetRelation(Hero_a1542c81-6895-929e-4522-10ce218bb360, _Var2, _Var3, _Var1, _Var1)
AND
_Var3 < 50
THEN
PROC_SetRelationToPlayers(_Var2, 50);

PROC
PROC_LOW_PhilgravesMansion_ZombiesGoToHouse()
AND
DB_LOW_PhilgravesMansion_ZombieBeggars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsActive(_Var1, 1, _Var1, _Var1, _Var1)
THEN
TriggerRegisterForCharacter(LOW_PhilgravesMansion_MainHallTrigger_97b50e48-fc3e-435c-a3ba-2745eb733f2e, _Var1);
ClearFlag(LOW_PhilgravesMansion_State_ZombieInOriginalLocation_0c1ac3f8-ce83-40b2-bcff-9ea7572bd983, _Var1);
SetEntityEvent(_Var1, "LOW_PhilgravesMansion_ZombieGoToHouse");

PROC
PROC_LOW_PhilgravesMansion_ZombiesGoToHouse()
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_ChangeFactionUndeads", _, _, _, _)
THEN
SetFlag(LOW_PhilgravesMansion_State_ZombiesMastersOfHouse_d1fe7420-0244-48dd-a726-e98c9e130ac9);
PROC_LOW_PhilgravesMansion_ChangeFactionUndeads();

PROC
PROC_LOW_PhilgravesMansion_ZombiesGoToHouse()
AND
DB_LOW_PhilgravesMansion_LeavingTriggers(_Var1, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsActive(_Var1, 0, _Var1, _Var1, _Var1)
THEN
ClearFlag(LOW_PhilgravesMansion_State_ZombieInOriginalLocation_0c1ac3f8-ce83-40b2-bcff-9ea7572bd983, _Var1);
PROC_DisappearOutOfSightTo(_Var1, _Var2, "Run", 0, "LOW_PhilgravesMansion_ZombieLeftInitialPosition");

IF
EntityEvent((GUIDSTRING)_Var1, "LOW_PhilgravesMansion_ZombieLeftInitialPosition", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
Random(6000, _Var2, _Var1, _Var1, _Var1)
THEN
ObjectTimerLaunch(_Var1, "LOW_PhilgravesMansion_WaitingBeforeAppearingInHouse", _Var2, 0);

IF
ObjectTimerFinished((CHARACTER)_Var1, "LOW_PhilgravesMansion_WaitingBeforeAppearingInHouse", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_PhilgravesMansion_ZombieBeggarsInsideHouseLocations(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_AppearOutOfSightTo(_Var1, S_LOW_OutOfSightHouseTrigger_bcca2908-f0f5-40a6-852e-8b27d9bbd95c, _Var2, "LOW_PhilgravesMansion_ZombieAppearsNearHouse");

IF
EntityEvent((CHARACTER)_Var1, "LOW_PhilgravesMansion_ZombieAppearsNearHouse", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_PhilgravesMansion_ZombieBeggarsInsideHouseLocations(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
DB_LOW_PhilgravesMansion_GoingInsideHouse(_Var1);
PROC_CharacterMoveTo(_Var1, _Var2, "Run", "LOW_PhilgravesMansion_ZombieInstalledInHouse");

IF
DB_LOW_PhilgravesMansion_GoingInsideHouse(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TriggerRegisterForCharacter(S_LOW_PhilgravesMansion_MainHallTrigger_97b50e48-fc3e-435c-a3ba-2745eb733f2e, _Var1);

IF
DB_GlobalFlag(LOW_Thrumbo_State_IsDead_21e2f143-abef-45fa-a29c-6eb91491b9ec, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_FatherCarrion_State_IsFullyDead_683c08ad-358d-400f-8dc8-c1a93f31dcac, _, _, _, _)
THEN
PROC_LOW_PhilgravesMansion_RemoveAllBeggars();

PROC
PROC_LOW_PhilgravesMansion_RemoveAllBeggars()
AND
DB_LOW_PhilgravesMansion_BeggarOneShotTriggers(_Var1, _Var2, _Var3, _Var4, _Var1)
THEN
PROC_TriggerUnregisterForPlayers(_Var1);
PROC_LOW_PhilgravesMansion_RemoveCharacter(_Var2, "Run");
PROC_LOW_PhilgravesMansion_RemoveCharacter(_Var3, "Walk");
NOT DB_LOW_PhilgravesMansion_BeggarOneShotTriggers(_Var1, _Var2, _Var3, _Var4);

PROC
PROC_LOW_PhilgravesMansion_RemoveCharacter((CHARACTER)_Var1, (STRING)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
IsOnStage(_Var1, 1, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DisappearOutOfSight(_Var1, _Var2, 0, "LOW_PhilgravesMansion_CharLeavesPermanently");

IF
EntityEvent((GUIDSTRING)_Var1, "LOW_PhilgravesMansion_StartBeggarConversation", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
PROC_TryStartAD(LOW_PhilgravesMansion_AD_BeggarsConversationEndState_3be8f5f2-3c49-facf-2e1e-727e2510e794, _Var1);

IF
DB_LOW_PhilgravesMansion_CarrionBuffs(_Var1, _, _Var1, _Var1, _Var1)
THEN
ApplyStatus(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _Var1, -1);

IF
DestroyedBy((ITEM)_Var1, _, _, _, (ITEM)_Var1)
AND
DB_LOW_PhilgravesMansion_CarrionBuffs(_Var5, _Var1, _Var1, _Var1, _Var1)
THEN
RemoveStatus(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _Var5);

IF
LevelLoaded("CTY_Main_A", _, _, _, _)
AND NOT
DB_LOW_PhilgravesMansion_MovedGem(1, _, _, _, _)
THEN
SetGravity(S_FOR_DangerousBook_Key_000_123c268d-ad0c-4df5-905b-a78dacbed80b, 0);
TeleportTo(S_FOR_DangerousBook_Key_000_123c268d-ad0c-4df5-905b-a78dacbed80b, S_LOW_PhilgravesMansion_PlaceForGem_5e6f51c1-a861-493f-91e8-806c8498fa64, "", 0, 0, 0, 0, 0);

PROC
PROC_SpotPlayers_Spotted((CHARACTER)_Var1, "LOW_PhilgravesMansion_CarrionSpotted", (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_GetClosestAvailableCharacterTo(_Var1, 1, 0, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, 1, _Var1, _Var1, _Var1, _Var1)
AND
DB_ClosestAvailableCharacterTo_PreferAvatar(_Var3, _Var1, _, _, _Var1)
AND
QRY_SpeakerIsAvailable(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_CarrionNotSpotting_223ba810-bd5e-4a07-801b-2a84c8eedd04, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialog(LOW_PhilgravesMansion_FatherCarrion_b141f677-21c0-cba8-331e-21e157dba36b, _Var1, _Var3, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_StartDialog_AddExtraSpeakers(LOW_PhilgravesMansion_FatherCarrion_b141f677-21c0-cba8-331e-21e157dba36b, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
QRY_SpeakerIsAvailableAndInDialogRange(S_LOW_FatherCarrion_Ghast_Lower_d8141d00-5f80-4245-9a48-fe3651be6954, S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_LOW_FatherCarrion_Ghast_Lower_d8141d00-5f80-4245-9a48-fe3651be6954);

IF
DialogStarted(LOW_PhilgravesMansion_FatherCarrion_b141f677-21c0-cba8-331e-21e157dba36b, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_CarrionNotSpotting_223ba810-bd5e-4a07-801b-2a84c8eedd04, _, _, _, _)
THEN
SetFlag(LOW_PhilgravesMansion_State_CarrionNotSpotting_223ba810-bd5e-4a07-801b-2a84c8eedd04);
PROC_TriggerUnregisterForPlayers(LOW_PhilgravesMansion_MainHallTrigger_97b50e48-fc3e-435c-a3ba-2745eb733f2e);

IF
Saw(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, _, _, _)
AND NOT
DB_GlobalFlag(LOW_FatherCarrion_State_ReactedToDroppedCorpse_6f17e3bb-64b2-4e67-b3f9-a2daca64e6e7, _, _, _, _)
AND
DB_PermaDefeated(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_FatherCarrion_State_IsIndebtedToPlayers_b2e22b4d-f88a-437a-b893-1f20e3e5ebf9, _, _, _, _)
THEN
PROC_PhilgravesMansion_CarrionReactToDroppedCorpse();

PROC
PROC_PhilgravesMansion_CarrionReactToDroppedCorpse()
AND
QRY_LOW_PhilgravesMansion_CarrionFindAvatarToTalk(0, _, _, _, _)
AND
DB_QRYRTN_LOW_PhilgravesMansion_CarrionFindAvatarToTalk(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(LOW_FatherCarrion_Event_ReactToDroppedCorpse_65c40747-2eb8-47a8-b0ea-20f1450f4796);
PROC_CharacterMoveToAndTalk(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _Var1, LOW_PhilgravesMansion_FatherCarrion_b141f677-21c0-cba8-331e-21e157dba36b, "LOW_PhilgravesMansion_CarrionReactToCorpse", "Walk", 15);

PROC
PROC_PhilgravesMansion_CarrionReactToDroppedCorpse()
AND NOT
QRY_LOW_PhilgravesMansion_CarrionFindAvatarToTalk(0, _, _, _, _)
THEN
DB_LOW_PhilgravesMansion_CarrionSawThrumboOnGround(1);

IF
Saw(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_CarrionSawThrumboOnGround(1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(LOW_FatherCarrion_Event_ReactToDroppedCorpse_65c40747-2eb8-47a8-b0ea-20f1450f4796);
PROC_CharacterMoveToAndTalk(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _Var1, LOW_PhilgravesMansion_FatherCarrion_b141f677-21c0-cba8-331e-21e157dba36b, "LOW_PhilgravesMansion_CarrionReactToCorpse", "Walk", 15);

IF
FlagSet(LOW_FatherCarrion_State_ReactedToDroppedCorpse_6f17e3bb-64b2-4e67-b3f9-a2daca64e6e7, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
NOT DB_LOW_PhilgravesMansion_CarrionSawThrumboOnGround(1);

IF
CharacterMoveToAndTalkFailed((CHARACTER)_Var1, (GUIDSTRING)_Var2, "LOW_PhilgravesMansion_CarrionReactToCorpse", _, (CHARACTER)_Var1)
THEN
PROC_TryStartAD(LOW_PhilgravesMansion_AD_CarrionSeesThrumboInHouse_32b2a54a-be23-143a-103a-263db958a871, _Var1);

IF
UseStarted(_, S_LOW_LetterFatherCarrion_c4aae84c-c9b5-4941-a94f-c5c8ead07205, (CHARACTER)_, (CHARACTER)_, (CHARACTER)_)
THEN
SetFlag(LOW_OskarsBeloved_State_ReadLetter_ee3f0fae-416f-4511-a2e6-30e79685f730);

PROC
PROC_PhilgravesMansion_RevealStartCombatLower()
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_CoffinsExploded_1f9f2727-f672-42d9-a78f-977be962c77b, _, _, _, _)
THEN
PROC_LOW_PhilgravesMansion_ExplodeCoffins();
SetFlag(LOW_PhilgravesMansion_State_CoffinsExploded_1f9f2727-f672-42d9-a78f-977be962c77b);

PROC
PROC_PhilgravesMansion_RevealStartCombatUpper()
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_CoffinsExploded_1f9f2727-f672-42d9-a78f-977be962c77b, _, _, _, _)
THEN
SetFlag(LOW_PhilgravesMansion_State_CoffinsUpperExploded_f0f97b89-13ef-4b15-9c94-25e0e76181e1);
PROC_SetRelationToPlayers(ACT3_LOW_PhilgravesMansion_FatherCarrionUpperFloor_1d746532-eee0-4ea7-a7fa-09fbddb84f94, 0);

IF
AttackedBy((ITEM)_Var1, (GUIDSTRING)_Var2, _, (STRING)_Var4, _, _, _, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_LOW_PhilgravesMansion_Jars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var4 != "Fire"
THEN
ApplyDamage(_Var2, 5, "Necrotic", _Var2);

IF
AttackedBy((ITEM)_Var1, (CHARACTER)_Var2, _, (STRING)_Var4, _, _, _, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_LOW_PhilgravesMansion_Jars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
_Var4 != "Fire"
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_ReactionToWrongJarAttack", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(LOW_PhilgravesMansion_PAD_ReactToJarNoDamage_cee6df2f-ad9c-d5f5-5846-af7edc9c0e0f, _Var2);

IF
DestroyedBy((ITEM)_Var1, _, (CHARACTER)_Var3, _, (ITEM)_Var1)
AND
DB_LOW_PhilgravesMansion_Jars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetPosition(_Var1, _Var5, _Var6, _Var7, _Var1)
THEN
CreateExplosionAtPosition(_Var5, _Var6, _Var7, "Projectile_Fireball", 5, NULL_00000000-0000-0000-0000-000000000000);

IF
DestroyedBy((ITEM)_Var1, _, (CHARACTER)_Var3, _, (ITEM)_Var1)
AND
DB_LOW_PhilgravesMansion_Jars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_DestroyedNonHeartJar_0b8a48a7-b093-4ac2-a4b1-502e9b5dad31, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(LOW_PhilgravesMansion_State_DestroyedNonHeartJar_0b8a48a7-b093-4ac2-a4b1-502e9b5dad31);

IF
DestroyedBy((ITEM)_Var1, _, (CHARACTER)_Var3, _, (ITEM)_Var1)
AND
DB_LOW_PhilgravesMansion_Jars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_CharacterGetOwnerOrSelf(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
DB_QRYRTN_CharacterGetOwnerOrSelf(_Var5, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_FirstJarDestroyed", _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(LOW_FatherCarrion_Event_DetectedDestroyedJar_5e62e951-554d-40bb-b743-a69488cafdd0);
PROC_SetRelationToPlayers(ACT3_LOW_PhilgravesMansion_FatherCarrionUpperFloor_1d746532-eee0-4ea7-a7fa-09fbddb84f94, 0);
PROC_SetRelationToPlayers(ACT3_LOW_PhilgravesMansion_FatherCarrion_6ee4b3ed-b298-4388-ab59-e999f4d2a504, 0);
PROC_TryStartAD(LOW_PhilgravesMansion_PAD_ReactToJarDestroyed_b1f012fe-8e9a-0174-2fd5-be784db92cc2, _Var5);

IF
DB_GlobalFlag(LOW_PhilgravesMansion_Event_SetJarsToChest_98b9ea3e-835d-4cfe-8dca-def8b48affcb, _, _, _, _)
THEN
PROC_LOW_PhilgravesMansion_SendAllJarsToBasement();

IF
DB_GlobalFlag(LOW_PhilgravesMansion_Event_SendThrumboTorsoToChest_d3ff1c4d-8ed9-494b-bcaa-6bcb9bfc3c61, _Var1, _Var1, _Var1, _Var1)
AND
GetInventoryOwner(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, _Var1, _Var1, _Var1, _Var1)
THEN
MagicPocketsDrop(_Var1, S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb);
PROC_PhilgravesMansion_SendJarToBasement(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492);

IF
DB_GlobalFlag(LOW_PhilgravesMansion_Event_SendHeartToChest_c3117ba0-ab0c-40f1-a73a-516af03c44a6, _, _, _, _)
THEN
PROC_PhilgravesMansion_SendJarToBasement(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492);

PROC
PROC_LOW_PhilgravesMansion_SendAllJarsToBasement()
AND
DB_LOW_PhilgravesMansion_Jars(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PhilgravesMansion_SendJarToBasement(_Var1);

IF
AddedTo((ITEM)_Var1, (CHARACTER)_Var2, _, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_Jars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_GrabbedFirstJarOtherThanHeart_6e4cb103-051d-4164-8c0a-84af4b2a3bff, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(LOW_PhilgravesMansion_State_GrabbedFirstJarOtherThanHeart_6e4cb103-051d-4164-8c0a-84af4b2a3bff);

IF
AddedTo((ITEM)_Var1, (CHARACTER)_Var2, _, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_Jars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetDirectInventoryOwner(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_ReactToGettingFirstJar", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(LOW_PhilgravesMansion_PAD_FirstJarGrabbed_5b6dd0c6-c2b0-c5a5-3bf0-ab99b830d334, _Var2);

IF
AddedTo((ITEM)_Var1, (GUIDSTRING)_Var2, _, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_LOW_PhilgravesMansion_Jars(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_LOW_PhilgravesMansion_JarContainer(_Var1, _Var2);

IF
RemovedFrom((ITEM)_Var1, (GUIDSTRING)_Var2, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_LOW_PhilgravesMansion_JarContainer(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_PhilgravesMansion_JarContainer(_Var1, _Var2);

PROC
PROC_PhilgravesMansion_SendJarsFromHeartContainer()
AND
DB_LOW_PhilgravesMansion_JarContainer(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_JarContainer(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492 != _Var2
THEN
PROC_PhilgravesMansion_SendJarToBasement(_Var2);

PROC
PROC_PhilgravesMansion_SendJarToBasement((ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1, (ITEM)_Var1)
AND
DB_LOW_PhilgravesMansion_Jars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PhilgravesMansion_JarBasementLocation(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
GetPosition(_Var2, _Var3, _Var4, _Var5, _Var1)
AND
GetHostCharacter(_Var6, _Var1, _Var1, _Var1, _Var1)
AND
GUIDToString(_Var1, _Var7, _Var1, _Var1, _Var1)
THEN
SetGravity(_Var1, 0);
TeleportTo(_Var1, _Var2, "", 0, 0, 0, 0, 0);

IF
LongRestFinished()
AND
DB_Defeated(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_FatherCarrion_State_IsFullyDead_683c08ad-358d-400f-8dc8-c1a93f31dcac, _, _, _, _)
AND
GetOwner(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_CarrionThreatSend", _Var1, _Var1, _Var1, _Var1)
THEN
ObjectTimerLaunch(_Var1, "LOW_PhilgravesMansion_CarrionThreatSendTimer", 2000);

IF
ObjectTimerFinished((GUIDSTRING)_Var1, "LOW_PhilgravesMansion_CarrionThreatSendTimer", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
PROC_SetOnStage(S_LOW_CarrionThreat_2ae36508-b040-4292-843d-b5939285435e, 1);
ToInventory(S_LOW_CarrionThreat_2ae36508-b040-4292-843d-b5939285435e, _Var1, 1, 0);

IF
RelationChanged(ACT3_LOW_PhilgravesMansion_FatherCarrion_6ee4b3ed-b298-4388-ab59-e999f4d2a504, (FACTION)_Var1, 0, 0, (FACTION)_Var1)
AND
FactionGetParentFaction(_Var1, 1, Hero_a1542c81-6895-929e-4522-10ce218bb360, _Var1, _Var1)
THEN
PROC_SetRelationMutual(ACT3_LOW_PhilgravesMansion_FatherCarrion_6ee4b3ed-b298-4388-ab59-e999f4d2a504, _Var1, 0);

IF
RelationChanged(ACT3_LOW_PhilgravesMansion_FatherCarrion_6ee4b3ed-b298-4388-ab59-e999f4d2a504, (FACTION)_Var1, 0, _, (FACTION)_Var1)
AND
FactionGetParentFaction(_Var1, 1, Hero_a1542c81-6895-929e-4522-10ce218bb360, _Var1, _Var1)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_AngeredCarrion", _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(LOW_FatherCarrion_State_IsHostile_50c741f9-19be-4fac-997a-3d31202ba14e);

IF
DB_Is_InCombat(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_LOW_PhilgravesMansion_CarrionCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PhilgravesMansion_RevealStartCombatLower();
DB_LOW_PhilgravesMansion_CarrionCombat(_Var1);

IF
CombatEnded((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_PhilgravesMansion_CarrionCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Defeated(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _Var1, _Var1, _Var1, _Var1)
AND
QRY_LOW_PhilgravesMansion_ShouldPlayersReactToCarrionDeath()
AND
QRY_GetClosestAvailableCharacterTo(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, 0, 0, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, 0, 0, 1, _Var1, _Var1)
AND
DB_ClosestAvailableCharacterTo(_Var2, S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _, _Var1, _Var1)
THEN
PROC_LOW_PhilgravesMansion_PlayCarrionReaction(_Var2);

PROC
PROC_LOW_PhilgravesMansion_PlayCarrionReaction((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_GlobalFlag(LOW_PhilgravesMansion_State_IdentifiedCarrionAsMummyLord_a6769dc6-e746-40be-95f2-321c2ec9b182, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(LOW_PhilgravesMansion_PAD_CarrionKilledReaction_58d92b94-d115-8af4-51d8-ed535461857f, _Var1);

PROC
PROC_LOW_PhilgravesMansion_PlayCarrionReaction((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_IdentifiedCarrionAsMummyLord_a6769dc6-e746-40be-95f2-321c2ec9b182, _Var1, _Var1, _Var1, _Var1)
THEN
RequestPassiveRoll(_Var1, _Var1, "SkillCheck", "Arcana", Act3_Hard_6298329e-255c-4826-9209-e911873b64e7, 0, "LOW_PhilgravesMansion_CarrionDeathReaction");

PROC
PROC_RollResult("LOW_PhilgravesMansion_CarrionDeathReaction", (CHARACTER)_Var1, (CHARACTER)_Var1, 1, (CHARACTER)_Var1)
THEN
SetFlag(LOW_PhilgravesMansion_Event_PlayersSucceededRollCarrionDeath_51e725be-2b27-4411-bc77-4148552a6d32);

PROC
PROC_RollResult("LOW_PhilgravesMansion_CarrionDeathReaction", (CHARACTER)_Var1, (CHARACTER)_Var1, _, (CHARACTER)_Var1)
THEN
PROC_TryStartAD(LOW_PhilgravesMansion_PAD_CarrionKilledReaction_58d92b94-d115-8af4-51d8-ed535461857f, _Var1);

QRY
QRY_LOW_PhilgravesMansion_ShouldPlayersReactToCarrionDeath()
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_HeartIsDestroyed_fcf8164a-742d-4ef4-af61-3773d8891a44, _, _, _, _)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_CarrionDeathAD_HeartAlive", _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_LOW_PhilgravesMansion_ShouldPlayersReactToCarrionDeath()
AND
DB_GlobalFlag(LOW_PhilgravesMansion_State_HeartIsDestroyed_fcf8164a-742d-4ef4-af61-3773d8891a44, _, _, _, _)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_CarrionDeathAD_HeartDead", _, _, _, _)
THEN
DB_NOOP(1);

IF
CombatEnded((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_PhilgravesMansion_CarrionCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(LOW_FatherCarrion_State_IsFullyDead_683c08ad-358d-400f-8dc8-c1a93f31dcac, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_PhilgravesMansion_BeggarTakeover();

IF
DB_GlobalFlag(LOW_FatherCarrion_State_IsFullyDead_683c08ad-358d-400f-8dc8-c1a93f31dcac, _, _, _, _)
AND NOT
DB_LOW_PhilgravesMansion_CarrionCombat(_, _, _, _, _)
AND NOT
DB_PermaDefeated(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, _, _, _, _)
THEN
PROC_LOW_PhilgravesMansion_BeggarTakeover();

PROC
PROC_LOW_PhilgravesMansion_BeggarTakeover()
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_BeggarTakeover", _, _, _, _)
THEN
PROC_RemoveAllDialogEntriesForSpeaker(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb);
SetCustomTradeTreasure(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, "LOW_MysticCarrion_Thrumbo");
DB_Dialogs(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, LOW_PhilgravesMansion_ThrumboInsideHouse_149b5744-5f7a-154b-87d0-ac1f54a02b6c);
PROC_SetOnStage(S_LOW_ThrumboRing_15edfd0b-ae2a-4ce5-8369-748070746713, 1);
ToInventory(S_LOW_ThrumboRing_15edfd0b-ae2a-4ce5-8369-748070746713, S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, 1, 0, 1);
SetCanInteract(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab, 1);
Unlock(S_LOW_StreetDoor_8f8f545c-5718-47a1-9c3a-f23d10b4e5ab);
DB_SpotPlayers(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, "LOW_PhilgravesMansion_ThrumboWantsToThank", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers_CustomRadius(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, "LOW_PhilgravesMansion_ThrumboWantsToThank", 15);
PROC_LOW_PhilgravesMansion_ZombiesGoToHouse();

IF
CombatEnded((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_PhilgravesMansion_CarrionCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_PhilgravesMansion_CarrionCombat(_Var1);

IF
SwitchedCombat(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, (GUIDSTRING)_Var1, (GUIDSTRING)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_PhilgravesMansion_CarrionCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_PhilgravesMansion_CarrionCombat(_Var1);
DB_LOW_PhilgravesMansion_CarrionCombat(_Var2);

IF
MovedFromTo(S_UNI_LOW_TorchOfRevocation_a042774f-ae71-4d19-9554-ba90cf34d046, _, (GUIDSTRING)_Var2, _, _)
AND
_Var2 != S_LOW_PhilgravesMansion_ClientChest_ee7e8c08-5359-4cc2-932a-42edd01c4de6
THEN
ClearFlag(LOW_PhilgravesMansion_TorchIsInChest_177f5f22-0fd8-4e31-8949-cb8cf45f0dfa);

IF
MovedFromTo(S_UNI_LOW_TorchOfRevocation_a042774f-ae71-4d19-9554-ba90cf34d046, _, S_LOW_PhilgravesMansion_ClientChest_ee7e8c08-5359-4cc2-932a-42edd01c4de6, _, (GUIDSTRING)_)
THEN
SetFlag(LOW_PhilgravesMansion_TorchIsInChest_177f5f22-0fd8-4e31-8949-cb8cf45f0dfa);

PROC
PROC_LongRest()
AND NOT
DB_PermaDefeated(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _, _, _, _)
AND
DB_GlobalFlag(LOW_PhilgravesMansion_State_GivenJarsToFatherCarrion_6b2c0f7b-1246-4154-b3ad-75dc4332099c, _, _, _, _)
AND
DB_GlobalFlag(LOW_PhilgravesMansion_State_AllZombiesOutsideHouseOrDead_e49545bc-075c-4ec6-8434-c7a0b56ea654, _, _, _, _)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_GetZombiesBack", _, _, _, _)
THEN
PROC_LOW_PhilgravesMansion_GetZombiesBack();

PROC
PROC_LongRest()
AND
DB_Defeated(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _, _, _, _)
AND
QRY_LOW_PhilgravesMansion_ZombieHasHeart()
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_GetZombiesBack", _, _, _, _)
THEN
PROC_LOW_PhilgravesMansion_GetZombiesBack();

PROC
PROC_LOW_PhilgravesMansion_GetZombiesBack()
AND
DB_LOW_PhilgravesMansion_ZombieBeggars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb
AND
DB_LOW_PhilgravesMansion_BasementDropZombies(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_SetRelationToPlayers(ACT3_LOW_PhilgravesMansion_FatherCarrionUpperFloor_1d746532-eee0-4ea7-a7fa-09fbddb84f94, 0);
PROC_SetRelationToPlayers(ACT3_LOW_PhilgravesMansion_FatherCarrion_6ee4b3ed-b298-4388-ab59-e999f4d2a504, 0);
SetFlag(LOW_PhilgravesMansion_State_CarrionWantingToBoastAboutBeggars_b43b44c8-2a8e-4aef-ad47-9e79cda37617);
PROC_SetOnStage(_Var1, 1);
Die(_Var1, 0, 0);
TeleportTo(_Var1, _Var2, "", 0, 0, 0, 0, 1);

PROC
PROC_LOW_PhilgravesMansion_GetZombiesBack()
AND
DB_LOW_PhilgravesMansion_ZombieBeggars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_LOW_PhilgravesMansion_ZombieHasJar(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_LOW_PhilgravesMansion_GetZombiesBack()
THEN
TeleportTo(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, S_LOW_ThrumboLocation_a1f7a6d1-d3af-4fcd-a69c-7d6812ba2c50);

PROC
PROC_LOW_PhilgravesMansion_GetZombiesBack()
THEN
PROC_SetOnStage(S_LOW_ThrumboDeadWarningCleaver_6e254dae-1454-4885-acd9-26bd917a9cc0, 1);
PROC_SetOnStage(S_LOW_ThrumboDeadWarning_113c6cee-50d1-41f0-bedb-ebd759f2828c, 1);
SetFlag(LOW_PhilgravesMansion_State_CarrionKilledThrumbo_6dae544d-10d8-45d0-b2c9-af51e59c0a8e);
DB_SeenDeadNPCGlobalFlag(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, LOW_PhilgravesMansion_SeenThrumboExploded_8e2a4753-5fb7-4132-8db5-fde42ce4c96f);
Die(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, 0, 0);

QRY
QRY_LOW_PhilgravesMansion_ZombieHasJar((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PhilgravesMansion_JarBasementLocation(_Var2, _Var3, _Var1, _Var1, _Var1)
AND
GetOwner(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
SetGravity(_Var2, 0);
TeleportTo(_Var2, _Var3, "", 0, 0, 0, 0, 0);

PROC
PROC_LOW_PhilgravesMansion_GetZombiesBack()
AND
DB_LOW_PhilgravesMansion_ZombieBeggars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
IsOnStage(_Var1, 0, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var1, 1);

QRY
QRY_LOW_PhilgravesMansion_ZombieHasHeart()
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_JarsInBodiesDiscovered_3b3d84a4-7b4f-4c9b-a669-95ba915a603d, _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_LOW_PhilgravesMansion_ZombieHasHeart()
AND
DB_LOW_PhilgravesMansion_JarContainer(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_ZombieBeggars(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_LongRest()
AND
DB_Defeated(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_FatherCarrion_State_IsFullyDead_683c08ad-358d-400f-8dc8-c1a93f31dcac, _, _, _, _)
THEN
PROC_CharacterFullRestore(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e);
NOT DB_PhilgravesMansion_AngryCarrionHasTalked(1);
TeleportTo(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, S_LOW_FatherCarrionTeleportTo_5681db68-1e7c-4f82-8a07-e62a33ce17ea);
PROC_PhilgravesMansion_SendJarsFromHeartContainer();
PROC_PhilgravesMansion_SendJarToBasement(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492);
ClearFlag(LOW_FatherCarrion_State_IsTempDefeated_56356b1f-9ddc-4d34-a22b-3b92dc2b6e8b);

PROC
PROC_LOW_PhilgravesMansion_InitJars()
AND
DB_LOW_PhilgravesMansion_Jars(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_GLO_DefeatCounter(_Var1, "LOW_PhilgravesMansion_Jars");

IF
DialogEnded(LOW_PhilgravesMansion_AngryFatherCarrion_f1c37076-434c-a441-d6ec-0f0827f97ed2, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_PhilgravesMansion_RevealStartCombatLower();
PROC_PhilgravesMansion_RevealStartCombatUpper();

QRY
QRY_CarrionShouldStartAngryDialog()
AND
DB_GlobalFlag(LOW_FatherCarrion_State_HasBeenKilled_34a30ab8-c0e4-44a1-b2b4-31a5cc65bcea, _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_CarrionShouldStartAngryDialog()
AND
DB_GlobalFlag(LOW_PhilgravesMansion_State_DestroyedNonHeartJar_0b8a48a7-b093-4ac2-a4b1-502e9b5dad31, _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_CarrionShouldStartAngryDialog()
AND
DB_GlobalFlag(LOW_PhilgravesMansion_State_HeartIsDestroyed_fcf8164a-742d-4ef4-af61-3773d8891a44, _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_CarrionShouldStartAngryDialog()
AND
DB_GlobalFlag(LOW_PhilgravesMansion_State_CarrionWantingToBoastAboutBeggars_b43b44c8-2a8e-4aef-ad47-9e79cda37617, _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_CarrionShouldStartAngryDialog()
AND
DB_GlobalFlag(LOW_FatherCarrion_State_IsIndebtedToPlayers_b2e22b4d-f88a-437a-b893-1f20e3e5ebf9, _, _, _, _)
AND
DB_GlobalFlag(LOW_PhilgravesMansion_State_HasHeart_22154967-9777-4149-bbae-216409fea025, _, _, _, _)
THEN
DB_NOOP(1);

IF
DB_Is_InCombat(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PhilgravesMansion_AngryCarrionHasTalked(1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_CarrionShouldStartAngryDialog()
AND
CombatGetInvolvedPlayersCount(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
_Var2 > 0
AND
QRY_LOW_PhilgravesMansion_CarrionFindAvatarToTalk(1, _Var1, _Var1, _Var1, _Var1)
AND
DB_QRYRTN_LOW_PhilgravesMansion_CarrionFindAvatarToTalk(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(LOW_PhilgravesMansion_AngryFatherCarrion_f1c37076-434c-a441-d6ec-0f0827f97ed2, S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _Var3, 0, 0, 0, 1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_StartDialog_AddExtraSpeakers(LOW_PhilgravesMansion_AngryFatherCarrion_f1c37076-434c-a441-d6ec-0f0827f97ed2, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_DialogRequestCache_SpeakerList_Players(LOW_PhilgravesMansion_AngryFatherCarrion_f1c37076-434c-a441-d6ec-0f0827f97ed2, _Var1, _Var2, 1, _Var1)
AND
DB_Is_InCombat(_Var2, _Var3, _Var1, _Var1, _Var1)
AND
DB_Players(_Var4, _Var1, _Var1, _Var1, _Var1)
AND
_Var2 != _Var4
AND
DB_Is_InCombat(_Var4, _Var3, _Var1, _Var1, _Var1)
AND NOT
DB_DialogRequestCache_SpeakerList_Players(LOW_PhilgravesMansion_AngryFatherCarrion_f1c37076-434c-a441-d6ec-0f0827f97ed2, _Var1, _Var4, _, _Var1)
THEN
PROC_DialogAddListeningActor(_Var1, _Var4);

IF
DialogStarted(LOW_PhilgravesMansion_AngryFatherCarrion_f1c37076-434c-a441-d6ec-0f0827f97ed2, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
DB_PhilgravesMansion_AngryCarrionHasTalked(1);

IF
DialogStarted(LOW_PhilgravesMansion_AngryFatherCarrion_f1c37076-434c-a441-d6ec-0f0827f97ed2, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_IdentifiedCarrionAsMummyLord_a6769dc6-e746-40be-95f2-321c2ec9b182, _, _, _, _)
THEN
SetFlag(LOW_PhilgravesMansion_State_IdentifiedCarrionAsMummyLord_a6769dc6-e746-40be-95f2-321c2ec9b182);

QRY
QRY_LOW_PhilgravesMansion_CarrionFindAvatarToTalk(_, _, _, _, _)
AND
DB_QRYRTN_LOW_PhilgravesMansion_CarrionFindAvatarToTalk(_Var2, _, _, _, _)
THEN
NOT DB_QRYRTN_LOW_PhilgravesMansion_CarrionFindAvatarToTalk(_Var2);

QRY
QRY_LOW_PhilgravesMansion_CarrionFindAvatarToTalk(0, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_QRYRTN_LOW_PhilgravesMansion_CarrionFindAvatarToTalk(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_SpeakerIsAvailable(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
CanSee(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _Var1, 1, _Var1, _Var1)
THEN
DB_QRYRTN_LOW_PhilgravesMansion_CarrionFindAvatarToTalk(_Var1);

QRY
QRY_LOW_PhilgravesMansion_CarrionFindAvatarToTalk(1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_QRYRTN_LOW_PhilgravesMansion_CarrionFindAvatarToTalk(_, _Var1, _Var1, _Var1, _Var1)
AND
CanSee(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _Var1, 1, _Var1, _Var1)
THEN
DB_QRYRTN_LOW_PhilgravesMansion_CarrionFindAvatarToTalk(_Var1);

QRY
QRY_LOW_PhilgravesMansion_DestroyedJarOrMetParty()
AND
DB_GlobalFlag(LOW_FatherCarrion_HasMetParty_7ef170f0-4a35-48b4-a0b8-34340d5b5fba, _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_LOW_PhilgravesMansion_DestroyedJarOrMetParty()
AND
DB_GlobalFlag(LOW_FatherCarrion_Event_DetectedDestroyedJar_5e62e951-554d-40bb-b743-a69488cafdd0, _, _, _, _)
THEN
DB_NOOP(1);

IF
DB_Dead(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_FatherCarrion_State_HasBeenKilled_34a30ab8-c0e4-44a1-b2b4-31a5cc65bcea, _, _, _, _)
THEN
SetFlag(LOW_FatherCarrion_State_HasBeenKilled_34a30ab8-c0e4-44a1-b2b4-31a5cc65bcea);

IF
DB_Defeated(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _, _, _, _)
THEN
SetFlag(LOW_FatherCarrion_State_IsTempDefeated_56356b1f-9ddc-4d34-a22b-3b92dc2b6e8b);
PROC_SetRelationToPlayers(ACT3_LOW_PhilgravesMansion_FatherCarrionUpperFloor_1d746532-eee0-4ea7-a7fa-09fbddb84f94, 0);
PROC_SetRelationToPlayers(ACT3_LOW_PhilgravesMansion_FatherCarrion_6ee4b3ed-b298-4388-ab59-e999f4d2a504, 0);

IF
DB_PermaDefeated(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _, _, _, _)
AND
DB_GlobalFlag(LOW_Philgraves_State_HeartIsDestroyed_fcf8164a-742d-4ef4-af61-3773d8891a44, _, _, _, _)
THEN
SetFlag(LOW_FatherCarrion_State_IsFullyDead_683c08ad-358d-400f-8dc8-c1a93f31dcac);

IF
DestroyedBy(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492, _, _, _, (CHARACTER)_)
THEN
SetFlag(LOW_Philgraves_State_HeartIsDestroyed_fcf8164a-742d-4ef4-af61-3773d8891a44);
NOT DB_PreventPermaDefeated(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e);

IF
DestroyedBy(S_LOW_UNI_CarrionJar_Heart_13d8bafe-6614-4ae8-be27-2e1e1d294492, _, _, _, _)
AND
DB_Dead(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _, _, _, _)
THEN
SetFlag(LOW_FatherCarrion_State_IsFullyDead_683c08ad-358d-400f-8dc8-c1a93f31dcac);

IF
UseStarted((CHARACTER)_Var1, S_LOW_BeggarsPortrait_9e5d743a-f00e-4d5c-93ff-272b9a895c15, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_DisarmedPortrait_086174ca-6f10-4d8c-a149-007671cc9240, _Var1, _Var1, _Var1, _Var1)
THEN
RequestActiveRoll(_Var1, S_LOW_BeggarsPortrait_9e5d743a-f00e-4d5c-93ff-272b9a895c15, "Arcana", DC_Legacy_15_bddbb9b8-a242-4c3e-a2eb-3fd274c0c539, "LOW_PhilgravesMansion_BeggarsPortrait");

PROC
PROC_RollResult("LOW_PhilgravesMansion_BeggarsPortrait", (CHARACTER)_Var1, _, 1, (CHARACTER)_Var1)
THEN
SetFlag(LOW_PhilgravesMansion_State_DisarmedPortrait_086174ca-6f10-4d8c-a149-007671cc9240);
PROC_SetOnStage(S_LOW_NoteFromThrumbo_c1fb827d-eb8c-4898-8d3b-32281695a682, 1);
ToInventory(S_LOW_NoteFromThrumbo_c1fb827d-eb8c-4898-8d3b-32281695a682, _Var1, 1, 1, 1);

IF
GameBookInterfaceClosed(S_LOW_NoteFromThrumbo_c1fb827d-eb8c-4898-8d3b-32281695a682, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_ReadThrumboNote", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(LOW_PhilgravesMansion_PAD_PortraitLetter_94a8c42b-9322-65cb-f7e9-6efa2b29162b, _Var1);
SetFlag(LOW_PhilgravesMansion_State_ReadThrumboNote_2e0a5f21-a80c-4e6b-852b-dad97ac47f19);

PROC
PROC_RollResult("LOW_PhilgravesMansion_BeggarsPortrait", (CHARACTER)_Var1, (GUIDSTRING)_Var2, 0, (CHARACTER)_Var1)
THEN
CreateSurface(S_LOW_BeggarsPortrait_9e5d743a-f00e-4d5c-93ff-272b9a895c15, "SurfaceDarknessCloud", 9, 16, _Var1);
PROC_LOW_ApplyMaddeningDarkness();

PROC
PROC_LOW_ApplyMaddeningDarkness()
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetDistanceTo(_Var1, S_LOW_BeggarsPortrait_9e5d743a-f00e-4d5c-93ff-272b9a895c15, _Var2, _Var1, _Var1)
AND
_Var2 <= 9
THEN
RequestPassiveRoll(_Var1, S_LOW_BeggarsPortrait_9e5d743a-f00e-4d5c-93ff-272b9a895c15, "SavingThrow", "Wisdom", DC_Legacy_15_625be976-7a67-4394-97c8-14c69715ae4b, 0, "LOW_MaddeningDarkness");

PROC
PROC_RollResult("LOW_MaddeningDarkness", (CHARACTER)_Var1, _, 1, (CHARACTER)_Var1)
AND
Random(28, _Var3, _Var1, _Var1, _Var1)
AND
IntegerSum(_Var3, 4, _Var4, _Var1, _Var1)
THEN
ApplyDamage(_Var1, _Var4, "Psychic", S_LOW_BeggarsPortrait_9e5d743a-f00e-4d5c-93ff-272b9a895c15);

PROC
PROC_RollResult("LOW_MaddeningDarkness", (CHARACTER)_Var1, _, 0, (CHARACTER)_Var1)
AND
Random(56, _Var3, _Var1, _Var1, _Var1)
AND
IntegerSum(_Var3, 8, _Var4, _Var1, _Var1)
THEN
ApplyDamage(_Var1, _Var4, "Psychic", S_LOW_BeggarsPortrait_9e5d743a-f00e-4d5c-93ff-272b9a895c15);

IF
UseFinished((CHARACTER)_Var1, S_LOW_CarrionJarDiagrams_c8a2228a-adff-4fcd-b60a-81f81c033e2f, 1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_ReadFirstTimeCarrionDiagrams", _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(LOW_PhilgravesMansion_Quest_ReadJarDiagrams_9d307fd4-e5e3-430c-b617-2d208d5e1053);
SetFlag(LOW_PhilgravesMansion_State_JarsInBodiesDiscovered_3b3d84a4-7b4f-4c9b-a669-95ba915a603d);
PROC_TryStartAD(LOW_PhilgravesMansion_PAD_DiscoveredMummyLordResearch_ba106cdb-0223-7e89-062d-c536d2dc9d72, _Var1);

IF
DB_PerceptionSkillCheck(_Var1, S_LOW_PhilgravesBasementGuardedDoor_717a919a-e1e0-4ca3-b2da-eac784afae00, 1, _Var1, _Var1)
THEN
DB_LOW_PhilgravesMansion_RevealedAlarm(1);
ApplyStatus(S_LOW_PhilgravesBasementGuardedDoor_717a919a-e1e0-4ca3-b2da-eac784afae00, "LOW_PHILGRAVESMANSION_ALARM", -1, 1);

IF
RequestCanUse((CHARACTER)_Var1, S_LOW_PhilgravesBasementGuardedDoor_717a919a-e1e0-4ca3-b2da-eac784afae00, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_LOW_PhilgravesMansion_RevealedAlarm(1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_PhilgravesMansion_AlertTrigger();
PROC_LOW_PhilgravesMansion_EnemiesDetectingAlarm();

IF
RequestCanUse((CHARACTER)_Var1, S_LOW_PhilgravesBasementGuardedDoor_717a919a-e1e0-4ca3-b2da-eac784afae00, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_AlarmSpellRemoved_e947c865-923d-485d-96da-4589403b7f5c, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_RevealedAlarm(1, _Var1, _Var1, _Var1, _Var1)
THEN
RequestActiveRoll(_Var1, S_LOW_PhilgravesBasementGuardedDoor_717a919a-e1e0-4ca3-b2da-eac784afae00, "Arcana", Act3_Medium_77cee1c4-384a-4217-b670-67db3c7add57, "LOW_PhilgravesMansion_WorkshopDoorDisarm");

PROC
PROC_LOW_PhilgravesMansion_EnemiesDetectingAlarm()
THEN
SetFlag(LOW_PhilgravesMansion_Event_ReactToAlarm_5f888172-7806-47c4-bdfe-dd5631a670d2);
PROC_PhilgravesMansion_RevealStartCombatLower();
PROC_PhilgravesMansion_RevealStartCombatUpper();

PROC
PROC_RollResult("LOW_PhilgravesMansion_WorkshopDoorDisarm", (CHARACTER)_Var1, _, 1, (CHARACTER)_Var1)
THEN
SetFlag(LOW_PhilgravesMansion_State_AlarmSpellRemoved_e947c865-923d-485d-96da-4589403b7f5c);
RemoveStatus(S_LOW_PhilgravesBasementGuardedDoor_717a919a-e1e0-4ca3-b2da-eac784afae00, "LOW_PHILGRAVESMANSION_ALARM");
PROC_TryStartAD(LOW_PhilgravesMansion_PAD_AlarmDoorDispeled_a2cec61e-8761-1309-4d97-3c79c5b173dc, _Var1);

PROC
PROC_RollResult("LOW_PhilgravesMansion_WorkshopDoorDisarm", (CHARACTER)_Var1, _, 0, (CHARACTER)_Var1)
THEN
PROC_LOW_PhilgravesMansion_AlertTrigger();
PROC_LOW_PhilgravesMansion_EnemiesDetectingAlarm();

IF
AttackedBy(S_LOW_PhilgravesBasementGuardedDoor_717a919a-e1e0-4ca3-b2da-eac784afae00, (GUIDSTRING)_Var1, _, _, _, _, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_AlarmSpellRemoved_e947c865-923d-485d-96da-4589403b7f5c, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_PhilgravesMansion_AlertTrigger();
PROC_LOW_PhilgravesMansion_EnemiesDetectingAlarm();

QRY
QRY_CRIME_BlockRegisterCrime((CHARACTER)_Var1, "UseForbiddenItem", S_LOW_PhilgravesBasementGuardedDoor_717a919a-e1e0-4ca3-b2da-eac784afae00, (CHARACTER)_Var2, (INTEGER)_Var3)
AND
DB_Sees(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("LOW_Philgraves_GetHostileWithPeople", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_PhilgravesMansion_EnemiesDetectingAlarm();

PROC
PROC_LOW_PhilgravesMansion_AlertTrigger()
AND
QRY_OnlyOnce("LOW_PhilgravesMansion_Alarm", _, _, _, _)
THEN
PROC_TryStartAD(LOW_PhilgravesMansion_AlarmDoor_AD_14abcf8d-febd-fe93-4da8-cbe78b46ad05, S_LOW_PhilgravesBasementGuardedDoor_717a919a-e1e0-4ca3-b2da-eac784afae00);

PROC
PROC_LOW_PhilgravesMansion_AlertTrigger()
AND
HasActiveStatus(S_LOW_PhilgravesBasementGuardedDoor_717a919a-e1e0-4ca3-b2da-eac784afae00, "LOW_PHILGRAVESMANSION_ALARM", 0, _, _)
THEN
ApplyStatus(S_LOW_PhilgravesBasementGuardedDoor_717a919a-e1e0-4ca3-b2da-eac784afae00, "LOW_PHILGRAVESMANSION_ALARM", -1, 1);

IF
EnteredTrigger((CHARACTER)_Var1, S_LOW_PhilgravesLarderTrigger_362d5da1-7b69-485e-a7a6-65e5277dc9dd, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_TryStartAD(LOW_PhilgravesMansion_PAD_EnteredLarder_e2c0362a-fb62-4e91-2540-d6425bb12740, _Var1);

IF
FlagSet(LOW_Thrumbo_State_IsDead_21e2f143-abef-45fa-a29c-6eb91491b9ec, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_State_CarrionKilledThrumbo_6dae544d-10d8-45d0-b2c9-af51e59c0a8e, _, _, _, _)
AND
DB_GlobalFlag(LOW_FatherCarrion_State_ExplainedTask_f77ed6af-3076-43da-9a68-1d83edf9068d, _, _, _, _)
THEN
QuestUpdate("LOW_PhilgravesMansion", "Thrumbo_PlayerKilled");

IF
DB_Dead(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_Philgraves_State_HeartIsDestroyed_fcf8164a-742d-4ef4-af61-3773d8891a44, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_Quest_ThrumboToldAboutCarrionResurrecting_77ba2f6a-05a5-4ac7-9946-cbe8a4863e64, _, _, _, _)
AND NOT
QRY_QuestUpdateIsUnlockedForAny("LOW_PhilgravesMansion", "Carrion_Killed", _, _, _)
THEN
QuestUpdate("LOW_PhilgravesMansion", "Carrion_Killed");

IF
DB_Dead(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _, _, _, _)
AND
QRY_LOW_PhilgravesMansion_ThrumboHasHeartAndIsAlive()
AND
DB_GlobalFlag(LOW_PhilgravesMansion_Quest_ThrumboToldAboutCarrionResurrecting_77ba2f6a-05a5-4ac7-9946-cbe8a4863e64, _, _, _, _)
AND NOT
QRY_QuestUpdateIsUnlockedForAny("LOW_PhilgravesMansion", "Carrion_KilledKnowsWillResurrect_ThrumboAliveWithJar", _, _, _)
AND NOT
QRY_QuestUpdateIsUnlockedForAny("LOW_PhilgravesMansion", "Carrion_KilledKnowsWillResurrect_ThrumboDeadOrNoJar", _, _, _)
THEN
QuestUpdate("LOW_PhilgravesMansion", "Carrion_KilledKnowsWillResurrect_ThrumboAliveWithJar");

IF
DB_Dead(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _, _, _, _)
AND NOT
QRY_LOW_PhilgravesMansion_ThrumboHasHeartAndIsAlive()
AND
DB_GlobalFlag(LOW_PhilgravesMansion_Quest_ThrumboToldAboutCarrionResurrecting_77ba2f6a-05a5-4ac7-9946-cbe8a4863e64, _, _, _, _)
AND NOT
QRY_QuestUpdateIsUnlockedForAny("LOW_PhilgravesMansion", "Carrion_KilledKnowsWillResurrect_ThrumboDeadOrNoJar", _, _, _)
AND NOT
QRY_QuestUpdateIsUnlockedForAny("LOW_PhilgravesMansion", "Carrion_KilledKnowsWillResurrect_ThrumboAliveWithJar", _, _, _)
THEN
QuestUpdate("LOW_PhilgravesMansion", "Carrion_KilledKnowsWillResurrect_ThrumboDeadOrNoJar");

QRY
QRY_LOW_PhilgravesMansion_ThrumboHasHeartAndIsAlive()
AND
DB_GlobalFlag(LOW_PhilgravesMansion_State_HeartInThrumbosInventory_46beba15-84e7-47ac-bc46-922cf0345b1a, _, _, _, _)
AND NOT
DB_Dead(S_LOW_Thrumbo_c20c1d4e-eea9-473b-b26e-abe5973ba0eb, _, _, _, _)
THEN
DB_NOOP(1);

IF
FlagSet(LOW_PhilgravesMansion_SeenThrumboExploded_8e2a4753-5fb7-4132-8db5-fde42ce4c96f, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(LOW_PhilgravesMansion_Quest_ThrumboToldAboutCarrionResurrecting_77ba2f6a-05a5-4ac7-9946-cbe8a4863e64, _Var1, _Var1, _Var1, _Var1)
THEN
QuestUpdate("LOW_PhilgravesMansion", "Thrumbo_FoundDead_MetHim");

IF
FlagSet(LOW_PhilgravesMansion_SeenThrumboExploded_8e2a4753-5fb7-4132-8db5-fde42ce4c96f, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(LOW_FatherCarrion_State_ExplainedTask_f77ed6af-3076-43da-9a68-1d83edf9068d, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_Quest_ThrumboToldAboutCarrionResurrecting_77ba2f6a-05a5-4ac7-9946-cbe8a4863e64, _Var1, _Var1, _Var1, _Var1)
THEN
QuestUpdate("LOW_PhilgravesMansion", "ThrumboFoundDead_NotMetHim_Explained");

IF
GameBookInterfaceClosed(S_LOW_ThrumboDeadWarning_113c6cee-50d1-41f0-bedb-ebd759f2828c, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_GlobalFlag(LOW_FatherCarrion_State_ExplainedTask_f77ed6af-3076-43da-9a68-1d83edf9068d, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(LOW_PhilgravesMansion_Quest_ThrumboToldAboutCarrionResurrecting_77ba2f6a-05a5-4ac7-9946-cbe8a4863e64, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_QuestUpdateIsUnlockedForAny("LOW_PhilgravesMansion", "ThrumboFoundDead_NotMetHim_NotExplained", _Var1, _Var1, _Var1)
THEN
QuestUpdate("LOW_PhilgravesMansion", "ThrumboFoundDead_NotMetHim_NotExplained");

IF
FlagSet(LOW_PhilgravesMansion_State_HeartIsDestroyed_fcf8164a-742d-4ef4-af61-3773d8891a44, _, _, _, _)
AND
QRY_LOW_PhilgravesMansion_PlayersKnowHeartStopsResurrection()
THEN
QuestUpdate("LOW_PhilgravesMansion", "HeartDestroyed_Parent");

IF
FlagSet(LOW_PhilgravesMansion_State_HeartIsDestroyed_fcf8164a-742d-4ef4-af61-3773d8891a44, _, _, _, _)
AND
QRY_LOW_PhilgravesMansion_PlayersKnowHeartStopsResurrection()
THEN
QuestUpdate("LOW_PhilgravesMansion", "HeartDestroyed");

QRY
QRY_LOW_PhilgravesMansion_PlayersKnowHeartStopsResurrection()
AND
DB_GlobalFlag(LOW_PhilgravesMansion_Quest_ThrumboToldAboutCarrionResurrecting_77ba2f6a-05a5-4ac7-9946-cbe8a4863e64, _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_LOW_PhilgravesMansion_PlayersKnowHeartStopsResurrection()
AND
DB_GlobalFlag(LOW_PhilgravesMansion_State_JarsInBodiesDiscovered_3b3d84a4-7b4f-4c9b-a669-95ba915a603d, _, _, _, _)
THEN
DB_NOOP(1);

IF
Resurrected(S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _, _, _, _)
AND
DB_OnlyOnce("LOW_PhilgravesMansion_FirstCarrionResurrection", _, _, _, _)
THEN
DB_LOW_PhilgravesMansion_ReadyToReactWhenSeenCarrion(1);

IF
DB_Sees(_Var1, S_LOW_FatherCarrion_b003409c-364f-4065-94bf-7436001d890e, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_PhilgravesMansion_ReadyToReactWhenSeenCarrion(1, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_QuestUpdateIsUnlockedForAny("LOW_PhilgravesMansion", "Carrion_FoundAliveAfterDeath", _Var1, _Var1, _Var1)
THEN
QuestUpdate("LOW_PhilgravesMansion", "Carrion_FoundAliveAfterDeath");

PROC
PROC_OneShotTriggerEntered(_, S_LOW_PhilgravesMansion_BasementRegionTrigger_17a71a2b-98b2-470d-bb7b-f8cfeda2d4dc, (CHARACTER)_, (CHARACTER)_, (CHARACTER)_)
THEN
QuestUpdate("LOW_PhilgravesMansion", "ReachedBasement");

PROC
PROC_OneShotTriggerEntered(_, S_LOW_PhilgravesMansion_AncientLairRegion_ec10580c-2e07-4eb1-8465-a648183ccaea, (CHARACTER)_, (CHARACTER)_, (CHARACTER)_)
THEN
QuestUpdate("LOW_PhilgravesMansion", "AncientLair_Explore");

IF
FlagSet(LOW_PhilgravesMansion_State_HasHeart_22154967-9777-4149-bbae-216409fea025, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_QuestUpdateIsUnlockedForAny("LOW_PhilgravesMansion", "LootedHeart", _Var1, _Var1, _Var1)
THEN
QuestUpdate("LOW_PhilgravesMansion", "LootedHeart");


EXITSECTION
ENDEXITSECTION

ParentTargetEdge "Act3b"
