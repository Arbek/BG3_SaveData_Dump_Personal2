Version 1
SubGoalCombiner SGC_AND

INITSECTION
DB_OriginInPartyDialog(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, CAMP_OwlbearCub_b040f859-255a-f8aa-fba7-3e31a1b8c641);
DB_CampNight(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, 1040);
DB_CampNight_Camp(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, "WLDMAIN");
DB_CampNight_Camp(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, "WLDDUNABB");
DB_CampNight_Camp(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, "WLDBAS");
DB_CampNight_Camp(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, "WLDCAVGRN");
DB_CampNight_Camp(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, "WLDDUNSHA");
DB_CampNight_Camp(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, "WLDCAVSND");
DB_CampNight_Camp(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, "WLDUND");
DB_CampNight_Camp(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, "CREMAIN");
DB_CampNight_Camp(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, "CREINSIDE");
DB_CampNight_Camp(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, "SCLMAIN");
DB_CampNight_Camp(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, "HAVEN");
DB_CampNight_Camp(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, "SHARTEMPLE");
DB_CampNight_Camp(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, "MOONRISE");
DB_CampNight_Requirement(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, GOB_ChickenChase_State_OwlbearAcquired_da704027-02ea-717c-4390-f538e5e5cd7a);
DB_CampNight_SCO(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, CAMP_OwlbearCub_CRD_1_b8d1c425-089c-d04d-b63f-40cc99b1c747);
DB_CampNight_CancelledBy(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, GLO_OwlbearCub_State_PermaDefeated_e407829a-d8ff-4759-9dbc-89f2b2f33151);
DB_CampNight(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, 1030);
DB_CampNight_Camp(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, "WLDMAIN");
DB_CampNight_Camp(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, "WLDDUNABB");
DB_CampNight_Camp(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, "WLDBAS");
DB_CampNight_Camp(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, "WLDCAVGRN");
DB_CampNight_Camp(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, "WLDDUNSHA");
DB_CampNight_Camp(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, "WLDCAVSND");
DB_CampNight_Camp(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, "WLDUND");
DB_CampNight_Camp(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, "CREMAIN");
DB_CampNight_Camp(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, "CREINSIDE");
DB_CampNight_Camp(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, "SCLMAIN");
DB_CampNight_Camp(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, "HAVEN");
DB_CampNight_Camp(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, "SHARTEMPLE");
DB_CampNight_Camp(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, "MOONRISE");
DB_CampNight_Requirement(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4);
DB_CampNight_SCO(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, CAMP_OwlbearCub_CRD_2_aaccfa43-76c2-b9b2-1415-1377def80251);
DB_CampNight_CancelledBy(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, CAMP_OwlbearCub_Event_Fight_036f6f5f-b2a2-52b1-8229-e5ce6da0c676);
DB_CampNight_CancelledBy(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, GLO_OwlbearCub_State_PermaDefeated_e407829a-d8ff-4759-9dbc-89f2b2f33151);
DB_CampNight(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, 1010);
DB_CampNight_Camp(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, "WLDMAIN");
DB_CampNight_Camp(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, "WLDDUNABB");
DB_CampNight_Camp(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, "WLDBAS");
DB_CampNight_Camp(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, "WLDCAVGRN");
DB_CampNight_Camp(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, "WLDDUNSHA");
DB_CampNight_Camp(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, "WLDCAVSND");
DB_CampNight_Camp(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, "WLDUND");
DB_CampNight_Camp(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, "CREMAIN");
DB_CampNight_Camp(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, "CREINSIDE");
DB_CampNight_Camp(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, "SCLMAIN");
DB_CampNight_Camp(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, "HAVEN");
DB_CampNight_Camp(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, "SHARTEMPLE");
DB_CampNight_Camp(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, "MOONRISE");
DB_CampNight_Requirement(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, COURIERDOG_9a7eacd5-a43f-4258-a07f-d55725fa20f2, CAMP_OwlbearCub_State_BecameCampFollower_a9742288-21b5-428a-9efa-a2e73981c02f);
DB_CampNight_SCO(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, CAMP_OwlbearCub_CFM_Dog_547dc3a3-f899-bc24-cb8e-43af4c721197);
DB_CampNight_CancelledBy(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, CAMP_OwlbearCub_Event_Fight_036f6f5f-b2a2-52b1-8229-e5ce6da0c676);
DB_CampNight_CancelledBy(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, GLO_OwlbearCub_State_PermaDefeated_e407829a-d8ff-4759-9dbc-89f2b2f33151);
DB_CampNight_CancelledBy(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, GLO_CourierDog_State_IsPermaDefeated_4d17c54b-9507-4948-bbcc-0fe307f79f0b);
DB_GLO_OwlbearCub_CampNights(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4, CAMP_OwlbearCub_CRD_1_b8d1c425-089c-d04d-b63f-40cc99b1c747);
DB_GLO_OwlbearCub_CampNights(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, CAMP_OwlbearCub_CRD_2_aaccfa43-76c2-b9b2-1415-1377def80251);
DB_GLO_OwlbearCub_CampNights(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, CAMP_OwlbearCub_CFM_Dog_547dc3a3-f899-bc24-cb8e-43af4c721197);

KBSECTION
PROC
PROC_CampNight_StartSleepMoments_PreHook()
AND NOT
DB_Camp_QueuedNight(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, _, _, _, _)
AND
DB_Camp_QueuedNight(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_CampNight_Completed(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GLO_OwlbearCub_CampNights(_Var1, _, _Var1, _Var1, _Var1)
AND
DB_ActiveCamp(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
DB_Camp(_Var3, _, _, _Var6, _Var1)
THEN
TeleportTo(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, _Var6);
PROC_SetOnStage(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, 1);

PROC
PROC_CampNight_StartSleepMoments_PreHook()
AND
DB_Camp_QueuedNight(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, _, _, _, _)
THEN
TeleportTo(S_FOR_Courier_Dog_3059f69c-068d-4e28-8491-55953c027901, S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09);
PROC_SetOnStage(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, 1);
PROC_SetOnStage(S_FOR_Courier_Dog_3059f69c-068d-4e28-8491-55953c027901, 1);

QRY
QRY_Camp_SleepCutsceneOverride_CustomDialogStart((DIALOGRESOURCE)_Var1, (CHARACTER)_Var2, (CHARACTER)_Var3, (CHARACTER)_Var4, (CHARACTER)_Var5)
AND NOT
DB_Camp_QueuedNight(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, _Var1, _Var1, _Var1, _Var1)
AND
DB_Camp_QueuedNight(_Var6, _Var1, _Var1, _Var1, _Var1)
AND
DB_GLO_OwlbearCub_CampNights(_Var6, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialog_Fixed(_Var1, S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, _Var2, _Var3, _Var4, _Var5, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_Camp_SleepCutsceneOverride_CustomDialogStart(CAMP_OwlbearCub_CFM_Dog_547dc3a3-f899-bc24-cb8e-43af4c721197, (CHARACTER)_Var1, (CHARACTER)_Var2, (CHARACTER)_Var3, (CHARACTER)_Var4)
AND
QRY_StartDialog_Fixed(CAMP_OwlbearCub_CFM_Dog_547dc3a3-f899-bc24-cb8e-43af4c721197, S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, S_FOR_Courier_Dog_3059f69c-068d-4e28-8491-55953c027901, _Var1, _Var2, _Var3, _Var4, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_Camp_SleepCutsceneOverride_CustomDialogStart((DIALOGRESOURCE)_Var1, (CHARACTER)_Var2, (CHARACTER)_Var3, (CHARACTER)_Var4, (CHARACTER)_Var5)
AND
DB_GLO_OwlbearCub_CampNights(_Var6, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
FlagSet(CAMP_OwlbearCub_Event_Fight_036f6f5f-b2a2-52b1-8229-e5ce6da0c676, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
DB_Camp_PreventEndOfNight(1);

IF
FlagSet(CAMP_OwlbearCub_State_BecameCampFollower_a9742288-21b5-428a-9efa-a2e73981c02f, _, _, _, _)
AND
DB_Camp_QueuedNight(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, _, _, _, _)
THEN
DB_Dialogs(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, CAMP_OwlbearCub_CRD_2_aaccfa43-76c2-b9b2-1415-1377def80251);
DB_Camp_PreventEndOfNight(1);

IF
FlagSet(CAMP_OwlbearCub_Event_Feed_b1f8123f-5049-b3aa-0e30-9f288d98fd1b, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
MagicPocketsDestroyLocalItemsByTag(_Var1, "FOOD_c86e0114-a5ab-48f6-b497-de321ebff577", 1);

IF
FlagSet(CAMP_OwlbearCub_Event_PlayersAteFood_09198ba5-ecea-4e13-8d4a-d3fe07abb456, (CHARACTER)_Var1, _, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
MagicPocketsDestroyLocalItemsByTag(_Var1, "FOOD_c86e0114-a5ab-48f6-b497-de321ebff577", 1);

IF
FlagSet(CAMP_OwlbearCub_State_BecameCampFollower_a9742288-21b5-428a-9efa-a2e73981c02f, _, _, _, _)
AND
DB_Players(_Var3, _, _, _, _)
THEN
QuestUpdate(_Var3, "HIDDEN_WLD_Boosters", "CAMP_OwlbearCub_Tamed");

IF
FlagSet(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc, _, _, _, _)
AND
DB_GlobalFlag(CAMP_OwlbearCub_State_BecameCampFollower_a9742288-21b5-428a-9efa-a2e73981c02f, _, _, _, _)
THEN
PROC_ORI_SetupCamp(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, 1);

IF
DialogEnded((DIALOGRESOURCE)_Var1, _, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1, (DIALOGRESOURCE)_Var1)
AND
DB_GLO_OwlbearCub_CampNights(_Var3, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(CAMP_OwlbearCub_State_BecameCampFollower_a9742288-21b5-428a-9efa-a2e73981c02f, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(CAMP_OwlbearCub_Event_Fight_036f6f5f-b2a2-52b1-8229-e5ce6da0c676, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, 0);
TeleportTo(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, S_FOR_OwlbearCub_WanderTrigger_889db7ef-5cd5-4761-a061-69759892c4f5);

IF
EnteredCombat(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GlobalFlag(CAMP_OwlbearCub_Event_Fight_036f6f5f-b2a2-52b1-8229-e5ce6da0c676, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("CAMP_OwlbearCub_CombatStarted_OnlyOnce", _Var1, _Var1, _Var1, _Var1)
THEN
DB_CAMP_OwlbearCub_NightCombat(_Var1);

IF
LeftCombat(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_CAMP_OwlbearCub_NightCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Defeated(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DisappearOutOfSight(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, "Run", 0, "CAMP_OwlbearCub_RanAwayAtNight");

IF
EntityEvent(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, "CAMP_OwlbearCub_RanAwayAtNight", _, _, _)
THEN
TeleportTo(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, S_FOR_OwlbearCub_WanderTrigger_889db7ef-5cd5-4761-a061-69759892c4f5);

IF
DB_Camp_InvisibleCamper(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, _, _, _, _)
AND
DB_GlobalFlag(CAMP_OwlbearCub_Event_Fight_036f6f5f-b2a2-52b1-8229-e5ce6da0c676, _, _, _, _)
THEN
NOT DB_Camp_InvisibleCamper(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09);

PROC
PROC_LongRest()
AND
DB_GlobalFlag(CAMP_OwlbearCubDog_State_NightActive_e092ebb1-f756-4644-b4dc-5bf0c0df3fd7, _, _, _, _)
THEN
ClearFlag(CAMP_OwlbearCubDog_State_NightActive_e092ebb1-f756-4644-b4dc-5bf0c0df3fd7, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_CAMPDEBUG_QueueNight((FLAG)_Var1, (INTEGER)_Var2, (FLAG)_Var1, (FLAG)_Var1, (FLAG)_Var1)
AND
DB_GLO_OwlbearCub_CampNights(_Var1, _, _Var1, _Var1, _Var1)
THEN
DB_OnlyOnce("PROC_FOR_OwlBear_LastCubResolution");
DB_OnlyOnce("FOR_OwlBearCub_LastCubLeaveCombat");
Die(S_WLD_FOR_OwlBear_e903a41f-8ef7-46dc-a847-7d0ec2804d08, 0, 0);
PROC_SetOnStage(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, 0);
PROC_RemoveAllDialogEntriesForSpeaker(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09);
SetFaction(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, ACT1_FOR_OwlbearLastCub_71235128-c21a-4ccf-7552-71824901405c);

PROC
PROC_CAMPDEBUG_QueueNight(NIGHT_OwlbearCubDog_902e10f8-e9d8-4eb6-ac0f-9ad8ba8787ed, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND NOT
DB_PermaDefeated(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(CAMP_OwlbearCub_State_BecameCampFollower_a9742288-21b5-428a-9efa-a2e73981c02f);
PROC_CampNight_ForceComplete(NIGHT_OwlbearCub1_43696ea8-3bff-440d-bee8-9cd912e4e8b4);
PROC_CampNight_ForceComplete(NIGHT_OwlbearCub2_5cc6fbd5-0b70-4fb5-a29c-9b7ed9e39fcc);
PROC_FOR_Courier_Dog_MoveToCamp();
PROC_ORI_SetupCamp(S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09, 1);


EXITSECTION
ENDEXITSECTION

ParentTargetEdge "Start"
