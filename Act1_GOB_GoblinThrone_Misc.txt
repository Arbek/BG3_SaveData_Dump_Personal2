Version 1
SubGoalCombiner SGC_AND

INITSECTION
DB_Dialogs(S_GOB_GoblinBrash_35ffa172-7f23-4452-8f90-5dc24fd3bb6d, GOB_GoblinBrash_3888ab50-ac0f-e5d2-af4b-c79d1501ddf0);
DB_Dialogs(S_GOB_GoblinGlib_f63f921c-ae35-4574-9a70-30aee55fdb26, GOB_GoblinGlib_958a4c31-b39b-25d7-ef65-b386fde7a1bd);
DB_Dialogs(S_GOB_GoblinJolly_59557329-d49b-448b-bdd0-fd66ae0d67f6, GOB_GoblinJolly_7a91d411-de61-12ef-c90c-dc472515593f);
DB_Dialogs(S_GOB_GoblinSulky_dd21e1d9-c426-4b12-b5a0-ef3445e9e967, GOB_GoblinSulky_06cdc854-f3f0-5900-df1e-a02a70a2525f);
DB_Dialogs(S_GOB_GoblinWily_d8667091-dd64-499c-8bee-000cf42175fc, GOB_GoblinWily_788eeb86-4266-1ba4-752a-662ceafebaa4);
DB_Dialogs(S_GOB_GoblinLush_d738c9a4-a031-4dd9-912f-93cda8d8d8b7, GOB_GoblinLush_9aa58339-96d3-3340-6418-ac64421627eb);
DB_Dialogs(S_GOB_RaiderBold_1c9fd1dd-12bc-4b81-acb8-9eef54174c55, GOB_RaiderBold_ab8b00c3-8913-d8d9-9516-a143fede5222);
DB_Dialogs(S_GOB_RaiderHefty_fcbb04a8-f4e6-4065-901c-1a4a708ccd54, GOB_RaiderHefty_854340e2-a57c-4866-e217-c473c7fc2485);
DB_Dialogs(S_GOB_RaiderHardy_6687f78f-5d6a-40d4-8cfd-2b972dacde3c, GOB_RaiderHardy_d8445b34-35ef-72c7-0c58-449798925c99);
SetOnStage(S_GOB_FlamingFistArmor_Cuirass_5a8e958f-08db-4b82-9c1b-4022be9fcc50, 0);
SetOnStage(S_GOB_FlamingFistArmor_Helm_376d4696-1d7b-49b0-afab-320782d7d820, 0);
SetOnStage(S_GOB_FlamingFistArmor_Boots_d07b5845-30e6-4f6f-a30f-4ced29197fdd, 0);
SetOnStage(S_GOB_FlamingFistArmor_Gauntlets_2e9acdbc-17c2-4a4c-b356-69f8d8037407, 0);
DB_Dialogs(S_GOB_GuardTense_97409af2-6e52-4e9d-83df-bd4827ca7992, GOB_GuardTense_c06c6054-8f04-fdab-e527-e34afbc4ac54);
DB_Dialogs(S_GOB_GuardUpset_87e77c4f-1776-4fd9-a70f-3a237388715c, GOB_GuardUpset_23efd46a-1e2d-3e51-80d9-86987b92372f);
DB_Dialogs(S_GOB_GuardPolite_56540e3d-f1ac-441b-a690-5f9602c04b86, GOB_GuardPolite_ba253afd-624a-1d51-4c80-32cac8580bde);
DB_Dialogs(S_GOB_GuardVulgar_a063d18e-d513-4d30-80ea-40a5bffb4bd7, GOB_GuardVulgar_cc5a8421-d93e-ff73-42f2-5e64a425d30b);
DB_Dialogs(S_GOB_InnerCheckpoint_Backup_01_901d33bf-f9bc-4417-a8fb-9765fa992940, GOB_InnerCheckpoint_Backup_01_1a5a0211-9d0e-6698-9541-225ed75f3be8);
DB_Dialogs(S_GOB_InnerCheckpoint_Backup_02_82bd8b76-bb3a-4312-b67a-f4848c2d1f2b, GOB_InnerCheckpoint_Backup_02_07292968-4403-b00e-5677-0c0f3b930ff6);
DB_Dialogs(S_GOB_InnerCheckpoint_Backup_03_919f607e-6595-4b00-a140-a4b5b6dfeda4, GOB_InnerCheckpoint_Backup_03_8cf06f72-c3ae-0a3a-2ca9-9f5f3fbac858);
DB_Dialogs(S_GOB_InnerCheckpoint_Backup_04_acf83de4-e91e-4d60-b959-17123886feba, GOB_InnerCheckpoint_Backup_04_3d23357e-491e-e837-3156-1fc1f6b794ff);
DB_Dialogs(S_GOB_Quartermaster_646936f3-8d8d-484e-9361-cd1ed484c615, GOB_Quartermaster_7c9846aa-5af2-a0c0-0c70-7f6562fe4b1d);
DB_Dialogs(S_GOB_ZhentarimGuard_Caster_4b9818fa-cca6-4bad-b382-4c01334ef22a, GOB_ZhentarimGuard_Caster_01_719e69b7-9e17-a128-d49c-8124c9f568dd);
DB_Dialogs(S_GOB_ZhentarimGuard_Melee_afc5350d-dc9f-4808-b6ce-d7b1bb7c8229, GOB_ZhentarimGuard_Melee_01_6c87aa23-77d5-190a-c43c-a8bad403b3ad);
DB_Dialogs(S_GOB_RaiderStupid_5d049dbe-ff35-45be-88f9-5f999dc0ffe4, DIALOGRESOURCEGUID_GOB_RaiderStupid_6f92efd0-efb7-c0e1-0d4b-089b5d37780a);
DB_Dialogs(S_GOB_RaiderArrogant_43d953fa-575e-452c-b220-939e6bdcc36b, DIALOGRESOURCEGUID_GOB_RaiderArrogant_0638e3d2-a69c-f8ae-0939-6924fc0ab130);
DB_Dialogs(S_GOB_RaiderCunning_abdd3748-0834-46f3-8214-18dd4dca9d40, DIALOGRESOURCEGUID_GOB_RaiderCunning_78ede125-f936-10d9-fbfa-73ee28ec41fd);
DB_GLO_DefeatCounter(S_GOB_RaiderHefty_fcbb04a8-f4e6-4065-901c-1a4a708ccd54, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_RaiderBold_1c9fd1dd-12bc-4b81-acb8-9eef54174c55, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_RaiderHardy_6687f78f-5d6a-40d4-8cfd-2b972dacde3c, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_GoblinLush_d738c9a4-a031-4dd9-912f-93cda8d8d8b7, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_GuardTense_97409af2-6e52-4e9d-83df-bd4827ca7992, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_GuardUpset_87e77c4f-1776-4fd9-a70f-3a237388715c, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_GuardPolite_56540e3d-f1ac-441b-a690-5f9602c04b86, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_GuardVulgar_a063d18e-d513-4d30-80ea-40a5bffb4bd7, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_Quartermaster_646936f3-8d8d-484e-9361-cd1ed484c615, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_ZhentarimGuard_Caster_4b9818fa-cca6-4bad-b382-4c01334ef22a, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_ZhentarimGuard_Melee_afc5350d-dc9f-4808-b6ce-d7b1bb7c8229, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_InnerCheckpoint_Backup_01_901d33bf-f9bc-4417-a8fb-9765fa992940, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_InnerCheckpoint_Backup_02_82bd8b76-bb3a-4312-b67a-f4848c2d1f2b, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_InnerCheckpoint_Backup_03_919f607e-6595-4b00-a140-a4b5b6dfeda4, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_InnerCheckpoint_Backup_04_acf83de4-e91e-4d60-b959-17123886feba, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_Torturers_Spike_3f1fa953-6a0d-4589-adfd-23c69603da2f, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_Torturers_Goblet_0f18201e-2836-4642-8a26-d0a6e1a8a8cc, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_Bravado_Goblin_001_0ee08ad4-329e-40c1-a40b-a74e74c39055, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_Bravado_Goblin_002_02291a93-e5d6-40f2-8cd0-f5edad8f4b6d, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_Bravado_Goblin_003_6ca1d4f0-59fd-4c7f-9d07-bb158eef2246, "GOB_GoblinThroneGeneral");
DB_GLO_DefeatCounter(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, "GOB_BrandingParty");
DB_GLO_DefeatCounter(S_GOB_GoblinBrash_35ffa172-7f23-4452-8f90-5dc24fd3bb6d, "GOB_BrandingParty");
DB_GLO_DefeatCounter(S_GOB_GoblinGlib_f63f921c-ae35-4574-9a70-30aee55fdb26, "GOB_BrandingParty");
DB_GLO_DefeatCounter(S_GOB_GoblinSulky_dd21e1d9-c426-4b12-b5a0-ef3445e9e967, "GOB_BrandingParty");
DB_GLO_DefeatCounter(S_GOB_GoblinWily_d8667091-dd64-499c-8bee-000cf42175fc, "GOB_BrandingParty");
DB_GLO_DefeatCounter(S_GOB_GoblinJolly_59557329-d49b-448b-bdd0-fd66ae0d67f6, "GOB_BrandingParty");
DB_GLO_DefeatCounter(S_GOB_RaiderStupid_5d049dbe-ff35-45be-88f9-5f999dc0ffe4, "GOB_WolfPens_Backup");
DB_GLO_DefeatCounter(S_GOB_RaiderArrogant_43d953fa-575e-452c-b220-939e6bdcc36b, "GOB_WolfPens_Backup");
DB_GLO_DefeatCounter(S_GOB_RaiderCunning_abdd3748-0834-46f3-8214-18dd4dca9d40, "GOB_WolfPens_Backup");
DB_ItemOwnerShipTriggers("WLD_Main_A", S_GOB_Quartermaster_OwnershipTrigger_d7721e24-de44-4ec8-b388-522bfd5e8d79, S_GOB_Quartermaster_646936f3-8d8d-484e-9361-cd1ed484c615);
DB_TrespassTrigger(S_GOB_Quartermaster_OwnershipTrigger_d7721e24-de44-4ec8-b388-522bfd5e8d79, S_GOB_Quartermaster_OutStorageTrigger_e5462b9f-9c27-4cda-91ab-6117693cc156);
DB_GOB_GoblinLeadersDeadVB(S_GOB_GoblinPriest_b983c336-9a14-4e9b-adb9-4689e7e0afa9, GOB_GoblinHunt_VB_KilledPriestess_083b8527-4c82-15e8-4903-227c92745c10);
DB_GOB_GoblinLeadersDeadVB(S_GOB_DrowCommander_25721313-0c15-4935-8176-9f134385451b, GOB_GoblinHunt_VB_KilledDrow_8a6f62bf-413f-6ac9-fdd6-af782150ec65);

KBSECTION
PROC
PROC_GLO_DefeatCounter_AllPermaDefeated("GOB_BrandingParty", _, _, _, _)
THEN
SetFlag(GOB_BrandingParty_State_Swept_a1a3ee9e-1379-4e51-9c2f-74f316ffff10, NULL_00000000-0000-0000-0000-000000000000, 0);

PROC
PROC_GLO_DefeatCounter_AllPermaDefeated("GOB_GoblinThroneGeneral", _, _, _, _)
THEN
SetFlag(GOB_GoblinThroneGeneral_State_Swept_02190656-f3c7-4ef9-beb2-5a8033a84a2e, NULL_00000000-0000-0000-0000-000000000000, 0);

PROC
PROC_GLO_DefeatCounter_AllPermaDefeated("GOB_WolfPens_Backup", _, _, _, _)
THEN
SetFlag(GOB_WolfPens_Backup_State_Swept_92fcadbe-e200-8686-a334-1fd1829eaea9, NULL_00000000-0000-0000-0000-000000000000, 0);

IF
DB_GlobalFlag(GOB_GoblinThroneGeneral_State_Swept_02190656-f3c7-4ef9-beb2-5a8033a84a2e, _, _, _, _)
AND
DB_GlobalFlag(GOB_WarMapArea_State_Swept_73aa9614-8c08-4b17-add8-216f71a90eec, _, _, _, _)
AND
DB_GlobalFlag(GOB_BrandingParty_State_Swept_a1a3ee9e-1379-4e51-9c2f-74f316ffff10, _, _, _, _)
AND
DB_GlobalFlag(GOB_ScryingRoom_State_Swept_d73219ec-1bf2-46d8-8d55-33a0643324c9, _, _, _, _)
AND
DB_GlobalFlag(GOB_WolfPens_Backup_State_Swept_92fcadbe-e200-8686-a334-1fd1829eaea9, _, _, _, _)
THEN
SetFlag(GOB_GoblinThroneArea_State_Swept_fd04a298-0efd-48c5-99a1-d3ded1b6fb66, NULL_00000000-0000-0000-0000-000000000000, 0);
PROC_CorpseLooting_ClearRedOutlinesForDefeatCounter("GOB_GoblinThroneGeneral");
PROC_CorpseLooting_ClearRedOutlinesForDefeatCounter("GOB_WarMapArea");
PROC_CorpseLooting_ClearRedOutlinesForDefeatCounter("GOB_BrandingParty");
PROC_CorpseLooting_ClearRedOutlinesForDefeatCounter("GOB_GoblinKing_ScryingRoom");
PROC_CorpseLooting_ClearRedOutlinesForDefeatCounter("GOB_WolfPens_Backup");
PROC_CorpseLooting_NoRedOutline("WLD_Main_A", S_GOB_GoblinHeretic_3af8a55b-903a-43cd-84d3-9cb7ca8f69de);

QRY
QRY_SelectCustomDialog_AfterGenerics((CHARACTER)_Var1, (GUIDSTRING)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_GLO_DefeatCounter(_Var1, "GOB_BrandingParty", _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetFlag(GOB_GoblinBranding_GettingBrand_ad1413b8-71bb-4542-b863-e13fd4fc8e85, _Var1, 1, _Var1, _Var1)
THEN
DB_SelectedDialog(GOB_BrandingGoblins_AD_Busy_2db5deb3-0636-b7e9-b720-519c8654e3e5, _Var1);

IF
EnteredTrigger((GUIDSTRING)_Var1, S_GOB_ThroneRoom_SUB_bb81678b-641c-43fc-bd41-53295d59be03, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(GOB_GoblinThrone_Event_Entered_88523974-c85f-4be5-8317-4bc62b3e3cf9, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(GOB_GoblinThrone_Event_Entered_88523974-c85f-4be5-8317-4bc62b3e3cf9, NULL_00000000-0000-0000-0000-000000000000, 0);

IF
DB_GlobalFlag(GOB_GoblinThrone_Event_Entered_88523974-c85f-4be5-8317-4bc62b3e3cf9, _, _, _, _)
AND NOT
DB_GlobalFlag(GLO_GoblinCamp_EverEnteredBefore_7a0172dd-df95-448a-aa2e-a04acdf7eabe, _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(GLO_GoblinCamp_EverEnteredBefore_7a0172dd-df95-448a-aa2e-a04acdf7eabe);

IF
DestroyedBy((ITEM)_Var1, _, _, _, (ITEM)_Var1)
AND
DB_GOB_FestivSleepers_Wall(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetFlag(GOB_Festivities_Event_SecretWallDestroyed_9659d067-f867-4352-977d-b63ffba6ff44, NULL_00000000-0000-0000-0000-000000000000, 0);

PROC
PROC_BlockUseOfItem((CHARACTER)_Var1, S_GOB_GoblinThrone_SecretEntrance_LadderFrom_1e4c968c-370c-4c8d-a074-ab227d85b28d, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_GlobalFlag(GOB_Festivities_Event_SecretWallDestroyed_9659d067-f867-4352-977d-b63ffba6ff44, _Var1, _Var1, _Var1, _Var1)
THEN
DB_CustomUseItemResponse(_Var1, S_GOB_GoblinThrone_SecretEntrance_LadderFrom_1e4c968c-370c-4c8d-a074-ab227d85b28d, 0);

PROC
PROC_BlockUseOfItem((CHARACTER)_Var1, S_GOB_GoblinThrone_SecretEntrance_LadderFrom_1e4c968c-370c-4c8d-a074-ab227d85b28d, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_GlobalFlag(GOB_Festivities_Event_SecretWallDestroyed_9659d067-f867-4352-977d-b63ffba6ff44, _Var1, _Var1, _Var1, _Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(GOB_GoblinThrone_PAD_SecretHatchBlocked_eff1764d-3b63-f8ec-c523-d544fd9f76aa, _Var1);

IF
CombatEnded((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GOB_GoblinLeadersDeadVB(_Var2, _Var3, _Var1, _Var1, _Var1)
AND
DB_Was_InCombat(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_PermaDefeated(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GOB_GoblinLeadersDeadVB_Played(_, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GOB_GoblinLeadersDeadVB_Played(_Var2, _, _Var1, _Var1, _Var1)
AND
GetClosestAlivePlayer(_Var2, _Var6, _, _Var1, _Var1)
AND NOT
DB_CantTalk(_Var6, _Var1, _Var1, _Var1, _Var1)
THEN
DB_GOB_GoblinLeadersDeadVB_Played(_Var2, _Var1);
StartVoiceBark(_Var3, _Var6);

IF
Dying((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_GOB_GoblinLeadersDeadVB(_Var1, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_Is_InCombat(_Var1, _, _Var1, _Var1, _Var1)
AND NOT
DB_GOB_GoblinLeadersDeadVB_Played(_Var1, _, _Var1, _Var1, _Var1)
AND
GetClosestAlivePlayer(_Var1, _Var5, _, _Var1, _Var1)
AND NOT
DB_CantTalk(_Var5, _Var1, _Var1, _Var1, _Var1)
THEN
DB_GOB_GoblinLeadersDeadVB_Played(_Var1, NULL_00000000-0000-0000-0000-000000000000);
StartVoiceBark(_Var2, _Var5);

PROC
PROC_LongRest()
AND
DB_GlobalFlag(GOB_GoblinThroneArea_State_Swept_fd04a298-0efd-48c5-99a1-d3ded1b6fb66, _, _, _, _)
AND
DB_GlobalFlag(GOB_State_LeadersAreDead_a1c5b01f-4b7f-47ab-82b0-d24d9c6d8bc6, _, _, _, _)
AND
QRY_OnlyOnce("GOB_ThroneRoom_RegisterPartyBanter", _, _, _, _)
THEN
PROC_RegisterWorldGossipTrigger(S_PartyBanterTrigger_GOB_TempleCleared_f4edd556-60f8-444d-ae39-e67a5b4e01c6);


EXITSECTION
ENDEXITSECTION

ParentTargetEdge "Act1"
