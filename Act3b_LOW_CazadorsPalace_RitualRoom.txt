Version 1
SubGoalCombiner SGC_AND

INITSECTION
DB_GLO_SetupForAct_Character("CTY_Main_A", S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);
DB_GLO_ExclusiveFlag("LOW_CazadorsPalace_Ritual", LOW_CazadorsPalace_RitualRoom_State_BeforeRitual_540f9932-f058-48a3-8fa2-21254b7f830e);
DB_GLO_ExclusiveFlag("LOW_CazadorsPalace_Ritual", LOW_CazadorsPalace_RitualRoom_State_RitualInProgress_95fe8bc3-21da-4741-a6dc-f5ccfd89be2a);
DB_GLO_ExclusiveFlag("LOW_CazadorsPalace_Ritual", LOW_CazadorsPalace_RitualRoom_State_RitualCompleted_7edf33ff-b185-46ed-b4d8-546c8a016387);
DB_GLO_ExclusiveFlag("LOW_CazadorsPalace_Ritual", LOW_CazadorsPalace_RitualRoom_State_RitualCancelled_989b59f6-b4e3-4236-a8d0-a694fddde5d4);
DB_LOW_CazadorsPalace_RitualRoom_Spawns(S_LOW_CazadorsPalace_RitualRoom_Spawn_001_062ff971-d709-4f54-bb03-51c02844eacb, S_LOW_CazadorsPalace_RitualRoom_SpawnPosition_001_94ca69d7-2184-47cc-92fe-4cd89a7df7d6, S_LOW_CazadorsPalace_RitualRoom_Rune_001_9a8d7873-f550-4c1f-a4fd-dba3262422e8, S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_001_1cc54c07-d989-454f-9700-4bf3c4843a69);
DB_LOW_CazadorsPalace_RitualRoom_Spawns(S_LOW_CazadorsPalace_RitualRoom_Spawn_002_a612de01-a750-491a-bacd-e09a67fc0de3, S_LOW_CazadorsPalace_RitualRoom_SpawnPosition_002_6e1aa083-e518-49ec-ae68-d17333d3a284, S_LOW_CazadorsPalace_RitualRoom_Rune_002_d74fd7a1-cbac-43e3-bfa6-cbbb5796b8c8, S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_002_f6ee4605-b6f9-4f12-b058-ef4ebeca7706);
DB_LOW_CazadorsPalace_RitualRoom_Spawns(S_LOW_CazadorsPalace_RitualRoom_Spawn_003_52ede1c9-6caf-4f7a-8d97-984c0e90e9cf, S_LOW_CazadorsPalace_RitualRoom_SpawnPosition_003_5f0fba13-103c-4ddc-81ff-de07a52f77f7, S_LOW_CazadorsPalace_RitualRoom_Rune_003_ef4c37eb-fa8a-465b-9539-873b033a09de, S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_003_36f6edae-2f39-4b0a-ac03-43645307c9c2);
DB_LOW_CazadorsPalace_RitualRoom_Spawns(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, S_LOW_CazadorsPalace_RitualRoom_SpawnPosition_004_737c59cc-e0ec-4821-b059-d8f0c05089a6, S_LOW_CazadorsPalace_RitualRoom_Rune_004_a018ef7f-e269-4026-96b6-32fdc6e38d77, S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_004_c3556707-6c0c-492c-b8a7-d1a984fd90f3);
DB_LOW_CazadorsPalace_RitualRoom_Spawns(S_LOW_CazadorsPalace_RitualRoom_Spawn_004_a4dc8e21-833c-4469-a72b-1969c688b8a4, S_LOW_CazadorsPalace_RitualRoom_SpawnPosition_005_9dcf4fb4-1d87-4d26-a8d8-3e446e3311ec, S_LOW_CazadorsPalace_RitualRoom_Rune_005_975cefe4-5a3c-408e-a0f5-7011093e32a5, S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_005_2c41eb0c-584c-4d31-993f-15f4fe76de6c);
DB_LOW_CazadorsPalace_RitualRoom_Spawns(S_WYR_VampireSpawns_Dalyria_204a74d2-e6ad-4e9b-a275-f03cb5f3d975, S_LOW_CazadorsPalace_RitualRoom_SpawnPosition_006_8b7d28df-342d-42f0-ab87-2642a9daa6c4, S_LOW_CazadorsPalace_RitualRoom_Rune_006_fe538d66-a34b-47b3-952d-7d238354e850, S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_006_01d5245a-3ef3-4057-8e88-04c762046518);
DB_LOW_CazadorsPalace_RitualRoom_Spawns(S_WYR_VampireSpawns_Petra_6fb6e85e-ccd0-42ef-a37d-1e256a433f3b, S_LOW_CazadorsPalace_RitualRoom_SpawnPosition_007_d3d5f06b-d255-4523-94c6-2e4c59089a6e, S_LOW_CazadorsPalace_RitualRoom_Rune_007_58209a8c-4c92-4dc1-857e-c5f26ef9498d, S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_007_2687f607-eaee-406a-90c0-9b5d3afe782a);
DB_LOW_CazadorsPalace_RitualRoom_Gratings(S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_001_1cc54c07-d989-454f-9700-4bf3c4843a69, S_LOW_CazadorsPalace_RitualRoom_GlowingGratingHelper_001_6d5acf2c-19b2-410c-b54c-ebad87b41a00);
DB_LOW_CazadorsPalace_RitualRoom_Gratings(S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_002_f6ee4605-b6f9-4f12-b058-ef4ebeca7706, S_LOW_CazadorsPalace_RitualRoom_GlowingGratingHelper_002_58ecf93f-529f-45ff-8ec1-0685cb5e15e0);
DB_LOW_CazadorsPalace_RitualRoom_Gratings(S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_003_36f6edae-2f39-4b0a-ac03-43645307c9c2, S_LOW_CazadorsPalace_RitualRoom_GlowingGratingHelper_003_3886ee94-256c-4be3-ba70-a7ca5a0593d2);
DB_LOW_CazadorsPalace_RitualRoom_Gratings(S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_004_c3556707-6c0c-492c-b8a7-d1a984fd90f3, S_LOW_CazadorsPalace_RitualRoom_GlowingGratingHelper_004_353ced4d-0cf5-4f74-8184-64f1b5eeb147);
DB_LOW_CazadorsPalace_RitualRoom_Gratings(S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_005_2c41eb0c-584c-4d31-993f-15f4fe76de6c, S_LOW_CazadorsPalace_RitualRoom_GlowingGratingHelper_005_eba2f518-47cd-4aa6-ad40-b36539242a2a);
DB_LOW_CazadorsPalace_RitualRoom_Gratings(S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_006_01d5245a-3ef3-4057-8e88-04c762046518, S_LOW_CazadorsPalace_RitualRoom_GlowingGratingHelper_006_6103fbee-0a0f-4b54-bf05-b7b9e4ac9fb2);
DB_LOW_CazadorsPalace_RitualRoom_Gratings(S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_007_2687f607-eaee-406a-90c0-9b5d3afe782a, S_LOW_CazadorsPalace_RitualRoom_GlowingGratingHelper_007_93c453d7-ec4a-42e0-ba55-ff311aa8df79);
DB_LOW_CazadorsPalace_RitualRoom_Buffs(1, "LOW_CAZADORSPALACE_SPAWNBUFF_001", "LOW_CAZADORSPALACE_SARCOPHAGUS_BEAM_001");
DB_LOW_CazadorsPalace_RitualRoom_Buffs(2, "LOW_CAZADORSPALACE_SPAWNBUFF_002", "LOW_CAZADORSPALACE_SARCOPHAGUS_BEAM_002");
DB_LOW_CazadorsPalace_RitualRoom_Buffs(3, "LOW_CAZADORSPALACE_SPAWNBUFF_003", "LOW_CAZADORSPALACE_SARCOPHAGUS_BEAM_003");
DB_LOW_CazadorsPalace_RitualRoom_Buffs(4, "LOW_CAZADORSPALACE_SPAWNBUFF_004", "LOW_CAZADORSPALACE_SARCOPHAGUS_BEAM_004");
DB_LOW_CazadorsPalace_RitualRoom_Buffs(5, "LOW_CAZADORSPALACE_SPAWNBUFF_005", "LOW_CAZADORSPALACE_SARCOPHAGUS_BEAM_005");
DB_LOW_CazadorsPalace_RitualRoom_Buffs(6, "LOW_CAZADORSPALACE_SPAWNBUFF_006", "LOW_CAZADORSPALACE_SARCOPHAGUS_BEAM_006");
DB_LOW_CazadorsPalace_RitualRoom_Buffs(7, "LOW_CAZADORSPALACE_SPAWNBUFF_007", "LOW_CAZADORSPALACE_SARCOPHAGUS_BEAM_007");
DB_LOW_CazadorsPalace_RitualRoom_ExtraBuffs(S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_003_36f6edae-2f39-4b0a-ac03-43645307c9c2, "LOW_CAZADORSPALACE_SPAWNBUFF_YOUSEN");
DB_LOW_CazadorsPalace_RitualRoom_ExtraBuffs(S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_004_c3556707-6c0c-492c-b8a7-d1a984fd90f3, "LOW_CAZADORSPALACE_SPAWNBUFF_ASTARION");
DB_LOW_CazadorsPalace_RitualRoom_ExtraBuffs(S_LOW_CazadorsPalace_RitualRoom_RuneTrigger_005_2c41eb0c-584c-4d31-993f-15f4fe76de6c, "LOW_CAZADORSPALACE_SPAWNBUFF_VIOLET");
DB_LOW_CazadorsPalace_RitualRoom_SpawnDialogs(S_LOW_CazadorsPalace_RitualRoom_Spawn_001_062ff971-d709-4f54-bb03-51c02844eacb, LOW_CazadorsPalace_RitualRoom_Spawn_001_ddc84f02-7cf7-744f-e0ae-6ee090b0aad4);
DB_LOW_CazadorsPalace_RitualRoom_SpawnDialogs(S_LOW_CazadorsPalace_RitualRoom_Spawn_002_a612de01-a750-491a-bacd-e09a67fc0de3, LOW_CazadorsPalace_RitualRoom_Spawn_002_fc7c5cf5-3213-5044-8e7f-7b441391f75d);
DB_LOW_CazadorsPalace_RitualRoom_SpawnDialogs(S_LOW_CazadorsPalace_RitualRoom_Spawn_003_52ede1c9-6caf-4f7a-8d97-984c0e90e9cf, LOW_CazadorsPalace_RitualRoom_Spawn_002_fc7c5cf5-3213-5044-8e7f-7b441391f75d);
DB_LOW_CazadorsPalace_RitualRoom_SpawnDialogs(S_LOW_CazadorsPalace_RitualRoom_Spawn_004_a4dc8e21-833c-4469-a72b-1969c688b8a4, LOW_CazadorsPalace_RitualRoom_Spawn_004_102b7d1b-f43d-9240-7784-c34918621c75);
DB_LOW_CazadorsPalace_RitualRoom_SpawnDialogs(S_WYR_VampireSpawns_Dalyria_204a74d2-e6ad-4e9b-a275-f03cb5f3d975, LOW_CazadorsPalace_RitualRoom_Dalyria_c417651b-a4a7-8a00-d20a-481969b2f4fb);
DB_LOW_CazadorsPalace_RitualRoom_SpawnDialogs(S_WYR_VampireSpawns_Petra_6fb6e85e-ccd0-42ef-a37d-1e256a433f3b, LOW_CazadorsPalace_RitualRoom_Petras_b1c83f95-aa53-c830-a411-9e2c5577942a);
DB_LOW_CazadorsPalace_RitualRoom_RitualForms(S_LOW_CazadorsPalace_RitualRoom_Spawn_001_062ff971-d709-4f54-bb03-51c02844eacb, S_LOW_CazadorsPalace_RitualRoom_Spawn_001_Ritual_88f2b674-5e09-4819-8ac7-04b1be422dec);
DB_LOW_CazadorsPalace_RitualRoom_RitualForms(S_LOW_CazadorsPalace_RitualRoom_Spawn_002_a612de01-a750-491a-bacd-e09a67fc0de3, S_LOW_CazadorsPalace_RitualRoom_Spawn_002_Ritual_9c85d82a-819f-4aed-8d70-abe45875b7b1);
DB_LOW_CazadorsPalace_RitualRoom_RitualForms(S_LOW_CazadorsPalace_RitualRoom_Spawn_003_52ede1c9-6caf-4f7a-8d97-984c0e90e9cf, S_LOW_CazadorsPalace_RitualRoom_Spawn_003_Ritual_bc89115e-94ea-4dcd-98ec-864ba29303d4);
DB_LOW_CazadorsPalace_RitualRoom_RitualForms(S_LOW_CazadorsPalace_RitualRoom_Spawn_004_a4dc8e21-833c-4469-a72b-1969c688b8a4, S_LOW_CazadorsPalace_RitualRoom_Spawn_004_Ritual_6c2d5b8b-a582-4e3c-af28-4d5c7255c98d);
DB_LOW_CazadorsPalace_RitualRoom_RitualForms(S_WYR_VampireSpawns_Dalyria_204a74d2-e6ad-4e9b-a275-f03cb5f3d975, S_WYR_VampireSpawns_Dalyria_Ritual_d53769c4-02b7-4a1c-af0b-d27c5e0391bf);
DB_LOW_CazadorsPalace_RitualRoom_RitualForms(S_WYR_VampireSpawns_Petra_6fb6e85e-ccd0-42ef-a37d-1e256a433f3b, S_WYR_VampireSpawns_Petra_Ritual_874214ac-dceb-45de-8120-f77fe8c8069c);
DB_LOW_CazadorsPalace_RitualRoom_Spotters(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);
DB_LOW_CazadorsPalace_RitualRoom_Minions(S_LOW_CazadorsPalace_RitualRoom_Zombie_01_0692451b-3093-4cf8-9370-55783a45d3d1);
DB_LOW_CazadorsPalace_RitualRoom_Minions(S_LOW_CazadorsPalace_RitualRoom_Zombie_02_24880c17-853e-4d0d-9243-1da4d1f32cb9);
DB_LOW_CazadorsPalace_RitualRoom_Minions(S_LOW_CazadorsPalace_RitualRoom_Zombie_04_978c53cd-db10-4eb0-81c3-7afac4344f39);
DB_LOW_CazadorsPalace_RitualRoom_Minions(S_LOW_CazadorsPalace_RitualRoom_Ritualist_01_e98c8ed5-1d3e-4b92-a05a-3b90107905c3);
DB_LOW_CazadorsPalace_RitualRoom_Minions(S_LOW_CazadorsPalace_RitualRoom_Bat_01_02bbc7ca-66c8-4a8f-b518-c599506442e5);
DB_LOW_CazadorsPalace_RitualRoom_Minions(S_LOW_CazadorsPalace_RitualRoom_Bat_02_6cc1a7ea-611c-40d7-b4b5-f1a2c9819644);
DB_LOW_CazadorsPalace_RitualRoom_Minions(S_LOW_CazadorsPalace_RitualRoom_Bat_03_a8290645-9301-4ec0-b481-a7c49844a2aa);
DB_LOW_CazadorsPalace_RitualRoom_Minions(S_LOW_CazadorsPalace_RitualRoom_Bat_04_d4f70089-3956-4ed5-8aa1-c231b9bb23ab);
DB_LOW_CazadorsPalace_RitualRoom_Minions(S_LOW_CazadorsPalace_RitualRoom_Bat_05_ea827be9-8e09-4331-9abe-d08d4c690f45);
DB_LOW_CazadorsPalace_RitualRoom_Minions(S_LOW_CazadorsPalace_RitualRoom_Bat_06_341fc0da-f6c4-4540-aeed-5b2cae43e5f4);
DB_LOW_CazadorsPalace_RitualRoom_Minions(S_LOW_CazadorsPalace_RitualRoom_Werewolf_01_20ff3b11-d07a-4ecc-ae23-41fc09966ba5);
DB_LOW_CazadorsPalace_RitualRoom_Minions(S_LOW_CazadorsPalace_RitualRoom_Werewolf_02_79138f67-ed4a-4d3a-8fb7-1e4c4d6c8620);
DB_LOW_CazadorsPalace_RitualRoom_Minions(S_LOW_CazadorsPalace_RitualRoom_Werewolf_03_471eff9e-66df-468c-919a-d7160f02e46e);
DB_LOW_CazadorsPalace_RitualRoom_Minions(S_LOW_CazadorsPalace_RitualRoom_Werewolf_04_f8eb826d-9071-4fc4-aeee-9383fab42bac);
DB_LOW_CazadorsPalace_RitualRoom_AdditionalMinions(LOW_Bat_Cazador_Ritual_Swarmed_52081abb-e6ad-40aa-acd1-46ce81340400, 3, S_LOW_CazadorsPalace_RitualRoom_BatPoint_01_e11cde2a-a76e-4607-8633-fb2bf87cdd6d);
DB_LOW_CazadorsPalace_RitualRoom_AdditionalMinions(LOW_Bat_Cazador_Ritual_Swarmed_52081abb-e6ad-40aa-acd1-46ce81340400, 3, S_LOW_CazadorsPalace_RitualRoom_BatPoint_02_5409a339-ec8d-4887-a951-cd1ec06a5619);
DB_LOW_CazadorsPalace_RitualRoom_AdditionalMinions(LOW_Bat_Cazador_Ritual_Swarmed_52081abb-e6ad-40aa-acd1-46ce81340400, 3, S_LOW_CazadorsPalace_RitualRoom_BatPoint_03_e5bf5f1c-d081-497d-a230-0e10b77a2aa5);
DB_LOW_CazadorsPalace_RitualRoom_AdditionalMinions(LOW_Bat_Cazador_Ritual_Swarmed_52081abb-e6ad-40aa-acd1-46ce81340400, 3, S_LOW_CazadorsPalace_RitualRoom_BatPoint_04_15749af3-c8f8-4b44-bac5-4bbfff2dd85f);
DB_LOW_CazadorsPalace_RitualRoom_AdditionalMinions(LOW_Bat_Cazador_Ritual_Swarmed_52081abb-e6ad-40aa-acd1-46ce81340400, 3, S_LOW_CazadorsPalace_RitualRoom_BatPoint_05_f71ccb5a-f493-4455-93e1-25bf25469ddb);
DB_LOW_CazadorsPalace_RitualRoom_AdditionalMinions(LOW_Bat_Cazador_Ritual_Swarmed_52081abb-e6ad-40aa-acd1-46ce81340400, 3, S_LOW_CazadorsPalace_RitualRoom_BatPoint_06_54158d74-d2ac-4092-8367-d163167e373c);
DB_LOW_CazadorsPalace_RitualRoom_AdditionalMinions(LOW_Bat_Cazador_Ritual_Swarmed_52081abb-e6ad-40aa-acd1-46ce81340400, 5, S_LOW_CazadorsPalace_RitualRoom_BatPoint_01_e11cde2a-a76e-4607-8633-fb2bf87cdd6d);
DB_LOW_CazadorsPalace_RitualRoom_AdditionalMinions(LOW_Bat_Cazador_Ritual_Swarmed_52081abb-e6ad-40aa-acd1-46ce81340400, 5, S_LOW_CazadorsPalace_RitualRoom_BatPoint_02_5409a339-ec8d-4887-a951-cd1ec06a5619);
DB_LOW_CazadorsPalace_RitualRoom_AdditionalMinions(LOW_Bat_Cazador_Ritual_Swarmed_52081abb-e6ad-40aa-acd1-46ce81340400, 5, S_LOW_CazadorsPalace_RitualRoom_BatPoint_03_e5bf5f1c-d081-497d-a230-0e10b77a2aa5);
DB_LOW_CazadorsPalace_RitualRoom_AdditionalMinions(LOW_Bat_Cazador_Ritual_Swarmed_52081abb-e6ad-40aa-acd1-46ce81340400, 5, S_LOW_CazadorsPalace_RitualRoom_BatPoint_04_15749af3-c8f8-4b44-bac5-4bbfff2dd85f);
DB_LOW_CazadorsPalace_RitualRoom_AdditionalMinions(LOW_Bat_Cazador_Ritual_Swarmed_52081abb-e6ad-40aa-acd1-46ce81340400, 5, S_LOW_CazadorsPalace_RitualRoom_BatPoint_05_f71ccb5a-f493-4455-93e1-25bf25469ddb);
DB_LOW_CazadorsPalace_RitualRoom_AdditionalMinions(LOW_Bat_Cazador_Ritual_Swarmed_52081abb-e6ad-40aa-acd1-46ce81340400, 5, S_LOW_CazadorsPalace_RitualRoom_BatPoint_06_54158d74-d2ac-4092-8367-d163167e373c);
PROC_TriggerRegisterForPlayers(S_LOW_CazadorsPalace_RitualRoom_LoneAstarionWarning_fd2a64a4-5d0b-4e96-b6d2-2d40a62c3ac0);
PROC_DefineSingleOriginMoment(LOW_CazadorsPalace_RitualRoom_PreCombat_NoAstarion_061da20f-7611-e738-999b-ab05089626d6, ASTARION_23a46e79-e73c-4043-940f-cb0aace9ab2e, LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212, LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212, LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212);
DB_DropMutingStatussesDialog(LOW_CazadorsPalace_RitualRoom_PreCombat_NoAstarion_061da20f-7611-e738-999b-ab05089626d6);
DB_OriginMoment_MaxDistance(LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212, 30);
PROC_TriggerRegisterForParty(S_LOW_CazadorsPalace_RitualRoom_RitualArea_60e2e3a7-f648-427b-86d3-96e9621fab03);
DB_AddCharactersInTriggerToDialog(LOW_CazadorsPalace_RitualRoom_PreCombat_NoAstarion_061da20f-7611-e738-999b-ab05089626d6, S_LOW_CazadorsPalace_RitualRoom_RitualArea_60e2e3a7-f648-427b-86d3-96e9621fab03, 1, 1, 0);
DB_AddCharactersInTriggerToDialog_IgnoreHidden(LOW_CazadorsPalace_RitualRoom_PreCombat_NoAstarion_061da20f-7611-e738-999b-ab05089626d6);
DB_AddCharactersInTriggerToDialog(LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212, S_LOW_CazadorsPalace_RitualRoom_RitualArea_60e2e3a7-f648-427b-86d3-96e9621fab03, 1, 1, 0);
DB_AddCharactersInTriggerToDialog_IgnoreHidden(LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212);
DB_DialogBlockTradeButton(LOW_CazadorsPalace_RitualRoom_PreCombat_NoAstarion_061da20f-7611-e738-999b-ab05089626d6);
DB_DialogBlockTradeButton(LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212);
DB_DialogBlockAttackButton(LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212);
DB_LOW_CazadorsPalace_RitualRoom_RitualIndicators(S_LOW_CazadorsPalace_RitualRoom_RoundIndicator_003_a695ea65-f76c-44e5-a1eb-a553c533c276, 1);
DB_LOW_CazadorsPalace_RitualRoom_RitualIndicators(S_LOW_CazadorsPalace_RitualRoom_RoundIndicator_002_442f7c8a-2282-419d-9de3-8b15175046ed, 2);
DB_LOW_CazadorsPalace_RitualRoom_RitualIndicators(S_LOW_CazadorsPalace_RitualRoom_RoundIndicator_001_09f0b7a5-3b7b-4bc1-b844-3e7e07db9e6a, 3);
AddPreferredAiTargetTag(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, ASTARION_23a46e79-e73c-4043-940f-cb0aace9ab2e);
PROC_DefineSingleOriginMoment(LOW_CazadorsPalace_Coffin_826f2df8-33c9-db18-6b87-0ca5755c9c09, ASTARION_23a46e79-e73c-4043-940f-cb0aace9ab2e, LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b);
DB_OriginMoment_DontAutoClearOriginMoment(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b);
DB_DialogBlockAttackButton(LOW_CazadorsPalace_Coffin_826f2df8-33c9-db18-6b87-0ca5755c9c09);
DB_DialogBlockTradeButton(LOW_CazadorsPalace_Coffin_826f2df8-33c9-db18-6b87-0ca5755c9c09);
DB_DialogBlockAttackButton(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b);
DB_DialogBlockTradeButton(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b);
DB_OriginMoment_ExtraNPCs(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853);
DB_DropMutingStatussesDialog(LOW_CazadorsPalace_Coffin_826f2df8-33c9-db18-6b87-0ca5755c9c09);
DB_AddCharactersInTriggerToDialog(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, S_LOW_CazadorsPalace_RitualRoom_RitualArea_60e2e3a7-f648-427b-86d3-96e9621fab03, 1, 1, 0);
DB_PermaDefeatedEvent(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, ORI_Astarion_State_CazadorPermaDefeated_5258c8d8-09a3-4343-bb6e-13ff5b8e3438);
DB_GLO_ExclusiveFlag("LOW_CazadorsPalace_RitualRoom_CazadorState", LOW_CazadorsPalace_RitualRoom_State_CazadorInCoffin_15322f0b-da2e-48f8-b7d0-a6418c58893c);
DB_GLO_ExclusiveFlag("LOW_CazadorsPalace_RitualRoom_CazadorState", ORI_Astarion_State_CazadorPermaDefeated_5258c8d8-09a3-4343-bb6e-13ff5b8e3438);
DB_OriginMayLeaveDialog(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b);
DB_Inclusion_Object(S_WYR_VampireSpawns_Dalyria_204a74d2-e6ad-4e9b-a275-f03cb5f3d975, LOW_CazadorsPalace_Dalyria_StartInclusion_e56cf5a6-7438-420f-9bce-72a9bd3fe700, LOW_CazadorsPalace_Dalyria_EndInclusion_35f6bcb7-0019-4233-9cb9-30bc020c0bd5);
DB_Inclusion_Object(S_WYR_VampireSpawns_Petra_6fb6e85e-ccd0-42ef-a37d-1e256a433f3b, LOW_CazadorsPalace_Petra_StartInclusion_950d720a-809b-4552-a107-2bd99c623e63, LOW_CazadorsPalace_Petra_EndInclusion_b2db88f5-762a-4491-8daf-df3004fa7707);
DB_Inclusion_NPCDialog(LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212, S_WYR_VampireSpawns_Dalyria_204a74d2-e6ad-4e9b-a275-f03cb5f3d975);
DB_Inclusion_NPCDialog(LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212, S_WYR_VampireSpawns_Petra_6fb6e85e-ccd0-42ef-a37d-1e256a433f3b);
DB_Inclusion_NPCDialog(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, S_WYR_VampireSpawns_Dalyria_204a74d2-e6ad-4e9b-a275-f03cb5f3d975);
DB_Inclusion_NPCDialog(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, S_WYR_VampireSpawns_Petra_6fb6e85e-ccd0-42ef-a37d-1e256a433f3b);
DB_GlobalFlagReactionAfterDialog(LOW_CazadorsPalace_RitualRoom_Event_KillCazador_d0ae6721-9927-405c-a98c-f3930506f611, LOW_CazadorsPalace_Coffin_826f2df8-33c9-db18-6b87-0ca5755c9c09);
DB_GlobalFlagReactionAfterDialog(LOW_CazadorsPalace_RitualRoom_Event_KillCazador_d0ae6721-9927-405c-a98c-f3930506f611, LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b);
DB_GLO_CompoundFlag(ORI_Astarion_State_StayedVampireSpawn_2724b881-6be1-49a7-8375-a49e9acb4546, ORI_Astarion_Knows_CazadorDead_5f891b0c-a2d8-4d6c-9f99-3012ab00b54e);
DB_GLO_CompoundFlag(ORI_Astarion_State_BecameVampireLord_c446ce94-efd8-45d5-b407-284177b6b57e, ORI_Astarion_Knows_CazadorDead_5f891b0c-a2d8-4d6c-9f99-3012ab00b54e);
DB_CombatReact_AD_StatusRemoved(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, LOW_CazadorsPalace_RitualRoom_AD_BuffRemoved_001_Combat_ee4a186e-2009-f47a-be12-cfd4462a4219, "LOW_CAZADORSPALACE_SPAWNBUFF_007");
DB_CombatReact_AD_StatusRemoved(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, LOW_CazadorsPalace_RitualRoom_AD_BuffRemoved_002_Combat_2c442107-0d6c-1133-344e-f8fb1e304d00, "LOW_CAZADORSPALACE_SPAWNBUFF_006");
DB_LOW_CazadorsPalace_RitualRoom_PostCombatAdditionalSpeakers(S_LOW_CazadorsPalace_RitualRoom_Spawn_001_062ff971-d709-4f54-bb03-51c02844eacb);
DB_LOW_CazadorsPalace_RitualRoom_PostCombatAdditionalSpeakers(S_LOW_CazadorsPalace_RitualRoom_Spawn_002_a612de01-a750-491a-bacd-e09a67fc0de3);
DB_LOW_CazadorsPalace_RitualRoom_PostCombatAdditionalSpeakers(S_LOW_CazadorsPalace_RitualRoom_Spawn_003_52ede1c9-6caf-4f7a-8d97-984c0e90e9cf);
DB_LOW_CazadorsPalace_RitualRoom_PostCombatAdditionalSpeakers(S_LOW_CazadorsPalace_RitualRoom_Spawn_004_a4dc8e21-833c-4469-a72b-1969c688b8a4);

KBSECTION
PROC
PROC_GLO_SetupForAct("CTY_Main_A", S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 1, _, _)
THEN
PROC_GLO_SetupForAct_Place(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, S_LOW_CazadorsPalace_RitualRoom_CazadorsDefaultPos_a3a70d4c-8ab8-4835-9a72-9b0eefb1b1e3, Act3_LOW_CazadorsPalace_RitualRoom_0aa59526-0d5a-4db1-be35-10df64686385, LOW_CazadorsPalace_RitualRoom_PreCombat_NoAstarion_061da20f-7611-e738-999b-ab05089626d6, "LOW_CazadorsPalace_RitualRoom_CazadorTeleported");
PROC_SetOnStage(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 1);
SetCombatGroupID(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "af1418d4-cf34-46af-800b-ff7278470e7e");
SetImmortal(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 1);
DB_CustomDialogRange(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 50);
DB_NoLowAttitudeDialog(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);

IF
DB_LOW_CazadorsPalace_RitualRoom_RitualIndicators(_Var1, _, _Var1, _Var1, _Var1)
THEN
SetDetached(_Var1, 0);

IF
FlagSet(LOW_CazadorsPalace_EnteredDungeon_740ea5cd-7ada-4610-aadb-f52026782700, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_LOW_CazadorsPalace_CheckAstarionAndProceed();

PROC
PROC_LOW_CazadorsPalace_CheckAstarionAndProceed()
AND
DB_GlobalFlag(GLO_Origin_PartOfTheTeam_Astarion_24ae9cee-0516-47c6-8291-cb143256264d, _, _, _, _)
THEN
PROC_LOW_CazadorsPalace_PlayerEnteredDungeon();

PROC
PROC_LOW_CazadorsPalace_CheckAstarionAndProceed()
AND NOT
DB_GlobalFlag(GLO_Origin_PartOfTheTeam_Astarion_24ae9cee-0516-47c6-8291-cb143256264d, _, _, _, _)
AND
IsDead(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, 0, _, _, _)
THEN
SetFlag(LOW_CazadorsPalace_RitualRoom_State_CazadorGotAstarion_f353a103-3a5e-489e-ab3c-4520f835e24c);
PROC_LOW_CazadorsPalace_PlayerEnteredDungeon();

PROC
PROC_LOW_CazadorsPalace_CheckAstarionAndProceed()
AND NOT
DB_GlobalFlag(GLO_Origin_PartOfTheTeam_Astarion_24ae9cee-0516-47c6-8291-cb143256264d, _, _, _, _)
AND
IsDead(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, 1, _, _, _)
THEN
TeleportTo(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, S_LOW_CazadorsPalace_RitualRoom_AsylumPos_5a9de1d3-dbfa-4796-96f5-973cee523b32, "LOW_CazadorsPalace_DeadAstarionTeleportedToAsylum", 0, 0, 0, 0, 1);

IF
EntityEvent(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CazadorsPalace_DeadAstarionTeleportedToAsylum", _, _, _)
THEN
DB_LOW_CazadorsPalace_RitualRoom_AstarionIsBeingResurrected(1);
Resurrect(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);

IF
Resurrected(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_AstarionIsBeingResurrected(1, _, _, _, _)
THEN
NOT DB_LOW_CazadorsPalace_RitualRoom_AstarionIsBeingResurrected(1);
SetFlag(LOW_CazadorsPalace_RitualRoom_State_CazadorGotAstarion_f353a103-3a5e-489e-ab3c-4520f835e24c);
PROC_LOW_CazadorsPalace_PlayerEnteredDungeon();

PROC
PROC_LOW_CazadorsPalace_PlayerEnteredDungeon()
THEN
SetFlag(LOW_CazadorsPalace_RitualRoom_State_BeforeRitual_540f9932-f058-48a3-8fa2-21254b7f830e);

IF
EnteredTrigger(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, S_LOW_CazadorsPalace_RitualRoom_LoneAstarionWarning_fd2a64a4-5d0b-4e96-b6d2-2d40a62c3ac0, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetClosestAlivePlayer(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _Var1, _Var2, _Var1, _Var1)
AND
_Var2 > 30
THEN
PROC_TriggerUnregisterForPlayers(S_LOW_CazadorsPalace_RitualRoom_LoneAstarionWarning_fd2a64a4-5d0b-4e96-b6d2-2d40a62c3ac0);
PROC_TryStartAD(LOW_CazadorsPalace_RitualRoom_AD_LoneAstarionWarning_bc57d57b-fc43-1670-6fab-0401fe3224be, S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);

IF
EnteredTrigger((CHARACTER)_Var1, S_LOW_CazadorsPalace_RitualRoom_RitualArea_60e2e3a7-f648-427b-86d3-96e9621fab03, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TriggerUnregisterForPlayers(S_LOW_CazadorsPalace_RitualRoom_LoneAstarionWarning_fd2a64a4-5d0b-4e96-b6d2-2d40a62c3ac0);

IF
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_BeforeRitual_540f9932-f058-48a3-8fa2-21254b7f830e, _, _, _, _)
THEN
DB_SceneManager(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CazadorsPalace_RitualRoom_BeforeRitual");
DB_SceneNoHostileContinuousDisturbance("LOW_CazadorsPalace_RitualRoom_BeforeRitual");
SetCombatGroupID(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CazadorsPalace_RitualRoom");

IF
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_BeforeRitual_540f9932-f058-48a3-8fa2-21254b7f830e, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Minions(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_SceneManager(_Var1, "LOW_CazadorsPalace_RitualRoom_BeforeRitual");
SetCombatGroupID(_Var1, "LOW_CazadorsPalace_RitualRoom");
SetHasDialog(_Var1, 1);

IF
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_BeforeRitual_540f9932-f058-48a3-8fa2-21254b7f830e, _, _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_, _, _, _Var4, _)
THEN
PROC_TriggerRegisterForParty(_Var4);
TriggerRegisterForCharacter(_Var4, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);

IF
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_BeforeRitual_540f9932-f058-48a3-8fa2-21254b7f830e, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spotters(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_SpotPlayers(_Var1, "LOW_CazadorsPalace_RitualRoom", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers_SpotTrigger(_Var1, "LOW_CazadorsPalace_RitualRoom", S_LOW_CazadorsPalace_RitualRoom_SpotArea_b736e33e-8875-4193-be94-275de35805bd);

IF
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_BeforeRitual_540f9932-f058-48a3-8fa2-21254b7f830e, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Minions(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_SpotPlayers(_Var1, "LOW_CazadorsPalace_RitualRoom", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers_SpotTrigger(_Var1, "LOW_CazadorsPalace_RitualRoom", S_LOW_CazadorsPalace_RitualRoom_SpotArea_b736e33e-8875-4193-be94-275de35805bd);

IF
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_BeforeRitual_540f9932-f058-48a3-8fa2-21254b7f830e, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var1, _Var2, _, _, _Var1)
AND
QRY_LOW_CazadorsPalace_RitualRoom_SpawnCanBeTeleported(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TeleportTo(_Var1, _Var2, "LOW_CazadorsPalace_RitualRoom_SpawnTeleported", 0, 0, 0, 1, 1);
SetCombatGroupID(_Var1, "af1418d4-cf34-46af-800b-ff7278470e7e");

QRY
QRY_LOW_CazadorsPalace_RitualRoom_SpawnCanBeTeleported((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
_Var1 != S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255
THEN
DB_NOOP(1);

QRY
QRY_LOW_CazadorsPalace_RitualRoom_SpawnCanBeTeleported((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
_Var1 == S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_CazadorGotAstarion_f353a103-3a5e-489e-ab3c-4520f835e24c, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
EntityEvent((CHARACTER)_Var1, "LOW_CazadorsPalace_RitualRoom_SpawnTeleported", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_Foop(_Var1);
RemoveHarmfulStatuses(_Var1);
SetHitpointsPercentage(_Var1, 100);
SetImmortal(_Var1, 0);
ApplyStatus(_Var1, "LOW_CAZADORSPALACE_RITUAL_CRYSTALLISED", -1, 1, NULL_00000000-0000-0000-0000-000000000000);
SetFaction(_Var1, Act3_LOW_CazadorsPalace_RitualRoom_Spawns_128ae9fe-23a3-4fb3-bb67-24b925290f8d);
SetCanFight(_Var1, 0);
SetCanJoinCombat(_Var1, 0);
DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(_Var1);
DB_SceneManager(_Var1, "LOW_CazadorsPalace_RitualRoom_BeforeRitual");

IF
EntityEvent((CHARACTER)_Var1, "LOW_CazadorsPalace_RitualRoom_SpawnTeleported", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_SpawnDialogs(_Var1, _, _Var1, _Var1, _Var1)
THEN
PROC_RemoveAllDialogEntriesForSpeaker(_Var1);
SetHasDialog(_Var1, 0);

IF
EntityEvent((CHARACTER)_Var1, "LOW_CazadorsPalace_RitualRoom_SpawnTeleported", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_RitualForms(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
Transform(_Var1, _Var2, DisguiseKeepName_c7c3381e-b901-416e-a0c4-bc745e1ff54a);

IF
EntityEvent(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CazadorsPalace_RitualRoom_SpawnTeleported", _, _, _)
THEN
PROC_RemoveAllDialogEntriesForSpeaker(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);
PROC_GlobalSetFlagAndCache(ORI_Astarion_State_NecroZombie_273d5473-cfd1-4fec-b1f5-a4db0ac4f4ed);
Transform(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, Undead_Zombie_Melee_5b2827cb-1cf9-4cd5-9b58-0f7eb4657f0c, LOW_AstarionZombie_32b73660-dd8e-46ce-9b07-81dd8581b918);
SetStoryDisplayName(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CazadorsPalace_ZombieAstarion");

PROC
PROC_SceneInterrupted(_, (CHARACTER)_Var2, "LOW_CazadorsPalace_RitualRoom_BeforeRitual", (STRING)_Var3, _)
AND
DB_GLO_GenericSceneManager_ViolenceReason(_Var3, _, _, _, _)
THEN
DB_SceneManager_AllowViolenceDisturbanceRegistration("LOW_CazadorsPalace_RitualRoom_BeforeRitual");
PROC_SceneOver("LOW_CazadorsPalace_RitualRoom_BeforeRitual");
PROC_LOW_CazadorsPalace_RitualRoom_MakeRitualRoomHostile();

PROC
PROC_LOW_CazadorsPalace_RitualRoom_MakeRitualRoomHostile()
AND
GetFaction(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SetRelationToPlayers(_Var1, 0);

IF
EnteredCombat(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _, _, _, _)
AND NOT
DB_LOW_CazadorsPalace_PreCombatOMHappened(1, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_RitualCannotBeCompleted_71cb0aae-aea2-4304-9932-4c57bf6669a8, _, _, _, _)
AND
QRY_OnlyOnce("LOW_CazadorsPalace_PreCombat_LookingForAstarion", _, _, _, _)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_StartSpottingAstarion();

IF
FlagSet(LOW_CazadorsPalace_Cazador_State_FetchingAstarion_a2d019a4-164c-1028-e2ae-8651b3e4cf08, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_StartSpottingAstarion();

PROC
PROC_LOW_CazadorsPalace_RitualRoom_StartSpottingAstarion()
THEN
PROC_SpotPlayers_StopSpotting("LOW_CazadorsPalace_RitualRoom");
DB_OriginMoment_IgnoreCombat(LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212);
DB_SpotPlayers_HasTag(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CazadorsPalace_PreCombat_LookingForAstarion", ASTARION_23a46e79-e73c-4043-940f-cb0aace9ab2e, 1);
DB_SpotPlayers_SpotTrigger(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CazadorsPalace_PreCombat_LookingForAstarion", S_LOW_CazadorsPalace_RitualRoom_SpotArea_b736e33e-8875-4193-be94-275de35805bd);
DB_SpotPlayers_IgnoreCombat(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CazadorsPalace_PreCombat_LookingForAstarion");
DB_SpotPlayers_TargetIgnoreCantTalk(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CazadorsPalace_PreCombat_LookingForAstarion");
DB_SpotPlayers(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CazadorsPalace_PreCombat_LookingForAstarion", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_SpotPlayers_Spotted((CHARACTER)_Var1, "LOW_CazadorsPalace_RitualRoom", (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_OnlyOnce("LOW_CazadorsPalace_RitualRoom_PreCombatOM", _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_StartDialog(LOW_CazadorsPalace_RitualRoom_PreCombat_NoAstarion_061da20f-7611-e738-999b-ab05089626d6, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var2, _Var1, _Var1)
AND NOT
DB_QRYRTN_StartDialog_FailReason("OriginMomentOverride", _Var1, _Var1, _Var1, _Var1)
AND
GetFaction(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var3, _Var1, _Var1, _Var1)
THEN
PROC_SetRelationToPlayers(_Var3, 0);

PROC
PROC_SpotPlayers_Spotted((CHARACTER)_Var1, "LOW_CazadorsPalace_PreCombat_LookingForAstarion", (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_OnlyOnce("LOW_CazadorsPalace_RitualRoom_PreCombatOM_LookingForAstarion", _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_StartDialog(LOW_CazadorsPalace_RitualRoom_PreCombat_NoAstarion_061da20f-7611-e738-999b-ab05089626d6, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var2, _Var1, _Var1)
AND NOT
DB_QRYRTN_StartDialog_FailReason("OriginMomentOverride", _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Is_InCombat(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _, _Var1, _Var1, _Var1)
AND
GetFaction(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var4, _Var1, _Var1, _Var1)
THEN
PROC_SetRelationToPlayers(_Var4, 0);

QRY
QRY_SelectCustomDialog_AfterGenerics((CHARACTER)_Var1, (GUIDSTRING)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Minions(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_StartDialog(LOW_CazadorsPalace_RitualRoom_PreCombat_NoAstarion_061da20f-7611-e738-999b-ab05089626d6, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var2, _Var1, _Var1)
AND
GetFaction(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var3, _Var1, _Var1, _Var1)
THEN
PROC_SetRelationToPlayers(_Var3, 0);

PROC
PROC_DialogFlagSetup(LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212, _, _, _, _)
AND
DB_Players(_Var3, _, _, _, _)
AND
_Var3 != S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255
AND
GetDistanceTo(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _Var3, _Var4, _, _)
AND
_Var4 < 20
THEN
PROC_GlobalSetFlagAndCache(LOW_CazadorsPalace_RitualRoom_State_AnotherPartyMemberPresent_fcfad818-3f62-493b-a03a-bbc28f4b370e);

IF
DialogEnded(LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212, _, _, _, _)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_AnotherPartyMemberPresent_fcfad818-3f62-493b-a03a-bbc28f4b370e, _, _, _, _)
THEN
PROC_GlobalClearFlagAndCache(LOW_CazadorsPalace_RitualRoom_State_AnotherPartyMemberPresent_fcfad818-3f62-493b-a03a-bbc28f4b370e);

QRY
QRY_OriginMoment_PreventRelaunchDialog(LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
DB_NOOP(1);

IF
FlagSet(LOW_CazadorsPalace_RitualRoom_Event_TeleportAstarion_1318f561-8b32-4ac2-bb85-a4f2b93f53d4, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);
TeleportTo(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, S_LOW_CazadorsPalace_RitualRoom_SpawnPosition_004_737c59cc-e0ec-4821-b059-d8f0c05089a6, "LOW_CazadorsPalace_RitualRoom_AstarionTeleportedDuringDialog", 0, 0, 0, 1, 1);

IF
EntityEvent(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CazadorsPalace_RitualRoom_AstarionTeleportedDuringDialog", _, _, _)
THEN
ApplyStatus(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CAZADORSPALACE_RITUAL_INCAPACITATED", -1, 1, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);

IF
CastedSpell(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "Target_LOW_RitualCapture_Cazador", _, _, _)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_CaptureAstarion();

PROC
PROC_LOW_CazadorsPalace_RitualRoom_CaptureAstarion()
THEN
SetFlag(ORI_Astarion_State_CapturedInCombat_705422ce-924a-4267-a16e-067aed0f3089);
PROC_TryStartAD(LOW_CazadorsPalace_RitualRoom_AD_TeleportingAstarionToRitualPosition_7fa32da3-0c9d-a859-bc1c-08d7be9eb0a0, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);
DB_LOW_CazadorsPalace_RitualRoom_AstarionCapturedInCombat(1);
RemoveStatus(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "DOWNED", NULL_00000000-0000-0000-0000-000000000000);
RemoveHarmfulStatuses(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);
SetHitpoints(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, 1);
TeleportTo(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, S_LOW_CazadorsPalace_RitualRoom_SpawnPosition_004_737c59cc-e0ec-4821-b059-d8f0c05089a6, "LOW_CazadorsPalace_RitualRoom_AstarionTeleportedDuringCombat", 0, 0, 0, 1, 1);

IF
EntityEvent(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CazadorsPalace_RitualRoom_AstarionTeleportedDuringCombat", _, _, _)
THEN
Freeze(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);
RealtimeObjectTimerLaunch(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CazadorsPalace_RitualRoom_IncapacitateAstarion", 2000);

IF
ObjectTimerFinished(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CazadorsPalace_RitualRoom_IncapacitateAstarion", _, _, _)
THEN
Unfreeze(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);
ApplyStatus(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CAZADORSPALACE_RITUAL_INCAPACITATED", -1, 1, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);

IF
StatusApplied(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CAZADORSPALACE_RITUAL_INCAPACITATED", _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_AstarionCapturedInCombat(1, _, _, _, _)
THEN
DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);

IF
DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_AstarionCapturedInCombat(1, _, _, _, _)
AND NOT
QRY_LOW_CazadorsPalace_RitualRoom_CanStartRitualInCombat()
THEN
PROC_LOW_CazadorsPalace_RitualRoom_EnableBeam(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyBuffs();
NOT DB_LOW_CazadorsPalace_RitualRoom_AstarionCapturedInCombat(1);

IF
DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_AstarionCapturedInCombat(1, _, _, _, _)
AND
QRY_LOW_CazadorsPalace_RitualRoom_CanStartRitualInCombat()
THEN
PROC_GlobalSetFlagAndCache(LOW_CazadorsPalace_RitualRoom_State_RitualInProgress_95fe8bc3-21da-4741-a6dc-f5ccfd89be2a);
NOT DB_LOW_CazadorsPalace_RitualRoom_AstarionCapturedInCombat(1);

QRY
QRY_LOW_CazadorsPalace_RitualRoom_CanStartRitualInCombat()
AND NOT
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_RitualInProgress_95fe8bc3-21da-4741-a6dc-f5ccfd89be2a, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_RitualCannotBeCompleted_71cb0aae-aea2-4304-9932-4c57bf6669a8, _, _, _, _)
THEN
DB_NOOP(1);

IF
StatusRemoved(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CAZADORSPALACE_RITUAL_INCAPACITATED", _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _Var4, _, _)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_RitualInProgress_95fe8bc3-21da-4741-a6dc-f5ccfd89be2a, _, _, _, _)
THEN
NOT DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);
PROC_LOW_CazadorsPalace_RitualRoom_DisableBeam(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);
RemoveStatus(_Var4, "LOW_CAZADORSPALACE_PENTAGRAM_BUFF_GLOW");
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyBuffs();

IF
DialogStarted(LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
DB_LOW_CazadorsPalace_PreCombatOMHappened(1);

IF
DialogEnded(LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_SceneOver("LOW_CazadorsPalace_RitualRoom_BeforeRitual");
PROC_LOW_CazadorsPalace_RitualRoom_MakeRitualRoomHostile();

IF
DialogEnded(LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212, _, _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(LOW_CazadorsPalace_RitualRoom_State_RitualInProgress_95fe8bc3-21da-4741-a6dc-f5ccfd89be2a);

IF
DialogEnded(LOW_CazadorsPalace_RitualRoom_PreCombat_NoAstarion_061da20f-7611-e738-999b-ab05089626d6, _, _, _, _)
AND
DB_GlobalFlag(ORI_Astarion_State_NecroZombie_273d5473-cfd1-4fec-b1f5-a4db0ac4f4ed, _, _, _, _)
THEN
PROC_SceneOver("LOW_CazadorsPalace_RitualRoom_BeforeRitual");
PROC_LOW_CazadorsPalace_RitualRoom_MakeRitualRoomHostile();
PROC_GlobalSetFlagAndCache(LOW_CazadorsPalace_RitualRoom_State_RitualInProgress_95fe8bc3-21da-4741-a6dc-f5ccfd89be2a);

PROC
PROC_SceneOver("LOW_CazadorsPalace_RitualRoom_BeforeRitual", _, _, _, _)
THEN
SetFlag(ORI_Astarion_State_PreRitualSceneEnded_8e60ef2f-d3cc-49b2-a552-70a545caceed);
PROC_SpotPlayers_StopSpotting("LOW_CazadorsPalace_RitualRoom");
PROC_SpotPlayers_StopSpotting("LOW_CazadorsPalace_PreCombat_LookingForAstarion");

IF
EnteredCombat(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_CombatID(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
_Var2 != _Var1
THEN
NOT DB_LOW_CazadorsPalace_RitualRoom_CombatID(_Var2);

IF
EnteredCombat(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
DB_LOW_CazadorsPalace_RitualRoom_CombatID(_Var1);

IF
SwitchedCombat(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, (GUIDSTRING)_Var1, (GUIDSTRING)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_CombatID(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_CazadorsPalace_RitualRoom_CombatID(_Var1);
DB_LOW_CazadorsPalace_RitualRoom_CombatID(_Var2);

IF
CombatRoundStarted((GUIDSTRING)_Var1, (INTEGER)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_CombatID(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_LOW_CazadorsPalace_RitualRoom_AnyoneInCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_AdditionalMinions(_Var3, _Var2, _Var4, _Var1, _Var1)
AND
GetPosition(_Var4, _Var5, _Var6, _Var7, _Var1)
AND
CreateAt(_Var3, _Var5, _Var6, _Var7, 0, 1, "LOW_CazadorsPalace_RitualRoom_MinionSpawned", _, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_LOW_CazadorsPalace_RitualRoom_AnyoneInCombat((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Is_InCombat(_, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
EntityEvent((GUIDSTRING)_Var1, "LOW_CazadorsPalace_RitualRoom_MinionSpawned", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
THEN
SetCombatGroupID(_Var1, "LOW_CazadorsPalace_RitualRoom");

IF
FlagSet(LOW_CazadorsPalace_RitualRoom_State_RitualInProgress_95fe8bc3-21da-4741-a6dc-f5ccfd89be2a, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_BeginRitual();

PROC
PROC_LOW_CazadorsPalace_RitualRoom_BeginRitual()
THEN
SetFlag(LOW_CazadorsPalace_RitualRoom_State_CanProgressRitualInCombat_078a4b8e-cf26-4f2c-b4e1-efa07935f1be, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_BeginRitual()
AND
DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_EnableBeam(_Var1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_BeginRitual()
THEN
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyBuffs();

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyBuffs()
THEN
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyMainBuffs();
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyExtraBuffs();

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyMainBuffs()
AND
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_Var1, _Var2, _Var3, _Var1, _Var1)
THEN
NOT DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_Var1, _Var2, _Var3);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyMainBuffs()
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var1, _, _Var3, _Var4, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_ActivePentagrams(_Var3, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_CazadorsPalace_CheckPentagram(_Var4);

PROC
PROC_LOW_CazadorsPalace_CheckPentagram((TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1)
AND
IsInTrigger(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var1, 1, _Var1, _Var1)
THEN
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var1, 0);

PROC
PROC_LOW_CazadorsPalace_CheckPentagram((TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1)
AND NOT
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_, _Var1, _, _Var1, _Var1)
AND
DB_PartyMembers(_Var4, _Var1, _Var1, _Var1, _Var1)
AND
IsInTrigger(_Var4, _Var1, 1, _Var1, _Var1)
THEN
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_Var4, _Var1, 1);

PROC
PROC_LOW_CazadorsPalace_CheckPentagram((TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1)
AND NOT
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_, _Var1, _, _Var1, _Var1)
THEN
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var1, 0);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyMainBuffs()
AND
QRY_LOW_CazadorsPalace_RitualRoom_ResetBuffCounters()
AND
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_Var1, _Var2, _, _Var1, _Var1)
AND
QRY_LOW_CazadorsPalace_RitualRoom_IncreaseBuffsCounter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_LOW_CazadorsPalace_RitualRoom_ResetBuffCounters()
THEN
PROC_LOW_CazadorsPalace_RitualRoom_ClearBuffCounterDB();

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ClearBuffCounterDB()
AND
DB_LOW_CazadorsPalace_RitualRoom_OldNumOfBuffs(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_CazadorsPalace_RitualRoom_OldNumOfBuffs(_Var1, _Var2);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ClearBuffCounterDB()
AND
DB_LOW_CazadorsPalace_RitualRoom_NumOfBuffs(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
DB_LOW_CazadorsPalace_RitualRoom_OldNumOfBuffs(_Var1, _Var2);
NOT DB_LOW_CazadorsPalace_RitualRoom_NumOfBuffs(_Var1, _Var2);

QRY
QRY_LOW_CazadorsPalace_RitualRoom_IncreaseBuffsCounter((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_NumOfBuffs(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
IntegerSum(_Var2, 1, _Var3, _Var1, _Var1)
THEN
NOT DB_LOW_CazadorsPalace_RitualRoom_NumOfBuffs(_Var1, _Var2);
DB_LOW_CazadorsPalace_RitualRoom_NumOfBuffs(_Var1, _Var3);

QRY
QRY_LOW_CazadorsPalace_RitualRoom_IncreaseBuffsCounter((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_LOW_CazadorsPalace_RitualRoom_NumOfBuffs(_Var1, _, _Var1, _Var1, _Var1)
THEN
DB_LOW_CazadorsPalace_RitualRoom_NumOfBuffs(_Var1, 1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyMainBuffs()
AND
DB_LOW_CazadorsPalace_RitualRoom_OldNumOfBuffs(_Var1, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_LOW_CazadorsPalace_RitualRoom_NumOfBuffs(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Buffs(_Var2, _Var3, _, _Var1, _Var1)
THEN
RemoveStatus(_Var1, _Var3, NULL_00000000-0000-0000-0000-000000000000);
NOT DB_LOW_CazadorsPalace_RitualRoom_OldNumOfBuffs(_Var1, _Var2);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyMainBuffs()
AND
DB_LOW_CazadorsPalace_RitualRoom_NumOfBuffs(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_OldNumOfBuffs(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyMainBuffs()
AND
DB_LOW_CazadorsPalace_RitualRoom_NumOfBuffs(_Var1, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_LOW_CazadorsPalace_RitualRoom_OldNumOfBuffs(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Buffs(_Var2, _Var3, _, _Var1, _Var1)
THEN
ApplyStatus(_Var1, _Var3, -1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyExtraBuffs()
AND
DB_LOW_CazadorsPalace_RitualRoom_ExtraBuffs(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_AppliedExtraBuffs(_Var3, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_Var3, _Var1, _, _Var1, _Var1)
THEN
NOT DB_LOW_CazadorsPalace_RitualRoom_AppliedExtraBuffs(_Var3, _Var2);
RemoveStatus(_Var3, _Var2);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyExtraBuffs()
AND
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_Var1, _Var2, _, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_ExtraBuffs(_Var2, _Var4, _Var1, _Var1, _Var1)
AND NOT
DB_LOW_CazadorsPalace_RitualRoom_AppliedExtraBuffs(_Var1, _Var4, _Var1, _Var1, _Var1)
THEN
DB_LOW_CazadorsPalace_RitualRoom_AppliedExtraBuffs(_Var1, _Var4);
ApplyStatus(_Var1, _Var4, -1);

IF
StatusApplied(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, (STRING)_Var1, _, _, (STRING)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Buffs(_, _Var1, _Var5, _Var1, _Var1)
AND
HasActiveStatus(S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, _Var5, 0, _Var1, _Var1)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_ClearBeamFromSarcophagus();
ApplyStatus(S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, _Var5, -1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ClearBeamFromSarcophagus()
AND
DB_LOW_CazadorsPalace_RitualRoom_Buffs(_, _, _Var3, _, _)
AND
HasActiveStatus(S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, _Var3, 1, _, _)
THEN
RemoveStatus(S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, _Var3);

IF
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_, _Var2, _Var3, _, _)
AND
_Var3 == 0
THEN
PROC_LOW_CazadorsPalace_RitualRoom_DeactivateBuffToPlayerVFX(_Var2);
PROC_LOW_CazadorsPalace_RitualRoom_ActivateBuffToCazadorVFX(_Var2);

IF
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_, _Var2, _Var3, _, _)
AND
_Var3 == 1
THEN
PROC_LOW_CazadorsPalace_RitualRoom_ActivateBuffToPlayerVFX(_Var2);
PROC_LOW_CazadorsPalace_RitualRoom_DeactivateBuffToCazadorVFX(_Var2);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_DeactivateBuffToPlayerVFX((TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_, _, _Var4, _Var1, _Var1)
AND
HasActiveStatus(_Var4, "LOW_CAZADORSPALACE_PENTAGRAM_BUFF_GLOW", 1, _Var1, _Var1)
THEN
RemoveStatus(_Var4, "LOW_CAZADORSPALACE_PENTAGRAM_BUFF_GLOW");

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ActivateBuffToPlayerVFX((TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_, _, _Var4, _Var1, _Var1)
AND
HasActiveStatus(_Var4, "LOW_CAZADORSPALACE_PENTAGRAM_BUFF_GLOW", 0, _Var1, _Var1)
THEN
ApplyStatus(_Var4, "LOW_CAZADORSPALACE_PENTAGRAM_BUFF_GLOW", -1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_DeactivateBuffToCazadorVFX((TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Gratings(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
HasActiveStatus(_Var2, "LOW_CAZADORSPALACE_GRATING_BUFF_GLOW", 1, _Var1, _Var1)
THEN
RemoveStatus(_Var2, "LOW_CAZADORSPALACE_GRATING_BUFF_GLOW");

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ActivateBuffToCazadorVFX((TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Gratings(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
HasActiveStatus(_Var2, "LOW_CAZADORSPALACE_GRATING_BUFF_GLOW", 0, _Var1, _Var1)
THEN
ApplyStatus(_Var2, "LOW_CAZADORSPALACE_GRATING_BUFF_GLOW", -1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_EnableBeam((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var1, _, _Var3, _, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
ApplyStatus(_Var1, "LOW_CAZADORSPALACE_BEAM_TO_PENTAGRAM", -1, 1, _Var3);
ApplyStatus(_Var3, "LOW_CAZADORSPALACE_PENTAGRAM_ACTIVATED", -1);
DB_LOW_CazadorsPalace_RitualRoom_ActivePentagrams(_Var3);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_StopRitual()
AND NOT
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_RitualCompleted_7edf33ff-b185-46ed-b4d8-546c8a016387, _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(LOW_CazadorsPalace_RitualRoom_State_RitualCancelled_989b59f6-b4e3-4236-a8d0-a694fddde5d4);

IF
FlagSet(ORI_Astarion_State_CazadorPermaDefeated_5258c8d8-09a3-4343-bb6e-13ff5b8e3438, _, _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var3, _, _, _, _)
AND
HasActiveStatus(_Var3, "LOW_CAZADORSPALACE_RITUAL_CRYSTALLISED", 1, _, _)
THEN
RemoveStatus(_Var3, "LOW_CAZADORSPALACE_RITUAL_CRYSTALLISED", NULL_00000000-0000-0000-0000-000000000000);

IF
StatusRemoved((GUIDSTRING)_Var1, "LOW_CAZADORSPALACE_RITUAL_CRYSTALLISED", NULL_00000000-0000-0000-0000-000000000000, _, (GUIDSTRING)_Var1)
AND NOT
DB_GlobalFlag(ORI_Astarion_State_CazadorPermaDefeated_5258c8d8-09a3-4343-bb6e-13ff5b8e3438, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_RitualInProgress_95fe8bc3-21da-4741-a6dc-f5ccfd89be2a, _Var1, _Var1, _Var1, _Var1)
THEN
ApplyStatus(_Var1, "LOW_CAZADORSPALACE_RITUAL_INCAPACITATED", -1, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
StatusRemoved((GUIDSTRING)_Var1, "LOW_CAZADORSPALACE_RITUAL_CRYSTALLISED", NULL_00000000-0000-0000-0000-000000000000, _, (GUIDSTRING)_Var1)
AND
DB_GlobalFlag(ORI_Astarion_State_CazadorPermaDefeated_5258c8d8-09a3-4343-bb6e-13ff5b8e3438, _Var1, _Var1, _Var1, _Var1)
THEN
ApplyStatus(_Var1, "LOW_CAZADORSPALACE_RITUAL_DAZED", -1, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
DB_GlobalFlag(ORI_Astarion_State_CazadorPermaDefeated_5258c8d8-09a3-4343-bb6e-13ff5b8e3438, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var1, _, _, _, _Var1)
AND
HasActiveStatus(_Var1, "LOW_CAZADORSPALACE_RITUAL_INCAPACITATED", 1, _Var1, _Var1)
THEN
RemoveStatus(_Var1, "LOW_CAZADORSPALACE_RITUAL_INCAPACITATED", NULL_00000000-0000-0000-0000-000000000000);
ApplyStatus(_Var1, "LOW_CAZADORSPALACE_RITUAL_DAZED", -1, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
StatusApplied((CHARACTER)_Var1, "LOW_CAZADORSPALACE_RITUAL_DAZED", _, _, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_SpawnDialogs(_Var1, _Var4, _Var1, _Var1, _Var1)
THEN
DB_Dialogs(_Var1, _Var4);
DB_GlobalFlagReactionAfterDialog(LOW_CazadorsPalace_RitualRoom_State_LetSpawnsLeave_db2fa5ac-0fb9-46da-add9-f01db1d9e479, _Var4);
DB_GlobalFlagReactionAfterDialog(LOW_CazadorsPalace_RitualRoom_State_AttackedSpawns_c304d348-bc99-444b-b3c8-a11b795c75f7, _Var4);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_StopRitual()
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var1, _, _, _, _Var1)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_DisableBeam(_Var1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_StopRitual()
AND
DB_LOW_CazadorsPalace_RitualRoom_RitualIndicators(_Var1, _, _Var1, _Var1, _Var1)
THEN
RemoveStatus(_Var1, "LOW_CAZADORSPALACE_SCRIPTURE_GLOWING");

PROC
PROC_LOW_CazadorsPalace_RitualRoom_StopRitual()
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_, _, _, _Var4, _)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_DeactivateBuffToPlayerVFX(_Var4);
PROC_LOW_CazadorsPalace_RitualRoom_DeactivateBuffToCazadorVFX(_Var4);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_StopRitual()
THEN
PROC_LOW_CazadorsPalace_RitualRoom_ClearBeamFromSarcophagus();

PROC
PROC_LOW_CazadorsPalace_RitualRoom_StopRitual()
AND
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_Var1, _Var2, _Var3, _Var1, _Var1)
THEN
NOT DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_Var1, _Var2, _Var3);
PROC_LOW_CazadorsPalace_RitualRoom_ClearMainBuffs(_Var1);
PROC_LOW_CazadorsPalace_RitualRoom_ClearExtraBuffs(_Var1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ClearMainBuffs((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Buffs(_, _Var3, _, _Var1, _Var1)
AND
HasActiveStatus(_Var1, _Var3, 1, _Var1, _Var1)
THEN
RemoveStatus(_Var1, _Var3, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ClearExtraBuffs((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_AppliedExtraBuffs(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_CazadorsPalace_RitualRoom_AppliedExtraBuffs(_Var1, _Var2);
RemoveStatus(_Var1, _Var2);

IF
EnteredTrigger((CHARACTER)_Var1, (TRIGGER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_, _, _Var5, _Var2, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_ActivePentagrams(_Var5, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_LOW_CazadorsPalace_RitualRoom_PentagramTakenByCazador(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_, _Var2, 1, _Var1, _Var1)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyBuffs();

PROC
PROC_StateCleared_Defeated((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_, _, _Var4, _Var5, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_ActivePentagrams(_Var4, _Var1, _Var1, _Var1, _Var1)
AND
IsInTrigger(_Var1, _Var5, 1, _Var1, _Var1)
AND NOT
QRY_LOW_CazadorsPalace_RitualRoom_PentagramTakenByCazador(_Var5, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_, _Var5, 1, _Var1, _Var1)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyBuffs();

QRY
QRY_LOW_CazadorsPalace_RitualRoom_PentagramTakenByCazador((TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1, (TRIGGER)_Var1)
AND
IsInTrigger(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var1, 1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_, _Var1, 0, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
LeftTrigger((CHARACTER)_Var1, (TRIGGER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_, _, _Var5, _Var2, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_ActivePentagrams(_Var5, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_Var1, _Var2, _, _Var1, _Var1)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyBuffs();

PROC
PROC_StateCleared_Defeated((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_TakenPentagrams(_Var1, _, 1, _Var1, _Var1)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyBuffs();

IF
DB_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var1, _, _, _, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_RitualInProgress_95fe8bc3-21da-4741-a6dc-f5ccfd89be2a, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_DisableBeam(_Var1);
PROC_LOW_CazadorsPalace_RitualRoom_ReapplyBuffs();

PROC
PROC_LOW_CazadorsPalace_RitualRoom_DisableBeam((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var1, _, _Var3, _, _Var1)
THEN
RemoveStatus(_Var1, "LOW_CAZADORSPALACE_BEAM_TO_PENTAGRAM");
RemoveStatus(_Var3, "LOW_CAZADORSPALACE_PENTAGRAM_ACTIVATED");
NOT DB_LOW_CazadorsPalace_RitualRoom_ActivePentagrams(_Var3);

IF
DB_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var1, _, _, _, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(_Var1);

IF
EntityEvent((GUIDSTRING)_Var1, "LOW_CazadorsPalace_RitualRoom_EnableRitualIndicator", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
HasActiveStatus(_Var1, "LOW_CAZADORSPALACE_SCRIPTURE_GLOWING", 0, _Var1, _Var1)
THEN
ApplyStatus(_Var1, "LOW_CAZADORSPALACE_SCRIPTURE_GLOWING", -1);

IF
EntityEvent(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CazadorsPalace_RitualRoom_Ascended", _, _, _)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_RitualInProgress_95fe8bc3-21da-4741-a6dc-f5ccfd89be2a, _, _, _, _)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_CompleteRitual(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);

IF
FlagSet(ORI_Astarion_State_StayedVampireSpawn_2724b881-6be1-49a7-8375-a49e9acb4546, NULL_00000000-0000-0000-0000-000000000000, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
THEN
SetFlag(LOW_CazadorsPalace_RitualRoom_Event_KillCazador_d0ae6721-9927-405c-a98c-f3930506f611, NULL_00000000-0000-0000-0000-000000000000, _Var1);
SetFlag(LOW_CazadorsPalace_RitualRoom_Event_KillCazadorWithClear_9253fd5b-c5b9-4621-893c-3fc1f36db6bd, NULL_00000000-0000-0000-0000-000000000000, _Var1);

IF
FlagSet(ORI_Astarion_State_BecameVampireLord_c446ce94-efd8-45d5-b407-284177b6b57e, NULL_00000000-0000-0000-0000-000000000000, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
THEN
SetFlag(LOW_CazadorsPalace_RitualRoom_Event_KillCazador_d0ae6721-9927-405c-a98c-f3930506f611, NULL_00000000-0000-0000-0000-000000000000, _Var1);
SetFlag(LOW_CazadorsPalace_RitualRoom_Event_KillCazadorWithClear_9253fd5b-c5b9-4621-893c-3fc1f36db6bd, NULL_00000000-0000-0000-0000-000000000000, _Var1);

IF
FlagSet(ORI_Astarion_State_BecameVampireLord_c446ce94-efd8-45d5-b407-284177b6b57e, NULL_00000000-0000-0000-0000-000000000000, _, (INTEGER)_, (INTEGER)_)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_CompleteRitual(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_CompleteRitual((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
NOT DB_CombatReact_AD_StatusRemoved(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, LOW_CazadorsPalace_RitualRoom_AD_BuffRemoved_001_Combat_ee4a186e-2009-f47a-be12-cfd4462a4219, "LOW_CAZADORSPALACE_SPAWNBUFF_007");
NOT DB_CombatReact_AD_StatusRemoved(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, LOW_CazadorsPalace_RitualRoom_AD_BuffRemoved_002_Combat_2c442107-0d6c-1133-344e-f8fb1e304d00, "LOW_CAZADORSPALACE_SPAWNBUFF_006");
PROC_GlobalSetFlagAndCache(LOW_CazadorsPalace_RitualRoom_State_RitualCompleted_7edf33ff-b185-46ed-b4d8-546c8a016387);
PROC_LOW_CazadorsPalace_RitualRoom_StopRitual();
PROC_LOW_CazadorsPalace_RitualRoom_KillSpawns(_Var1);
PROC_LOW_CazadorsPalace_RitualRoom_KillPrisoners();

PROC
PROC_LOW_CazadorsPalace_RitualRoom_KillPrisoners()
AND
DB_LOW_CazadorsPalace_Cells_Prisoners(_Var1, _, _, _Var1, _Var1)
AND
HasActiveStatus(_Var1, "LOW_CAZADORSPALACE_PRISONER_INVULNERABILITY", 1, _Var1, _Var1)
THEN
RemoveStatus(_Var1, "LOW_CAZADORSPALACE_PRISONER_INVULNERABILITY", NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_KillPrisoners()
AND
DB_LOW_CazadorsPalace_Cells_Prisoners(_Var1, _, 1, _Var1, _Var1)
THEN
PROC_Children_RemoveNPC(_Var1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_KillPrisoners()
AND
DB_LOW_CazadorsPalace_Cells_Prisoners(_Var1, _, _, _Var1, _Var1)
THEN
DB_DialogDeath(_Var1);
Die(_Var1, 0, NULL_00000000-0000-0000-0000-000000000000, 0, 0, 1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_KillSpawns(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var1, _, _, _, _Var1)
THEN
DB_DialogDeath(_Var1);
Die(_Var1, 0, NULL_00000000-0000-0000-0000-000000000000, 1, 0, 1);
SetTag(_Var1, BLOCK_RESURRECTION_22a75dbb-1588-407e-b559-5aa4e6d4e6a6);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_KillSpawns(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var1, _, _, _, _Var1)
AND
_Var1 != S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255
THEN
DB_DialogDeath(_Var1);
Die(_Var1, 0, NULL_00000000-0000-0000-0000-000000000000, 1, 0, 1);
SetTag(_Var1, BLOCK_RESURRECTION_22a75dbb-1588-407e-b559-5aa4e6d4e6a6);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_CompleteRitual(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(LOW_CazadorsPalace_RitualRoom_State_CazadorAscended_68cf8d54-b6f2-468b-925d-5f4610e93c04);
PROC_LOW_CazadorsPalace_RitualRoom_AstarionSacrificed();
ObjectSetTitle(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CazadorsPalace_Ascendant");
SetHitpointsPercentage(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 100);
RemoveHarmfulStatuses(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_CompleteRitual(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _, _, _, _)
AND
HasActiveStatus(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CAZADORSPALACE_ASCENSION_BUFF", 0, _, _)
THEN
ApplyStatus(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CAZADORSPALACE_ASCENSION_BUFF", -1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_AstarionSacrificed()
AND
DB_Avatars(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
THEN
ShowGameOverMenu();
DB_NOOP(1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_AstarionSacrificed()
AND NOT
DB_Avatars(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
THEN
PROC_Origins_CompanionLeavePermanently(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "AstarionSacrificed");

PROC
PROC_LOW_CazadorsPalace_RitualRoom_CompleteRitual(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
THEN
AddPassive(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_Astarion_VampireAscendant");

IF
FlagSet(LOW_CazadorsPalace_RitualRoom_State_ReleasedPrisoners_5784cf70-bff9-467c-b150-39d1f5a78240, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_ReleasePrisoners();

IF
FlagSet(LOW_CazadorsPalace_RitualRoom_State_KilledPrisoners_a138792f-04ae-410b-afce-1bf661e9c868, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_KillPrisoners();

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ReleasePrisoners()
AND
DB_LOW_CazadorsPalace_Cells_Prisoners(_Var1, _, _, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var1, 0);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_ReleasePrisoners()
AND
DB_LOW_CazadorsPalace_CellsDoors(_Var1, _, _, _Var1, _Var1)
THEN
PROC_LOW_CazadorsPalace_Dungeon_OpenDoor(_Var1);

IF
DB_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var1, _, _, _, _Var1)
AND NOT
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_RitualCompleted_7edf33ff-b185-46ed-b4d8-546c8a016387, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GlobalSetFlagAndCache(LOW_CazadorsPalace_RitualRoom_State_RitualCannotBeCompleted_71cb0aae-aea2-4304-9932-4c57bf6669a8);

IF
DB_PermaDefeated(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _, _, _, _)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_RitualInProgress_95fe8bc3-21da-4741-a6dc-f5ccfd89be2a, _, _, _, _)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_StopRitual();

IF
HitpointsChanged(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 0, _, _, _)
AND
IsImmortal(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 1, _, _, _)
THEN
PROC_LOW_CazadorsPalace_SendCazadorToCoffin();

PROC
PROC_LOW_CazadorsPalace_SendCazadorToCoffin()
THEN
PROC_SelfHealing_Disable(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);
SetCanJoinCombat(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 0);
SetCanFight(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 0);
LeaveCombat(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);
RemoveHarmfulStatuses(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);
PROC_GlobalSetFlagAndCache(LOW_CazadorsPalace_RitualRoom_State_CazadorInCoffin_15322f0b-da2e-48f8-b7d0-a6418c58893c);
NOT DB_CustomDialogRange(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 50);
DB_CustomDialogRange(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 10000);
ApplyStatus(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CAZADORSPALACE_CAZADOR_MISTY_ESCAPE", 6);

IF
StatusAttemptFailed(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CAZADORSPALACE_CAZADOR_MISTY_ESCAPE", _, _, (GUIDSTRING)_)
THEN
PROC_Poof(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, VFX_Script_VampireSpawn_Disappearing_BodyFX_01_a65c2389-2ab4-1ec4-57b6-84087d529d1e);
ApplyStatus(S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, "LOW_CAZADORSPALACE_SARCOPHAGUS_AURA", -1);
TeleportTo(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, S_LOW_CazadorsPalace_RitualRoom_AsylumPos_5a9de1d3-dbfa-4796-96f5-973cee523b32, "LOW_CazadorsPalace_CazadorTeleportedToAsylum");

IF
StatusApplied(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CAZADORSPALACE_CAZADOR_MISTY_ESCAPE", _, _, (GUIDSTRING)_)
THEN
Freeze(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);
ApplyStatus(S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, "LOW_CAZADORSPALACE_CAZADOR_MISTY_ESCAPE_BEAM", 6, 1, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);
RealtimeObjectTimerLaunch(S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, "LOW_CazadorsPalace_EnableCoffinVFX", 1500);

IF
StatusAttemptFailed(S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, "LOW_CAZADORSPALACE_CAZADOR_MISTY_ESCAPE_BEAM", _, _, (GUIDSTRING)_)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_CazadorInCoffin();

IF
StatusApplied(S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, "LOW_CAZADORSPALACE_CAZADOR_MISTY_ESCAPE_BEAM", _, _, (GUIDSTRING)_)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_CazadorInCoffin();

PROC
PROC_LOW_CazadorsPalace_RitualRoom_CazadorInCoffin()
THEN
PROC_SetOnStage(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 0);
TeleportTo(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, S_LOW_CazadorsPalace_RitualRoom_AsylumPos_5a9de1d3-dbfa-4796-96f5-973cee523b32, "LOW_CazadorsPalace_CazadorTeleportedToAsylum");
Unfreeze(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);

IF
ObjectTimerFinished(S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, "LOW_CazadorsPalace_EnableCoffinVFX", _, _, _)
THEN
ApplyStatus(S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, "LOW_CAZADORSPALACE_SARCOPHAGUS_AURA", -1);

IF
EntityEvent(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CazadorsPalace_CazadorTeleportedToAsylum", _, _, _)
THEN
PROC_SetOnStage(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 1);
SetHitpoints(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 1);
RemoveHarmfulStatuses(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);

IF
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_CazadorInCoffin_15322f0b-da2e-48f8-b7d0-a6418c58893c, _, _, _, _)
AND
HasAppliedStatus(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CAZADORSPALACE_RITUAL_INCAPACITATED", 1, _, _)
THEN
RemoveStatus(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CAZADORSPALACE_RITUAL_INCAPACITATED", NULL_00000000-0000-0000-0000-000000000000);

IF
StatusApplied(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CAZADORSPALACE_RITUAL_INCAPACITATED", _, _, _)
AND
GetFaction(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _Var3, _, _, _)
THEN
DB_LOW_CazadorsPalace_RitualRoom_AstarionsFaction(_Var3);
SetFaction(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, Act3_LOW_CazadorsPalace_RitualRoom_Spawns_128ae9fe-23a3-4fb3-bb67-24b925290f8d);

IF
StatusRemoved(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CAZADORSPALACE_RITUAL_INCAPACITATED", _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_AstarionsFaction(_Var3, _, _, _, _)
THEN
NOT DB_LOW_CazadorsPalace_RitualRoom_AstarionsFaction(_Var3);
SetFaction(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _Var3);

IF
StatusRemoved(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CAZADORSPALACE_RITUAL_INCAPACITATED", _, _, _)
AND NOT
DB_CantAct(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
THEN
PROC_EnterCombat(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);

PROC
PROC_BlockUseOfItem((CHARACTER)_Var1, S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_CazadorInCoffin_15322f0b-da2e-48f8-b7d0-a6418c58893c, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Is_InCombat(_Var1, _, _Var1, _Var1, _Var1)
THEN
DB_CustomUseItemResponse(_Var1, S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, 0);
PROC_LOW_CazadorsPalace_RitualRoom_StartDialogWithCoffin(_Var1);

PROC
PROC_BlockUseOfItem((CHARACTER)_Var1, S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_CazadorInCoffin_15322f0b-da2e-48f8-b7d0-a6418c58893c, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var1, _, _Var1, _Var1, _Var1)
THEN
PROC_PlayCantUseItemAD(_Var1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_StartDialogWithCoffin((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_StartDialog(LOW_CazadorsPalace_Coffin_826f2df8-33c9-db18-6b87-0ca5755c9c09, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var1, S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_OriginMoments_SpeakerIsAvailableAndInDialogRange((CHARACTER)_Var1, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, LOW_CazadorsPalace_Coffin_826f2df8-33c9-db18-6b87-0ca5755c9c09, (CHARACTER)_Var1)
AND
GetDistanceTo(_Var1, S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, _Var2, _Var1, _Var1)
AND
QRY_SpeakerIsAvailable(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var2 < 60
THEN
DB_NOOP(1);

IF
DialogStarted(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
HasAppliedStatus(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CAZADORSPALACE_RITUAL_INCAPACITATED", 1, _Var1, _Var1)
THEN
RemoveStatus(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CAZADORSPALACE_RITUAL_INCAPACITATED", NULL_00000000-0000-0000-0000-000000000000);

QRY
QRY_OriginMoment_PreventRelaunchDialog(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
DB_NOOP(1);

IF
FlagSet(ORI_Astarion_State_CazadorPermaDefeated_5258c8d8-09a3-4343-bb6e-13ff5b8e3438, NULL_00000000-0000-0000-0000-000000000000, _, (INTEGER)_, (INTEGER)_)
THEN
NOT DB_OriginMoment_DontAutoClearOriginMoment(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b);

PROC
PROC_GlobalFlagReactionAfterDialog(LOW_CazadorsPalace_RitualRoom_Event_KillCazador_d0ae6721-9927-405c-a98c-f3930506f611, _, _, _, _)
THEN
NOT DB_OriginMoment_DontAutoClearOriginMoment(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b);

PROC
PROC_GlobalFlagReactionAfterDialog(LOW_CazadorsPalace_RitualRoom_Event_KillCazador_d0ae6721-9927-405c-a98c-f3930506f611, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_CazadorsPalace_Cells_State_OMHappened_58ce1207-c80e-462d-8a6a-48e1cd0b2fd4, _, _, _, _)
THEN
PROC_SpotPlayers_StopSpotting("LOW_CazadorsPalace_Cells");
PROC_ClearOriginMoment(LOW_CazadorsPalace_Cells_OM_Astarion_AOM_OOM_ab54e585-5764-e180-9c2d-507eb4824c48);
PROC_ClearOriginMoment(LOW_CazadorsPalace_Cells_OM_Astarion_COM_00b72133-ddb8-d587-e7cc-761d9079317d);

PROC
PROC_GlobalFlagReactionAfterDialog(LOW_CazadorsPalace_RitualRoom_Event_KillCazador_d0ae6721-9927-405c-a98c-f3930506f611, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_KilledPrisoners_a138792f-04ae-410b-afce-1bf661e9c868, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_ReleasedPrisoners_5784cf70-bff9-467c-b150-39d1f5a78240, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_LeftPrisonersRot_52cc991c-1d18-4d84-ab28-61e21ac958b5, _, _, _, _)
AND NOT
DB_GlobalFlag(ORI_Astarion_State_BecameVampireLord_c446ce94-efd8-45d5-b407-284177b6b57e, _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(LOW_CazadorsPalace_RitualRoom_State_LeftPrisonersRot_52cc991c-1d18-4d84-ab28-61e21ac958b5);

IF
FlagSet(ORI_Astarion_State_CazadorPermaDefeated_5258c8d8-09a3-4343-bb6e-13ff5b8e3438, _, _, _, _)
AND
DB_GlobalFlag(ORI_Astarion_State_NecroZombie_273d5473-cfd1-4fec-b1f5-a4db0ac4f4ed, _, _, _, _)
AND NOT
DB_PermaDefeated(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
THEN
Die(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, 0, NULL_00000000-0000-0000-0000-000000000000, 1, 0, 1);

IF
FlagSet(LOW_CazadorsPalace_RitualRoom_Event_GivePlayerCazadorsStaff_d347bcc5-2e68-4d7e-a22d-c97f4412da67, (GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
GetItemByTemplateInInventory(MAG_LC_CazadorVampiric_Quarterstaff_cf42b0d0-89d8-4756-b6d7-1e258dceeab0, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var3, _Var1, _Var1)
THEN
ToInventory(_Var3, _Var1, 1, 1, 1);

IF
FlagSet(LOW_CazadorsPalace_RitualRoom_State_LeftPrisonersRot_52cc991c-1d18-4d84-ab28-61e21ac958b5, (GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
GetItemByTemplateInInventory(MAG_LC_CazadorVampiric_Quarterstaff_cf42b0d0-89d8-4756-b6d7-1e258dceeab0, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var3, _Var1, _Var1)
THEN
ToInventory(_Var3, S_LOW_CazadorsPalace_RitualRoom_StaffContainer_f0f8521d-77f6-4ce2-b211-9562a2cd7e4d, 1, 0, 1);

IF
DialogStarted(LOW_CazadorsPalace_Coffin_826f2df8-33c9-db18-6b87-0ca5755c9c09, _, _, _, _)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_CazadorInCoffin_15322f0b-da2e-48f8-b7d0-a6418c58893c, _, _, _, _)
THEN
RemoveStatus(S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, "LOW_CAZADORSPALACE_SARCOPHAGUS_AURA");

IF
DialogStarted(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, _, _, _, _)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_CazadorInCoffin_15322f0b-da2e-48f8-b7d0-a6418c58893c, _, _, _, _)
THEN
RemoveStatus(S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, "LOW_CAZADORSPALACE_SARCOPHAGUS_AURA");

IF
DialogStarted(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_GlobalSetFlagAndCache(LOW_CazadorsPalace_RitualRoom_State_PostCombatOMInProgress_df9626cc-5a9f-4e38-bad1-c7d1553ced14);

IF
DialogEnded(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, _, _, _, _)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_PostCombatOMInProgress_df9626cc-5a9f-4e38-bad1-c7d1553ced14, _, _, _, _)
THEN
PROC_GlobalClearFlagAndCache(LOW_CazadorsPalace_RitualRoom_State_PostCombatOMInProgress_df9626cc-5a9f-4e38-bad1-c7d1553ced14);

PROC
PROC_GlobalFlagReactionAfterDialog(LOW_CazadorsPalace_RitualRoom_State_AttackedSpawns_c304d348-bc99-444b-b3c8-a11b795c75f7, _, _, _, _)
THEN
PROC_SetRelationToPlayers(Act3_LOW_CazadorsPalace_RitualRoom_Spawns_128ae9fe-23a3-4fb3-bb67-24b925290f8d, 0);

IF
DialogEnded(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND NOT
DB_GlobalFlag(ORI_Astarion_State_BecameVampireLord_c446ce94-efd8-45d5-b407-284177b6b57e, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_SpawnsLeftInCinematic_25a1be30-b998-4b26-8e0e-7571cd3ece23, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_SpawnDialogs(_Var2, _, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var2, 0);

IF
DialogEnded(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND NOT
DB_GlobalFlag(ORI_Astarion_State_BecameVampireLord_c446ce94-efd8-45d5-b407-284177b6b57e, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_SpawnsLeftInCinematic_25a1be30-b998-4b26-8e0e-7571cd3ece23, _Var1, _Var1, _Var1, _Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_SpawnDialogs(_Var2, _, _Var1, _Var1, _Var1)
THEN
PROC_DisappearOutOfSightTo(_Var2, S_LOW_CazadorsPalace_RitualRoom_SpawnDisappearPos_569c8fc4-b125-41ce-8905-f276f0b7c776, "Sprint", 1, "");

PROC
PROC_GlobalFlagReactionAfterDialog(LOW_CazadorsPalace_RitualRoom_State_LetSpawnsLeave_db2fa5ac-0fb9-46da-add9-f01db1d9e479, _, _, _, _)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_SpawnsLeave();

PROC
PROC_LOW_CazadorsPalace_RitualRoom_SpawnsLeave()
AND
DB_LOW_CazadorsPalace_RitualRoom_SpawnDialogs(_Var1, _, _Var1, _Var1, _Var1)
THEN
PROC_NotifyWhenReadyToMoveOn(_Var1, "LOW_CazadorsPalace_RitualRoom_SpawnReadyToLeave");

PROC
PROC_ReadyToMoveOn((CHARACTER)_Var1, "LOW_CazadorsPalace_RitualRoom_SpawnReadyToLeave", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_DisappearOutOfSight(_Var1, "Run", 0, "");

PROC
PROC_LongRest()
AND
DB_GlobalFlag(ORI_Astarion_State_CazadorPermaDefeated_5258c8d8-09a3-4343-bb6e-13ff5b8e3438, _, _, _, _)
AND
QRY_OnlyOnce("LOW_CazadorsPalace_CheckRemoveSpawns", _, _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_SpawnDialogs(_Var1, _, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var1, 0);

PROC
PROC_LongRest()
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_CazadorInCoffin_15322f0b-da2e-48f8-b7d0-a6418c58893c, _, _, _, _)
THEN
PROC_SelfHealing_Enable(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);
SetCanJoinCombat(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 1);
SetCanFight(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 1);
SetHitpointsPercentage(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 100);
PROC_GlobalClearFlagAndCache(LOW_CazadorsPalace_RitualRoom_State_CazadorInCoffin_15322f0b-da2e-48f8-b7d0-a6418c58893c);
NOT DB_CustomDialogRange(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 10000);
TeleportTo(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, S_LOW_CazadorsPalace_RitualRoom_CazadorsDefaultPos_a3a70d4c-8ab8-4835-9a72-9b0eefb1b1e3);

PROC
PROC_StartDialog_AddExtraSpeakers(LOW_CazadorsPalace_Coffin_826f2df8-33c9-db18-6b87-0ca5755c9c09, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_LOW_CazadorsPalace_Cells_Prisoner_001_5f39e17d-28dc-4d48-8370-91bb41098c44);
PROC_DialogAddSpeakingActor(_Var1, S_LOW_CazadorsPalace_Cells_Prisoner_002_4f062990-71e8-4c38-a66c-f5b623d5c0b8);
PROC_DialogAddSpeakingActor(_Var1, S_LOW_CazadorsPalace_Cells_Prisoner_003_bf2bc6f6-3fad-4b81-848d-f60a32852c9e);
PROC_DialogAddSpeakingActor(_Var1, S_LOW_CazadorsPalace_Cells_Prisoner_004_98b38439-05d9-4e25-a270-5005222869b9);

PROC
PROC_StartDialog_AddExtraSpeakers(LOW_CazadorsPalace_RitualRoom_PreCombat_OM_Astarion_AOM_COM_OOM_6f574f0c-848b-522f-b104-1e1488b2e212, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_LOW_CazadorsPalace_RitualRoom_Spawn_001_062ff971-d709-4f54-bb03-51c02844eacb);
PROC_DialogAddSpeakingActor(_Var1, S_LOW_CazadorsPalace_RitualRoom_Spawn_002_a612de01-a750-491a-bacd-e09a67fc0de3);
PROC_DialogAddSpeakingActor(_Var1, S_LOW_CazadorsPalace_RitualRoom_Spawn_003_52ede1c9-6caf-4f7a-8d97-984c0e90e9cf);
PROC_DialogAddSpeakingActor(_Var1, S_LOW_CazadorsPalace_RitualRoom_Spawn_004_a4dc8e21-833c-4469-a72b-1969c688b8a4);

PROC
PROC_StartDialog_AddExtraSpeakers(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, S_LOW_CazadorsPalace_Cells_Prisoner_001_5f39e17d-28dc-4d48-8370-91bb41098c44);
PROC_DialogAddSpeakingActor(_Var1, S_LOW_CazadorsPalace_Cells_Prisoner_002_4f062990-71e8-4c38-a66c-f5b623d5c0b8);

PROC
PROC_StartDialog_AddExtraSpeakers(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_PostCombatAdditionalSpeakers(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_DialogAddSpeakingActor(_Var1, _Var2);

IF
TextEvent("cp_getstaff", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetItemByTemplateInInventory(MAG_LC_CazadorVampiric_Quarterstaff_cf42b0d0-89d8-4756-b6d7-1e258dceeab0, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var2, _Var1, _Var1)
THEN
ToInventory(_Var2, _Var1, 1, 1, 1);

IF
TextEvent("cp_hideminions", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Minions(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SetOnStage(_Var1, 0);

IF
TextEvent("cp_disableritual", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spotters(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SpotPlayers_StopSpotting("LOW_CazadorsPalace_RitualRoom");

IF
TextEvent("cp_disableritual", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Minions(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SpotPlayers_StopSpotting("LOW_CazadorsPalace_RitualRoom");

IF
TextEvent("cp_enableritual", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spotters(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SpotPlayers_RestartSpotting(_Var1, "LOW_CazadorsPalace_RitualRoom");

IF
TextEvent("cp_enableritual", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Minions(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SpotPlayers_RestartSpotting(_Var1, "LOW_CazadorsPalace_RitualRoom");

IF
TextEvent("cp_beam_to_p_on", _, _, _, _)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_EnableBeam(S_LOW_CazadorsPalace_RitualRoom_Spawn_001_062ff971-d709-4f54-bb03-51c02844eacb);

IF
TextEvent("cp_beam_to_p_off", _, _, _, _)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_DisableBeam(S_LOW_CazadorsPalace_RitualRoom_Spawn_001_062ff971-d709-4f54-bb03-51c02844eacb);

IF
TextEvent("cp_beam_to_c_on", _, _, _, _)
THEN
ApplyStatus(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CAZADORSPALACE_SPAWNBUFF_001", -1, 1, S_LOW_CazadorsPalace_RitualRoom_Rune_001_9a8d7873-f550-4c1f-a4fd-dba3262422e8);

IF
TextEvent("cp_beam_to_c_off", _, _, _, _)
THEN
RemoveStatus(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CAZADORSPALACE_SPAWNBUFF_001");

IF
TextEvent("cp_beam_to_s_on", _, _, _, _)
THEN
ApplyStatus(S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, "LOW_CAZADORSPALACE_CAZADOR_MISTY_ESCAPE_BEAM", 6, 1, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);

IF
TextEvent("cp_beam_to_s_off", _, _, _, _)
THEN
RemoveStatus(S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, "LOW_CAZADORSPALACE_CAZADOR_MISTY_ESCAPE_BEAM");

IF
TextEvent("cp_to_coffin", _, _, _, _)
THEN
ApplyStatus(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CAZADORSPALACE_CAZADOR_MISTY_ESCAPE", 6, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
TextEvent("cp_from_coffin", _, _, _, _)
THEN
RemoveStatus(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CAZADORSPALACE_CAZADOR_MISTY_ESCAPE");

IF
TextEvent("cp_scripture_on", _, _, _, _)
THEN
ApplyStatus(S_LOW_CazadorsPalace_RitualRoom_RoundIndicator_001_09f0b7a5-3b7b-4bc1-b844-3e7e07db9e6a, "LOW_CAZADORSPALACE_SCRIPTURE_GLOWING", -1);

IF
TextEvent("cp_scripture_off", _, _, _, _)
THEN
RemoveStatus(S_LOW_CazadorsPalace_RitualRoom_RoundIndicator_001_09f0b7a5-3b7b-4bc1-b844-3e7e07db9e6a, "LOW_CAZADORSPALACE_SCRIPTURE_GLOWING");

IF
TextEvent("cp_beginritual", _, _, _, _)
THEN
SetFlag(LOW_CazadorsPalace_RitualRoom_State_RitualInProgress_95fe8bc3-21da-4741-a6dc-f5ccfd89be2a);

IF
TextEvent("cp_endritual", _, _, _, _)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_StopRitual();

IF
TextEvent("cp_addgurhunter", _, _, _, _)
THEN
PROC_DebugBook_AddGurHunterToGurTribe();

IF
TextEvent("cp_killcazador", _, _, _, _)
THEN
SetImmortal(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 0);
Die(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 0, NULL_00000000-0000-0000-0000-000000000000, 1, 0, 1);

IF
TextEvent("cp_om", _, _, _, _)
THEN
DB_OriginDialog(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b);

IF
TextEvent("cp_ind1", _, _, _, _)
THEN
SetEntityEvent(S_LOW_CazadorsPalace_RitualRoom_RoundIndicator_001_09f0b7a5-3b7b-4bc1-b844-3e7e07db9e6a, "LOW_CazadorsPalace_RitualRoom_EnableRitualIndicator");

IF
TextEvent("cp_ind2", _, _, _, _)
THEN
SetEntityEvent(S_LOW_CazadorsPalace_RitualRoom_RoundIndicator_002_442f7c8a-2282-419d-9de3-8b15175046ed, "LOW_CazadorsPalace_RitualRoom_EnableRitualIndicator");

IF
TextEvent("cp_ind3", _, _, _, _)
THEN
SetEntityEvent(S_LOW_CazadorsPalace_RitualRoom_RoundIndicator_003_a695ea65-f76c-44e5-a1eb-a553c533c276, "LOW_CazadorsPalace_RitualRoom_EnableRitualIndicator");

IF
TextEvent("cp_pcd_c", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255
AND NOT
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_Debug_LOW_CazadorsPalace_RitualRoom_PostCombatDialog(_Var1);

IF
TextEvent("cp_pcd_a", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255
AND
DB_Avatars(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_Debug_LOW_CazadorsPalace_RitualRoom_PostCombatDialog(_Var1);

PROC
PROC_Debug_LOW_CazadorsPalace_RitualRoom_PostCombatDialog((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_StartDialog(LOW_CazadorsPalace_Coffin_826f2df8-33c9-db18-6b87-0ca5755c9c09, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _Var1, S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853, _Var1)
THEN
DB_NOOP(1);

IF
TextEvent("captureastarion", _, _, _, _)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_CaptureAstarion();

IF
TextEvent("releaseastarion", _, _, _, _)
THEN
RemoveStatus(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, "LOW_CAZADORSPALACE_RITUAL_INCAPACITATED", NULL_00000000-0000-0000-0000-000000000000);

IF
TextEvent("cazador_ascend", _, _, _, _)
THEN
SetEntityEvent(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "debug_cazador_ascend");

IF
TextEvent("cazador_pd", _, _, _, _)
THEN
DB_PermaDefeated(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);

IF
TextEvent("cazador_aa", _, _, _, _)
THEN
ApplyStatus(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "ACID_ARROW", 12, 1, NULL_00000000-0000-0000-0000-000000000000);

IF
TextEvent("cazador_rhs", _, _, _, _)
THEN
RemoveHarmfulStatuses(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);

IF
DialogStarted(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, _, _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var2, _, _Var4, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(_Var2, _, _, _, _)
THEN
RemoveStatus(_Var2, "LOW_CAZADORSPALACE_BEAM_TO_PENTAGRAM", NULL_00000000-0000-0000-0000-000000000000);

IF
DialogEnded(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_Event_KillCazador_d0ae6721-9927-405c-a98c-f3930506f611, _, _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var2, _, _Var4, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_RitualParticipants(_Var2, _, _, _, _)
THEN
ApplyStatus(_Var2, "LOW_CAZADORSPALACE_BEAM_TO_PENTAGRAM", -1, 1, _Var4);

IF
KilledBy((CHARACTER)_Var1, (CHARACTER)_Var2, _, _, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var1, _, _, _, _Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255
THEN
PROC_LOW_CazadorsPalace_RitualRoom_SpawnKilledDuringRitual(_Var2, _Var1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_SpawnKilledDuringRitual((CHARACTER)_Var1, (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
QRY_LOW_CazadorsPalace_RitualRoom_AstarionCanReactToSpawnDeath(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_CazadorReactsToSpawnDeath(_Var2);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_SpawnKilledDuringRitual((CHARACTER)_Var1, (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
QRY_LOW_CazadorsPalace_RitualRoom_AstarionCanReactToSpawnDeath(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_AstarionReactsToSpawnDeath(_Var2);

QRY
QRY_LOW_CazadorsPalace_RitualRoom_AstarionCanReactToSpawnDeath((CHARACTER)_Var1, (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_Avatars(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(ORI_Astarion_State_NecroZombie_273d5473-cfd1-4fec-b1f5-a4db0ac4f4ed, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255
AND NOT
DB_CantTalk_IgnoreCombat(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _Var1, _Var1, _Var1, _Var1)
AND
IsInTrigger(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, S_LOW_CazadorsPalace_RitualRoom_RitualArea_60e2e3a7-f648-427b-86d3-96e9621fab03, 1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_LOW_CazadorsPalace_RitualRoom_AstarionReactsToSpawnDeath((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_RitualFailedAstarionsReaction", _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(LOW_CazadorsPalace_RitualRoom_PAD_SpawnKilled_fe216b0c-ab0f-1231-9f5b-0245671887b0, S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_RitualFailedAstarionsReaction");

PROC
PROC_LOW_CazadorsPalace_RitualRoom_CazadorReactsToSpawnDeath((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_CazadorReactedOnce", _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(LOW_CazadorsPalace_RitualRoom_AD_SpawnKilled_002_Combat_60e3d49d-78c8-44f3-ca61-5268d57a0233, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_CazadorReactedTwice");

PROC
PROC_LOW_CazadorsPalace_RitualRoom_CazadorReactsToSpawnDeath((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_CazadorReactedOnce", _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(LOW_CazadorsPalace_RitualRoom_AD_SpawnKilled_001_Combat_80c90882-a196-d179-59fd-fd0eaa30c5a8, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 0, 0, 0, 0, _Var1, _Var1, _Var1, _Var1)
THEN
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_CazadorReactedOnce");

IF
TurnStarted(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _, _, _, _)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_RitualInProgress_95fe8bc3-21da-4741-a6dc-f5ccfd89be2a, _, _, _, _)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_RitualCannotBeCompleted_71cb0aae-aea2-4304-9932-4c57bf6669a8, _, _, _, _)
AND NOT
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_RitualFailedCazadorsReaction", _, _, _, _)
AND
QRY_StartDialogCustom(LOW_CazadorsPalace_RitualRoom_AD_RitualFailure_Cazador_4d21a4fb-94d2-5271-e58f-15b06c871959, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 0, 0, 0, 0, _, _, _, _)
THEN
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_RitualFailedCazadorsReaction");

IF
TurnStarted(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_RitualInProgress_95fe8bc3-21da-4741-a6dc-f5ccfd89be2a, _, _, _, _)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_RitualCannotBeCompleted_71cb0aae-aea2-4304-9932-4c57bf6669a8, _, _, _, _)
AND
IsInTrigger(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, S_LOW_CazadorsPalace_RitualRoom_RitualArea_60e2e3a7-f648-427b-86d3-96e9621fab03, 1, _, _)
AND NOT
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_RitualFailedAstarionsReaction", _, _, _, _)
AND
QRY_StartDialogCustom(LOW_CazadorsPalace_RitualRoom_AD_RitualFailure_Astarion_b458ba23-9ba1-a114-2e35-287830b3d4a3, S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, 0, 0, 0, 0, _, _, _, _)
THEN
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_RitualFailedAstarionsReaction");
DB_LOW_CazadorsPalace_RitualRoom_AstarionReactedToFailure(1);

IF
TurnEnded(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_AstarionReactedToFailure(1, _, _, _, _)
THEN
NOT DB_LOW_CazadorsPalace_RitualRoom_AstarionReactedToFailure(1);

IF
TurnStarted(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
AND NOT
DB_LOW_CazadorsPalace_RitualRoom_AstarionReactedToFailure(1, _, _, _, _)
AND NOT
DB_CantTalk_IgnoreCombat(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _, _)
AND
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_RitualInProgress_95fe8bc3-21da-4741-a6dc-f5ccfd89be2a, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_CazadorInCoffin_15322f0b-da2e-48f8-b7d0-a6418c58893c, _, _, _, _)
THEN
PROC_LOW_CazadorsPalace_RitualRoom_TryAstarionBanter();

PROC
PROC_LOW_CazadorsPalace_RitualRoom_TryAstarionBanter()
AND
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_AstarionBanter_001", _, _, _, _)
AND NOT
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_AstarionBanter_002", _, _, _, _)
AND
QRY_StartDialogCustom(LOW_CazadorsPalace_RitualRoom_PAD_AstarionTalksToCazador_002_24e5d57d-752c-3206-97e3-b4d69b7bca11, S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, 0, 0, 0, 0, _, _, _, _)
THEN
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_AstarionBanter_002");

PROC
PROC_LOW_CazadorsPalace_RitualRoom_TryAstarionBanter()
AND NOT
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_AstarionBanter_001", _, _, _, _)
AND
QRY_StartDialogCustom(LOW_CazadorsPalace_RitualRoom_PAD_AstarionTalksToCazador_001_35c1c3f5-ccd8-9447-4297-0fda61762c73, S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, 0, 0, 0, 0, _, _, _, _)
THEN
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_AstarionBanter_001");

IF
AutomatedDialogEnded(LOW_CazadorsPalace_RitualRoom_PAD_AstarionTalksToCazador_001_35c1c3f5-ccd8-9447-4297-0fda61762c73, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_TryStartAD(LOW_CazadorsPalace_RitualRoom_AD_ResponseToAstarion_001_475dab57-7cb2-9816-047c-fbeb9a4baabb, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);

IF
AutomatedDialogEnded(LOW_CazadorsPalace_RitualRoom_PAD_AstarionTalksToCazador_002_24e5d57d-752c-3206-97e3-b4d69b7bca11, _, (INTEGER)_, (INTEGER)_, (INTEGER)_)
THEN
PROC_TryStartAD(LOW_CazadorsPalace_RitualRoom_AD_ResponseToAstarion_002_c53fb4aa-4d64-df41-ce5f-29718f9fd71c, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);

IF
AttackedBy(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _, _, _, _, _, _, _, _)
AND NOT
DB_GlobalFlag(LOW_CazadorsPalace_RitualRoom_State_CazadorAscended_68cf8d54-b6f2-468b-925d-5f4610e93c04, _, _, _, _)
AND NOT
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_CazadorAttackedAstarion", _, _, _, _)
AND
QRY_StartDialogCustom(LOW_CazadorsPalace_RitualRoom_AD_AttackingAstarion_6e8f1b00-042d-b0fc-e4db-e16519bd7f92, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 0, 0, 0, 0, _, _, _, _)
THEN
DB_OnlyOnce("LOW_CazadorsPalace_RitualRoom_CazadorAttackedAstarion");

IF
EnteredChasm(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, _, _, _, _, _, _, _, _, _)
AND
IsImmortal(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 1, _, _, _)
THEN
EnterChasmProcessed(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 1);
PROC_LOW_CazadorsPalace_SendCazadorToCoffin();

IF
FlagSet(LOW_CazadorsPalace_RitualRoom_Event_KillCazadorWithClear_9253fd5b-c5b9-4621-893c-3fc1f36db6bd, _, (INTEGER)_Var2, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
SetImmortal(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 0);
DB_DialogDeath(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3);
DB_LOW_CazadorsPalace_RitualRoom_MoveItemsToCoffinAfterDialog(_Var2);

IF
FlagSet(LOW_CazadorsPalace_RitualRoom_Event_KillCazadorWithClear_9253fd5b-c5b9-4621-893c-3fc1f36db6bd, _, (INTEGER)_Var2, _, _)
AND
GetFlag(ORI_Astarion_State_StayedVampireSpawn_2724b881-6be1-49a7-8375-a49e9acb4546, NULL_00000000-0000-0000-0000-000000000000, 1, _, _)
AND
GetFlag(LOW_CazadorsPalace_RitualRoom_State_StoppedRitual_ece54bb7-acdf-4f6f-a153-d3b33bdc37d2, NULL_00000000-0000-0000-0000-000000000000, 1, _, _)
THEN
PROC_DieImmediate(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 0, 1);
TeleportTo(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, S_LOW_CazadorsPalace_RitualRoom_SpawnPosition_004_737c59cc-e0ec-4821-b059-d8f0c05089a6);

IF
FlagSet(LOW_CazadorsPalace_RitualRoom_Event_KillCazadorWithClear_9253fd5b-c5b9-4621-893c-3fc1f36db6bd, _, (INTEGER)_Var2, _, _)
AND
GetFlag(ORI_Astarion_State_StayedVampireSpawn_2724b881-6be1-49a7-8375-a49e9acb4546, NULL_00000000-0000-0000-0000-000000000000, 1, _, _)
AND
GetFlag(LOW_CazadorsPalace_RitualRoom_State_StoppedRitual_ece54bb7-acdf-4f6f-a153-d3b33bdc37d2, NULL_00000000-0000-0000-0000-000000000000, 0, _, _)
THEN
PROC_DieImmediate(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 0, 1);
TeleportTo(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, S_LOW_CazadorsPalace_RitualRoom_CazadorsDefaultPos_a3a70d4c-8ab8-4835-9a72-9b0eefb1b1e3);

IF
FlagSet(LOW_CazadorsPalace_RitualRoom_Event_KillCazadorWithClear_9253fd5b-c5b9-4621-893c-3fc1f36db6bd, _, (INTEGER)_Var2, _, _)
AND
GetFlag(ORI_Astarion_State_BecameVampireLord_c446ce94-efd8-45d5-b407-284177b6b57e, NULL_00000000-0000-0000-0000-000000000000, 1, _, _)
THEN
TeleportTo(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, S_LOW_CazadorsPalace_RitualRoom_SpawnPosition_004_737c59cc-e0ec-4821-b059-d8f0c05089a6, "LOW_CazadorsPalace_RitualRoom_CazadorTeleportedToRitualPos");

IF
EntityEvent(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, "LOW_CazadorsPalace_RitualRoom_CazadorTeleportedToRitualPos", _, _, _)
THEN
PROC_DieImmediate(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 0, 1);

IF
FlagSet(LOW_CazadorsPalace_RitualRoom_Event_KillCazadorWithClear_9253fd5b-c5b9-4621-893c-3fc1f36db6bd, _, (INTEGER)_Var2, _, _)
AND
GetFlag(ORI_Astarion_State_BecameVampireLord_c446ce94-efd8-45d5-b407-284177b6b57e, NULL_00000000-0000-0000-0000-000000000000, 0, _, _)
AND
GetFlag(ORI_Astarion_State_StayedVampireSpawn_2724b881-6be1-49a7-8375-a49e9acb4546, NULL_00000000-0000-0000-0000-000000000000, 0, _, _)
THEN
PROC_DieImmediate(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 0, 1);
DB_LOW_CazadorsPalace_RitualRoom_MoveToCoffin(1);

IF
DialogEnded(LOW_CazadorsPalace_Coffin_826f2df8-33c9-db18-6b87-0ca5755c9c09, _, _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_MoveToCoffin(1, _, _, _, _)
THEN
NOT DB_LOW_CazadorsPalace_RitualRoom_MoveToCoffin(1);
ToInventory(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, S_LOW_CazadorsPalace_RitualRoom_CoffinLid_82b2b28f-c1cd-4baa-9341-71b465afd853);

IF
DialogEnded(_, (INTEGER)_Var2, _, _, _)
AND
DB_LOW_CazadorsPalace_RitualRoom_MoveItemsToCoffinAfterDialog(_Var3, _, _, _, _)
THEN
NOT DB_LOW_CazadorsPalace_RitualRoom_MoveItemsToCoffinAfterDialog(_Var3);
ToInventory(S_LOW_CazadorsPalace_RitualRoom_RitualDagger_feae3d43-138d-4692-aa43-787e3f7e499f, S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, 1, 0, 1);

IF
FlagSet(LOW_CazadorsPalace_RitualRoom_Event_CheckNotAlone_0fbd0058-9ec6-4265-89db-b15849fcc3a5, S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _, _, _)
AND
DB_Players(_Var2, _, _, _, _)
AND
_Var2 != S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255
AND
GetDistanceTo(S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, _Var2, _Var3, _, _)
AND
_Var3 < 30
THEN
SetFlag(LOW_CazadorsPalace_RitualRoom_State_NotAlone_e3a36203-aae3-4791-bcd5-d6124ec50279, S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);

IF
DialogEnded(LOW_CazadorsPalace_RitualRoom_PostCombat_OM_Astarion_AOM_COM_OOM_28e5e4d3-f76e-5932-5426-c542619a745b, _, _, _, _)
AND
GetFlag(LOW_CazadorsPalace_RitualRoom_State_NotAlone_e3a36203-aae3-4791-bcd5-d6124ec50279, S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255, 1, _, _)
THEN
ClearFlag(LOW_CazadorsPalace_RitualRoom_State_NotAlone_e3a36203-aae3-4791-bcd5-d6124ec50279, S_Player_Astarion_c7c13742-bacd-460a-8f65-f864fe41f255);

IF
Dying((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_LOW_CazadorsPalace_RitualRoom_Spawns(_Var1, _, _, _, _Var1)
THEN
NOT DB_CombatReact_AD_StatusRemoved(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, LOW_CazadorsPalace_RitualRoom_AD_BuffRemoved_001_Combat_ee4a186e-2009-f47a-be12-cfd4462a4219, "LOW_CAZADORSPALACE_SPAWNBUFF_007");
NOT DB_CombatReact_AD_StatusRemoved(S_GLO_Cazador_2f1880e6-1297-4ca3-a79c-9fabc7f179d3, LOW_CazadorsPalace_RitualRoom_AD_BuffRemoved_002_Combat_2c442107-0d6c-1133-344e-f8fb1e304d00, "LOW_CAZADORSPALACE_SPAWNBUFF_006");


EXITSECTION
PROC_LOW_CazadorsPalace_RitualRoom_StopRitual();
ENDEXITSECTION

ParentTargetEdge "Act3b"
