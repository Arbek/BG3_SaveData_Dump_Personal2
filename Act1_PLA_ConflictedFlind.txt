Version 1
SubGoalCombiner SGC_AND

INITSECTION
PROC_TriggerRegisterForParty(S_PLA_ConflictedFlind_Cave_DangerZone_0aa90ecf-f46e-441e-ac25-8a9e236f2738);
DB_PLA_ConflictedFlind_Gnolls_States(PLA_ConflictedFlind_State_NotEncountered_c4bed850-2d45-4806-bc6d-5d778e60cde4);
DB_PLA_ConflictedFlind_Gnolls_States(PLA_ConflictedFlind_State_Hostile_4ba98bb7-f66b-a105-b5fd-0569dd61b030);
DB_PLA_ConflictedFlind_Gnolls_States(PLA_ConflictedFlind_State_TalkingToFlind_dd11bd98-c488-4964-83aa-765ddd7b0562);
DB_PLA_ConflictedFlind_Gnolls_States(PLA_ConflictedFlind_State_Instigate_273fb05a-4c2c-4816-8458-7af837d919a2);
DB_PLA_ConflictedFlind_Gnolls_States(PLA_ConflictedFlind_State_AfterKilledRegularGnolls_51320d12-ea6d-4948-99dd-5cf372577fb2);
DB_PLA_ConflictedFlind_Gnolls_States(PLA_ConflictedFlind_State_AfterLongRest_346fa778-1a8a-4793-9abf-f129445e0631);
DB_PLA_ConflictedFlind_Gnolls_States(PLA_ConflictedFlind_State_Gone_4152beef-e7d1-e10f-7b06-62584d3571f2);
PROC_GlobalSetFlagAndCache(PLA_ConflictedFlind_State_NotEncountered_c4bed850-2d45-4806-bc6d-5d778e60cde4);
DB_PLA_ConflictedFlind_GnollPack(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0);
DB_PLA_ConflictedFlind_GnollPack(S_PLA_ConflictedFlind_Gnoll_Ranger_01_8c73365b-a23e-4aba-b556-fa7dedc8d33b);
DB_PLA_ConflictedFlind_GnollPack(S_PLA_ConflictedFlind_Gnoll_Ranger_02_008ec55e-ce89-49f0-b50d-0fe705951a32);
DB_PLA_ConflictedFlind_GnollPack(S_PLA_ConflictedFlind_Gnoll_Ranger_03_81b29ac1-ba32-466b-bca8-9bb555aa3a6d);
DB_PLA_ConflictedFlind_GnollPack(S_PLA_ConflictedFlind_Gnoll_FleshGnawer_01_4929dbdd-bf47-4fb2-aa07-3814c7eac07c);
DB_PLA_ConflictedFlind_GnollPack(S_PLA_ConflictedFlind_Gnoll_FangOfYeenoghu_01_f787a3c0-ecde-480d-a24b-5ec18f191f03);
DB_PLA_ConflictedFlind_GnollPack(S_PLA_ConflictedFlind_Hyena_01_69bc3485-8f3b-4a76-a3ca-fd9da89bb908);
DB_PLA_ConflictedFlind_GnollPack(S_PLA_ConflictedFlind_Hyena_02_9c5f8832-a4c3-43c7-a860-4d7b4aa309b5);
PROC_ConflictedFlind_DisableCrimesOnZhents();
DB_FlagReactionAfterDialog(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, PLA_ConflictedFlind_Event_MindControl_Leave_53e6cdf7-d5ce-dd99-6b4b-1006c8221f5d, PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04);
DB_FlagReactionAfterDialog(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, PLA_ConflictedFlind_Event_MindControl_Attack_8b622d47-729f-555a-ae8c-e5b7a51e7552, PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04);
DB_FlagReactionAfterDialog(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, PLA_ConflictedFlind_Event_TurnedOnGnolls_e106f8d7-1cc5-46a2-8b6d-46f2de0f4ea1, PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04);
DB_FlagReactionAfterDialog(PLA_ConflictedFlind_Event_MindControlDamage_Minor_74513fa5-0adb-9023-cad4-132d7ea5742c, PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04);
DB_FlagReactionAfterDialog(PLA_ConflictedFlind_Event_MindControlDamage_Heavy_2721b722-2d3e-48ac-8c2d-122d4f3873c4, PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04);
DB_FlagReactionAfterDialog(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, PLA_ConflictedFlind_Event_MindControl_KillHerself_89d4304d-1256-d655-a53f-b6c52f62d23f, PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04);
DB_FlagReactionAfterDialog(PLA_ConflictedFlind_Event_MakeGnollsLaugh_cf856e51-194f-4560-b51c-8dc2c29e568a, PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04);
DB_AutoSaveTrigger(TRIGGERGUID_S_PLA_ConflictedFlind_Autosave_49e111b9-92dc-4272-b164-bb8902ef329c);
PROC_DeclareCounter("PLA_ConflictedFlind_DialogAttempts");
DB_NoLowAttitudeDialog(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0);
SetCanTrade(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, 0);
PROC_TriggerRegisterForParty(S_PLA_ZhentShipment_GnollBehaviorCommentArea_2895b396-8f1c-49fc-b97a-bfe427b4ce5c);
DB_GLO_ADManager_Category("PLA_ConflictedFlind", PLA_ConflictedFlind_State_BlockAD_a440d701-ef76-4ae1-aace-98b1035d50b4, 1500, 500);
DB_GLO_ADManager_AD("PLA_ConflictedFlind", PLA_ConflictedFlind_GnollRanger01_AD_ecdb6acb-cc88-758e-4f70-0efbb72da23e, PLA_ConflictedFlind_State_BlockAD_GnollRanger01_cc713add-a59c-44ea-9a4d-4335aa170f07);
DB_GLO_ADManager_AD("PLA_ConflictedFlind", PLA_ConflictedFlind_GnollRanger02_AD_5de19839-b8e8-96d4-7a39-887345c01db7, PLA_ConflictedFlind_State_BlockAD_GnollRanger02_c7933897-40b5-43e5-997b-5ebeb0c57d0b);
DB_GLO_ADManager_AD("PLA_ConflictedFlind", PLA_ConflictedFlind_GnollRanger03_AD_11d4ed98-1e5e-684e-d652-2cd15b034d37, PLA_ConflictedFlind_State_BlockAD_GnollRanger03_2d2d02cb-5864-4696-8ce2-62984b141745);
DB_GLO_ADManager_AD("PLA_ConflictedFlind", PLA_ConflictedFlind_GnollRanger04_AD_b03f1805-8792-5aa4-c759-9ee2f3db1bad, PLA_ConflictedFlind_State_BlockAD_GnollRanger04_117eb698-98c9-4370-b072-a31a3fc66e67);
DB_GLO_ADManager_AD("PLA_ConflictedFlind", PLA_ConflictedFlind_Flind_AD_ffdccc02-fdba-2efb-cc0b-db3f7dc11e67, PLA_ConflictedFlind_State_BlockAD_Flind_5810ce7f-0e34-4498-968c-dc67f88d5389);
DB_GLO_ADManager_AD("PLA_ConflictedFlind", PLA_ConflictedFlind_Gnoll_FangOfYeenoghu_01_AD_e9564fca-53bb-7917-e3f7-dfaa8c0f4028, PLA_ConflictedFlind_State_BlockAD_Fang_3a931891-216e-4965-a94e-338dae690a36);
DB_PLA_ConflictedFlind_Howling(S_PLA_ConflictedFlind_GnollHowlingArea_Cave_f1f05654-27ef-4c6b-ae94-61bd3a500b5d, "SE_Distant_Howls_ConflictedFlind_Underground");
DB_PLA_ConflictedFlind_Howling(S_PLA_ConflictedFlind_GnollHowlingArea_Outdoor_22624dab-5113-4e9b-a544-6d3142abb3b9, "SE_Distant_Howls_ConflictedFlind_Above");
DB_PLA_ConflictedFlind_BloodSymbols(S_PLA_ConflictedFlind_BloodSymbolArea_001_a0b09223-a353-40b0-a29e-8ad87b9cc534, S_PLA_ConflictedFlind_BloodSymbol_VFXTrigger_001_49f3ab79-ab8a-4779-b1b8-2be1efd15aef);
DB_PLA_ConflictedFlind_BloodSymbols(S_PLA_ConflictedFlind_BloodSymbolArea_002_b54f9462-c07c-40c1-9b3e-de80b03d495e, S_PLA_ConflictedFlind_BloodSymbol_VFXTrigger_002_6cd434a0-5862-4bbb-89c6-be6d81d0cee2);

KBSECTION
IF
EnteredTrigger((GUIDSTRING)_Var1, S_PLA_Plains_SUB_bcc3efa5-bfe1-4224-9df1-6758cac764cd, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(PLA_ConflictedFlind_State_NotEncountered_c4bed850-2d45-4806-bc6d-5d778e60cde4, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_Gone_4152beef-e7d1-e10f-7b06-62584d3571f2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_ConflictedFlind_Surfaces_Oneshot", _Var1, _Var1, _Var1, _Var1)
THEN
CreateSurface(S_PLA_ConflictedFlind_EntranceSurfaces_1_3f32deb8-6635-4ed4-9b6f-26184d351f65, "SurfaceFire", 1.5, -1);
CreateSurface(S_PLA_ConflictedFlind_EntranceSurfaces_2_256722b2-71d2-4bee-a619-6437d04957a8, "SurfaceFire", 1.5, -1);
CreateSurface(S_PLA_ConflictedFlind_EntranceSurfaces_3_032ad108-973d-4bba-9a52-cfc5ec2ea7e7, "SurfaceFire", 1.5, -1);
CreateSurface(S_PLA_ConflictedFlind_Zhentarim_Corpse_01973f38-1fd2-4035-abb3-27429f49bd47, "SurfaceBlood", 1.7, -1);
CreateSurface(S_PLA_ConflictedFlind_BurnedHyenaTrigger_15588ab4-e483-43ab-a52f-31880ab61ce9, "SurfaceFire", 1.5, -1);

PROC
PROC_PLA_ConflictedFlind_AfterAbandoningZhents()
THEN
PROC_PLA_ConflictedFlind_ClearSurfaces();

PROC
PROC_PLA_ZhentShipment_RemoveAgentsFromTheCave()
THEN
PROC_PLA_ConflictedFlind_ClearSurfaces();

PROC
PROC_PLA_ConflictedFlind_ClearSurfaces()
THEN
RemoveSurfaceLayer(TRIGGERGUID_S_PLA_ConflictedFlind_BehindFireTrigger_850796f3-766e-4955-acf7-1490796ebe5a, "Ground", 8);
RemoveSurfaceLayer(S_PLA_ConflictedFlind_BurnedHyenaTrigger_15588ab4-e483-43ab-a52f-31880ab61ce9, "Ground", 2);

IF
FlagSet((GUIDSTRING)_Var1, _, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GlobalFlag(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_ConflictedFlind_Gnolls_States(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_ChangeState(_Var1);

PROC
PROC_PLA_ConflictedFlind_ChangeState((FLAG)_Var1, (FLAG)_Var1, (FLAG)_Var1, (FLAG)_Var1, (FLAG)_Var1)
AND NOT
DB_GlobalFlag(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GlobalSetFlagAndCache(_Var1);

PROC
PROC_PLA_ConflictedFlind_ChangeState((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PLA_ConflictedFlind_Gnolls_States(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_ConflictedFlind_Gnolls_CurrentState(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
_Var2 != _Var1
THEN
PROC_GlobalClearFlagAndCache(_Var2);
NOT DB_PLA_ConflictedFlind_Gnolls_CurrentState(_Var2);
DB_PLA_ConflictedFlind_Gnolls_CurrentState(_Var1);
PROC_ConflictedFlind_OnStateChanged(_Var2, _Var1);

IF
FlagSet((GUIDSTRING)_Var1, _, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PLA_ConflictedFlind_Gnolls_States(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PLA_ConflictedFlind_Gnolls_CurrentState(_, _Var1, _Var1, _Var1, _Var1)
THEN
DB_PLA_ConflictedFlind_Gnolls_CurrentState(_Var1);

PROC
PROC_ConflictedFlind_OnStateChanged((FLAG)_Var1, (GUIDSTRING)_Var2, (FLAG)_Var1, (FLAG)_Var1, (FLAG)_Var1)
THEN
DB_NOOP(1);

IF
FlagSet(PLA_ConflictedFlind_State_Gone_4152beef-e7d1-e10f-7b06-62584d3571f2, _, _, _, _)
AND
DB_GlobalFlag(PLA_DyingHyena_State_Gone_62e3eb5c-d0c8-48ca-be82-b6c64008b093, _, _, _, _)
AND
QRY_OnlyOnce("PLA_ConflictedFlind_Activate_PartyBanterTrigger", _, _, _, _)
THEN
PROC_RegisterWorldGossipTrigger(TRIGGERGUID_S_PartyBanterTrigger_PLA_HillCleared_367f316d-e9e2-4d6e-9f08-eaf63b480e22);

IF
FlagSet(PLA_DyingHyena_State_Gone_62e3eb5c-d0c8-48ca-be82-b6c64008b093, _, _, _, _)
AND
DB_GlobalFlag(PLA_ConflictedFlind_State_Gone_4152beef-e7d1-e10f-7b06-62584d3571f2, _, _, _, _)
AND
QRY_OnlyOnce("PLA_ConflictedFlind_Activate_PartyBanterTrigger", _, _, _, _)
THEN
PROC_RegisterWorldGossipTrigger(TRIGGERGUID_S_PartyBanterTrigger_PLA_HillCleared_367f316d-e9e2-4d6e-9f08-eaf63b480e22);

IF
TurnStarted((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_Gone_4152beef-e7d1-e10f-7b06-62584d3571f2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_TalkingToFlind_dd11bd98-c488-4964-83aa-765ddd7b0562, _Var1, _Var1, _Var1, _Var1)
AND
QRY_PLA_ZhentShipment_PlayersAndGnollsAreFighting()
AND
QRY_PLA_ConflictedFlind_GnollsHostile()
THEN
PROC_PLA_ConflictedFlind_ChangeState(PLA_ConflictedFlind_State_Hostile_4ba98bb7-f66b-a105-b5fd-0569dd61b030);

IF
DialogEnded(PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_GlobalFlag(PLA_ConflictedFlind_State_Hostile_4ba98bb7-f66b-a105-b5fd-0569dd61b030, _Var1, _Var1, _Var1, _Var1)
AND
DB_DialogPlayers(_Var1, _Var2, 1, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_ChangeGnollsRelationToPlayers(0);
PROC_PLA_ConflictedFlind_FlindPlaysAngryAnimation(_Var2);

PROC
PROC_PLA_ConflictedFlind_FlindPlaysAngryAnimation((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Is_InCombat(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var2, _Var1, _Var1, _Var1)
THEN
SetDualEntityEvent(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, "PLA_ConflictedFlind_Event_PlayAngryAnim", 1);

IF
TurnStarted(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _, _, _)
AND
QRY_ConflictedFlind_FlindCanInterruptCombat()
AND NOT
DB_PLA_ConflictedFlind_MovingToPlayer(_, _, _, _, _)
AND
DB_Is_InCombat(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var3, _, _, _)
AND NOT
QRY_PLA_ConflictedFlind_ZhentsAreInCombat(_Var3, _, _, _, _)
AND NOT
QRY_PLA_ConflictedFlind_OtherPackGnollsAreInCombat(_Var3, _, _, _, _)
AND
QRY_PLA_ConflictedFlind_GetClosestAvailableCharacterTo(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _, _, _)
AND
DB_ClosestAvailableCharacterTo(_Var4, S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var5, _, _)
AND NOT
DB_InRegion(_Var4, S_PLA_ZhentShipment_InsideCaveCombatArea_1482ce04-5188-4759-a548-f609c6e74181, _, _, _)
THEN
DB_OnlyOnce("PLA_ConflictedFlind_Event_InterruptCombat");
PROC_PLA_ConflictedFlind_CharacterMoveToAndTalk(_Var4, "PLA_ConflictedFlind_FlindMovesToPlayer", _Var5);

IF
TurnStarted(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _, _, _)
AND
QRY_PLA_ConflictedFlind_FlindHeavilyWounded()
AND
QRY_OnlyOnce("PLA_ConflictedFlind_FlindHeavilyWoundedAD", _, _, _, _)
THEN
PROC_TryStartAD(PLA_ConflictedFlind_Flind_Wounded_AD_5732796b-dfe9-3830-1b15-0d98cb01fea5, S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0);

IF
TurnStarted(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Is_InCombat(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var1, _Var1, _Var1)
AND
QRY_PLA_ConflictedFlind_ZhentsAreInCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_ConflictedFlind_FlindHeavilyWoundedAD", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(PLA_ConflictedFlind_Flind_Wounded_AD_5732796b-dfe9-3830-1b15-0d98cb01fea5, S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0);

IF
AttackedBy(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, (CHARACTER)_Var1, _, _, (INTEGER)_Var4, _, _, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_OnlyOnce("PLA_ConflictedFlind_FlindHeavilyWoundedAD", _Var1, _Var1, _Var1, _Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var4 > 1
AND
QRY_PLA_ConflictedFlind_FlindHeavilyWounded()
AND
QRY_OnlyOnce("PLA_ConflictedFlind_FlindHeavilyWoundedAD", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_TryStartAD(PLA_ConflictedFlind_Flind_Wounded_AD_5732796b-dfe9-3830-1b15-0d98cb01fea5, S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0);

QRY
QRY_ConflictedFlind_FlindCanInterruptCombat()
AND NOT
DB_OnlyOnce("PLA_ConflictedFlind_Event_InterruptCombat", _, _, _, _)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_Instigate_273fb05a-4c2c-4816-8458-7af837d919a2, _, _, _, _)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_AfterLongRest_346fa778-1a8a-4793-9abf-f129445e0631, _, _, _, _)
AND NOT
DB_GlobalFlag(PLA_ZhentShipment_Event_ProvokeGnolls_b7fe3fee-61ce-7d8d-64a6-519f0dc610cb, _, _, _, _)
AND NOT
DB_GlobalFlag(PLA_ZhentShipment_State_SurvivorsAreDead_bb54af09-b0c2-46c2-84e8-642280ccec6a, _, _, _, _)
AND NOT
DB_Defeated(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _, _, _)
AND
HasActiveStatus(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, "SURPRISED", 0, _, _)
AND
SysCount("DB_PLA_ConflictedFlind_GnollPack", 1, _Var1, _Var1, _Var1)
AND
_Var1 > 1
AND NOT
QRY_PLA_ConflictedFlind_FlindHeavilyWounded()
THEN
DB_NOOP(1);

QRY
QRY_PLA_ConflictedFlind_FlindHeavilyWounded()
AND
GetHitpointsPercentage(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 < 50
THEN
DB_NOOP(1);

QRY
QRY_PLA_ConflictedFlind_ZhentsAreInCombat((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_PLA_ZhentShipment_ZhentEnteredCombatJustForAD(_, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_ZhentShipment_Agents(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var3, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_PLA_ConflictedFlind_OtherPackGnollsAreInCombat((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PLA_DyingHyena_GnollPack(_Var2, _, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_PLA_ConflictedFlind_GetClosestAvailableCharacterTo((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
QRY_GetClosestAvailableCharacterTo(_Var1, 1, 0, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, 1, _Var1, _Var1, _Var1, _Var1)
AND
DB_ClosestAvailableCharacterTo(_, _Var1, _, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_PLA_ConflictedFlind_GetClosestAvailableCharacterTo((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_ClosestAvailableCharacterTo(_, _Var1, _, _Var1, _Var1)
AND
QRY_GetClosestAvailableCharacterTo(_Var1, 0, 0, NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000, 1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_PLA_ConflictedFlind_CharacterMoveToAndTalk((GUIDSTRING)_Var1, (STRING)_Var2, (REAL)_Var3, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_PLA_ConflictedFlind_MovingToPlayer(_Var1, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_PLA_ConflictedFlind_FlindDialogStarted(_, _Var1, _Var1, _Var1, _Var1)
AND
_Var3 <= 5
THEN
PROC_PLA_ConflictedFlind_StartFlindDialog(_Var1);

PROC
PROC_PLA_ConflictedFlind_CharacterMoveToAndTalk((GUIDSTRING)_Var1, (STRING)_Var2, (REAL)_Var3, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_PLA_ConflictedFlind_MovingToPlayer(_Var1, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_PLA_ConflictedFlind_FlindDialogStarted(_, _Var1, _Var1, _Var1, _Var1)
AND
_Var3 > 5
AND NOT
DB_CantMove(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var1, _Var1, _Var1)
THEN
DB_PLA_ConflictedFlind_MovingToPlayer(_Var1, _Var2);
CharacterMoveToAndTalk(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04, _Var2, "Walk", 25);

PROC
PROC_PLA_ConflictedFlind_StartFlindDialog((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_PLA_ConflictedFlind_FlindDialogStarted(PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04, _Var1, _Var1, _Var1, _Var1)
AND
QRY_StartDialogCustom(PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04, S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, 0, 0, 0, 1, _Var1, _Var1, _Var1)
THEN
DB_PLA_ConflictedFlind_FlindDialogStarted(PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04);

PROC
PROC_StartDialog_AddExtraSpeakers(PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
DB_DialogRequestCache_SpeakerList_Players(PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04, _Var1, _Var2, 1, _Var1)
AND
DB_Is_InCombat(_Var2, _Var3, _Var1, _Var1, _Var1)
AND
DB_Players(_Var4, _Var1, _Var1, _Var1, _Var1)
AND
_Var2 != _Var4
AND
DB_Is_InCombat(_Var4, _Var3, _Var1, _Var1, _Var1)
AND NOT
DB_DialogRequestCache_SpeakerList_Players(PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04, _Var1, _Var4, _, _Var1)
THEN
PROC_DialogAddListeningActor(_Var1, _Var4);

IF
DialogStarted(PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_Instigate_273fb05a-4c2c-4816-8458-7af837d919a2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_AfterKilledRegularGnolls_51320d12-ea6d-4948-99dd-5cf372577fb2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_ChangeState(PLA_ConflictedFlind_State_TalkingToFlind_dd11bd98-c488-4964-83aa-765ddd7b0562);

IF
EnteredCombat((CHARACTER)_Var1, (GUIDSTRING)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var2, _Var1, _Var1, _Var1)
AND
DB_DialogNPCs(_Var3, S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _Var1, _Var1)
AND NOT
DB_DialogPlayers(_Var3, _Var1, _, _Var1, _Var1)
THEN
PROC_DialogAddListeningActor(_Var3, _Var1);

IF
CombatEnded((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Was_InCombat(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var1, _Var1, _Var1)
AND
DB_PartyMembers(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_Was_InCombat(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
DB_OnlyOnce("PLA_ConflictedFlind_CombatWithFlindEnded");

IF
DialogStarted(PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
QRY_OnlyOnce("PLA_ConflictedFlind_DashFirstTime", _Var1, _Var1, _Var1, _Var1)
THEN
ApplyStatus(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, "PLA_CONFLICTEDFLIND_FAKEDASH", 1, 1, S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0);

IF
AttackedBy(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, (CHARACTER)_Var1, _, _, _, _, _, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_DialogName(PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04, _Var7, _Var1, _Var1, _Var1)
AND
DB_DialogNPCs(_Var7, S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _Var1, _Var1)
AND
DB_DialogPlayers(_Var7, _Var9, _, _Var1, _Var1)
THEN
PROC_GlobalSetFlagAndCache(PLA_ConflictedFlind_State_Hostile_4ba98bb7-f66b-a105-b5fd-0569dd61b030);
PROC_ForceStopDialog(_Var9);

IF
CharacterMoveToAndTalkFailed(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, (GUIDSTRING)_Var1, "PLA_ConflictedFlind_FlindMovesToPlayer", (STRING)_Var2, (GUIDSTRING)_Var1)
AND
DB_PLA_ConflictedFlind_MovingToPlayer(_Var1, _Var3, _Var1, _Var1, _Var1)
AND
Concatenate("CharacterMoveToAndTalk FAILED: ", _Var2, _Var4, _Var1, _Var1)
THEN
DebugText(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var4);
NOT DB_PLA_ConflictedFlind_MovingToPlayer(_Var1, _Var3);
PROC_PLA_ConflictedFlind_FlindDialogFallback(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1);

PROC
PROC_PLA_ConflictedFlind_FlindDialogFallback(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_PLA_ConflictedFlind_FlindDialogStarted(PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04, _Var1, _Var1, _Var1, _Var1)
AND
QRY_PLA_ConflictedFlind_GetClosestAvailableCharacterTo(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var1, _Var1, _Var1)
AND
DB_ClosestAvailableCharacterTo(_Var2, S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var3, _Var1, _Var1)
AND
_Var3 <= 5
THEN
PROC_PLA_ConflictedFlind_StartFlindDialog(_Var2);

PROC
PROC_PLA_ConflictedFlind_FlindDialogFallback(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_PLA_ConflictedFlind_FlindDialogStarted(PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04, _Var1, _Var1, _Var1, _Var1)
AND
DB_ClosestAvailableCharacterTo(_Var2, S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var3, _Var1, _Var1)
AND
_Var3 > 5
AND
DB_GlobalCounter("PLA_ConflictedFlind_DialogAttempts", _Var4, _Var1, _Var1, _Var1)
AND
_Var4 < 2
AND NOT
QRY_PLA_ConflictedFlind_FlindHeavilyWounded()
THEN
PROC_IncreaseCounter("PLA_ConflictedFlind_DialogAttempts");
NOT DB_OnlyOnce("PLA_ConflictedFlind_Event_InterruptCombat");
PROC_TryStartAD(PLA_ConflictedFlind_Flind_Wounded_AD_5732796b-dfe9-3830-1b15-0d98cb01fea5, S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0);
EndTurn(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0);

IF
AttackedBy(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, (CHARACTER)_Var1, _, _, (INTEGER)_Var4, _, _, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_ConflictedFlind_MovingToPlayer(_Var1, _Var7, _Var1, _Var1, _Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var4 > 4
THEN
CharacterMoveToAndTalkFail(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var7, "Attacked");

IF
Died((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_ConflictedFlind_MovingToPlayer(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
CharacterMoveToAndTalkFail(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var2, "TargetDied");

IF
Died(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_ConflictedFlind_MovingToPlayer(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
CharacterMoveToAndTalkFail(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var2, "CharacterDied");

IF
CharacterMoveToAndTalkRequestDialog(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, (CHARACTER)_Var1, (DIALOGRESOURCE)_Var2, (STRING)_Var3, (CHARACTER)_Var1)
AND
DB_PLA_ConflictedFlind_MovingToPlayer(_Var1, _Var3, _Var1, _Var1, _Var1)
AND NOT
DB_PLA_ConflictedFlind_FlindDialogStarted(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_StartFlindDialog(_Var1);

IF
CharacterMoveToAndTalkRequestDialog(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, (GUIDSTRING)_Var1, (DIALOGRESOURCE)_Var2, (STRING)_Var3, (GUIDSTRING)_Var1)
AND
DB_CharacterMoveToAndTalk_Info(_Var4, _Var1, _Var2, _Var5, _Var1)
AND NOT
DB_PLA_ConflictedFlind_FlindDialogStarted(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
CharacterMoveToAndTalkFail(_Var4, _Var1, _Var5, "DialogFailedToStart");

IF
CharacterMoveToAndTalkRequestDialog(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, (CHARACTER)_Var1, (DIALOGRESOURCE)_Var2, (STRING)_Var3, (CHARACTER)_Var1)
AND
DB_PLA_ConflictedFlind_MovingToPlayer(_Var1, _Var3, _Var1, _Var1, _Var1)
THEN
NOT DB_PLA_ConflictedFlind_MovingToPlayer(_Var1, _Var3);

IF
DialogStarted((GUIDSTRING)_Var1, _, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PLA_ConflictedFlind_FlindDialogStarted(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_PLA_ConflictedFlind_FlindDialogStarted(_Var1);

PROC
PROC_FlagReactionAfterDialog(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, PLA_ConflictedFlind_Event_MindControl_Leave_53e6cdf7-d5ce-dd99-6b4b-1006c8221f5d, _, _, _)
THEN
PROC_PLA_ConflictedFlind_ChangeGnollsRelationToPlayers(50);
PROC_PLA_ConflictedFlind_Leave();

PROC
PROC_PLA_ConflictedFlind_Leave()
THEN
PROC_PLA_ConflictedFlind_SetPeacefulResolutionXP();
PROC_GlobalSetFlagAndCache(PLA_ConflictedFlind_State_Left_ac73cf2a-7b7f-4f41-8fc4-4e0ab6f73c70);

PROC
PROC_PLA_ConflictedFlind_Leave()
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PLA_ConflictedFlind_LeftGnoll(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_PLA_ConflictedFlind_LeftGnoll(_Var1);
SetHasDialog(_Var1, 0);
PROC_NotifyWhenReadyToMoveOn(_Var1, "PLA_ConflictedFlind_LeftForAnotherPlace_Notify");

PROC
PROC_ReadyToMoveOn((CHARACTER)_Var1, "PLA_ConflictedFlind_LeftForAnotherPlace_Notify", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_DisappearOutOfSightTo(_Var1, S_PLA_ConflictedFlind_LeaveToTrigger_c30f35ca-ae9f-4861-b32a-f69c88de273c, "Run", 0, "");

PROC
PROC_FlagReactionAfterDialog(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, PLA_ConflictedFlind_Event_MindControl_Attack_8b622d47-729f-555a-ae8c-e5b7a51e7552, _, _, _)
THEN
PROC_PLA_ConflictedFlind_StartInstigateAlliedWithGnolls();

PROC
PROC_PLA_ConflictedFlind_StartInstigateAlliedWithGnolls()
AND
DB_Is_InCombat(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var1, _Var1, _Var1)
AND
QRY_PLA_ZhentShipment_AnyAgentInCombat(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_FlindPlaysAngryAnimation(S_PLA_ConflictedFlind_BehindFireTrigger_850796f3-766e-4955-acf7-1490796ebe5a);

PROC
PROC_PLA_ConflictedFlind_StartInstigateAlliedWithGnolls()
AND NOT
DB_PLA_ConflictedFlind_InstigatingAlliedWithGnolls(1, _, _, _, _)
THEN
DB_PLA_ConflictedFlind_InstigatingAlliedWithGnolls(1);
PROC_PLA_ConflictedFlind_StartInstigate(1);
PROC_PLA_ConflictedFlind_ChangeGnollsRelationToPlayers(50);
PROC_PLA_ZhentShipment_MakeZhentsAndPlayersHostile();

PROC
PROC_PLA_ConflictedFlind_StartInstigateAlliedWithGnolls()
AND
DB_Is_InCombat(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_ZhentShipment_AliveAgents(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_ConflictedFlind_StartInstigateAlliedWithGnolls_Hostility", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ZhentShipment_MakeZhentsAndGnollsHostile();

PROC
PROC_PLA_ConflictedFlind_StartInstigateAlliedWithGnolls()
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetDualEntityEvent(_Var1, S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, "PLA_ConflictedFlind_Event_PlayReactionPeace", 1);

PROC
PROC_PLA_ConflictedFlind_StartInstigateAlliedWithGnolls()
AND
DB_PLA_ZhentShipment_AliveAgents(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SelfHealing_Disable(_Var1);

PROC
PROC_PLA_ConflictedFlind_StartInstigateAlliedWithGnolls()
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SelfHealing_Disable(_Var1);

PROC
PROC_PLA_ConflictedFlind_StartInstigateAlliedWithGnolls()
AND
DB_PLA_ConflictedFlind_InstigatingAlliedWithGnolls(1, _, _, _, _)
THEN
NOT DB_PLA_ConflictedFlind_InstigatingAlliedWithGnolls(1);

IF
CombatEnded((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_Gone_4152beef-e7d1-e10f-7b06-62584d3571f2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_AfterLongRest_346fa778-1a8a-4793-9abf-f129445e0631, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_Instigate_273fb05a-4c2c-4816-8458-7af837d919a2, _Var1, _Var1, _Var1, _Var1)
AND
DB_Was_InCombat(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_ConflictedFlind_GnollPack(_, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_ConflictedFlind_InstigateAfterCombatEnded", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_StartInstigate(1);

PROC
PROC_PLA_ConflictedFlind_StartInstigate((INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_Gone_4152beef-e7d1-e10f-7b06-62584d3571f2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(PLA_ZhentShipment_State_SurvivorsAreDead_bb54af09-b0c2-46c2-84e8-642280ccec6a, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_ConflictedFlind_GnollPack(_, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_Instigate_273fb05a-4c2c-4816-8458-7af837d919a2, _Var1, _Var1, _Var1, _Var1)
AND
GetFlag(PLA_ConflictedFlind_Event_TurnedOnGnolls_e106f8d7-1cc5-46a2-8b6d-46f2de0f4ea1, S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, 0, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_ChangeState(PLA_ConflictedFlind_State_Instigate_273fb05a-4c2c-4816-8458-7af837d919a2);
PROC_PLA_ConfclitedFlind_ClearPeaceReturn();
PROC_PLA_ConflictedFlind_OnInstigateStarted(_Var1);

PROC
PROC_PLA_ConflictedFlind_OnInstigateStarted(_, _, _, _, _)
AND NOT
DB_Defeated(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _, _, _)
AND
DB_DialogNPCs(_, S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _, _)
THEN
PROC_ForceStopDialog(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0);

PROC
PROC_PLA_ConflictedFlind_OnInstigateStarted(1, _, _, _, _)
AND
DB_Defeated(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _, _, _)
THEN
PROC_PLA_ConflictedFlind_OnInstigateStarted(0);

PROC
PROC_PLA_ConflictedFlind_OnInstigateStarted(1, _, _, _, _)
AND NOT
DB_Defeated(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _, _, _)
THEN
TimerLaunch("PLA_ConflictedFlind_RushAtZhents_Timer", 4500);

PROC
PROC_PLA_ConflictedFlind_OnInstigateStarted(0, _, _, _, _)
THEN
TimerLaunch("PLA_ConflictedFlind_RushAtZhents_Timer", 2000);

IF
TimerFinished("PLA_ConflictedFlind_RushAtZhents_Timer", _, _, _, _)
THEN
PROC_PLA_ConflictedFlind_RushAtZhents();

PROC
PROC_PLA_ConflictedFlind_RushAtZhents()
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetEntityEvent(_Var1, "PLA_ConflictedFlind_Event_RushAtZhents", 1);

IF
DB_Is_InCombat(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(PLA_ConflictedFlind_State_Instigate_273fb05a-4c2c-4816-8458-7af837d919a2, _Var1, _Var1, _Var1, _Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_ZhentShipment_AliveAgents(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var3, _Var2, _Var1, _Var1, _Var1)
AND NOT
DB_OnlyOnce("PLA_ConflictedFlind_CombatWithPlayersAndZhentsStartedWithGnollsNear", _Var1, _Var1, _Var1, _Var1)
AND
QRY_PLA_ZhentShipment_AreZhentsAndPlayersHostile()
AND NOT
QRY_PLA_ConflictedFlind_GnollsHostile()
AND
QRY_OnlyOnce("PLA_ConflictedFlind_CombatWithPlayersAndZhentsStartedWithGnollsNear", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ZhentShipment_MakeZhentsAndGnollsHostile();

IF
FlagSet(PLA_ZhentShipment_State_SurvivorsAreDead_bb54af09-b0c2-46c2-84e8-642280ccec6a, _, _, _, _)
AND
DB_GlobalFlag(PLA_ConflictedFlind_State_Instigate_273fb05a-4c2c-4816-8458-7af837d919a2, _, _, _, _)
AND NOT
QRY_PLA_ConflictedFlind_GnollsHostile()
AND NOT
DB_Defeated(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _, _, _)
THEN
DB_SpotPlayers(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, "PLA_ConflictedFlind_FlindSpotter_AfterInstigate", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);

IF
FlagSet(PLA_ZhentShipment_State_SurvivorsAreDead_bb54af09-b0c2-46c2-84e8-642280ccec6a, _, _, _, _)
AND NOT
QRY_PLA_ConflictedFlind_GnollsHostile()
AND
DB_Defeated(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _, _, _)
THEN
PROC_PLA_ConflictedFlind_ChangeGnollsRelationToPlayers(0);

PROC
PROC_SpotPlayers_Spotted((CHARACTER)_Var1, "PLA_ConflictedFlind_FlindSpotter_AfterInstigate", (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND NOT
QRY_PLA_ConflictedFlind_GnollsHostile()
AND
QRY_OnlyOnce("PLA_ConflictedFlind_FlindSpotter_AfterInstigate", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_CharacterMoveToAndTalk(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var2, PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04, "PLA_ConflictedFlind_FlindMovesToPlayer_AfterInstigate", "Run", 15, 1, 0);

IF
CharacterMoveToAndTalkFailed(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, (CHARACTER)_Var1, "PLA_ConflictedFlind_FlindMovesToPlayer_AfterInstigate", _, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
TimerLaunch("PLA_ConflictedFlind_FlindMovesToPlayer_AfterInstigate_Timer", 5000);

IF
TimerFinished("PLA_ConflictedFlind_FlindMovesToPlayer_AfterInstigate_Timer", _, _, _, _)
AND
DB_Defeated(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _, _, _)
AND
QRY_OnlyOnce_Reset("PLA_ConflictedFlind_FlindSpotter_AfterInstigate", _, _, _, _)
THEN
DB_SpotPlayers(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, "PLA_ConflictedFlind_FlindSpotter_AfterInstigate", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_FlagReactionAfterDialog((CHARACTER)_Var1, PLA_ConflictedFlind_Event_MindControlDamage_Minor_74513fa5-0adb-9023-cad4-132d7ea5742c, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_ApplyLimitedDamagePercent(_Var1, 10, "Psychic", S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0);

PROC
PROC_FlagReactionAfterDialog(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, PLA_ConflictedFlind_Event_TurnedOnGnolls_e106f8d7-1cc5-46a2-8b6d-46f2de0f4ea1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_ConflictedFlind_FlindAttackGnolls", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SetRelationToPlayers(ACT1_PLA_ConflictedFlind_Flind_df4d741f-a2b3-c281-a3a4-111dac02f109, 50);
PROC_SetRelation(ACT1_PLA_ConflictedFlind_Flind_df4d741f-a2b3-c281-a3a4-111dac02f109, ACT1_PLA_ConflictedFlind_GnollPack_6f5c2543-dadb-7f16-94d4-9c7e5f23acf2, 0);
PROC_SetRelation(ACT1_PLA_ConflictedFlind_Flind_df4d741f-a2b3-c281-a3a4-111dac02f109, ACT1_PLA_CaravanGnolls_efcabb7b-9f84-464e-bfce-134a81664ae5, 0);
PROC_PLA_ConflictedFlind_FlindPlaysAngryAnimation(_Var1);
PROC_PLA_ConflictedFlind_SetPeacefulResolutionXP();

PROC
PROC_PLA_ConflictedFlind_SetPeacefulResolutionXP()
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PermaDefeated(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PeacefulResolve(_Var1);

IF
AttackedBy((CHARACTER)_Var1, S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _, (INTEGER)_Var4, _, _, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
GetFlag(PLA_ConflictedFlind_Event_TurnedOnGnolls_e106f8d7-1cc5-46a2-8b6d-46f2de0f4ea1, S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, 1, _Var1, _Var1)
AND
_Var4 > 0
THEN
PROC_PLA_ConflictedFlind_GnollsReactOnFlindBetrayal();

IF
TurnEnded(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _, _, _)
AND
GetFlag(PLA_ConflictedFlind_Event_TurnedOnGnolls_e106f8d7-1cc5-46a2-8b6d-46f2de0f4ea1, S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, 1, _, _)
AND NOT
DB_PLA_ConflictedFlind_GnollsReactOnFlindBetrayal(1, _, _, _, _)
THEN
PROC_PLA_ConflictedFlind_GnollsReactOnFlindBetrayal();

PROC
PROC_PLA_ConflictedFlind_GnollsReactOnFlindBetrayal()
AND NOT
DB_PLA_ConflictedFlind_GnollsReactOnFlindBetrayal(1, _, _, _, _)
THEN
DB_PLA_ConflictedFlind_GnollsReactOnFlindBetrayal(1);
PROC_SetRelation(ACT1_PLA_ConflictedFlind_GnollPack_6f5c2543-dadb-7f16-94d4-9c7e5f23acf2, ACT1_PLA_ConflictedFlind_Flind_df4d741f-a2b3-c281-a3a4-111dac02f109, 0);

PROC
PROC_PLA_ConflictedFlind_GnollsReactOnFlindBetrayal()
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetDualEntityEvent(_Var1, S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, "PLA_ConflictedFlind_Event_PlayReactionCombat", 1);

PROC
PROC_FlagReactionAfterDialog(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, PLA_ConflictedFlind_Event_TurnedOnGnolls_e106f8d7-1cc5-46a2-8b6d-46f2de0f4ea1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
AND
GetRelation(ACT1_PLA_ConflictedFlind_GnollPack_6f5c2543-dadb-7f16-94d4-9c7e5f23acf2, Hero_a1542c81-6895-929e-4522-10ce218bb360, _Var1, _Var1, _Var1)
AND
_Var1 > 0
THEN
PROC_SetRelationToPlayers(ACT1_PLA_ConflictedFlind_GnollPack_6f5c2543-dadb-7f16-94d4-9c7e5f23acf2, 0);

IF
FlagSet(PLA_ZhentShipment_State_JoinedFightWithGnolls_834c500f-8718-47b5-b320-8d37b2ad9b92, _, _, _, _)
AND
DB_PLA_ZhentShipment_AliveAgents(_Var3, _, _, _, _)
AND
DB_Is_InCombat(_Var3, _Var4, _, _, _)
AND
DB_Is_InCombat(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var4, _, _, _)
AND
GetFlag(PLA_ConflictedFlind_Event_TurnedOnGnolls_e106f8d7-1cc5-46a2-8b6d-46f2de0f4ea1, S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, 1, _, _)
AND NOT
QRY_PLA_ZhentShipment_AreZhentsAndPlayersHostile()
AND
QRY_OnlyOnce("PLA_ConflictedFlind_FlindAttacksPlayerAfterZhentsJoined", _, _, _, _)
THEN
PROC_SetRelationToPlayers(ACT1_PLA_ConflictedFlind_Flind_df4d741f-a2b3-c281-a3a4-111dac02f109, 0);

IF
CombatEnded((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Was_InCombat(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_Defeated(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(PLA_ConflictedFlind_State_RegularGnollsDead_7415a408-ed52-4e7c-8a96-fe697647e24a, _Var1, _Var1, _Var1, _Var1)
AND
GetFlag(PLA_ConflictedFlind_Event_TurnedOnGnolls_e106f8d7-1cc5-46a2-8b6d-46f2de0f4ea1, S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, 1, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_ChangeState(PLA_ConflictedFlind_State_AfterKilledRegularGnolls_51320d12-ea6d-4948-99dd-5cf372577fb2);
PROC_PLA_ConflictedFlind_FlindMovesAfterKillingGnolls();

PROC
PROC_PLA_ConflictedFlind_FlindMovesAfterKillingGnolls()
AND
GetClosestAlivePlayer(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var2, _Var1, _Var1)
AND
_Var2 < 25
THEN
PROC_CharacterMoveToAndTalk(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04, "PROC_PLA_ConflictedFlind_FlindMovesAfterKillingGnolls", "Run", 5, 1, 0);

PROC
PROC_PLA_ConflictedFlind_FlindMovesAfterKillingGnolls()
AND
GetClosestAlivePlayer(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var2, _Var1, _Var1)
AND
_Var2 >= 25
THEN
PROC_PLA_ConflictedFlind_FlindFailedToMoveAfterKillingGnolls();

IF
CharacterMoveToAndTalkFailed(_, _, "PROC_PLA_ConflictedFlind_FlindMovesAfterKillingGnolls", _, (CHARACTER)_)
THEN
PROC_PLA_ConflictedFlind_FlindFailedToMoveAfterKillingGnolls();

PROC
PROC_PLA_ConflictedFlind_FlindFailedToMoveAfterKillingGnolls()
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_FailedToTalkWithPlayer_556282ab-2667-4e93-80a0-3f75bb8d315e, _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(PLA_ConflictedFlind_State_FailedToTalkWithPlayer_556282ab-2667-4e93-80a0-3f75bb8d315e);
DB_SpotPlayers(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, "PLA_ConflictedFlind_FlindSpotter_AfterKilledGnolls", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);

PROC
PROC_SpotPlayers_Spotted((CHARACTER)_Var1, "PLA_ConflictedFlind_FlindSpotter_AfterKilledGnolls", (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Players(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(PLA_ConflictedFlind_State_AfterKilledRegularGnolls_51320d12-ea6d-4948-99dd-5cf372577fb2, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(PLA_ConflictedFlind_State_FailedToTalkWithPlayer_556282ab-2667-4e93-80a0-3f75bb8d315e, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_CharacterMoveToAndTalk(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var2, PLA_ConflictedFlind_Flind_e6a8c973-961f-8375-61ce-87a6dfbb3f04, "PROC_PLA_ConflictedFlind_FlindMovesAfterKillingGnolls_SecondAttempt", "Run", 15, 1, 0);

IF
CharacterMoveToAndTalkFailed(_, _, "PROC_PLA_ConflictedFlind_FlindMovesAfterKillingGnolls_SecondAttempt", _, (CHARACTER)_)
THEN
PROC_SetRelationToPlayers(ACT1_PLA_ConflictedFlind_Flind_df4d741f-a2b3-c281-a3a4-111dac02f109, 0);

PROC
PROC_FlagReactionAfterDialog(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, PLA_ConflictedFlind_Event_MindControl_KillHerself_89d4304d-1256-d655-a53f-b6c52f62d23f, _, _, _)
THEN
Die(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0);

QRY
QRY_PLA_ConflictedFlind_FlindNotTurnedOnGnollsOrDead()
AND
DB_Defeated(S_PLA_ConflictedFlind_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _, _, _, _)
THEN
DB_NOOP(1);

QRY
QRY_PLA_ConflictedFlind_FlindNotTurnedOnGnollsOrDead()
AND
GetFlag(PLA_ConflictedFlind_Event_TurnedOnGnolls_e106f8d7-1cc5-46a2-8b6d-46f2de0f4ea1, S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, 0, _, _)
THEN
DB_NOOP(1);

QRY
QRY_PLA_ConflictedFlind_FlindNotTurnedOnGnollsOrKilledThemOrDead()
AND
QRY_PLA_ConflictedFlind_FlindNotTurnedOnGnollsOrDead()
THEN
DB_NOOP(1);

QRY
QRY_PLA_ConflictedFlind_FlindNotTurnedOnGnollsOrKilledThemOrDead()
AND
DB_GlobalFlag(PLA_ConflictedFlind_State_AfterKilledRegularGnolls_51320d12-ea6d-4948-99dd-5cf372577fb2, _, _, _, _)
THEN
DB_NOOP(1);

IF
LeftTrigger((CHARACTER)_Var1, S_PLA_Plains_SUB_bcc3efa5-bfe1-4224-9df1-6758cac764cd, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_PLA_ConflictedFlind_CanAbandonZhents()
AND NOT
QRY_TriggerEvents_AnyPartyMemberInTrigger(S_PLA_Plains_SUB_bcc3efa5-bfe1-4224-9df1-6758cac764cd, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_AfterAbandoningZhents();

IF
LeftTrigger((CHARACTER)_Var1, S_PLA_ConflictedFlind_Cave_DangerZone_0aa90ecf-f46e-441e-ac25-8a9e236f2738, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_GlobalFlag(PLA_ZhentShipment_State_TouchedChest_1db4a628-dc86-4142-83cb-fe27d69532ef, _Var1, _Var1, _Var1, _Var1)
AND
QRY_PLA_ConflictedFlind_CanAbandonZhents()
AND NOT
QRY_TriggerEvents_AnyPartyMemberInTrigger(S_PLA_ConflictedFlind_Cave_DangerZone_0aa90ecf-f46e-441e-ac25-8a9e236f2738, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_AfterAbandoningZhents();

QRY
QRY_PLA_ConflictedFlind_CanAbandonZhents()
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_AfterLongRest_346fa778-1a8a-4793-9abf-f129445e0631, _, _, _, _)
AND
DB_GlobalFlag(PLA_ZhentShipment_Knows_SurvivorsInCave_6318e058-45f9-4640-a9f5-59489fccb843, _, _, _, _)
AND
DB_GlobalFlag(PLA_ConflictedFlind_Knows_Gnolls_c353a7d3-7561-05dc-c725-32e363ce6bf3, _, _, _, _)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_Gone_4152beef-e7d1-e10f-7b06-62584d3571f2, _, _, _, _)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_AfterLongRest_346fa778-1a8a-4793-9abf-f129445e0631, _, _, _, _)
THEN
DB_NOOP(1);

PROC
PROC_PLA_ConflictedFlind_AfterAbandoningZhents()
THEN
PROC_GlobalSetFlagAndCache(PLA_ConflictedFlind_State_AfterLongRest_346fa778-1a8a-4793-9abf-f129445e0631);

PROC
PROC_PLA_ConflictedFlind_AfterAbandoningZhents()
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
TriggerGetRandomPosition(S_PLA_ConflictedFlind_MainCombatArea_a45aa75d-81d7-4420-a69b-cee1d0174506, _Var2, _Var3, _Var4, _Var1)
AND
FindValidPosition(_Var2, _Var3, _Var4, 5, _Var1, 0, _Var5, _Var6, _Var7, _Var1)
THEN
TeleportToPosition(_Var1, _Var5, _Var6, _Var7, "", 0, 0, 1);

PROC
PROC_PLA_ConflictedFlind_AfterAbandoningZhents()
AND
DB_PLA_ZhentShipment_AliveAgents(_Var1, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(PLA_ZhentShipment_State_ReadyToLeaveCave_e458690a-ebd9-a0a1-e44e-acca93224b3e, _Var1, _Var1, _Var1, _Var1)
THEN
Die(_Var1, 0, 1);

PROC
PROC_PLA_ConflictedFlind_AfterAbandoningZhents()
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SelfHealing_Enable(_Var1);

PROC
PROC_PLA_ConflictedFlind_AfterAbandoningZhents()
THEN
PROC_PLA_ZhentShipment_MakeZhentsAndGnollsHostile();

IF
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_GLO_DefeatCounter(_Var1, "PLA_ConflictedFlind_Gnolls");

PROC
PROC_GLO_DefeatCounter_AllPermaDefeated("PLA_ConflictedFlind_Gnolls", _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(PLA_ConflictedFlind_State_Dead_89900583-c7c4-4f3b-9352-fda1fc57a9e2);

PROC
PROC_GLO_DefeatCounter_AllDefeated("PLA_ConflictedFlind_Gnolls", _, _, _, _)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_Gone_4152beef-e7d1-e10f-7b06-62584d3571f2, _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(PLA_ConflictedFlind_State_Gone_4152beef-e7d1-e10f-7b06-62584d3571f2);

IF
Dying((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_PLA_ConflictedFlind_GnollPack(_Var1);
DB_PLA_ConflictedFlind_DeadGnoll(_Var1);

IF
DB_PLA_ConflictedFlind_DeadGnoll(_, _, _, _, _)
AND NOT
DB_PLA_ConflictedFlind_GnollPack(_, _, _, _, _)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_Gone_4152beef-e7d1-e10f-7b06-62584d3571f2, _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(PLA_ConflictedFlind_State_Gone_4152beef-e7d1-e10f-7b06-62584d3571f2);

IF
DB_PLA_ConflictedFlind_DeadGnoll(_, _, _, _, _)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_RegularGnollsDead_7415a408-ed52-4e7c-8a96-fe697647e24a, _, _, _, _)
AND NOT
QRY_PLA_ConflictedFlind_RegularGnollsAlive()
THEN
PROC_GlobalSetFlagAndCache(PLA_ConflictedFlind_State_RegularGnollsDead_7415a408-ed52-4e7c-8a96-fe697647e24a);

QRY
QRY_PLA_ConflictedFlind_RegularGnollsAlive()
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
_Var1 != S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0
THEN
DB_NOOP(1);

IF
FlagSet(PLA_ConflictedFlind_State_Left_ac73cf2a-7b7f-4f41-8fc4-4e0ab6f73c70, _, _, _, _)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_Gone_4152beef-e7d1-e10f-7b06-62584d3571f2, _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(PLA_ConflictedFlind_State_Gone_4152beef-e7d1-e10f-7b06-62584d3571f2);

IF
EnteredTrigger((GUIDSTRING)_Var1, S_PLA_ZhentShipment_GnollBehaviorCommentArea_2895b396-8f1c-49fc-b97a-bfe427b4ce5c, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_OnSpotGnollsPack(_Var1);

IF
CombatStarted((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_Knows_Gnolls_c353a7d3-7561-05dc-c725-32e363ce6bf3, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_ConflictedFlind_GnollPack(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_PartyMembers(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OnlyOnce("PLA_ConflictedFlind_KnowGnollsOnCombatWithThem", _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_OnSpotGnollsPack(_Var3);

PROC
PROC_PLA_ConflictedFlind_OnSpotGnollsPack((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_Knows_Gnolls_c353a7d3-7561-05dc-c725-32e363ce6bf3, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_GlobalSetFlagAndCache(PLA_ConflictedFlind_Knows_Gnolls_c353a7d3-7561-05dc-c725-32e363ce6bf3);

IF
FlagSet(PLA_ZhentShipment_Quest_HasMet_5359e72b-f8ca-d2d6-4c3a-8fc00efe5c2c, _, _, _, _)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_Knows_Gnolls_c353a7d3-7561-05dc-c725-32e363ce6bf3, _, _, _, _)
THEN
PROC_GlobalSetFlagAndCache(PLA_ConflictedFlind_Knows_Gnolls_c353a7d3-7561-05dc-c725-32e363ce6bf3);

PROC
PROC_PLA_ConflictedFlind_OnSpotGnollsPack()
THEN
PROC_TriggerUnregisterForParty(S_PLA_ZhentShipment_GnollBehaviorCommentArea_2895b396-8f1c-49fc-b97a-bfe427b4ce5c);

PROC
PROC_PLA_ConflictedFlind_ChangeGnollsRelationToPlayers((INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1, (INTEGER)_Var1)
THEN
PROC_SetRelationToPlayers(ACT1_PLA_ConflictedFlind_GnollPack_6f5c2543-dadb-7f16-94d4-9c7e5f23acf2, _Var1);
PROC_SetRelationToPlayers(ACT1_PLA_ConflictedFlind_Flind_df4d741f-a2b3-c281-a3a4-111dac02f109, _Var1);

QRY
QRY_PLA_ConflictedFlind_GnollsHostile()
AND
GetRelation(ACT1_PLA_ConflictedFlind_Flind_df4d741f-a2b3-c281-a3a4-111dac02f109, Hero_a1542c81-6895-929e-4522-10ce218bb360, _Var1, _Var1, _Var1)
AND
_Var1 < 50
THEN
DB_NOOP(1);

IF
CombatStarted((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
QRY_PLA_ConflictedFlind_ShouldClearPeaceReturn(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ConfclitedFlind_ClearPeaceReturn();

PROC
PROC_PLA_ConfclitedFlind_ClearPeaceReturn()
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetEntityEvent(_Var1, "ClearPeaceReturn", 1);

QRY
QRY_PLA_ConflictedFlind_ShouldClearPeaceReturn((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GlobalFlag(PLA_ConflictedFlind_State_Instigate_273fb05a-4c2c-4816-8458-7af837d919a2, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_ConflictedFlind_GnollPack(_Var2, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var2, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_PLA_ConflictedFlind_ShouldClearPeaceReturn((GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_GlobalFlag(PLA_ConflictedFlind_State_Hostile_4ba98bb7-f66b-a105-b5fd-0569dd61b030, _Var1, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(S_PLA_ConflictedFlind_Gnoll_Boss_34464430-fed8-4f50-86d5-bd35846920a0, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

PROC
PROC_ConflictedFlind_DisableCrimesOnZhents()
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_AssaultFamilyIgnoreFor(_Var1, S_PLA_ZhentShipment_Agent_001_fd9b4edd-7828-4e22-85a9-ead2ba9d29e4);
DB_AssaultFamilyIgnoreFor(_Var1, S_PLA_ZhentShipment_Agent_002_7eda738e-8a85-4975-a1e1-1b3b2c4d641c);
DB_MurderIgnoreFor(_Var1, S_PLA_ZhentShipment_Agent_001_fd9b4edd-7828-4e22-85a9-ead2ba9d29e4);
DB_MurderIgnoreFor(_Var1, S_PLA_ZhentShipment_Agent_002_7eda738e-8a85-4975-a1e1-1b3b2c4d641c);

IF
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NoLowAttitudeDialog(_Var1);

IF
DB_PLA_ConflictedFlind_Howling(_Var1, _, _Var1, _Var1, _Var1)
THEN
PROC_TriggerRegisterForParty(_Var1);

IF
EnteredTrigger((GUIDSTRING)_Var1, (GUIDSTRING)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PLA_ConflictedFlind_Howling(_Var2, _Var3, _Var1, _Var1, _Var1)
AND
DB_PartyMembers(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
Concatenate("PLA_ConflictedFlind_HowlingSounds", _Var3, _Var4, _Var1, _Var1)
AND
QRY_OncePerUserAndNearbyPlayers(_Var1, _Var4, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ConflctedFlind_UnregisterHowling();
PlaySound(_Var1, _Var3);

PROC
PROC_PLA_ConflctedFlind_UnregisterHowling()
AND
DB_PLA_ConflictedFlind_Howling(_Var1, _, _Var1, _Var1, _Var1)
THEN
PROC_TriggerUnregisterForParty(_Var1);

PROC
PROC_ConflictedFlind_OnStateChanged((FLAG)_Var1, _, (FLAG)_Var1, (FLAG)_Var1, (FLAG)_Var1)
THEN
PROC_PLA_ConflctedFlind_UnregisterHowling();

IF
DB_PLA_ConflictedFlind_BloodSymbols(_Var1, _, _Var1, _Var1, _Var1)
THEN
PROC_TriggerRegisterForPlayers(_Var1);

IF
EnteredTrigger((GUIDSTRING)_Var1, (GUIDSTRING)_Var2, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_Players(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_ConflictedFlind_BloodSymbols(_Var2, _Var3, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_AfterKilledRegularGnolls_51320d12-ea6d-4948-99dd-5cf372577fb2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_TalkingToFlind_dd11bd98-c488-4964-83aa-765ddd7b0562, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_Instigate_273fb05a-4c2c-4816-8458-7af837d919a2, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_GlobalFlag(PLA_ConflictedFlind_State_Hostile_4ba98bb7-f66b-a105-b5fd-0569dd61b030, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_CantTalk(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
QRY_OncePerUserAndNearbyPlayers(_Var1, "PLA_ZhentShipment_FoundBloodSymbol", _Var1, _Var1, _Var1)
THEN
StartVoiceBark(VOICEBARKRESOURCEGUID_PLA_ZhentShipment_VB_BloodSymbol_ecb53599-72c2-aeba-d6c1-9052a8ac86c6, _Var1);
PROC_GlobalSetFlagAndCache(PLA_ZhentShipment_Quest_FoundBloodSymbol_79e44428-edb2-499a-b297-6f075c191073);
PROC_PlayPerceptionRevealEffect(_Var3, "PLA_ZhentShipment_BloodSymbolVFX");

PROC
PROC_PLA_ConflictedFlind_UnregisterBloodSymbolAreas()
AND
DB_PLA_ConflictedFlind_BloodSymbols(_Var1, _, _Var1, _Var1, _Var1)
THEN
PROC_TriggerUnregisterForPlayers(_Var1);

IF
EntityEvent((GUIDSTRING)_Var1, "PLA_ConflictedFlind_Event_GnollRushesIntoFire", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SelfHealing_Disable(_Var1);

IF
EntityEvent((GUIDSTRING)_Var1, "PLA_ConflictedFlind_Event_PlayAggressiveAnim", (GUIDSTRING)_Var1, (GUIDSTRING)_Var1, (GUIDSTRING)_Var1)
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_SelfHealing_Enable(_Var1);

IF
FlagSet(PLA_ZhentShipment_Debug_MakeGnollsHostile_7ba796b8-9ead-4e41-b2cf-fbb7e85be34e, _, _, (GUIDSTRING)_, (GUIDSTRING)_)
THEN
PROC_PLA_ConflictedFlind_ChangeGnollsRelationToPlayers(0);

IF
FlagSet(Debug_PLA_KillGnolls_5283045d-9655-55aa-0a55-213b7808f23c, _, _, _, _)
AND
DB_PLA_ConflictedFlind_GnollPack(_Var3, _, _, _, _)
AND NOT
DB_Dead(_Var3, _, _, _, _)
THEN
Die(_Var3, 0, 1);

IF
TextEvent("PLA_ConflictedFlind_KillGnolls", _, _, _, _)
THEN
SetFlag(Debug_PLA_KillGnolls_5283045d-9655-55aa-0a55-213b7808f23c, NULL_00000000-0000-0000-0000-000000000000, 0);

IF
TextEvent("PLA_ConflictedFlind_Instigate", _, _, _, _)
THEN
PROC_PLA_ConflictedFlind_StartInstigate(0);
PROC_PLA_ConflictedFlind_ChangeGnollsRelationToPlayers(0);

IF
TextEvent("PLA_ConflictedFlind_InstigateFriendly", _, _, _, _)
THEN
PROC_PLA_ConflictedFlind_StartInstigateAlliedWithGnolls();

IF
TextEvent("PLA_ConflictedFlind_HealGnolls", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
SetHitpointsPercentage(_Var1, 100);

IF
TextEvent("PLA_ConflictedFlind_MakeNeutral", _, _, _, _)
THEN
PROC_PLA_ConflictedFlind_ChangeGnollsRelationToPlayers(50);

IF
TextEvent("Test_GnollJoke", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
GetHostCharacter(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_MakeGnollsLaugh(_Var1);

PROC
PROC_FlagReactionAfterDialog((CHARACTER)_Var1, PLA_ConflictedFlind_Event_MakeGnollsLaugh_cf856e51-194f-4560-b51c-8dc2c29e568a, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
THEN
PROC_PLA_ConflictedFlind_MakeGnollsLaugh(_Var1);

PROC
PROC_PLA_ConflictedFlind_MakeGnollsLaugh((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_PLA_ConflictedFlind_GnollJoke_Caster(_, _, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var1, _, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_GnollJoke_Start(_Var1);

PROC
PROC_PLA_ConflictedFlind_GnollJoke_Start((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_PLA_ConflictedFlind_GnollJoke_Caster(_, _, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var1, _Var4, _Var1, _Var1, _Var1)
THEN
PauseCombat(_Var4);
DB_PLA_ConflictedFlind_GnollJoke_Caster(_Var1, _Var4);

PROC
PROC_PLA_ConflictedFlind_GnollJoke_Start(_, _, _, _, _)
AND
DB_PLA_ConflictedFlind_GnollJoke_Timer(_Var2, _, _, _, _)
THEN
NOT DB_PLA_ConflictedFlind_GnollJoke_Timer(_Var2);

PROC
PROC_PLA_ConflictedFlind_GnollJoke_Start(_, (CHARACTER)_, (CHARACTER)_, (CHARACTER)_, (CHARACTER)_)
THEN
DB_PLA_ConflictedFlind_GnollJoke_Timer(500);

PROC
PROC_PLA_ConflictedFlind_GnollJoke_Start((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_Is_InCombat(_Var1, _Var2, _Var1, _Var1, _Var1)
AND
DB_Is_InCombat(_Var3, _Var2, _Var1, _Var1, _Var1)
AND
QRY_PLA_ConflictedFlind_IsGnollOrHyena(_Var3, _Var1, _Var1, _Var1, _Var1)
AND NOT
DB_PLA_ConflictedFlind_GnollJoke_Awaiting(_Var3, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_ConflictedFlind_GnollJoke_Timer(_Var4, _Var1, _Var1, _Var1, _Var1)
AND
IntegerSum(_Var4, 300, _Var5, _Var1, _Var1)
THEN
NOT DB_PLA_ConflictedFlind_GnollJoke_Timer(_Var4);
DB_PLA_ConflictedFlind_GnollJoke_Timer(_Var5);
DB_PLA_ConflictedFlind_GnollJoke_Awaiting(_Var3);
RealtimeObjectTimerLaunch(_Var3, "PLA_ConflictedFlind_GnollJokeTimer", _Var4);

PROC
PROC_PLA_ConflictedFlind_GnollJoke_Start((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_PLA_ConflictedFlind_GnollJoke_Awaiting(_, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_ConflictedFlind_GnollJoke_Caster(_Var1, _Var3, _Var1, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_GnollJoke_Start_End();

QRY
QRY_PLA_ConflictedFlind_IsGnollOrHyena((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_ConflictedFlind_GnollPack(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_PLA_ConflictedFlind_IsGnollOrHyena((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_DyingHyena_GnollPack(_Var1, _, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

QRY
QRY_PLA_ConflictedFlind_IsGnollOrHyena((CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_DyingHyena_NewbornGnolls(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
DB_NOOP(1);

IF
ObjectTimerFinished((CHARACTER)_Var1, "PLA_ConflictedFlind_GnollJokeTimer", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND NOT
DB_Defeated(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_ConflictedFlind_GnollJoke_Awaiting(_Var1, _Var1, _Var1, _Var1, _Var1)
AND
DB_PLA_ConflictedFlind_GnollJoke_Caster(_Var2, _, _Var1, _Var1, _Var1)
AND
HasAppliedStatus(_Var1, "SILENCED", 0, _Var1, _Var1)
THEN
PROC_PLA_ConflictedFlind_ApplyLaughingStatus(_Var1, _Var2);

IF
ObjectTimerFinished((CHARACTER)_Var1, "PLA_ConflictedFlind_GnollJokeTimer", (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
DB_PLA_ConflictedFlind_GnollJoke_Awaiting(_Var1, _Var1, _Var1, _Var1, _Var1)
THEN
NOT DB_PLA_ConflictedFlind_GnollJoke_Awaiting(_Var1);
PROC_PLA_ConflictedFlind_GnollJoke_CheckEnd();

PROC
PROC_PLA_ConflictedFlind_ApplyLaughingStatus((CHARACTER)_Var1, (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
IsTagged(_Var1, GNOLL_1350164f-85e1-42f9-89c9-eb0c6703e890, 1, _Var1, _Var1)
THEN
ApplyStatus(_Var1, "PLA_LAUGHINGHARD_GNOLL", 12, 1, _Var2);

PROC
PROC_PLA_ConflictedFlind_ApplyLaughingStatus((CHARACTER)_Var1, (CHARACTER)_Var2, (CHARACTER)_Var1, (CHARACTER)_Var1, (CHARACTER)_Var1)
AND
IsTagged(_Var1, HYENA_035128b6-9778-4aa7-8f5f-6623aa4bf4c6, 1, _Var1, _Var1)
THEN
ApplyStatus(_Var1, "PLA_LAUGHINGHARD_HYENA", 12, 1, _Var2);

PROC
PROC_PLA_ConflictedFlind_GnollJoke_CheckEnd()
AND NOT
DB_PLA_ConflictedFlind_GnollJoke_Awaiting(_, _, _, _, _)
AND
DB_PLA_ConflictedFlind_GnollJoke_Caster(_Var2, _Var3, _, _, _)
THEN
PROC_PLA_ConflictedFlind_GnollJoke_Start_End();

PROC
PROC_PLA_ConflictedFlind_GnollJoke_Start_End()
AND
DB_PLA_ConflictedFlind_GnollJoke_Caster(_Var1, _Var2, _Var1, _Var1, _Var1)
THEN
NOT DB_PLA_ConflictedFlind_GnollJoke_Caster(_Var1, _Var2);
ResumeCombat(_Var2);


EXITSECTION
PROC_PLA_ConflictedFlind_UnregisterBloodSymbolAreas();
ENDEXITSECTION

ParentTargetEdge "Act1"
